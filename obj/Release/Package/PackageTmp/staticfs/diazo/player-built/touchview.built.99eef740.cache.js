function onYouTubePlayerAPIReady(){mejs.YouTubeApi.iFrameReady()}function onYouTubePlayerReady(e){mejs.YouTubeApi.flashReady(e)}(function(){var e=this,t=e._,i={},n=Array.prototype,a=Object.prototype,o=Function.prototype,r=n.push,s=n.slice,l=n.concat,c=a.toString,d=a.hasOwnProperty,h=n.forEach,u=n.map,p=n.reduce,m=n.reduceRight,f=n.filter,v=n.every,g=n.some,w=n.indexOf,_=n.lastIndexOf,y=Array.isArray,b=Object.keys,x=o.bind,S=function(e){return e instanceof S?e:this instanceof S?void(this._wrapped=e):new S(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.4.4";var T=S.each=S.forEach=function(e,t,n){if(null!=e)if(h&&e.forEach===h)e.forEach(t,n);else if(e.length===+e.length){for(var a=0,o=e.length;o>a;a++)if(t.call(n,e[a],a,e)===i)return}else for(var r in e)if(S.has(e,r)&&t.call(n,e[r],r,e)===i)return};S.map=S.collect=function(e,t,i){var n=[];return null==e?n:u&&e.map===u?e.map(t,i):(T(e,function(e,a,o){n[n.length]=t.call(i,e,a,o)}),n)};var C="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=S.bind(t,n)),a?e.reduce(t,i):e.reduce(t);if(T(e,function(e,o,r){a?i=t.call(n,i,e,o,r):(i=e,a=!0)}),!a)throw new TypeError(C);return i},S.reduceRight=S.foldr=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),m&&e.reduceRight===m)return n&&(t=S.bind(t,n)),a?e.reduceRight(t,i):e.reduceRight(t);var o=e.length;if(o!==+o){var r=S.keys(e);o=r.length}if(T(e,function(s,l,c){l=r?r[--o]:--o,a?i=t.call(n,i,e[l],l,c):(i=e[l],a=!0)}),!a)throw new TypeError(C);return i},S.find=S.detect=function(e,t,i){var n;return k(e,function(e,a,o){return t.call(i,e,a,o)?(n=e,!0):void 0}),n},S.filter=S.select=function(e,t,i){var n=[];return null==e?n:f&&e.filter===f?e.filter(t,i):(T(e,function(e,a,o){t.call(i,e,a,o)&&(n[n.length]=e)}),n)},S.reject=function(e,t,i){return S.filter(e,function(e,n,a){return!t.call(i,e,n,a)},i)},S.every=S.all=function(e,t,n){t||(t=S.identity);var a=!0;return null==e?a:v&&e.every===v?e.every(t,n):(T(e,function(e,o,r){return(a=a&&t.call(n,e,o,r))?void 0:i}),!!a)};var k=S.some=S.any=function(e,t,n){t||(t=S.identity);var a=!1;return null==e?a:g&&e.some===g?e.some(t,n):(T(e,function(e,o,r){return a||(a=t.call(n,e,o,r))?i:void 0}),!!a)};S.contains=S.include=function(e,t){return null==e?!1:w&&e.indexOf===w?-1!=e.indexOf(t):k(e,function(e){return e===t})},S.invoke=function(e,t){var i=s.call(arguments,2),n=S.isFunction(t);return S.map(e,function(e){return(n?t:e[t]).apply(e,i)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.where=function(e,t,i){return S.isEmpty(t)?i?null:[]:S[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},S.findWhere=function(e,t){return S.where(e,t,!0)},S.max=function(e,t,i){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-1/0;var n={computed:-1/0,value:-1/0};return T(e,function(e,a,o){var r=t?t.call(i,e,a,o):e;r>=n.computed&&(n={value:e,computed:r})}),n.value},S.min=function(e,t,i){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return T(e,function(e,a,o){var r=t?t.call(i,e,a,o):e;r<n.computed&&(n={value:e,computed:r})}),n.value},S.shuffle=function(e){var t,i=0,n=[];return T(e,function(e){t=S.random(i++),n[i-1]=n[t],n[t]=e}),n};var P=function(e){return S.isFunction(e)?e:function(t){return t[e]}};S.sortBy=function(e,t,i){var n=P(t);return S.pluck(S.map(e,function(e,t,a){return{value:e,index:t,criteria:n.call(i,e,t,a)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index<t.index?-1:1}),"value")};var E=function(e,t,i,n){var a={},o=P(t||S.identity);return T(e,function(t,r){var s=o.call(i,t,r,e);n(a,s,t)}),a};S.groupBy=function(e,t,i){return E(e,t,i,function(e,t,i){(S.has(e,t)?e[t]:e[t]=[]).push(i)})},S.countBy=function(e,t,i){return E(e,t,i,function(e,t){S.has(e,t)||(e[t]=0),e[t]++})},S.sortedIndex=function(e,t,i,n){i=null==i?S.identity:P(i);for(var a=i.call(n,t),o=0,r=e.length;r>o;){var s=o+r>>>1;i.call(n,e[s])<a?o=s+1:r=s}return o},S.toArray=function(e){return e?S.isArray(e)?s.call(e):e.length===+e.length?S.map(e,S.identity):S.values(e):[]},S.size=function(e){return null==e?0:e.length===+e.length?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:s.call(e,0,t)},S.initial=function(e,t,i){return s.call(e,0,e.length-(null==t||i?1:t))},S.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},S.rest=S.tail=S.drop=function(e,t,i){return s.call(e,null==t||i?1:t)},S.compact=function(e){return S.filter(e,S.identity)};var D=function(e,t,i){return T(e,function(e){S.isArray(e)?t?r.apply(i,e):D(e,t,i):i.push(e)}),i};S.flatten=function(e,t){return D(e,t,[])},S.without=function(e){return S.difference(e,s.call(arguments,1))},S.uniq=S.unique=function(e,t,i,n){S.isFunction(t)&&(n=i,i=t,t=!1);var a=i?S.map(e,i,n):e,o=[],r=[];return T(a,function(i,n){(t?n&&r[r.length-1]===i:S.contains(r,i))||(r.push(i),o.push(e[n]))}),o},S.union=function(){return S.uniq(l.apply(n,arguments))},S.intersection=function(e){var t=s.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=l.apply(n,s.call(arguments,1));return S.filter(e,function(e){return!S.contains(t,e)})},S.zip=function(){for(var e=s.call(arguments),t=S.max(S.pluck(e,"length")),i=new Array(t),n=0;t>n;n++)i[n]=S.pluck(e,""+n);return i},S.object=function(e,t){if(null==e)return{};for(var i={},n=0,a=e.length;a>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},S.indexOf=function(e,t,i){if(null==e)return-1;var n=0,a=e.length;if(i){if("number"!=typeof i)return n=S.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,a+i):i}if(w&&e.indexOf===w)return e.indexOf(t,i);for(;a>n;n++)if(e[n]===t)return n;return-1},S.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(_&&e.lastIndexOf===_)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var a=n?i:e.length;a--;)if(e[a]===t)return a;return-1},S.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),a=0,o=new Array(n);n>a;)o[a++]=e,e+=i;return o},S.bind=function(e,t){if(e.bind===x&&x)return x.apply(e,s.call(arguments,1));var i=s.call(arguments,2);return function(){return e.apply(t,i.concat(s.call(arguments)))}},S.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},S.bindAll=function(e){var t=s.call(arguments,1);return 0===t.length&&(t=S.functions(e)),T(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var i={};return t||(t=S.identity),function(){var n=t.apply(this,arguments);return S.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},S.delay=function(e,t){var i=s.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(s.call(arguments,1)))},S.throttle=function(e,t){var i,n,a,o,r=0,s=function(){r=new Date,a=null,o=e.apply(i,n)};return function(){var l=new Date,c=t-(l-r);return i=this,n=arguments,0>=c?(clearTimeout(a),a=null,r=l,o=e.apply(i,n)):a||(a=setTimeout(s,c)),o}},S.debounce=function(e,t,i){var n,a;return function(){var o=this,r=arguments,s=function(){n=null,i||(a=e.apply(o,r))},l=i&&!n;return clearTimeout(n),n=setTimeout(s,t),l&&(a=e.apply(o,r)),a}},S.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},S.wrap=function(e,t){return function(){var i=[e];return r.apply(i,arguments),t.apply(this,i)}},S.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},S.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},S.keys=b||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)S.has(e,i)&&(t[t.length]=i);return t},S.values=function(e){var t=[];for(var i in e)S.has(e,i)&&t.push(e[i]);return t},S.pairs=function(e){var t=[];for(var i in e)S.has(e,i)&&t.push([i,e[i]]);return t},S.invert=function(e){var t={};for(var i in e)S.has(e,i)&&(t[e[i]]=i);return t},S.functions=S.methods=function(e){var t=[];for(var i in e)S.isFunction(e[i])&&t.push(i);return t.sort()},S.extend=function(e){return T(s.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},S.pick=function(e){var t={},i=l.apply(n,s.call(arguments,1));return T(i,function(i){i in e&&(t[i]=e[i])}),t},S.omit=function(e){var t={},i=l.apply(n,s.call(arguments,1));for(var a in e)S.contains(i,a)||(t[a]=e[a]);return t},S.defaults=function(e){return T(s.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e};var A=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof S&&(e=e._wrapped),t instanceof S&&(t=t._wrapped);var a=c.call(e);if(a!=c.call(t))return!1;switch(a){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=i.length;o--;)if(i[o]==e)return n[o]==t;i.push(e),n.push(t);var r=0,s=!0;if("[object Array]"==a){if(r=e.length,s=r==t.length)for(;r--&&(s=A(e[r],t[r],i,n)););}else{var l=e.constructor,d=t.constructor;if(l!==d&&!(S.isFunction(l)&&l instanceof l&&S.isFunction(d)&&d instanceof d))return!1;for(var h in e)if(S.has(e,h)&&(r++,!(s=S.has(t,h)&&A(e[h],t[h],i,n))))break;if(s){for(h in t)if(S.has(t,h)&&!r--)break;s=!r}}return i.pop(),n.pop(),s};S.isEqual=function(e,t){return A(e,t,[],[])},S.isEmpty=function(e){if(null==e)return!0;if(S.isArray(e)||S.isString(e))return 0===e.length;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!(!e||1!==e.nodeType)},S.isArray=y||function(e){return"[object Array]"==c.call(e)},S.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){S["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),S.isArguments(arguments)||(S.isArguments=function(e){return!(!e||!S.has(e,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(e){return"function"==typeof e}),S.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},S.isNaN=function(e){return S.isNumber(e)&&e!=+e},S.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},S.isNull=function(e){return null===e},S.isUndefined=function(e){return void 0===e},S.has=function(e,t){return d.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,i){for(var n=Array(e),a=0;e>a;a++)n[a]=t.call(i,a);return n},S.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var $={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};$.unescape=S.invert($.escape);var I={escape:new RegExp("["+S.keys($.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys($.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(e){S[e]=function(t){return null==t?"":(""+t).replace(I[e],function(t){return $[e][t]})}}),S.result=function(e,t){if(null==e)return null;var i=e[t];return S.isFunction(i)?i.call(e):i},S.mixin=function(e){T(S.functions(e),function(t){var i=S[t]=e[t];S.prototype[t]=function(){var e=[this._wrapped];return r.apply(e,arguments),j.call(this,i.apply(S,e))}})};var O=0;S.uniqueId=function(e){var t=++O+"";return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(e,t,i){if(S.isFunction(e))return t?e(t):e;var n;i=S.defaults({},i,S.templateSettings);var a=new RegExp([(i.escape||N).source,(i.interpolate||N).source,(i.evaluate||N).source].join("|")+"|$","g"),o=0,r="__p+='",s=e;e.replace(a,function(t,i,n,a,s){return r+=e.slice(o,s).replace(M,function(e){return"\\"+R[e]}),i&&(r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(r+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(r+="';\n"+a+"\n__p+='"),o=s+t.length,t}),r+="';\n",i.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{n=new Function(i.variable||"obj","_",r)}catch(l){throw l.source=r,l}if(t)return n(t,S);var c=function(e){return n.call(this,e,S)};return c.source="function("+(i.variable||"obj")+"){\n"+r+"}",c.textsource=s,c},S.chain=function(e){return S(e).chain()};var j=function(e){return this._chain?S(e).chain():e};S.mixin(S),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];S.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],j.call(this,i)}}),T(["concat","join","slice"],function(e){var t=n[e];S.prototype[e]=function(){return j.call(this,t.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this),define("underscore",function(e){return function(){var t;return t||e._}}(this)),function(){var e,t=this,i=t.Backbone,n=[],a=n.push,o=n.slice,r=n.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="0.9.10";var s=t._;!s&&"undefined"!=typeof require&&(s=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var l=/\s+/,c=function(e,t,i,n){if(!i)return!0;if("object"==typeof i)for(var a in i)e[t].apply(e,[a,i[a]].concat(n));else{if(!l.test(i))return!0;i=i.split(l),a=0;for(var o=i.length;o>a;a++)e[t].apply(e,[i[a]].concat(n))}},d=function(e,t){var i,n=-1,a=e.length;switch(t.length){case 0:for(;++n<a;)(i=e[n]).callback.call(i.ctx);break;case 1:for(;++n<a;)(i=e[n]).callback.call(i.ctx,t[0]);break;case 2:for(;++n<a;)(i=e[n]).callback.call(i.ctx,t[0],t[1]);break;case 3:for(;++n<a;)(i=e[n]).callback.call(i.ctx,t[0],t[1],t[2]);break;default:for(;++n<a;)(i=e[n]).callback.apply(i.ctx,t)}},n=e.Events={on:function(e,t,i){return c(this,"on",e,[t,i])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:i,ctx:i||this}),this):this},once:function(e,t,i){if(!c(this,"once",e,[t,i])||!t)return this;var n=this,a=s.once(function(){n.off(e,a),t.apply(this,arguments)});return a._callback=t,this.on(e,a,i),this},off:function(e,t,i){var n,a,o,r,l,d,h,u;if(!this._events||!c(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events={},this;for(r=e?[e]:s.keys(this._events),l=0,d=r.length;d>l;l++)if(e=r[l],n=this._events[e]){if(o=[],t||i)for(h=0,u=n.length;u>h;h++)a=n[h],(t&&t!==a.callback&&t!==a.callback._callback||i&&i!==a.context)&&o.push(a);this._events[e]=o}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&d(i,t),n&&d(n,arguments),this},listenTo:function(e,t,i){var n=this._listeners||(this._listeners={}),a=e._listenerId||(e._listenerId=s.uniqueId("l"));return n[a]=e,e.on(t,"object"==typeof t?this:i,this),this},stopListening:function(e,t,i){var n=this._listeners;if(n){if(e)e.off(t,"object"==typeof t?this:i,this),!t&&!i&&delete n[e._listenerId];else{"object"==typeof t&&(i=this);for(var a in n)n[a].off(t,i,this);this._listeners={}}return this}}};n.bind=n.on,n.unbind=n.off,s.extend(e,n);var h=e.Model=function(e,t){var i,n=e||{};this.cid=s.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(n=this.parse(n,t)||{}),(i=s.result(this,"defaults"))&&(n=s.defaults({},n,i)),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};s.extend(h.prototype,n,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return s.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,a,o,r,l,c,d;if(null==e)return this;if("object"==typeof e?(a=e,i=t):(a={})[e]=t,i||(i={}),!this._validate(a,i))return!1;o=i.unset,r=i.silent,e=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=s.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in a&&(this.id=a[this.idAttribute]);for(n in a)t=a[n],s.isEqual(d[n],t)||e.push(n),s.isEqual(c[n],t)?delete this.changed[n]:this.changed[n]=t,o?delete d[n]:d[n]=t;if(!r)for(e.length&&(this._pending=!0),t=0,n=e.length;n>t;t++)this.trigger("change:"+e[t],this,d[e[t]],i);if(l)return this;if(!r)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._changing=this._pending=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t,i={};for(t in this.attributes)i[t]=void 0;return this.set(i,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,i,n=!1,a=this._changing?this._previousAttributes:this.attributes;for(i in e)s.isEqual(a[i],t=e[i])||((n||(n={}))[i]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,i,n){return e.set(e.parse(i,n),n)?void(t&&t(e,i,n)):!1},this.sync("read",this,e)},save:function(e,t,i){var n,a,o=this.attributes;return null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,!n||i&&i.wait||this.set(n,i)?(i=s.extend({validate:!0},i),this._validate(n,i)?(n&&i.wait&&(this.attributes=s.extend({},o,n)),void 0===i.parse&&(i.parse=!0),a=i.success,i.success=function(e,t,i){e.attributes=o;var r=e.parse(t,i);return i.wait&&(r=s.extend(n||{},r)),s.isObject(r)&&!e.set(r,i)?!1:void(a&&a(e,t,i))},e=this.isNew()?"create":i.patch?"patch":"update","patch"===e&&(i.attrs=n),e=this.sync(e,this,i),n&&i.wait&&(this.attributes=o),e):!1):!1},destroy:function(e){e=e?s.clone(e):{};var t=this,i=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(e,t,a){(a.wait||e.isNew())&&n(),i&&i(e,t,a)},this.isNew())return e.success(this,null,e),!1;var a=this.sync("delete",this,e);return e.wait||n(),a},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||P();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,t||{}),!1):!0}});var u=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))};s.extend(u.prototype,n,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var i,n,o,l,c,d,h,u,p,m;for(h=[],u=t.at,p=this.comparator&&null==u&&0!=t.sort,m=s.isString(this.comparator)?this.comparator:null,i=0,n=e.length;n>i;i++)(o=this._prepareModel(l=e[i],t))?(c=this.get(o))?t.merge&&(c.set(l===o?o.attributes:l,t),p&&!d&&c.hasChanged(m)&&(d=!0)):(h.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)):this.trigger("invalid",this,l,t);if(h.length&&(p&&(d=!0),this.length+=h.length,null!=u?r.apply(this.models,[u,0].concat(h)):a.apply(this.models,h)),d&&this.sort({silent:!0}),t.silent)return this;for(i=0,n=h.length;n>i;i++)(o=h[i]).trigger("add",o,this,t);return d&&this.trigger("sort",this,t),this},remove:function(e,t){e=s.isArray(e)?e.slice():[e],t||(t={});var i,n,a,o;for(i=0,n=e.length;n>i;i++)(o=this.get(e[i]))&&(delete this._byId[o.id],delete this._byId[o.cid],a=this.indexOf(o),this.models.splice(a,1),this.length--,t.silent||(t.index=a,o.trigger("remove",o,this,t)),this._removeReference(o));return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null!=e?(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e]):void 0},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),s.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(s.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return s.invoke(this.models,"get",e)},update:function(e,t){t=s.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var i,n,a,o,r=[],l=[],c={};if(s.isArray(e)||(e=e?[e]:[]),t.add&&!t.remove)return this.add(e,t);for(n=0,a=e.length;a>n;n++)i=e[n],o=this.get(i),t.remove&&o&&(c[o.cid]=!0),(t.add&&!o||t.merge&&o)&&r.push(i);if(t.remove)for(n=0,a=this.models.length;a>n;n++)i=this.models[n],c[i.cid]||l.push(i);return l.length&&this.remove(l,t),r.length&&this.add(r,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var i=0,n=this.models.length;n>i;i++)this._removeReference(this.models[i]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,i,n){e[n.update?"update":"reset"](i,n),t&&t(e,i,n)},this.sync("read",this,e)},create:function(e,t){if(t=t?s.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,n=t.success;return t.success=function(e,t,a){a.wait&&i.add(e,a),n&&n(e,t,a)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var i=new this.model(e,t);return i._validate(e,t)?i:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"===e||"remove"===e)&&i!==this||("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,i){t||(t=this.comparator);var n=s.isFunction(t)?t:function(e){return e.get(t)};return s.sortedIndex(this.models,e,n,i)}}),s.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(e){u.prototype[e]=function(){var t=o.call(arguments);return t.unshift(this.models),s[e].apply(s,t)}}),s.each(["groupBy","countBy","sortBy"],function(e){u.prototype[e]=function(t,i){var n=s.isFunction(t)?t:function(e){return e.get(t)};return s[e](this.models,n,i)}});var p=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},m=/\((.*?)\)/g,f=/(\(\?)?:\w+/g,v=/\*\w+/g,g=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(p.prototype,n,{initialize:function(){},route:function(t,i,n){return s.isRegExp(t)||(t=this._routeToRegExp(t)),n||(n=this[i]),e.history.route(t,s.bind(function(a){a=this._extractParameters(t,a),n&&n.apply(this,a),this.trigger.apply(this,["route:"+i].concat(a)),this.trigger("route",i,a),e.history.trigger("route",this,i,a)},this)),this},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes)for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(g,"\\$&").replace(m,"(?:$1)?").replace(f,function(e,t){return t?e:"([^/]+)"}).replace(v,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var w=e.History=function(){this.handlers=[],s.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,y=/^\/+|\/+$/g,b=/msie [\w.]+/,x=/\/$/;w.started=!1,s.extend(w.prototype,n,{interval:50,getHash:function(e){return(e=(e||this).location.href.match(/#(.*)$/))?e[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(x,"");e.indexOf(i)||(e=e.substr(i.length))}else e=this.getHash();return e.replace(_,"")},start:function(t){if(w.started)throw Error("Backbone.history has already been started");w.started=!0,this.options=s.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState),t=this.getFragment();var i=document.documentMode,i=b.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);return this.root=("/"+this.root+"/").replace(y,"/"),i&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,t=this.location,i=t.pathname.replace(/[^\/]$/,"$&/")===this.root,this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!i?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&i&&t.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment+t.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),w.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return s.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(e,t){if(!w.started)return!1;if(t&&!0!==t||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var i=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,i){i?(i=e.href.replace(/(javascript:|#).*$/,""),e.replace(i+"#"+t)):e.hash="#"+t}}),e.history=new w;var S=e.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},T=/^(\S+)\s*(.*)$/,C="model collection el id attributes className tagName events".split(" ");s.extend(S.prototype,n,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=s.result(this,"events"))){this.undelegateEvents();for(var t in e){var i=e[t];if(s.isFunction(i)||(i=this[e[t]]),!i)throw Error('Method "'+e[t]+'" does not exist');var n=t.match(T),a=n[1],n=n[2],i=s.bind(i,this),a=a+(".delegateEvents"+this.cid);""===n?this.$el.on(a,i):this.$el.on(a,n,i)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},s.result(this,"options"),e)),s.extend(this,s.pick(e,C)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"),!1);else{var t=s.extend({},s.result(this,"attributes"));this.id&&(t.id=s.result(this,"id")),this.className&&(t["class"]=s.result(this,"className")),t=e.$("<"+s.result(this,"tagName")+">").attr(t),this.setElement(t,!1)}}});var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.sync=function(t,i,n){var a=k[t];s.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:a,dataType:"json"};if(n.url||(o.url=s.result(i,"url")||P()),null!=n.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){o.type="POST",n.emulateJSON&&(o.data._method=a);var r=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",a),r?r.apply(this,arguments):void 0}}"GET"!==o.type&&!n.emulateJSON&&(o.processData=!1);var l=n.success;n.success=function(e){l&&l(i,e,n),i.trigger("sync",i,e,n)};var c=n.error;return n.error=function(e){c&&c(i,e,n),i.trigger("error",i,e,n)},t=n.xhr=e.ajax(s.extend(o,n)),i.trigger("request",i,t,n),t},e.ajax=function(){return e.$.ajax.apply(e.$,arguments)},h.extend=u.extend=p.extend=S.extend=w.extend=function(e,t){var i,n=this;i=e&&s.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},s.extend(i,n,t);var a=function(){this.constructor=i};return a.prototype=n.prototype,i.prototype=new a,e&&s.extend(i.prototype,e),i.__super__=n.prototype,i};var P=function(){throw Error('A "url" property or function must be specified')}}.call(this),define("backbone",["underscore","jquery"],function(e){return function(){var t;return t||e.Backbone}}(this)),define("text",["module"],function(e){var t,i,n,a,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),d=l&&location.hostname,h=l&&(location.port||void 0),u=[],p=e.config&&e.config()||{};
return t={version:"2.0.5+",strip:function(e){if(e){e=e.replace(r,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=o[t];try{e=new ActiveXObject(i)}catch(n){}if(e){o=[i];break}}return e},parseName:function(e){var t,i,n,a=!1,o=e.indexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!r||o>1)?(t=e.substring(0,o),i=e.substring(o+1,e.length)):t=e,n=i||t,o=n.indexOf("!"),-1!==o&&(a="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:t=n),{moduleName:t,ext:i,strip:a}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,a){var o,r,s,l=t.xdRegExp.exec(e);return l?(o=l[2],r=l[3],r=r.split(":"),s=r[1],r=r[0],!(o&&o!==i||r&&r.toLowerCase()!==n.toLowerCase()||(s||r)&&s!==a)):!0},finishLoad:function(e,i,n,a){n=i?t.strip(n):n,p.isBuild&&(u[e]=n),a(n)},load:function(e,i,n,a){if(a.isBuild&&!a.inlineText)return void n();p.isBuild=a.isBuild;var o=t.parseName(e),r=o.moduleName+(o.ext?"."+o.ext:""),s=i.toUrl(r),u=p.useXhr||t.useXhr;!l||u(s,c,d,h)?t.get(s,function(i){t.finishLoad(e,o.strip,i,n)},function(e){n.error&&n.error(e)}):i([r],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)})},write:function(e,i,n){if(u.hasOwnProperty(i)){var a=t.jsEscape(u[i]);n.asModule(e+"!"+i,"define(function () { return '"+a+"';});\n")}},writeFile:function(e,i,n,a,o){var r=t.parseName(i),s=r.ext?"."+r.ext:"",l=r.moduleName+s,c=n.toUrl(r.moduleName+s)+".js";t.load(l,n,function(){var i=function(e){return a(c,e)};i.asModule=function(e,t){return a.asModule(e,c,t)},t.write(e,l,i,o)},o)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(i=require.nodeRequire("fs"),t.get=function(e,t){var n=i.readFileSync(e,"utf8");0===n.indexOf("ï»¿")&&(n=n.substring(1)),t(n)}):"xhr"===p.env||!p.env&&t.createXhr()?t.get=function(e,i,n,a){var o,r=t.createXhr();if(r.open("GET",e,!0),a)for(o in a)a.hasOwnProperty(o)&&r.setRequestHeader(o.toLowerCase(),a[o]);p.onXhr&&p.onXhr(r,e),r.onreadystatechange=function(){var t,a;4===r.readyState&&(t=r.status,t>399&&600>t?(a=new Error(e+" HTTP status: "+t),a.xhr=r,n(a)):i(r.responseText))},r.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,a="utf-8",o=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),a)),l="";try{for(i=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),i.append(n);null!==(n=s.readLine());)i.append(r),i.append(n);l=String(i.toString())}finally{s.close()}t(l)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,a=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var i,o,r={},s=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream),i.init(s,1,0,!1),o=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream),o.init(i,"utf-8",i.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(i.available(),r),o.close(),i.close(),t(r.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),t}),define("text!interaction_view/template/message.js",[],function(){return'<div class="status <%=type%>">\n<p><%=msg%></p>\n<a href="#" class="close">Close</a>\n</div>'}),define("text!interaction_view/template/slidenumber.js",[],function(){return'<%if(slidelength>1){%>\n<% if(iDetail.slideno_horizontal){%>\n<nav class="iView nav-horizen slidenumber" data-id="<%=id%>" style="left:<%=iDetail.slideno_horizontal_data.x%>px;top:<%=iDetail.slideno_horizontal_data.y%>px;" data-x="<%=iDetail.slideno_horizontal_data.x%>" data-y="<%=iDetail.slideno_horizontal_data.y%>">\n    <%for(i=0;i<slidelength;i++){%><li class="<%=0==i?"active":""%>"><a href="#" data-index="<%=i%>"></a></li><% } %>\n</nav>\n<% } %>\n<% if(iDetail.slideno_vertical){%>\n<nav class="iView nav-vertical slidenumber" data-id="<%=id%>" style="left:<%=iDetail.slideno_vertical_data.x%>px;top:<%=iDetail.slideno_vertical_data.y%>px;" data-x="<%=iDetail.slideno_vertical_data.x%>" data-y="<%=iDetail.slideno_vertical_data.y%>">\n    <%for(i=0;i<slidelength;i++){%><li class="<%=0==i?"active":""%>"><a href="#" data-index="<%=i%>"></a></li><% } %>\n</nav>\n<% } %>\n<% } %>\n'}),define("text!interaction_view/template/imgpreview.js",[],function(){return'<div class="btn-group action-control" style="position: absolute;left: 0;top: 0;z-index: 100001;background: transparent;width: 100%;height: 100%;">\n    <button class="btn preview-left enabled" href="#" rel="tooltip" data-original-title="PREV" style="color: #FFF;position: absolute;left: 0;top: 50%;background-color: transparent;background: none;">\n        <i class="icon-chevron-left icon-2x"></i>\n    </button>\n    <button class="btn preview-right enabled" href="#" rel="tooltip" data-original-title="NEXT" style="color: #FFF;background: transparent;position: absolute;right: 0px;top: 50%;">\n        <i class="icon-chevron-right icon-2x"></i>\n    </button>\n</div>'}),function(){var e={uuid:function(e){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}if(e){for(var i="";e--;)i+=t();return i}return t()+t()+t()+t()+t()+t()+t()+t()},changeURLPar:function(e,t,i){var n,a=e.split("#")[0];if(-1!=a.indexOf("?")){var o="";o=a.substr(a.indexOf("?")+1);var r,s="",l="",c="0";if(-1!=o.indexOf("&")){r=o.split("&");for(var d=0;d<r.length;d++){if(r[d].split("=")[0]==t){if(""==i)continue;l=i,c="1"}else l=r[d].split("=")[1];s=s+r[d].split("=")[0]+"="+l+"&"}s=s.substr(0,s.length-1),"0"==c&&""!=i&&s==o&&(s=s+"&"+t+"="+i)}else-1!=o.indexOf("=")?(r=o.split("="),r[0]==t?(l=i,c="1"):l=r[1],""!=l&&(s=r[0]+"="+l),"0"==c&&s==o&&""!=i&&(s=s+"&"+t+"="+i)):""!=i&&(s=t+"="+i);n=a.substr(0,a.indexOf("?")),""!=s&&(n=n+"?"+s)}else n=""!=i?a+"?"+t+"="+i:a;return e.indexOf("#")>0&&(n=n+"#"+e.split("#")[1]),n},getUrlParameterByName:function(e,t){var i=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),n=new RegExp("([\\?&]"+i+"=([^&#]*))+"),a=n.exec("undefined"!=typeof t&&t||location.search);return null==a?null:decodeURIComponent(a[a.length-1].replace(/\+/g," "))},replaceUrlParameterByName:function(e,t,i){var n=t.split("=")[1];return this.changeURLPar(i,e,n)},getHashParameterByName:function(e){var t=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),i=new RegExp("[\\#&]"+t+"=([^&#]*)"),n=i.exec(location.hash);return null==n?null:decodeURIComponent(n[1].replace(/\+/g," "))},replaceHashParameterByName:function(e,t){var i=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),n=new RegExp("[\\#&]"+i+"=([^&#]*)"),a=n.exec(location.hash);return location.hash.replace(a[0].substr(1),t)},parseTemplate:function(e){var t=null;return"function"==typeof e&&(t=e),"string"==typeof e&&(t=_.template(e)),t},renderT:function(e,t,i,n,a){if(!e)return!1;t||(t={});var o=n||null,r=$.extend(!0,{},t);if(o&&"undefined"!=typeof _gDebug&&_gDebug&&_g.debug&&_g.debug.enabled&&_g.debug.query_user_template(o)&&!a&&(e=_g.debug.query_user_template(o)),i){var s={};s[i]=r,r=s}var l=_g.parseTemplate(e);o&&_g.debug&&_g.debug.enabled&&(_g.debug.template[o]={data:r,template:"string"==typeof e?e:e.textsource,debug:!0});var c=$(l(r));return o&&_g.debug&&_g.debug.enabled&&(_g.debug.template[o].el=c),_g.generator&&(_g.generator.autoWidget(c),(c.hasClass("c-slimscroll")||c.find(".c-slimscroll").length)&&_g.generator.autoScroll(c)),c.find("[data-toggle=tooltip],.c-tooltip-btn").each(function(){var e=$(this),t=$(this).data().template;t?require(["text!"+t],function(){var i=require("text!"+t);e.tooltip({template:i})}):$(this).tooltip()}),c},domExist:function(e,t){return t||(t=document),"string"==typeof e&&(e=$(e)),$.contains(t.documentElement,e[0])},browserSupport:function(e){var t=!1,i={msie:1,chrome:1,mozilla:1,safari:1,opera:1,success:null,fail:null};e=e?$.extend(!0,{},i,e):$.extend(!0,{},i);var n=parseInt($.browser.version,10);return $.browser.msie&&1==e.msie||$.browser.chrome&&1==e.chrome||$.browser.mozilla&&1==e.mozilla||$.browser.safari&&1==e.safrai&&$.browser.opera&&1==e.opera?t=!0:$.browser.msie&&0==e.msie||$.browser.chrome&&0==e.chrome||$.browser.mozilla&&0==e.mozilla||$.browser.safari&&0==e.safrai&&$.browser.opera&&0==e.opera?t=!1:($.browser.msie&&(t=n>=e.msie),$.browser.chrome&&(t=n>=e.chrome),$.browser.mozilla&&(t=n>=e.mozilla),$.browser.opera&&(t=n>=e.opera),$.browser.safari&&(t=n>=e.safari)),t?e.success&&e.success():e.fail&&e.fail(),t},array:{moveup:function(e,t){var i=e.indexOf(t);return i>0&&(e=_g.array.swap(e,i,i-1)),e},movedown:function(e,t){var i=e.indexOf(t);return i<e.length&&(e=_g.array.swap(e,i,i+1)),e},swap:function(e,t,i){return e[t]=e.splice(i,1,e[t])[0],e},move2first:function(e,t){var n=[];for(n.push(t),i=0;i<e.length;i++)e[i]!=t&&n.push(e[i]);return n},move2last:function(e,t){var n=[];for(i=0;i<e.length;i++)e[i]!=t&&n.push(e[i]);return n.push(t),n},randomPick:function(e){return e[Math.floor(Math.random()*e.length)]},maptree:function(e){var t={treesource:null,mapdata:null,idAttribute:"id"};if(e=e?$.extend(!0,{},t,e):$.extend(!0,{},t),!e.treesource||!e.mapdata)return[];var i=[];return _.each(e.treesource,function(t){t.children&&(t.children=_g.array.maptree({treesource:t.children,mapdata:e.mapdata,idAttribute:e.idAttribute}));var n=_.find(e.mapdata,function(i){return i[e.idAttribute]==t[e.idAttribute]});n&&(t=$.extend(!0,t,n)),i.push(t)}),i},toDict:function(e,t){var n,a={};for(i=0;i<e.length;i++)n=e[i][t],a[n]=e[i];return a},treeToList:function(e,t,i){var n={childrenKey:"children",parentKey:"parent",idAttribute:"id"};if(t=t?$.extend(!0,{},n,t):$.extend(!0,{},n),!e)return[];var a=[];return _.each(e,function(n){if(n[t.childrenKey].length){var o=_g.array.toTreeList(n[t.childrenKey],t,i?i:e);for(j=0;j<o.length;j++)a.push(o[j]);n.children=_.pluck(n.children,"id")}else delete n.children;a.push(n)}),a},listToTree:function(e,t,i){var n={childrenKey:"children",parentKey:"parent",idAttribute:"id"};t=t?$.extend(!0,{},n,t):$.extend(!0,{},n);var a=[];return i&&(e=_.map(e,function(e){return"string"==typeof e&&(e=_.find(i,function(i){return i[t.idAttribute]==e})),e})),_.each(e,function(n){var o=$.extend(!0,{},n);i||o[t.parentKey],o[t.childrenKey]&&o[t.childrenKey].length?(o[t.childrenKey]=_g.array.listToTree(o[t.childrenKey],t,i?i:e),a.push(o)):a.push(o)}),a}},object:{jsonparse:function(e){if(!e)return null;try{return a=JSON.parse(e)}catch(t){return e}},equal:function(){},treeToArray:function(){},getKeyByValue:function(e,t){try{var i=_.keys(e)[_.values(e).indexOf(t)];return i}catch(n){return void 0}}},string:{randomGenerate:function(e){e=e?e:10;for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",n=0;e>n;n++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},getUrlExt:function(e){return e.match(/(.[^.]+|)$/)[0]},getUrlNameWithOutExt:function(e){return e.substr(0,e.lastIndexOf("."))||e},getFileNameByPath:function(e){return e.replace(/^.*[\\\/]/,"")},string2boolean:function(e){return"true"==e?!0:!1},capitalize:function(e){return e=e.substring(0,1).toUpperCase()+e.substring(1)},rmfirst:function(e){return e.replace(/^.(\s+)?/,"")},rmlast:function(e){return e.replace(/(\s+)?.$/,"")},isPureEng:function(e){var t=e;if(""==t)return!0;for(var i=0;i<t.length;i++)if(!(t.charCodeAt(i)>=48&&t.charCodeAt(i)<=57||t.charCodeAt(i)>=65&&t.charCodeAt(i)<=90||t.charCodeAt(i)>=97&&t.charCodeAt(i)<=122))return!1;return!0},isEng:function(e){var t=e;if(""==t)return!0;for(var i=0;i<t.length;i++)if(!(32==t.charCodeAt(i)||t.charCodeAt(i)>=48&&t.charCodeAt(i)<=57||t.charCodeAt(i)>=65&&t.charCodeAt(i)<=90||t.charCodeAt(i)>=97&&t.charCodeAt(i)<=122))return!1;return!0},isPureChi:function(e){var t=e;if(""==t)return!0;for(var i=0;i<t.length;i++)if(!(t.charCodeAt(i)>=19968&&t.charCodeAt(i)<=64041))return!1;return!0},isChi:function(e){var t=e;if(""==t)return!0;for(var i=0;i<t.length;i++)if(!(32==t.charCodeAt(i)||t.charCodeAt(i)>=19968&&t.charCodeAt(i)<=64041))return!1;return!0},autoName:function(e,t,i,n){e||(e=""),i||(i=""),n||(n=1);var a=e+n+i;return-1!=t.indexOf(a)?_g.string.autoName(e,t,i,n+1):a}},"boolean":{randomPick:function(){return!!Math.round(1*Math.random())}},number:{random:function(e,t){return"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=100),Math.random()*(t-e)+e},randomInt:function(e,t){return"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=100),Math.floor(Math.random()*(t-e+1))+e},round:function(e,t){var i=e;void 0==typeof t&&(t=.5);var n=parseInt(e),a=e-n;i=t>a?n:n+1},rgbToHex:function(e,t,i){return"#"+((1<<24)+(e<<16)+(t<<8)+i).toString(16).slice(1)},hexToRgb:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,i,n){return t+t+i+i+n+n});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},decimal:function(e,t){return Number(e.toFixed(t))}},hasTouch:function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}(),inIframe:function(){try{return window.self!==window.top}catch(e){return!0}},supportFlash:function(){return"undefined"!=typeof swfobject&&0!==swfobject.getFlashPlayerVersion().major?!0:!1},isMSIE11:function(){return!!navigator.userAgent.match(/Trident\/7\./)},getRGBA:function(e,t){if(t=void 0!=t?Number(t):1,!e)return"transparent";if(-1!=e.indexOf("rgb("))var i=e.replace(/rgb\((.*)\)/,"$1").split(","),n="rgba("+i[0]+","+i[1]+","+i[2]+","+t+")";else{var i=_g.number.hexToRgb(e);if(i)var n="rgba("+i.r+","+i.g+","+i.b+","+t+")";else n="rgba(255,255,255,1)"}return n},weixinShare:function(){if("undefined"!=typeof wx_permissions&&wx_permissions.onMenuShareTimeline){var e=message_link+(message_link.indexOf("disableHistoryStart=0")>=0?"#page/"+interaction_view.currentPage:""),t=shareTitle==bookTitle?descContent:shareTitle;wx.onMenuShareAppMessage({title:bookTitle,desc:t,link:e,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","appmessage","click"])},success:function(){_gaq.push(["_trackSocial","Wechat","appmessage",ga_opt_target,ga_opt_pagePath])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","appmessage","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","appmessage",JSON.stringify(e)])}}),wx.onMenuShareTimeline({title:shareTitle,link:e,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","timeline","click"])},success:function(){_gaq.push(["_trackSocial","Wechat","timeline",ga_opt_target,ga_opt_pagePath])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","timeline","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","timeline",JSON.stringify(e)])}}),wx.onMenuShareQQ({title:bookTitle,desc:t,link:e,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","QQ","click"])},complete:function(){_gaq.push(["_trackEvent","weixin","share","QQ","complete"])},success:function(){_gaq.push(["_trackSocial","Wechat","QQ",ga_opt_target,ga_opt_pagePath])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","QQ","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","QQ",JSON.stringify(e)])}}),wx.onMenuShareWeibo({title:shareTitle,desc:descContent,link:message_link,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","Weibo","click"])},complete:function(){_gaq.push(["_trackEvent","weixin","share","Weibo","complete"])},success:function(){_gaq.push(["_trackSocial","Wechat","Weibo",ga_opt_target,ga_opt_pagePath])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","Weibo","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","Weibo",JSON.stringify(e)])}})}}};"undefined"==typeof require?(window._g||(window._g={}),window._g=$.extend(!0,{},window._g,e),e=void 0):define("_g/base",["jquery","backbone"],function(){return window._g||(window._g={}),window._g=$.extend(!0,{},window._g,e),e=void 0,window._g})}(window),function(){var e={log:function(e){console.log(e)},serverError:function(e){$(document).trigger("serverError"),_g.error[e]&&_g.error[e]()}};"undefined"==typeof require?(window._g||(window._g={}),window._g.error=e):define("_g/error",["_g/base"],function(){return window._g.error=e,window._g.error})}(window),function(){var e={buttonGroupT:['<div class="_g_btn_group <%=opts.className||""%>">',"</div>"].join(""),buttonT:'   <button class="btn _g_btn _g_btn_confirm <%=opts.className||""%>" type="button" data-name="<%=opts.name%>"><%=opts.name%></button>',buttonGroupList:[],scale:function(e,t){$(e).css("zoom",t).css("-moz-transform","scale("+t+")").css("-o-transform","scale("+t+")")},center:function(e){var t={containment:null};return e="string"==typeof e?{containments:null,Item:e}:e?$.extend({},t,e):t,e.Item?void $(e.Item).css({left:"50%",top:"50%","margin-top":function(){return-($(this).height()/2+50)},"margin-left":function(){return-($(this).width()/2)}}):!1},centerImage:function(e){var t={containment:null,parentWidth:null,parentHeight:null,width:null,height:null,setParent:!0};if(e=e?$.extend({},t,e):t,!e.Item||!e.containment)return!1;var i=0;return e.setParent&&$(e.containment).css({"line-height":e.parentHeight+"px","text-align":"center"}),e.width/e.height>=e.parentWidth/e.parentHeight?($(e.Item).css({width:"100%",height:"auto","verticle-align":"middle"}),i=e.parentWidth,height=e.parentWidth/(e.width/e.height)):($(e.Item).css({width:"auto",height:"100%","verticle-align":"middle"}),height=e.parentHeight,i=e.parentHeight*(e.width/e.height)),{width:i,height:height}},fitImage:function(e){if(!e)return!1;if(e.fit||(e.fit=0),e.containment)switch($(e.containment).css({"background-repeat":"no-repeat","background-position":"50% 50%"}),e.fit){case 0:$(e.containment).css({"background-size":"100%"});break;case 1:$(e.containment).css({"background-size":"contain"});break;case 2:$(e.containment).css({"background-size":"cover"})}else e.items&&$(e.items).each(function(){var t=$(this);void 0==e.width&&(e.width=$(this).width()),void 0==e.height&&(e.height=$(this).height());var i=e.width,n=e.height,a=$(this).parent();if(e.parentHeight=e.parentHeight||a.height(),e.parentWidth=e.parentWidth||a.width(),0==e.fit&&(t.css({width:"100%",height:"100%",top:"",left:""}),t.addClass("fullsize bk_full"),t.removeClass("bk_contain bk_cover"),i=e.parentWidth,n=e.parentHeight),1==e.fit)if(a.css({"line-height":e.parentHeight-(e.borderH||0)+"px"}),e.useMargin||(a.css("text-align","center"),a.removeClass("bk_cover bk_full"),a.addClass("aligncenter bk_contain")),e.width/e.height>=e.parentWidth/e.parentHeight){if(i=e.parentWidth,n=e.parentWidth/(e.width/e.height),t.css({width:"100%",height:"auto","vertical-align":"middle",left:"",top:"",display:"inline-block",position:"relative"}),e.useMargin){var o=e.parentWidth/(e.width/e.height);t.css("margin-top",(e.parentHeight-o)/2+"px"),t.css("margin-bottom",(e.parentHeight-o)/2+"px"),t.css({"margin-left":0,"margin-right":0}),t.css("position","absolute")}}else if(n=e.parentHeight,i=e.parentHeight*(e.width/e.height),t.css({width:"auto",height:"100%","vertical-align":"top",left:"",top:"",display:"inline-block",position:"relative"}),e.useMargin){var r=e.parentHeight*(e.width/e.height);t.css("margin-left",(e.parentWidth-r)/2+"px"),t.css("margin-right",(e.parentWidth-r)/2+"px"),t.css({"margin-top":0,"margin-bottom":0}),t.css("position","absolute")}2==e.fit&&(a.css({"line-height":e.parentHeight+"px","text-align":"center",overflow:"hidden"}),a.removeClass("bK_full bk_contain"),a.addClass("aligncenter overflowhidden bk_cover"),e.width/e.height>=e.parentWidth/e.parentHeight?(t.css({width:e.parentHeight*e.width/e.height+"px",height:e.parentHeight+"px","verticle-align":"middle",position:"absolute",left:"-"+(e.parentHeight*e.width/e.height-e.parentWidth)/2+"px",top:0,"max-width":"none"}),e.useMargin&&(t.css("left",""),t.css("margin-left","-"+(e.parentHeight*e.width/e.height-e.parentWidth)/2+"px"))):(t.css({position:"absolute",width:e.parentWidth+"px",height:e.parentWidth/(e.width/e.height)+"px","verticle-align":"middle",top:"-"+(e.parentWidth/(e.width/e.height)-e.parentHeight)/2+"px",left:0,"max-height":"none"}),e.useMargin&&(t.css("top",""),t.css("margin-top","-"+(e.parentWidth/(e.width/e.height)-e.parentHeight)/2+"px")))),e.explicitSize&&t.css({width:i,height:n})})},opacity:function(){},addShade:function(e){var t={name:"_g_shadow",zindex:99999,color:"#000000",opacity:.8,containment:"body"};e=e?$.extend({},t,e):t,$(containment).append('<div id="'+e.name+'" style="z-index:'+e.zindex+";background:"+e.color+";opacity:"+e.opacity+';"></div>')},addButtonGroup:function(e){var t={containment:null,position:0,name:"_g_button"+_g.uuid(),className:null,confirmButton:{name:"ç¡®è®¤",enable:!0,className:"btn-small btn-primary",onClick:null},cancelButton:{name:"åæ¶",enable:!0,className:"btn-small",onClick:null},remove:function(){e.$el&&e.$el.remove()},getButton:function(t){return e.$el.find('[data-name="'+t+'"]')},addButton:function(t){var i={name:null,className:null,onClick:null};return t=t?$.extend(!0,{},i,t):i,t.name?(e.$el.append(_.template(_g.ui.buttonT,{opts:t})),void(t.onClick&&e.getButton(t.name).on("click",function(){t.onClick()}))):!1},removeButton:function(t){t&&e.$el.find('[data-name="'+t+'"]').remove()}};return e=e?$.extend(!0,{},t,e):$.extend(!0,{},t),e.containment?(0==e.position?($(e.containment).append(_.template(_g.ui.buttonGroupT,{opts:e})),e.$el=$(e.containment).children("._g_btn_group")):($(_.template(_g.ui.buttonGroupT,{opts:e})).insertAfter($(e.containment)),e.$el=$(e.containment).next("._g_btn_group")),e.confirmButton.enable&&e.addButton(e.confirmButton),e.cancelButton.enable&&e.addButton(e.cancelButton),e):!1},contenteditable:function(e){var t={eventType:0,mutiple:0,element:null,callback:null,type:0,enableControl:!1};return e=e?$.extend(!0,{},t,e):$.extend(!0,{},t),e.onKeyDown=function(t){var i=t.keyCode?t.keyCode:t.which;13==i&&0==e.mutiple&&(e.enableClose=!0,e.$this.blur(),$(document).off("keydown",e.onKeyDown),e.result())},e.result=function(){if(e.$this.data("before")!==e.$this.html()){e.$this.data("before",e.$this.html());var t=0==e.type?e.$this.text():e.$this.html();e.callback&&e.callback(t)}},e.enableEdit=!1,e.element?void(e.element&&(e.$this=$(e.element),e.$this.addClass("_g_contenteditable"),0==e.eventType&&$(e.element).attr("contenteditable","true"),1==e.eventType&&($(e.element).attr("contenteditable","false"),$(e.element).on("dblclick",function(){$(this).attr("contenteditable","true"),$(this).focus()})),$(e.element).on("focus",function(){return e.focus?!1:(e.focus=!0,e.$this.data("before",e.$this.html()),$(document).on("keydown",e.onKeyDown),e.enableControl&&(e.buttonGroup=_g.ui.addButtonGroup({containment:e.$this,position:1,confirmButton:{onClick:function(){e.enableClose=!0,e.$this.blur()}},cancelButton:{onClick:function(){e.enableClose=!0,e.$this.html(e.$this.data("before")),e.$this.blur()}}})),e.$this)}).on("blur",function(){if(e.enableControl){if(!e.enableClose)return e.$this.focus(),!1;e.enableClose=!1,e.buttonGroup.remove()}return e.focus=!1,$(document).off("keydown",e.onKeyDown),1==e.eventType&&$(e.element).attr("contenteditable","false"),e.result(),!1}))):!1},sortByIds:function(e){var t={containment:null,items:"li",ids:null};e=e?$.extend({},t,e):t,e.containment&&e.ids&&_.each(e.ids,function(t){if($(e.containment).children(e.items+'[id="'+t+'"]').length>0){var i=$(e.containment).children(e.items+'[id="'+t+'"]').detach();$(e.containment).append(i)}})},sortTreeByIds:function(e,t){var i={containment:null,items:"li",ids:null,childrenKey:"children",wrap:"ul",wrapClass:null};e=e?$.extend({},i,e):i,e.containment&&e.ids&&(e.root=t||e.containment,_.each(e.ids,function(i){if($(e.root).find(e.items+'[id="'+i.id+'"]').length>0){var n=$(e.root).find(e.items+'[id="'+i.id+'"]').detach();$(e.containment).is(e.wrap)||$(e.containment).children(e.wrap).length||($(e.containment).append(document.createElement(e.wrap)),e.containment=$(e.containment).children(e.wrap)),e.wrapClass&&$(e.containment).addClass(e.wrapClass),$(e.containment).append(n)}i[e.childrenKey]&&_g.ui.sortTreeByIds({containment:$(e.containment).find(e.items+'[id="'+i.id+'"]'),items:e.items,ids:i[e.childrenKey],childrenKey:e.childrenKey,wrapClass:e.wrapClass},t?t:e.containment)}))},findById:function(e){var t={containment:null,id:null};return e=e?$.extend({},t,e):t,e.containment&&e.id?$(e.containment).find('[id="'+e.id+'"],[data-id="'+e.id+'"]').first():[]},moveTo:function(e){var t={containment:null,sourceId:null,targetId:null,wrap:null,wrapClass:null,position:0};if(e=e?$.extend({},t,e):t,!e.containment)return!1;var i=_g.ui.findById({containment:e.containment,id:e.sourceId}),n=_g.ui.findById({containment:e.containment,id:e.targetId});e.wrap&&(0==n.has(e.wrap).length?(n.append(document.createElement(e.wrap)),n=n.children(e.wrap),e.wrapClass&&n.addClass(e.wrapClass)):n=n.children(e.wrap));var a=i.detach();0==e.position?n.prepend(a):n.append(a)},getTreeIds:function(e){var t={containment:null,items:null,idAttribute:"id",wrap:"ul"};e=e?$.extend({},t,e):t;var i=[];if(!e.containment||!e.items)return!1;if(e.wrap)if($(e.containment).is(e.wrap));else{if(!($(e.containment).children("ul").length>0))return[];e.containment=$(e.containment).children("ul")}return $(e.containment).children(e.items).each(function(){var t={};t.id=$(this).attr(e.idAttribute),t.children=_g.ui.getTreeIds({containment:$(this),items:e.items,idAttribute:e.idAttribute,wrap:e.wrap}),i.push(t)}),i},dialog:function(){},createDomMask:function(e){var t={containment:null,item:null,x:null,y:null,height:null,width:null,moveTo:function(t){e.offsetX=0-t.x,e.offsetY=0-t.y,$(e.item).css("left",e.offsetX),$(e.item).css("top",e.offsetY)},resize:function(t){$(e.containment).width(t.w),$(e.containment).height(t.h)}};return e=e?$.extend({},t,e):t,e.containment&&e.item?($(e.containment).css("overflow","hidden"),e.moveTo({x:e.x,y:e.y}),e.resize({w:e.width,h:e.height}),e):!1},clearSelection:function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var e=window.getSelection();e.removeAllRanges()}},isOverflowed:function(e){var t={x:!1,y:!1},i=0;return $.zoom&&1!=$.zoom&&(i=2),$(e)[0].offsetHeight+i<$(e)[0].scrollHeight&&(t.y=$(e)[0].scrollHeight||1),$(e)[0].offsetWidth+i<$(e)[0].scrollWidth&&(t.x=$(e)[0].scrollWidth||1),t}};"undefined"==typeof require?(window._g||(window._g={}),window._g.ui=e):define("_g/ui",["jquery","_g/base","_g/error"],function(){return window._g.ui=e,window._g.ui})}(window),function(){var e={getValueByType:function(e,t){switch(t=t?t.toLowerCase():t){case"number":return Number(e);case"boolean":return"false"==e?!1:"true"==e?!0:Boolean(e);case"numberboolean":return"false"==e?0:"true"==e?1:Boolean(e)?1:0;case"string":return String(e);case"object":return _g.object.jsonparse(e);default:return e}},bindPopOver:function(e){var t={containment:null,trigger:"click",getData:null,callback:null,onChange:null};return e=e?$.extend(!0,{},t,e):t,e.containment?void $(e.containment).find(".c-popover-btn").on(e.trigger,function(){var t=$(this).data();if(e.getData){var i=require("text!"+t.template),n=e.getData(this);t.content=_g.renderT(i,n,"data","text!"+t.template)}t.container=t.container?$(t.container):$(this).closest(".c-popover-containment")[0],t.container||(t.container="body"),t.viewport={selector:$(this).closest(".c-popover-viewport")[0],padding:t.padding||0},t.viewport.selector||(t.viewport.selector="body"),t.elm=$(this),t.callback=e.callback,t.beforeClose=e.beforeClose,t.onChange=e.onChange,t.onShow=e.onShow,t.onClose=e.onClose,t.getContent=function(){var t=e.getData(this);return _g.renderT(i,t,"data")};_g.form.popover(t);return!1}):!1},bindListAction:function(e){var t={containment:null,listClass:".c-list",callback:null};if(e=e?$.extend(!0,{},t,e):t,!e.containment)return!1;if(!e.containment.hasClass(e.listClass)&&!e.containment.find(e.listClass).length)return!1;var i=e.containment.hasClass(e.listClass)?e.containment.data():e.containment.find(e.listClass).first().data();e.containment.find(".c-list-add").on("click",function(t){if(e.callback){var n=_g.util.serializeValue({containment:e.containment});e.callback("add",i.target,n,t.currentTarget)}return!1}),e.containment.find(".c-list-remove").on("click",function(t){return e.callback&&callback("remove",i.target,t.currentTarget),!1})},bindFormChange:function(e){var t={containment:null,$item:null,callback:null,silentDisplay:!1};if(e=e?$.extend(!0,{},t,e):t,!e.containment)return!1;$(e.containment).find(".slider").each(function(){var t=$(this).find("input"),i=t.data();if(i.target){var n=$(e.containment).find('[name="'+i.target+'"]');n.on("change",function(){var e=t.slider("getValue");e!=Number($(this).val())&&t.slider("setValue",Number($(this).val()))}),t.on("slide",function(e){var t=Number(n.val());t!=e.value&&(n.closest(".spinner").spinner("value",e.value),n.trigger("change"))})}}),$(e.containment).find("[rel=form]").each(function(){var t=$(this).data();if(void 0!=t.value)if($(this).find("[data-value]").removeClass("active"),t.mutiple||t.multiple){var n=t.value.split(",");for(i=0;i<n.length;i++)$(this).find('[data-value="'+n[i]+'"]').addClass("active")}else $(this).find('[data-value="'+t.value+'"]').addClass("active");var a=$(this);$(this).find("[data-value]").on("click",function(){var i=!1,n=$(this).data("value");if(t.silentdisplay||a.find("[data-show]").text($(this).text()||n),t.multiple||t.mutiple){$(this).hasClass("active")?$(this).removeClass("active"):t.silentdisplay||$(this).addClass("active");var o=[];a.find("[data-value]").each(function(){var e=$(this).data("value");$(this).hasClass("active")&&o.push(_g.util.getValueByType(e,t.type))}),o=o.join(","),console.log(o),a.data("value",o),t.value=o,i=!0}else $(this).hasClass("active")||(n=_g.util.getValueByType(n,t.type),a.data("value",n),$(this).addClass("active"),$(this).siblings().length?$(this).siblings().removeClass("active"):$(this).parent().siblings().children().removeClass("active"),t.value=n,i=!0);e.callback&&i&&e.callback(a,e,t)})});var n=e.$item?e.$item:"input,textarea,select";$(e.containment).find(n).on("change",function(){var t=$(this).data();t.name=$(this).attr("name")||$(this).attr("id"),e.callback&&e.callback($(this),e,t)}),e.createIndex&&_g.util.createFormIndex({containment:e.containment})},serializeValue:function(e){var t={containment:null,typeAttr:"data-type",attrAttr:"data-attr",allowEmpty:!0};if(e=e?$.extend({},t,e):t,!e.containment)return!1;var i=e.containment,n={},a=function(t,i){if("disabled"!=t.attr("disabled")){var a=t.attr("name")||t.attr("id"),o=(t.attr(e.typeAttr),t.attr(e.attrAttr));a&&(o?("object"!=typeof n[o]&&(n[o]={}),n[o][a]=i):n[a]=i)}},o=function(e,t){if("disabled"!=e.attr("disabled")){var i=e.data(),a=i.name,o=(i.type,i.attr);a&&(o?("object"!=typeof n[o]&&(n[o]={}),n[o][a]=t):n[a]=t)}};return $(i).find('input[type="text"],input[type="email"],input[type="tel"],input[type="hidden"],textarea').each(function(){var t=($(this).attr("name")||$(this).attr("id"),$(this).attr(e.typeAttr)),i=($(this).attr(e.attrAttr),_g.util.getValueByType($(this).val(),t));a($(this),i)}),$(i).find('input[type="checkbox"]').each(function(){var t=$(this).attr("name")||$(this).attr("id"),i=$(this).attr(e.typeAttr),o=$(this).attr(e.attrAttr);o&&"object"!=typeof n[o]&&(n[o]={});var r=o?n[o][t]?n[o][t]:[]:n[t]?n[t]:[];"checked"==$(this).attr("checked")?"boolean"==i||"numberboolean"==i?r=_g.util.getValueByType($(this).attr("data-reverse")?!1:!0,i):r.push(_g.util.getValueByType($(this).val(),i)):("boolean"==i||"numberboolean"==i)&&(r=_g.util.getValueByType($(this).attr("data-reverse")?!0:!1,i)),a($(this),r)
}),$(i).find('input[type="radio"]:checked').each(function(){var t=($(this).attr("name")||$(this).attr("id"),$(this).attr(e.typeAttr)),i=($(this).attr(e.attrAttr),_g.util.getValueByType($(this).val(),t));a($(this),i)}),$(i).find("select").each(function(){var t,i=$(this).attr("name")||$(this).attr("id"),o=$(this).attr(e.typeAttr),r=$(this).attr(e.attrAttr),s=Boolean($(this).attr("data-mutiple"));s?(r&&"object"!=typeof n[r]&&(n[r]={}),t=r?n[r][i]?n[r][i]:[]:n[i]?n[i]:[],t.push($(this).val())):t=_g.util.getValueByType($(this).val(),o),a($(this),t)}),$(i).find("[rel=form]").each(function(){var e=$(this).data();if(e.mutiple||e.multiple)if(void 0!=e.value)var t=e.value;else var t="";else var t=_g.util.getValueByType(e.value,e.type);o($(this),t)}),n},createFormIndex:function(e){var t={containment:null,typeAttr:"data-type",attrAttr:"data-attr"};if(e=e?$.extend({},t,e):t,!e.containment)return!1;var i=e.containment;if(!$(i).data().formindex&&!e.force){var n={},a=function(e,t,i,a,o){t&&(e?(n[e]||(n[e]={}),n[e][t]?"radio"==o||"checkbox"==o&&"boolean"!=a?n[e][t].els.push(i):n[e][t].el=i:n[e][t]={el:i,els:[i],type:a,tag:i[0].tagName,_type:i[0].type}):n[t]?"radio"==o||"checkbox"==o&&"boolean"!=a?n[t].els.push(i):n[t].el=i:n[t]={el:i,els:[i],type:a,tag:i[0].tagName,_type:i[0].type})},o=function(e,t,i,a,o){t&&(e?(n[e]||(n[e]={}),n[e][t]?n[e][t].el=i:n[e][t]={el:i,els:[i],type:a,tag:i[0].tagName,_type:i[0].type,rel:!0,multiple:o}):n[t]?n[t].el=i:n[t]={el:i,els:[i],type:a,tag:i[0].tagName,_type:i[0].type,rel:!0,multiple:o})},r=function(e,t,i){t&&(e?(n[e]||(n[e]={}),n[e][t]?n[e][t].slider=i:n[e][t]={slider:i}):n[t]?n[t].slider=i:n[t]={slider:i})},s=function(e,t,i){t&&(e?(n[e]||(n[e]={}),n[e][t]?n[e][t].colorpicker=i:n[e][t]={colorpicker:i}):n[t]?n[t].colorpicker=i:n[t]={colorpicker:i})},l=function(e,t,i){t&&(e?(n[e]||(n[e]={}),n[e][t]?n[e][t].spinner=i:n[e][t]={spinner:i}):n[t]?n[t].spinner=i:n[t]={spinner:i})};$(i).find("input,textarea,select").each(function(){var t=$(this).attr("name")||$(this).attr("id"),i=$(this).attr(e.typeAttr),n=$(this).attr(e.attrAttr);a(n,t,$(this),i,this.type)}),$(i).find("[rel=form]").each(function(){var e=$(this).data();o(e.attr,e.name,$(this),e.type,e.multiple||e.mutiple)}),$(i).find(".slider").each(function(){var t=$(this).find("input"),i=t.data();if(i.target){var n=i.target,a=$(e.containment).find('[name="'+i.target+'"]');r(a.attr("data-attr"),n,$(this).find("input"))}}),$(i).find(".c_color_el").each(function(){var e=$(this).data();if(e.colorpicker){var t=$(this).find("input");s(t.attr("data-attr"),t.attr("name"),e.colorpicker)}}),$(i).find(".spinner").each(function(){var e=$(this).data();if(e.spinner){var t=$(this).find("input");l(t.attr("data-attr"),t.attr("name"),e.spinner)}}),$(i).data("formindex",n)}return n},renderFormInfo:function(e){if(!e.containment)return!1;var t=$(e.containment).data().formindex;if(t){e.keys||(e.keys=["value"]);for(var i=0;i<e.keys.length;i++)_.each(e[e.keys[i]],function(n,a){"value"==e.keys[i]?_.isObject(n)?t[a]&&_.each(n,function(e,i){t[a][i]&&(_g.util.setFormItemValue(t[a][i],e),t[a][i].slider&&t[a][i].slider.slider("setValue",e))}):t[a]&&(_g.util.setFormItemValue(t[a],n),t[a].slider&&t[a].slider.slider("setValue",n)):"name"==e.keys[i]&&(_.isObject(n)?t[a]&&_.each(n,function(e,i){t[a][i]&&_g.util.setFormItemName(t[a][i],e)}):t[a]&&_g.util.setFormItemName(t[a],n))})}},setFormItemValue:function(e,t){if(e||(e={}),e.colorpicker)return void e.colorpicker.setValue(t,{silent:!0});if(e.spinner)return void e.spinner.value(t);if(e.rel){if(e.multiple){e.el.find("[data-value]").removeClass("active");for(var i=0;i<t.length;i++)e.el.find('[data-value="'+t[i]+'"]').addClass("active")}else e.el.find('[data-value="'+t+'"]').addClass("active").siblings().removeClass("active"),e.el.find("[data-show]").html(e.el.find('[data-value="'+t+'"]').html());return void e.el.data("value",t)}if("number"==e.type&&(t=Number(t)),"INPUT"==e.tag)if("checkbox"==e._type)if("boolean"==e.type)t?e.el.attr("checked","checked"):e.el.removeAttr("checked");else for(var i=0;i<e.els.length;i++)_.include(t,"number"==e.type?Number(e.els[i].val()):e.els[i].val())?e.els[i].attr("checked","checked"):e.els[i].removeAttr("checked");else if("radio"==e._type)if("boolean"==e.type)t?e.el.attr("checked","checked"):e.el.removeAttr("checked");else for(var i=0;i<e.els.length;i++)t==("number"==e.type?Number(e.els[i].val()):e.els[i].val())?e.els[i].attr("checked","checked"):e.els[i].removeAttr("checked");else e.el.val(t);else"TEXTAREA"==e.tagName?e.el.html(t):e.el.val(t)},setFormItemName:function(e,t){if(e||(e={}),e.els.length>1)for(var i=0;i<e.els.length;i++)e.els[i].attr("name",t);else{if(e.rel)return e.el.attr("data-name",t),void e.el.data("name",t);e.el.attr("name",t)}},disableLink:function(e){var t={containment:null,linkitem:"a",enabled:!0},i=e.linkitem||t.linkitem;return e=e?$.extend(!0,{},t,e):t,e.linkitem=i,e.containment?(e.func=function(){return!1},e.enable=function(){$(e.containment).find(e.linkitem).each(function(){$(this).on("click",e.func),e.enabled=!0})},e.disable=function(){$(e.containment).find(e.linkitem).each(function(){$(this).off("click",e.func),e.enabled=!1})},e.enable(),e):!1},domExist:function(e,t){return t||(t=document),"string"==typeof e&&(e=$(e)),$.contains(t.documentElement,e[0])},getImageSizeBySrc:function(e,t,i){var n=new Image;n.onload=function(){if(i&&(this.width>i||this.height>i)){var e=this.width/this.height;e>1?(this.width=i,this.height=this.width/e):(this.height=i,this.width=this.height*e)}t&&t(this.width,this.height)},n.src=e},htmlspecialchars:function(e){function t(e,t,i){for(var n=e.length,a=0;n>a;a++)re=new RegExp(e[a],"ig"),i=i.replace(re,"string"==typeof t?t:t[a]?t[a]:t[0]);return i}return"string"!=typeof e?e:t(["&","<",">",'"',"&lt;br&gt;"],["&amp;","&lt;","&gt;","&quot;","<br>"],e)},toggleActive:function(e){$(e).css("-moz-transition","all 0.5s").css("-webkit-transition","all 0.5s").css("-ms-transition","all 0.5s").css("-o-transition","all 0.5s").css("transition","all 0.5s"),$(e).css("opacity","0.5").css("background-color","#f80"),setTimeout(function(){$(e).css("opacity","1").css("background-color","#fff")},500)}};"undefined"==typeof require?(window._g||(window._g={}),window._g.util=e,e=void 0):define("_g/util",["jquery","_g/base"],function(){return window._g.util=e,e=void 0,window._g.util})}(window),function(){var _g_mvc={saveHandle:function(e,t){200==e.code?t("success","æå"):t("error",e.msg)},_loadTemplate:function(){},_CollectionforSaveAll:function(){var e=Backbone.Model.extend({initialize:function(){this.set("id","GlobalSave")},sync:function(e,t,i){var n=this.data;this.attributes=n,"create"!=e&&("update"==e&&(i.url=this.url),"delete"!=e&&"read"!=e&&(Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,i)))}});return new e},createModel:function(opts){var defaults={defaults:{},autoIndex:!0,autoUpdate:!0,autoRemove:!0,enableSync:!0,createUrl:null,updateUrl:null,removeUrl:null,fetchUrl:null,staticFetchUrl:null,staticRemoveUrl:null,staticCreateUrl:null,staticUpdateUrl:null,fetchUrlName:null,removeUrlName:null,createUrlName:null,updateUrlName:null,restful:!1,debug:!1,bindChange:null,bindRemove:null,callback:null,initView:null,patchKeys:null,initialize:function(){if(this.iViewlist=[],this.iCollectionlist=[],this.get("id"))this.preset();else if(this.set("isNew",!0),this.autoIndex){var prefix=this.get("type")||this.get("iType")||"M";this.set("id",prefix+"_"+_g.uuid(4)),this.preset()}else this.save({},{wait:!0,success:function(model,response){var returned=eval(response);("Success"==returned.Status||200==returned.code)&&model.set("id",returned.ID.toString()),model.preset()}})},patchSave:function(callback,opts){if(opts||(opts={}),this.patchKeys&&this.patchKeys.length){var values=_.pick(this.toJSON(),this.patchKeys);this.save(values,{wait:!0,silent:opts.silent,patch:!0,success:function(model,response){if(callback){var returned=eval(response);callback(returned)}},error:function(e){_g.error.serverError("save_"+e.name),opts.onError&&opts.onError()}})}else this.save()},sync:function(e,t,i){var n,a="undefined"!=typeof _gDebug&&_gDebug||this.debug;if(!this.enableSync)return!1;if("create"==e){var o=this.createUrlName||this.createUrl;if(_g.debug&&_g.debug.enabled&&(_g.debug.data[o]={}),n=a?_g.debug&&_g.debug.query_user_data(o)?_g.debug.query_user_data(o):this.staticCreateUrl||this.createUrl:this.createUrl,!n)return;i.url=n}if("update"==e||"patch"==e){var o=this.updateUrlName||this.updateUrl;if(_g.debug&&_g.debug.enabled&&(_g.debug.data[o]={}),n=a?_g.debug&&_g.debug.query_user_data(o)?_g.debug.query_user_data(o):this.staticUpdateUrl||this.updateUrl:this.updateUrl,!n)return;i.url=n}if("delete"==e){var o=this.removeUrlName||this.removeUrl;if(_g.debug&&_g.debug.enabled&&(_g.debug.data[o]={}),n=a?_g.debug&&_g.debug.query_user_data(o)?_g.debug.query_user_data(o):this.staticRemoveUrl||this.removeUrl:this.removeUrl,!n)return;i.url=n}if("read"==e){var o=this.fetchUrlName||this.fetchUrl;if(n=a?this.staticFetchUrl:this.fetchUrl,_g.debug&&_g.debug.enabled&&(_g.debug.data[o]={}),n=a?_g.debug&&_g.debug.query_user_data(o)?_g.debug.query_user_data(o):this.staticFetchUrl||this.fetchUrl:this.fetchUrl,!n)return;i.url=n}i.url="string"==typeof i.url?i.url:i.url(t.attributes),this.restful||(Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0),Backbone.sync(e,t,i)},addView:function(e,t){if("function"==typeof t&&(this[e]=new t({model:this})),"object"==typeof t){var i=_g.mvc.createView(t);this[e]=new i({model:this})}this[e]&&this.iViewlist.push(this[e])},addCollection:function(e,t){if("function"==typeof t&&(this[e]=new t),"object"==typeof view){var i=_g.mvc.createCollection(t);this[e]=new i}this[e]&&this.iCollectionlist.push(this[e])},preset:function(){this.callback&&this.callback(this);var e=this;this.autoUpdate&&this.on("change",function(){e.updateAllViews()}),this.autoRemove&&this.on("destroy",function(e,t,i){e.removeAllViews(),e.bindRemove&&e.bindRemove(e,i)}),this.bindChange&&this.bindChange(),this.initView&&this.addView("iview",this.initView)},updateAllViews:function(){_.each(this.iViewlist,function(e){e.$el&&e.update()})},removeView:function(e){this[e]&&(this[e].remove(),this.iViewlist=_.reject(this.iViewlist,function(t){return t==this[e]}),this[e]=null)},removeAllViews:function(e){_.each(this.iViewlist,function(t){t.$el&&(e?t.undelegateEvents():t.remove())})}};opts=opts?$.extend(!0,{},defaults,opts):defaults;var Model=Backbone.Model.extend(opts);return Model},createView:function(e){var t={template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!0,position:1,parseData:null,callback:null,bindChange:null,parseTemplate:null,templateKey:null,templateName:null,afterRender:null,afterUpdate:null,initialize:function(){_.bindAll(this),this.autoRender&&this.render(),this.callback&&this.callback(this)},createEl:function(){var e,t=this.model.toJSON();return this.parseData&&(t=this.parseData()),e=this.parseTemplate?this.parseTemplate(this.template):this.template,_g.renderT(e,t,this.templateKey,this.templateName)},render:function(e,t){if(!this.model||!this.template)return!1;if(!_g.util.domExist(this.$el)){if(!e&&!this.containment)return!1;e||(e=$(this.containment)),t||(t=this.position),this.wrap&&!$(this.containment).is(this.wrap)&&(0==$(this.containment).children(this.wrap).length&&$(this.containment).append(document.createElement(this.wrap)),e=$(this.containment).children(this.wrap),this.containment&&this.wrapClassName&&e.addClass(this.wrapClassName));var i=this.createEl(),n=i;return this.setElement(n),1==t?e.append(n):e.prepend(n),this.className&&this.$el.addClass(this.className),this.afterRender&&this.afterRender(this),this}var i=this.createEl(),n=i;this.undelegateEvents(),this.$el.replaceWith(n),this.setElement(n),this.afterUpdate&&this.afterUpdate(this)},update:function(){this.render()},afterUpdate:function(){this.afterRender&&this.afterRender(this)},events:{}};e=e?$.extend(!0,{},t,e):t;var i=Backbone.View.extend(e);return i},createCollection:function(e){var t={enableSync:!1,fetchUrl:null,staticFetchUrl:null,saveUrl:null,staticSaveUrl:null,debug:!1,bindRemove:!1,bindReset:!0,bindAdd:null,callback:null,patchKeys:null,name:null,initialize:function(){var e=this;this.bindRemove&&this.on("remove",function(t){"function"==typeof e.bindRemove?e.bindRemove(t):t.removeAllViews()}),this.bindReset&&this.on("reset",function(t,i){"function"==typeof e.bindReset?e.bindReset(t,i):_.each(i.previousModels,function(e){e.removeAllViews()}),e.afterReset&&e.afterReset(t,i)}),this.bindAdd&&this.on("add",function(){e.bindAdd()}),this.callback&&this.callback(this)},sortByIds:function(e){var t=this;this.reset(_.map(e,function(e){return t.get(e)}),{silent:!0})},sync:function(e,t,i){var n="undefined"!=typeof _gDebug&&_gDebug||this.debug;if(!this.enableSync)return!1;if("read"==e){var a=n?this.staticFetchUrl?this.staticFetchUrl:this.fetchUrl:this.fetchUrl?this.fetchUrl:this.staticFetchUrl;if(!a)return;i.url=a}return i.url?(i.url="string"==typeof i.url?i.url:i.url(t.toJSON()),this.resetful||(Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0),void Backbone.sync(e,t,i)):!1},getAll:function(e){var t=this;this.fetch({success:function(t,i){e&&e(i)},error:function(){_g.error.serverError("get_"+t.name)}})},saveAll:function(e){var t=this,i="undefined"!=typeof _gDebug&&_gDebug||this.debug,n=i?this.staticSaveUrl?this.staticSaveUrl:this.saveUrl:this.saveUrl?this.saveUrl:this.staticSaveUrl;if(!n)return!1;var a=_g.mvc._CollectionforSaveAll();a.data=this.patchKeys&&this.patchKeys.length?_.map(this.toJSON(),function(e){var i=$.extend(!0,{},e);return i=_.pick(i,t.patchKeys)}):this.toJSON(),a.url=n,a.save({},{wait:!0,success:function(t,i){e&&e(i)},error:function(){_g.error.serverError("save_"+t.name)}})},refreshView:function(e){var t={containment:null,viewname:null};e=e?$.extend({},t,e):t,this.length>0&&(_.each(this.at(0).iViewlist,function(t){containment=e.containment||t.containment,containment&&(t.wrap&&!$(containment).is(t.wrap)?$(containment).children(t.wrap).empty():$(containment).empty())}),this.each(function(t){e.containment&&(t.iview.containment=e.containment),e.viewname?t[viewname].update():t.iview.update()}))},removeAllViews:function(e){this.each(function(t){t.removeAllViews(e)})}};e=e?$.extend(!0,{},t,e):t;var i=Backbone.Collection.extend(e);return i},createTreeByData:function(e){var t,i={collection:null,data:null,treeLevel:0,parent:null},n=e.parent;if(e=e?$.extend(!0,{},i,e):i,e.parent=n,!e.collection||!e.data)return null;var a=$.extend(!0,[],e.data);if("function"==typeof e.collection)t=new e.collection;else{var o=_g.mvc.createCollection(e.collection);t=new o}return t.parent=n,t.refreshTreeView=function(e){this.refreshView(e),this.each(function(t){t.icollection.refreshTreeView({containment:t.iview.$el,viewname:e?e.viewname:null})})},t.getModels=function(){var e=_g.mvc.getTreeModels(t);return e},t.getModelsJSON=function(){var e=t.getModels();return e=_.map(e,function(e){return e.toJSON()})},t.getModel=function(e){return _g.mvc.getTreeModel(t,e)},t.on("add",function(i){i.treeLevel=e.treeLevel,i.icollection=_g.mvc.createTreeByData({collection:e.collection,data:[],treeLevel:e.treeLevel+1}),t.parent&&(t.View="object"==typeof t.View?$.extend(!0,{},t.View,{containment:t.parent.iview.$el}):t.View.extend({containment:t.parent.iview.$el})),i.addView("iview",t.View),_g.ui.sortByIds({containment:i.iview.wrap?i.iview.$el.parent(i.iview.wrap):i.iview.$el.parent(),ids:t.pluck("id")}),i.icollection.parent=i,i.icollection.View=t.View}),t.saveAll=function(e){var t="undefined"!=typeof _gDebug&&_gDebug||this.debug,i=t&&this.staticSaveUrl?this.staticSaveUrl:this.saveUrl;if(!i)return!1;var n=_g.mvc._CollectionforSaveAll();n.data=_g.mvc.getTreeData(this),n.url=i,n.save({},{wait:!0,success:function(t,i){e&&e(i)},error:function(){}})},_.each(a,function(i){var n;n=i.children?$.extend(!0,[],i.children):[],delete i.children,t.add(i,{silent:!0});var a=t.at(t.length-1);a.treeLevel=e.treeLevel,console.log(n),a.icollection=_g.mvc.createTreeByData({collection:e.collection,data:n,treeLevel:e.treeLevel+1,parent:a})}),t},createTreeView:function(e){var t={collection:null,view:null,containment:null,wrap:null,wrapClassName:null,template:null,className:null,parseTemplate:null,templateKey:null,templateName:null,update:function(){if(!this.model||!this.template||!this.containment)return!1;if(_g.util.domExist(this.$el)){var e=this.createEl(),t=null;this.wrap&&(t=this.$el.children(this.wrap).detach()),this.undelegateEvents(),this.$el.replaceWith(e),this.setElement(e)}else this.render();this.afterUpdate&&this.afterUpdate(this)}},i=e.collection;e=e?$.extend(!0,{},t,e):t;var n={};if(e.collection=i,!e.collection||!e.view)return!1;e.containment&&(n.containment=e.containment),e.wrap&&(n.wrap=e.wrap),e.template&&(n.template=e.template),e.templateKey&&(n.templateKey=e.templateKey),e.templateName&&(n.templateName=e.templateName),e.parseTemplate&&(n.parseTemplate=e.parseTemplate),e.parseData&&(n.parseData=e.parseData),e.callback&&(n.callback=e.callback),e.wrapClassName&&(n.wrapClassName=e.wrapClassName),e.className&&(n.className=e.className),n.update=e.update;var a="function"==typeof e.view?e.view.extend(n):$.extend(!0,e.view,n);e.collection.View=a,e.collection.each(function(t){if(t.addView("iview",a),t.icollection){if(e.useJquerySel){var i=e.containment.children('[id="'+t.id+'"]');if(e.wrap)if(i.children(e.wrap+e.wrapClassName?"."+e.wrapClassName:"").length)i=i.children(e.wrap+e.wrapClassName?"."+e.wrapClassName:"");else{var n=$(document.createElement(e.wrap));i.append(n),e.wrapClassName&&n.addClass(e.wrapClassName),i=n}}else{"string"!=typeof e.containment&&(e.containment=e.containment.selector);var i=e.containment+(e.wrap?" >"+e.wrap:"")+' >[id="'+t.id+'"]'}_g.mvc.createTreeView({collection:t.icollection,view:e.view,wrapClassName:e.wrapClassName,containment:i,wrap:e.wrap||null,template:e.template||null,useJquerySel:e.useJquerySel})}})},sortTreeByIds:function(e){var t=function(i,n,o){return i?(i.reset([],{silent:e.silent}),_.each(n,function(n){n.children=n.children||[];var r=a.get(n.id);r.treeLevel=o,r.icollection=t(r.icollection,n.children,o+1),i.add(r,{silent:e.silent}),r.collection=i}),i):null},i={collection:null,ids:null,treeLevel:0,silent:!0},n=e.collection;if(e=e?$.extend(!0,{},i,e):i,e.collection=n,!e.collection||!e.ids)return!1;var a=new Backbone.Collection;a.add(_g.mvc.getTreeModels(e.collection));var o=t(e.collection,e.ids,e.treeLevel);return o},getTreeModels:function(e){var t=[];return e.each(function(e){if(t.push(e),e.icollection)for(var i=_g.mvc.getTreeModels(e.icollection),n=0;n<i.length;n++)t.push(i[n])}),t},getTreeModel:function(e,t){if(!e||!t)return!1;var i=_g.mvc.getTreeModels(e);return _.find(i,function(e){return e.id==t})},getTreeData:function(e,t){var i=[];return e.each(function(e){var n=$.extend(!0,{},e.toJSON());t&&t.filter&&(n=_.pick(n,t.filter)),e.icollection&&(n.children=_g.mvc.getTreeData(e.icollection,t)),i.push(n)}),i},moveTo:function(e){void 0==e.silent&&(e.silent=!0);var t=null;if(void 0!=e.fromIndex&&void 0!=e.toIndex)t=e.collection.at(e.fromIndex),e.collection.remove(t,{silent:e.silent}),e.collection.add(t,{at:e.toIndex,silent:e.silent});else if(void 0!=e.sourceId&&void 0!=e.targetId&&void 0!=e.position){t=e.collection.get(e.sourceId),e.collection.remove(t,{silent:e.silent});var i=e.collection.get(e.targetId),n=e.collection.indexOf(i);if(-1==e.position)var a=n;else var a=n+1;e.collection.add(t,{at:a,silent:e.silent})}}};"undefined"==typeof require?(window._g||(window._g={}),window._g.mvc=_g_mvc,_g_mvc=void 0):define("_g/mvc",["jquery","backbone","_g/base","_g/ui","_g/util"],function(){return window._g.mvc=_g_mvc,_g_mvc=void 0,window._g.mvc})}(window),define("text!interaction_view/template/page.js",[],function(){return'<section class="Presentation" id="<%=id%>">\n    <div class="interaction-area typo">\n      <div class="interaction-view"></div>\n   </div>\n</section>'}),define("text!interaction_view/template/pagegroup.js",[],function(){return'<section class="group" id="<%=id%>"></section>'}),define("interaction_view/view/page",["_g/mvc","text!interaction_view/template/page.js","text!interaction_view/template/pagegroup.js"],function(){var e={template:require("text!interaction_view/template/page.js"),className:null,containment:"div.slides",wrap:null,wrapClassName:null,autoRender:!0,position:1,parseData:null,callback:function(){"page_group"!=this.model.get("type")&&(this.overlays=this.model.get("overlays"),this.animations=this.model.get("animations"),this.actions=this.model.get("actions")),"page"==this.model.get("type")&&this.renderbg()},bindChange:null,parseTemplate:function(){var e=this.model.get("type");return _g.parseTemplate("page_group"==e?require("text!interaction_view/template/pagegroup.js"):require("text!interaction_view/template/page.js"))},render:function(e,t){if(!this.model||!this.template)return!1;if(!$.contains(document.documentElement,this.$el[0])){if(interaction_view.foredit){if(!e&&!this.containment)return!1;e||(e=$(this.containment)),t||(t=this.position),this.wrap&&!$(this.containment).is(this.wrap)&&(0==$(this.containment).children(this.wrap).length&&$(this.containment).append(document.createElement(this.wrap)),e=$(this.containment).children(this.wrap),this.containment&&this.wrapClassName&&e.addClass(this.wrapClassName))}var i,n;return $("section#"+this.model.id).length>0?(i=$("section#"+this.model.id)[0],n=i,this.setElement(n)):interaction_view.foredit&&(i=this.createEl(),n=i,this.setElement(n),1==t?e.append(n):e.prepend(n)),this.afterRender&&this.afterRender(this),this}var i=this.createEl(),n=i;this.$el.replaceWith(n),this.setElement(n),this.afterUpdate&&this.afterUpdate(this)},renderbg:function(){var e=this.$el;if(2==interaction_view.screen_mode&&(e=this.$el.children()),this.model.get("picture")&&e.css({"background-image":"url("+this.model.get("picture")+")","background-size":"contain","background-position":"center center","background-repeat":"no-repeat"}),interaction_view.forpreview){var t=this.model.get("bg_color"),i=this.model.get("bg_opacity"),n=-1==t.indexOf("rgba")?_g.getRGBA(t,i):t;this.$el.css({"background-color":n})}},prepareLoad:function(){for(var e=this,t=[],i=0;i<e.animations.length;i++){var n=$.extend(!0,{},e.animations[i]);n.pageid=e.model.id,e.isMaster&&(n.pagetype="master"),e.isBackground&&(n.pagetype="background"),t.push(n)}e.model.iAnimationlist.reset(t);for(var a=[],i=0;i<e.overlays.length;i++){var n=$.extend(!0,{},e.overlays[i]);interaction_view.model[n.iType]&&(n.pageid=e.model.id,n.zIndex=i,e.isMaster&&(n.pagetype="master","Audio"==n.iType&&n.iDetail.iAutoplay&&!interaction_view.hasbgsound&&(interaction_view.hasbgsound=!0,n.isBgsound=!0)),a.push(new interaction_view.model[n.iType](n)))}e.model.iOverlaylist.reset(a),e.model.iOverlaylist.each(function(e){e.iview.setZindex()});for(var o=[],i=0;i<e.actions.length;i++){var n=$.extend(!0,{},e.actions[i]);n.pageid=e.model.id,e.isMaster&&(n.pagetype="master"),o.push(n)}e.model.iActionlist.reset(o)},startLoad:function(){0==this.model.ipreloadlist.length?interaction_view.finishPagePreload(this.model.id,this.model):this.model.ipreloadlist.preload()},afterpreload:function(){var e=this;e.model.iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),e.hasRenderActionlist?e.model.iActionlist.each(function(e){e.iview&&_.include([0,1,2,4,6,7,14,15,20,21,99],e.get("iType"))&&e.iview.render({init:!1})}):(e.hasRenderActionlist={},e.model.iActionlist.each(function(e){e.iview&&e.iview.render({init:!0})}))},clearPageLoad:function(){if(this.model.get("loaded")){var e=this.$el.find(".interaction-view");e.empty(),this.model.iAnimationlist&&this.model.iAnimationlist.timeline&&this.model.iAnimationlist.timeline.kill(),this.model.isStartLoad=!1,this.model.playFinished=!1,this.ipreloadlist=new interaction_view.collection.Preload,interaction_view.events.clearRelatedEvents(this.model.id),this.model.unset("loaded",{silent:!0}),this.model.iview.$el.hasClass("dragConnector")&&connector.removeDragController(this.model.iview.$el)}presentation.pageClearCenter(this.model.id)}};return e}),define("interaction_view/view/subcontainer",["interaction_view/view/page"],function(){var e=require("interaction_view/view/page"),t=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!1,position:1,parseData:null,afterload:function(){var e=this;overlays=_.filter(e.model.suboverlays,function(t){return t.path=e.model.iOverlaylist.path,t.isSubOverlay=!0,interaction_view.model[t.iType]}),overlays=_.map(overlays,function(e){return new interaction_view.model[e.iType](e)}),e.model.iOverlaylist.reset(overlays),e.startSubLoad()},startSubLoad:function(){var e=this;0==e.model.ipreloadlist.length?e.model.iview.afterSubOverlayPreload():e.model.ipreloadlist.preload()}});return t});var _eT={RichText:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iText nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow-y:hidden;padding:0;margin:0;">',"<% if(iDetail.iStaticImage&&iDetail.iImg&&iDetail.iImg[0]){%>",'<img class="el_wrap" src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:auto;"/>',"<% }else{%>",'<div class="el_wrap" style="position:absolute;width:100%;height:100%;<%=iDetail.iStyle%>"><%=iDetail.iText%></div>',"<% } %>","</div>","</div>"].join(""),Paragraph:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iParagraph Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;padding:0;margin:0;line-height:1.5;">',"<% if(iDetail.iStaticImage&&iDetail.iImg&&iDetail.iImg[0]){%>",'<div class="paragraph nanoscrollbar el_wrap" style="position:absolute;left:0; top: 0 ;background-color:transparent;width:100%;height:100%;padding:0;margin:0;overflow:hidden;">','<img src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:auto;"/>',"</div>","<% }else{%>",'<div class="paragraph nanoscrollbar el_wrap" style="position:absolute;left:0; top: 0 ;background-color:transparent;width:100%;height:100%;padding:0;margin:0;overflow:hidden;<%=iDetail.iStyle||""%>">','<div style="text-align:inherit;width:100%;height:100%;font-size: inherit;color: inherit;font-family: inherit;font-weight:inherit;" class="iText"><%=iDetail.iText%></div>',"</div>","<% } %>","</div>","</div>"].join(""),TextLabel:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTextLabel nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow-y:hidden;<%=iDetail.iStyle%>">',"<% if(iDetail.iStaticImage&&iDetail.iImg&&iDetail.iImg[0]){%>",'<img src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:auto;"/>',"<% }else{%>",'<div style="position:absolute;width:100%;height:100%;<%=iDetail.iStyle%>"><%=iDetail.iText%></div>',"<% } %>","</div>","</div>"].join(""),Image:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iImage Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iMask?"overflow:hidden;":""%>">',"<%if(iDetail.iImg&&iDetail.iImg[0]){%>","<% if(iDetail.iMask){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:<%=iDetail.iMask_data.width%>px;height:<%=iDetail.iMask_data.height%>px;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else if(iDetail.iEraser||iDetail.iEditable||iDetail.iQrcode){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:100%;height:100%;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else{%>",'<div class="image_wrap el_wrap bk_full" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;background-image:url(<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>);<%=iDetail.iStyle%>">',"<% } %>","<%}%>","</div>","</div>"].join(""),ImageBlock:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iImageBlock Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">',"<%if(iDetail.iImg&&iDetail.iImg[0]){%>","<% if(iDetail.iMask){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:<%=iDetail.iMask_data.width%>px;height:<%=iDetail.iMask_data.height%>px;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else if(iDetail.iEraser||iDetail.iEditable||iDetail.iQrcode){%>",'<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:100%;height:100%;position:absolute;max-width:none;" src="<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>">',"</div>","<%}else{%>",'<div class="image_wrap el_wrap bk_full" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;background-image:url(<%=iDetail.iImg&&iDetail.iImg[0]&&iDetail.iImg[0].picture%>);<%=iDetail.iStyle%>">',"<% } %>","<%}%>","</div>","</div>"].join(""),Link:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iLink Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>"></div>',"</div>"].join(""),SearchInput:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iSearchInput Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">','<form class="search" style="position:relative; cursor:default;">','<input type="text" autofocus placeholder="è¾å¥å³é®å­" class="input-medium search-query" style="cursor:default; width:<%=iCommon[iPageDirection].iWidth-14%>px; height:<%=iCommon[iPageDirection].iHeight-2%>px; line-height:<%=iCommon[iPageDirection].iHeight-2%>px; border-radius:8px; border-color:<%=iDetail.border_color%>; color:<%=iDetail.text_color%>; background-color:transparent;">','<button class="btn" type="submit" style="cursor:default; position:absolute; top:0; right:0; display:block; width:30px; height:<%=iCommon[iPageDirection].iHeight-2%>px; line-height:30px; background:none; border:none; margin:0 0 0 -30px; padding:0; text-shadow:none; color:#ccc;">','<i class="icon-search"></i>',"</button>","</form>","</div>","</div>"].join(""),Input:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iInput Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<input type="text" placeholder="<%=iDetail.placeholder%>" class="input-medium search-query c-input" style=" width:<%=iCommon[iPageDirection].iWidth%>px; height:<%=iCommon[iPageDirection].iHeight%>px; line-height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>"> ',"</div>","</div>"].join(""),Textarea:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTextarea Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<textarea placeholder="<%=iDetail.placeholder%>" style="cursor:default; width:<%=iCommon[iPageDirection].iWidth%>px; height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>"></textarea>	 ',"</div>","</div>"].join(""),Select:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iInput Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<select class="input-medium search-query c-select" style="cursor:default; width:<%=iCommon[iPageDirection].iWidth%>px; height:<%=iCommon[iPageDirection].iHeight%>px; line-height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">			',"<option></option>","</select>","</div>","</div>"].join(""),SelectBox:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iSelectBox Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<input type="<%=iDetail.type%>" class="input-medium search-query" style="','vertical-align:"middle";','padding:0px;margin:0;" id="<%=id+"box"%>"> <label for="<%=id+"box"%>" ><span style="display:inline;<%=iDetail.iStyle%>"><%=iDetail.label%></span></label>',"</div>","</div>"].join(""),Tree:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTree Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">		 ',"</div>","</div>"].join(""),Grid:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iGrid Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),Gallery:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iGallery Element nanoscrollbar" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow:hidden;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),PageIndex:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iPageIndex Element nanoscrollbar" style="overflow:hidden;position:absolute;left: -<%=parseInt(iCommon[iPageDirection].iWidth/2,10)-0.5%>px; top: -<%=parseInt(iCommon[iPageDirection].iHeight/2,10)-0.5%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),Cell:['<div class="iView static hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="position:absolute; left: <%=iCommon[iPageDirection].iStartx%>px; top: <%=iCommon[iPageDirection].iStarty%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iCell Element" style="overflow:hidden;position:absolute;left: 0px; top:0px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow:hidden;<%=iDetail.iStyle%>">',"		</div>","</div>"].join(""),TabBar:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTabBar Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow:hidden;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),WebContent:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="i<%=iType%> nanoscrollbar Element iMouseWheel disableMouseWheelY disableMouseWheelX disableDragX disableDragY" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;-webkit-overflow-scrolling:touch;overflow:auto;<%=iDetail.iStyle%>">','<iframe style="position:absolute;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;min-height:<%=iCommon[iPageDirection].iHeight%>px;height:100%;border:none;overflow:visible;"></iframe>',"</div>","</div>"].join(""),Slide:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iSlide Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="slidecontent overflowhidden" style="position:absolute;width:100%;height:100%;line-height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"<%if(iDetail.iImg){%>","<%_.each(iDetail.iImg,function(i,index){%>",'<%if(_g.getUrlParameterByName("-playmode")=="1"){%>','<img data-index="<%=index%>" id="<%=preload_id[index]%>" class="Context" style="width:100%;height:100%;position:absolute;margin:auto;display:inline;verticle-align:middle;">',"<%}else{ %>",'<img data-index="<%=index%>" id="<%=preload_id[index]%>" class="Context" style="width:100%;height:100%;position:absolute;margin:auto;display:inline;verticle-align:middle;">',"<%}%>","<%})%>","<%}%>","</div>","</div>","</div>"].join(""),CycleImage:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iCycleImage Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="slidecontent overflowhidden" style="position:absolute;width:100%;height:100%;line-height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>","</div>"].join(""),Video:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iVideo Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),Audio:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iAudio Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"</div>","</div>"].join(""),Button:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iButton Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">',"<%if(iDetail.iconNormal&&iDetail.iconNormal[0]){%>",'<img class="Context iconNormal" id="<%=preload_id[0]%>" style="width:100%;height:100%;position:absolute;">',"<%}%>","<%if(iDetail.iconActive&&iDetail.iconActive[0]){%>",'<img class="Context iconActive" id="<%=preload_id[1]%>" style="width:100%;height:100%;position:absolute;display:none;">',"<%}%>","</div>","</div>","</div>"].join(""),Map:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iMap nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">','<iframe style="width: 100%; height: 100%;" src="<%if(web_url == \'./staticfs/\'){%>.<%}%><%=iDetail.iText + "&view=view"%>" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>',"</div>","</div>"].join(""),LayerRef:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iLayerRef Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="layer-mask" style="position:absolute;width:100%;height:100%;overflow:hidden;<%=iDetail.iStyle%>">',"<%if(iDetail.layer_ids&&iDetail.layer_ids.length>0){%>",'<div class="layer-content" style="position:absolute;width:100%;height:100%;">',"<% _.each(iDetail.layer_ids,function(layerid){ %>","<% if(interaction_view.ilayerlist.get(layerid)){ %>",'<div class="layer-item" data-index="<%=iDetail.layer_ids.indexOf(layerid)%>" data-id="<%=layerid%>" style="position:absolute;opacity:0;width:<%=interaction_view.ilayerlist.get(layerid).toJSON().layer_width%>px;height:<%=interaction_view.ilayerlist.get(layerid).toJSON().layer_height%>px;left:0px;right:0px;">','<div href="" class="layer-bg" style="position:absolute;width:100%;height:100%;text-align:center;line-height:<%=interaction_view.ilayerlist.get(layerid).toJSON().layer_height%>px;background-color:<%=interaction_view.ilayerlist.get(layerid).toJSON().bg_color%>;opacity:<%=interaction_view.ilayerlist.get(layerid).toJSON().bg_opacity%>">','<% if(interaction_view.ilayerlist.get(layerid).get("picture")){ %>','<img src="<%=interaction_view.ilayerlist.get(layerid).get("picture")%>" style="<%=(interaction_view.ilayerlist.get(layerid).toJSON().layer_width>=interaction_view.ilayerlist.get(layerid).toJSON().layer_height)?"width:auto;height:100%;":"width:100%;height:auto;"%>margin:auto">',"<% } %>","</div>","</div>","<% } %>","<% }) %>","</div>","<% } %>","</div>  ","</div>	","</div>"].join(""),ComponentRef:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iLayerRef Element" style="position:absolute;left: 0px; top: 0px;background-color:transparent;width:100%;height:100%;">',"<%if(iDetail.layer_ids&&iDetail.layer_ids.length>0){%>",'<div class="layer-content" style="position:absolute;width:100%;height:100%;">',"<% _.each(iDetail.layer_ids,function(layerid){ %>","<% if(interaction_view.iComponentlist.get(layerid)){ %>","<% var _layer=interaction_view.iComponentlist.get(layerid).toJSON(); %>",'<div class="layer-item" data-index="<%=iDetail.layer_ids.indexOf(layerid)%>" data-id="<%=layerid%>" style="position:absolute;opacity:0;width:100%;height:100%;left:0px;right:0px;">',"</div>","<% } %>","<% }) %>","</div>","<% } %>","</div>","</div>"].join(""),Shape:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<% if (_g.device.svg()){%><div class="iShape nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;<%=iDetail.iStyle%>">',"<%=iDetail.iSvg%>","</div>","</div><% }else{ %>",'<div class="iImage Element" style="position:absolute;left: <%=-iCommon[iPageDirection].iWidth/2%>px; top: <%=-iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">','<img draggable="false" class="Context" style="width:100%;height:100%;position:absolute;" src="<%=iDetail.iImg[0].picture%>">  ',"</div><% } %>","</div>"].join(""),DragDrop:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iDragDrop Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="image_wrap el_wrap" style="position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;position:absolute;<%=iDetail.iStyle%>">',"<%if(iDetail.iconNormal&&iDetail.iconNormal[0]){%>",'<img class="Context iconNormal" id="<%=preload_id[0]%>" style="width:100%;height:100%;position:absolute;">',"<%}%>","<%if(iDetail.iconActive&&iDetail.iconActive[0]){%>",'<img class="Context iconActive" id="<%=preload_id[1]%>" style="width:100%;height:100%;position:absolute;display:none;">',"<%}%>","</div>","</div>","</div>"].join(""),Variable:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iVariable nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"<%=iDetail.initial%>","</div>","</div>"].join(""),Timer:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iTimer nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"<%=iDetail.formatTime%>","</div>","</div>"].join(""),InfoList:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iInfoList Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="info-content iMouseWheel disableMouseWheelY disableDragY" style="min-width:100%;<%=iDetail.iStyle%>">','<div style="margin-top: -38px;height: 38px;color:#999;">','<div style="text-align: center; font-size: 12px;height:19px;">E<% if (typeof epub360!="undefined"&&epub360.settings&& ["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type) >=0 ){ %>Epub360ææ¯æ¯æ<% } %></div>','<div class="pullDown" style="text-align: center;font-size: 12px;">ä¸æå·æ°</div>',"</div>",'<div class="lists"></div>','<div class="pullUp" style="display:none;text-align: center;font-size: 12px; color:#999;">ä¸æå è½½æ´å¤</div>',"</div>","</div>","</div>"].join(""),ChartList:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iChartList Element" style="overflow:hidden;position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="info-content iMouseWheel disableMouseWheelY disableDragY" style="min-width:100%;<%=iDetail.iStyle%>">','<div style="margin-top: -38px;height: 38px;color:#999;">','<div style="text-align: center; font-size: 12px;height:19px;"><% if (typeof epub360!="undefined"&&epub360.settings&& ["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type) >=0 ){ %>Epub360ææ¯æ¯æ<% } %></div>','<div class="pullDown" style="text-align: center;font-size: 12px;">ä¸æå·æ°</div>',"</div>",'<div class="lists"></div>',"</div>","</div>","</div>"].join(""),UserSVG:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iUserSVG Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;<%=iDetail.iStyle%>">',"<%=iDetail.iSvg%>","</div>","</div>"].join(""),FormView:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="i<%=iType%> nanoscrollbar Element iMouseWheel disableMouseWheelY disableMouseWheelX disableDragX disableDragY" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;-webkit-overflow-scrolling:touch;overflow:auto;<%=iDetail.iStyle%>">',"<% if(interaction_view.getWebContentSrc(iDetail)&&interaction_view.getWebContentSrc(iDetail).src){%>",'<iframe src="<%=interaction_view.getWebContentSrc(iDetail).src||""%>" style="position:absolute;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;min-height:<%=iCommon[iPageDirection].iHeight%>px;height:100%;border:none;overflow:visible;"></iframe>',"<% } %>","<% if(interaction_view.getWebContentSrc(iDetail)&&interaction_view.getWebContentSrc(iDetail).content){%>",'<iframe style="position:absolute;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;min-height:<%=iCommon[iPageDirection].iHeight%>px;height:100%;border:none;overflow:visible;"></iframe>',"<% } %>","</div>","</div>"].join(""),Avatar:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iAvatar Element" style="visibility: hidden; position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">',"<%if(iDetail.iconNormal&&iDetail.iconNormal[0]){%>",'	<div class="thumb" style="width:<%=(iCommon[iPageDirection].iWidth-iDetail.borderW)%>px;height:<%=(iCommon[iPageDirection].iHeight-iDetail.borderH)%>px;overflow:hidden;position:absolute;<%=iDetail.iStyle%> background-image:url(<%=iDetail.iconNormal[0].picture%>);"></div>',"<%}%>","</div>","</div>"].join(""),AvatarList:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iAvatarList Element nanoscrollbar" style="visibility: hidden; position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;overflow:hidden;<%=iDetail.iStyle%>">','<div class="info-content iMouseWheel disableMouseWheelY disableDragY">','<div style="margin-top: -38px;height: 38px;color:#999;">','<div style="text-align: center; font-size: 12px;height:19px;">E<% if (typeof epub360!="undefined"&&epub360.settings&& ["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type) >=0 ){ %>Epub360ææ¯æ¯æ<% } %></div>','<div class="pullDown" style="text-align: center;font-size: 12px;">ä¸æå·æ°</div>',"</div>",'<div class="lists">',"<% for(i=0;i<18;i++){ %>",'	<div class="avatar" style="text-align:center; padding:5px; float:left;">','		<div class="thumb" style="width: 36px; height: 36px; border-radius: 18px; background: #999 url(http://qty83k.creatby.com/materials/origin/9691dee74ea33a01f494c7e085956c8c_origin.jpg) no-repeat 50% 50%;background-size: cover;"></div>','		<div class="title" style="font-size: 12px;width: 100%; overflow: hidden; word-wrap: normal;">Jason</div>',"	</div>","<% } %>","</div>",'<div class="pullUp" style="display:none;text-align: center;font-size: 12px; color:#999;">ä¸æå è½½æ´å¤</div>',"</div>",'<% if(!interaction_view.forpreview){ %><div class="info-template" style="opacity: 0;">','	<div class="avatar" style="text-align:center; padding:5px; float:left;">','		<div class="thumb" style="width: 36px; height: 36px; border-radius: 18px; background: #999 url(http://qty83k.creatby.com/materials/origin/9691dee74ea33a01f494c7e085956c8c_origin.jpg) no-repeat 50% 50%;background-size: cover;"></div>','		<div class="title" style="font-size: 12px;width: 100%; overflow: hidden; word-wrap: normal;">Jason</div>',"	</div>","</div><% } %>","</div>","</div>"].join(""),Plugin:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="i<%=iType%> nanoscrollbar Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;background-color:transparent;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;-webkit-overflow-scrolling:touch;overflow:auto;">',"</div>","</div>"].join(""),Container:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="el_wrap bk_full" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;<%=iDetail.iStyle%>">',"</div>","</div>","</div>"].join("")};
_eT.TextButton=_eT.Paragraph,_eT.BookButton=_eT.TextLabel,_eT.Vote=_eT.SelectButton=_eT.SubmitButton=_eT.WeixinCamera=_eT.WeixinVoice=_eT.Button,_eT.LayerSlide=_eT.LayerRef,_eT.InitButton=_eT.Button,_eT.QQVideo=_eT.Video,_eT.others=['<div class="iView dynamic hide empty_view <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">',"</div>"].join(""),window.funcT={},_.each(_eT,function(e,t){funcT["_"+t]=_.template(e)}),define("interaction_view/template/t_for_v2",function(){}),define("interaction_view/model/base",["jquery","backbone","text!interaction_view/template/message.js","text!interaction_view/template/slidenumber.js","text!interaction_view/template/imgpreview.js","interaction_view/view/subcontainer","interaction_view/template/t_for_v2"],function(){var e=(require("text!interaction_view/template/message.js"),require("text!interaction_view/template/slidenumber.js")),t=require("text!interaction_view/template/imgpreview.js");window.interaction_view={model:{Base:Backbone.Model.extend({defaults:{iType:"iBasetype",iCommon:null,iDetail:null,iPage:null,iParentModel:null,template:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,callback:null},initialize:function(){this.id?(this.setcollection(),this.setmodel()):(this.set("id","e_"+this.cid),this.setcollection(),this.setmodel())},savemodel:function(){},setmodel:function(){this.onInitialize&&this.onInitialize(),this.page=interaction_view.ipagelist.getPage(this.get("pageid"))||interaction_view.imasterlist.get(this.get("pageid"))||interaction_view.ibackgroundlist.get(this.get("pageid")),this.setlist(),this.setview(),this.setsyncmodel()},createPath:function(){var e=interaction_view.createPath({path:this.get("path"),isSubOverlay:this.get("isSubOverlay"),page_id:this.get("pageid"),model:this});return e},setSubOverlays:function(){var e=this;e.suboverlays=this.getSubOverlays(),e.iOverlaylist=new interaction_view.collection.list,e.iAnimationlist=new interaction_view.collection.Animation,e.iActionlist=new interaction_view.collection.Action,e.ipreloadlist=new interaction_view.collection.Preload,e.subcontainer=e.ipreloadlist.subcontainer=e.iOverlaylist.subcontainer=e.iAnimationlist.subcontainer=e.iActionlist.subcontainer=!0,e.ipreloadlist.path=e.iOverlaylist.path=e.iAnimationlist.path=e.iActionlist.path=this.createPath(),e.ipreloadlist.pagetype=e.iOverlaylist.pagetype=e.iAnimationlist.pagetype=e.iActionlist.pagetype="sub"},getSubOverlays:function(){return this.get("suboverlays")},setlist:function(){},setresourcesmodel:function(){},setsyncmodel:function(){},setcollection:function(){},setview:function(){},url:function(){},sync:function(){}})},collection:{Base:Backbone.Collection.extend({iSync:!1,initialize:function(){this.setonadd(),this.setonremove()},setonadd:function(){},setonremove:function(){},url:"",sync:function(){},parse:function(){},resetViewStatus:function(){this.each(function(e){e.iview.resetStatus()})}}),list:Backbone.Collection.extend({iSync:!0,url:"",setonadd:function(){this.on("add",function(){})},setonremove:function(){},sync:function(e,t,i){"read"==e&&(i.url=context_url+"/overlayinit.json"),Backbone.emulateHTTP=!0,Backbone.emulateJSON=!0,Backbone.sync(e,t,i)},parse:function(){},resetViewStatus:function(){this.each(function(e){e.iview.resetStatus()})},resetBindings:function(){this.each(function(e){"Binding"==e.get("iType")&&e.iview.resetBindingStatus()})}})},view:{Base:Backbone.View.extend({initialize:function(){_.bindAll(this),this.initstart()},initstart:function(){this.preload(),this.renderDynamicElement(),this.render()},events:{},options:{},change:function(){},bindImageSwitch:function(e,t){if($("body > #imagepreview").find("button.preview-left").on("click",function(){return e.iview.preview_left(t),!1}),$("body > #imagepreview").find("button.preview-right").on("click",function(){return e.iview.preview_right(t),!1}),interaction_view.ismobile){var i=this;$("body > #imagepreview").hammer().on("dragleft",function(e){return i.dragimage="left",e.gesture.preventDefault(),!1}),$("body > #imagepreview").hammer().on("dragright",function(e){return i.dragimage="right",e.gesture.preventDefault(),!1}),$("body > #imagepreview").hammer().on("dragend",function(n){return"right"==i.dragimage&&e.iview.preview_left(t),"left"==i.dragimage&&e.iview.preview_right(t),i.dragimage=null,n.gesture.preventDefault(),!1})}},initPage:function(){var e=this.model.get("pageid");if(this.model.iPageId=e,this.model.set("isMasterOverlay",!1),this.model.set("isBackgroundOverlay",!1),this.pagetype=this.model.get("pagetype"),this.iType=this.model.get("iType"),"LayerRef"==this.pagetype){var t=this.model.get("parentpageid"),i=this.model.get("layerid"),n=interaction_view.getParentpage(t);this.model.page=n.iOverlaylist.get(e).layer[i];var a=n.iOverlaylist.get(e);this.container=a.iview.$el.find(".layer-content").children(".layer-item[data-id="+i+"]"),this.model.iPageId=t}else if("master"==this.pagetype)this.container=interaction_view.touchview?$(".reveal"):$('.Presentation[id="'+interaction_view.currentPage+'"]').find(".interaction-view"),this.model.set("isMasterOverlay",!0),this.model.isMasterOverlay=!0;else if("background"==this.pagetype)this.container=interaction_view.touchview?$(".reveal"):$('.Presentation[id="'+interaction_view.currentPage+'"]').find(".interaction-view"),this.model.set("isBackgroundOverlay",!0),this.model.isBackgroundOverlay=!0;else if(this.model.get("isSubOverlay")){this.path=this.model.get("path");var o=interaction_view.getContainerModelByPath(this.path);this.container=o.iview.$el.children(".Element"),this.model.page=interaction_view.getContainerModelByPath(this.path)}else this.container=e?$('.Presentation[id="'+this.model.get("pageid")+'"]').find(".interaction-view"):$(".interaction-view")},renderStaticElement:function(){},renderDynamicElement:function(){this.initPage();var e=this.iType,t=this.model.toJSON();this.detail=t.iDetail,this.zIndex=t.zIndex,this.iSlideNumber=t.iSlideNumber,this.isStatic=t.isStatic;var i=funcT["_"+e]?funcT["_"+e](this.model.toJSON()):funcT._others(t);this.container.append(i),this.setElement(this.container.find('div.iView[id="'+this.model.id+'"]').first());var n=this.common=this.getcommon();this.x=n.iStartx+n.iWidth/2,this.y=n.iStarty+n.iHeight/2,this.staticX=n.iStartx,this.staticY=n.iStarty,this.originWidth=n.iWidth,this.originHeight=n.iHeight,this.setSizeAdapt(),this.setScreenAdapt(),this.isStatic||-1==this.$el[0].className.indexOf("empty_view")&&interaction_view.setPos(this.$el[0],{x:this.x,y:this.y}),"master"==this.pagetype&&this.$el.addClass("master masterhide"),"background"==this.pagetype&&this.$el.addClass("background"),("CycleImage"==e||"Slide"==e||"Button"==e)&&this.setRatiofixxed(),this.iSlideNumber&&this.renderSlideNumber()},setSizeAdapt:function(){if("undefined"==typeof Reveal||!Reveal.adapt)return!1;var e=this.detail;if(e.iSizeAdapt&&_.isObject(e.iSizeAdapt_data)&&_.keys(e.iSizeAdapt_data).length){var t=!1,i=null;if(e.iScreenAdapt&&(t=!0),e.iSizeAdapt&&(e.iScreenAdapt=!0,this.model.set("iDetail",e,{silent:!0})),t)switch(e.iScreenAdapt_data){case 1:e.iSizeAdapt_data.left=!0,e.iSizeAdapt_data.top=!0;break;case 2:e.iSizeAdapt_data.top=!0;break;case 3:e.iSizeAdapt_data.top=!0,e.iSizeAdapt_data.right=!0;break;case 4:e.iSizeAdapt_data.left=!0;break;case 5:break;case 6:e.iSizeAdapt_data.right=!0;break;case 7:e.iSizeAdapt_data.left=!0,e.iSizeAdapt_data.bottom=!0;break;case 8:e.iSizeAdapt_data.bottom=!0;break;case 9:e.iSizeAdapt_data.bottom=!0,e.iSizeAdapt_data.right=!0}e.iSizeAdapt_data.left&&e.iSizeAdapt_data.right&&e.iSizeAdapt_data.top&&e.iSizeAdapt_data.bottom?i=12:e.iSizeAdapt_data.top&&e.iSizeAdapt_data.bottom&&e.iSizeAdapt_data.left?i=15:e.iSizeAdapt_data.top&&e.iSizeAdapt_data.bottom&&e.iSizeAdapt_data.right?i=16:e.iSizeAdapt_data.bottom&&e.iSizeAdapt_data.right&&e.iSizeAdapt_data.left?i=13:e.iSizeAdapt_data.top&&e.iSizeAdapt_data.right&&e.iSizeAdapt_data.left?i=14:e.iSizeAdapt_data.left&&e.iSizeAdapt_data.right?i=10:e.iSizeAdapt_data.top&&e.iSizeAdapt_data.bottom?i=11:(e.iSizeAdapt_data.top&&(i=17),e.iSizeAdapt_data.left&&(i=20),e.iSizeAdapt_data.right&&(i=18),e.iSizeAdapt_data.bottom&&(i=19)),i&&(e.iScreenAdapt_data=i,this.model.set("iDetail",e,{silent:!0}))}},setScreenAdapt:function(){if("undefined"==typeof Reveal||!Reveal.adapt)return!1;var e=this.detail;if(!this.model.isMasterOverlay&&!this.model.isBackgroundOverlay&&!e.iScreenAdapt)return!1;if(this.model.isMasterOverlay&&this.model.isBackgroundOverlay||(this.$el.addClass("fixed"),this.model.get("isStatic")||this.$el.css({left:0,top:0})),e.iScreenAdapt){var t=e.iScreenAdapt_data;1!=t&&interaction_view.adapt.elements.push({model:this.model,view:this,type:interaction_view.getPageType2(this.model),adapt:t}),interaction_view.adapt.adjustElement({model:this.model,view:this,type:interaction_view.getPageType2(this.model),adapt:t})}else t=e.iScreenAdapt?e.iScreenAdapt_data:null,interaction_view.adapt.elements.push({model:this.model,view:this,type:interaction_view.getPageType2(this.model),adapt:t}),interaction_view.adapt.adjustElement({model:this.model,view:this,type:interaction_view.getPageType2(this.model),adapt:t});interaction_view.adapt.excute({view:this,adapt:t,type:interaction_view.getPageType2(this.model),model:this.model})},renderSlideNumber:function(){if(this.model.get("iSlideNumber")){{this.getdetail()}if(this.$el.parent().find('nav.slidenumber[data-id="'+this.model.id+'"]').remove(),this.getSlideLength()>1){var t=this.model.toJSON();t.slidelength=this.getSlideLength(),this.$el.parent().append(_.template(e,t)),this.hasSlideNumber=!0,this.setSlideNumberPosition()}}},renderBackGroud:function(){var e=this.getdetail(),t=e.bg_color,i=void 0!=e.bg_opacity?Number(e.bg_opacity):1;if(t){var n=_g.number.hexToRgb(t);t="rgba("+n.r+","+n.g+","+n.b+","+i+")"}else t="transparent";this.$el.children(".Element").css({background:t})},setSlideNumberPosition:function(){this.$el.parent().find('nav.slidenumber[data-id="'+this.model.id+'"]').each(function(){var e=$(this).actual?$(this).actual("outerWidth",{includeMargin:!0}):$(this).width(),t=$(this).actual?$(this).actual("outerHeight",{includeMargin:!0}):$(this).height();$(this).css({left:$(this).attr("data-x")-e/2,top:$(this).attr("data-y")-t/2})})},setSlideNumberDisplay:function(){this.getSlideLength()>1&&(this.$el.children(".Element").is(":hidden")?this.$el.parent().find('nav.slidenumber[data-id="'+this.model.id+'"]').hide():this.$el.parent().find('nav.slidenumber[data-id="'+this.model.id+'"]').show())},setFullView:function(e){var i=this;$("body").children("#imagepreview").remove(),$("body").append('<div id="imagepreview" style="z-index:10000;width:100%;height:100%;position:absolute;left:0;top:0;background:#000;"><button type="button" class="close" style="display:block;position: absolute; top: 10px; right: 10px; z-index: 9999; width: 32px; height: 32px; line-height: 32px; margin: 0; padding: 0; font-size: 32px; color: #ddd; box-shadow: 0; text-shadow: 0 1px 0 white; text-align: center; filter: alpha(opacity=100); -khtml-opacity: 1; opacity: 1;">Ã</button><img src="'+e.picture+'"</div>'),i.isFullSwitch()&&($("body > #imagepreview").append(t),i.bindImageSwitch(e.model,e.index)),_g.ui.fitImage({fit:1,items:"#imagepreview > img",width:e.width,height:e.height}),$("#imagepreview").on("click",function(){$(this).remove()}).css("line-height","initial"),$("#imagepreview button.close").on("click",function(){$(this).remove()})},fullviewIndex:function(e){var t=this,i=this.getdetail();if("undefined"!=typeof wx_permissions&&wx_permissions.previewImage)wx.previewImage({current:i.iImg[e].picture,urls:_.map(i.iImg,function(e){return e.picture})});else{var n={picture:i.iImg[e].picture,width:i.iImg[e].width,height:i.iImg[e].height,model:t.model,index:e};t.setFullView(n)}},preload:function(){},afterpreload:function(){this.setZindex(),this.setElementDisplay(),this.model.get("iSlideNumber")&&this.setSlideNumberDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".Element").attr("style"),this.preloaded=!0},setSlideImageDisplay:function(){var e=this,t=this.getdetail();if(this.imageDisplay=t.iDisplay,t.iImg&&0!=t.iImg.length){if(!this.imageDisplay)return!1;var i=this.getcommon();_.each(t.iImg,function(n){_g.ui.fitImage({items:e.$el.find(".slidecontent").children()[t.iImg.indexOf(n)],parentWidth:i.iWidth,parentHeight:i.iHeight,width:n.width,height:n.height,fit:e.imageDisplay,useMargin:!0})})}},setRatiofixxed:function(){var e=this,t=this.getdetail();if(t.ratiofixxed&&t.iImg&&0!=t.iImg.length){var i=this.getcommon();_.each(t.iImg,function(n){var a=_g.ui.centerImage({containment:e.$el.find(".slidecontent"),Item:e.$el.find(".slidecontent").children()[t.iImg.indexOf(n)],parentWidth:i.iWidth,parentHeight:i.iHeight,width:n.width,height:n.height,setParent:!1});a.width<i.iWidth&&(e.$el.find(".slidecontent").children("[data-index="+t.iImg.indexOf(n)+"]").css("margin-left",(i.iWidth-a.width)/2+"px"),e.$el.find(".slidecontent").children("[data-index="+t.iImg.indexOf(n)+"]").css("margin-right",(i.iWidth-a.width)/2+"px")),a.height<i.iHeight&&(e.$el.find(".slidecontent").children("[data-index="+t.iImg.indexOf(n)+"]").css("margin-top",(i.iHeight-a.height)/2+"px"),e.$el.find(".slidecontent").children("[data-index="+t.iImg.indexOf(n)+"]").css("margin-bottom",(i.iHeight-a.height)/2+"px"))})}},setElementDisplay:function(){this.$el.children(".Element").length>0&&interaction_view.setPos(this.$el.children(".Element")[0],{scale:1});var e=this.model.toJSON().iDetail,t=e.iHidden||!1;if("LayerRef"!=this.model.attributes.iType&&this.$el.children(".Element").find(".el_wrap").length&&(this.wrap_el=this.$el.children(".Element").find(".el_wrap").first()),!_.isNaN(Number(e.init_opacity))){var i=Number(e.init_opacity);1>=i&&i>=0&&(this.$el[0].style.opacity=Number(e.init_opacity))}if(e.init_rotation=Number(e.init_rotation)||Number(e.rotate),!_.isNaN(Number(e.init_rotation))){var n=Number(e.init_rotation);if(360>=n&&n>=-360&&0!=n){var a=this.wrap_el?this.wrap_el[0]:this.$el.children(".Element")[0];a&&"undefined"!=typeof TweenMax&&TweenMax.set(a,{rotation:Number(e.init_rotation)})}}var o=this.model.page.iAnimationlist.where({overlay_id:this.model.id}),r=!1;if(o&&o[0]&&o[0].toJSON().iType>=20&&o[0].toJSON().iType<=60)this.$el.addClass("hide");else if(o&&o[0]&&_.include([101,102,103,104,601,701],o[0].toJSON().iType)||r){var s=o&&o[0]&&_.include([101,102,103,104,601,701],o[0].toJSON().iType)?o[0]:r[0],l=-9999,c=-9999;if(s._animation&&s._animation.css&&(l=s._animation.css.x,c=s._animation.css.y),101==s.toJSON().iType){t&&this.$el.addClass("hide");{this.getcommon().iWidth,this.getcommon().iHeight}interaction_view.ismobile||_g.browserSupport({msie:9})?interaction_view.setPos(this.$el[0],{x:l,y:c}):$(this.$el[0]).css("margin",l+"px 0px 0px "+c+"px").removeClass("hide").show()}102==s.toJSON().iType&&(interaction_view.ismobile||_g.browserSupport({msie:9}))&&(t&&this.$el.addClass("hide"),interaction_view.setPos(this.$el.children(".Element")[0],{scale:0})),103==s.toJSON().iType&&(t&&this.$el.addClass("hide"),this.$el[0].style.opacity=0),104==s.toJSON().iType&&this.$el.addClass("hide"),601==s.toJSON().iType&&this.$el.addClass("hide"),701==o[0].toJSON().iType&&(t&&this.$el.addClass("hide"),"undefined"!=typeof TweenMax&&TweenMax.set(this.$el.find("svg").find("rect, circle, ellipse, polyline, path, line, polygon"),{drawSVG:"0%",force3D:interaction_view.force3D}))}else t?this.$el.addClass("hide"):"Video"!=this.model.get("iType")&&this.$el.removeClass("hide");e.init_classname&&this.$el.children(".Element").addClass(e.init_classname),this.hideClass=this.$el.hasClass("hide")},setOtherDisplay:function(){},setZindex:function(){if("Binding"==this.iType||"DragDropGroup"==this.iType)return!1;if("Audio"==this.iType&&!this.detail.iControl)return!1;var e=this.zIndex;"master"==this.pagetype?e+=2e3:"background"!=this.pagetype&&(e+=1e3),this.$el&&this.$el.css("z-index",e),this.iSlideNumber&&this.$el.parent().children('nav.slidenumber[data-id="'+this.model.id+'"]').css("z-index",e)},setMaskSlipable:function(e){var t=this,i=this.getMoveRange();if(i.x&&e.containment.addClass("iMouseWheel disableMouseWheelX disableDragX"),i.y&&e.containment.addClass("iMouseWheel disableMouseWheelY disableDragY"),i.x||i.y){var n=0,a=0;this.scrollview=new _g.scrollview({containment:e.containment,contentel:e.contentel,mask_width:this.$el.children(".Element").width(),mask_height:this.$el.children(".Element").height(),content_width:this.getLayerContentSize().width,content_height:this.getLayerContentSize().height,content_x:e.content_x,content_y:e.content_y,scrollX:i.x>0?!0:!1,scrollY:i.y>0?!0:!1,onScrollStart:function(){n=t.scrollview._getCurrentPosition().x,a=t.scrollview._getCurrentPosition().y,$("section#"+interaction_view.currentPage).children().data("is_scrollPage")&&interaction_view.ipagelist.getPage(interaction_view.currentPage).iview.scrollview.iScroll.disable()},onScrolling:function(o){if(i.x>0){t.scrollstart=o.controller?!0:!1;var r=o.deltaX-n;(Math.abs(o.deltaX)>i.x+30||o.deltaX>30)&&e.containment.addClass("is_exceededX");var s=Math.abs(o.deltaX)/i.x;t.onBindingChangeTo({type:0,delta:r,deltarate:s,cdirection:0})}if(i.y>0){var l=o.deltaY-a;(Math.abs(o.deltaY)>i.y+30||o.deltaY>30)&&e.containment.addClass("is_exceededY");var s=Math.abs(o.deltaY)/i.y;t.onBindingChangeTo({type:0,delta:l,deltarate:s,cdirection:1})}},onScrollend:function(){t.scrollstart=!1,e.containment.removeClass("is_exceededY"),e.containment.removeClass("is_exceededX"),$("section#"+interaction_view.currentPage).children().data("is_scrollPage")&&interaction_view.ipagelist.getPage(interaction_view.currentPage).iview.scrollview.iScroll.enable()}}),this.getdetail().iGravity&&_g.orientation.orientationEvents.push({scrollX:i.x>0?!0:!1,scrollY:i.y>0?!0:!1,speed:i.y?i.y/1200:i.x/1200,func:function(e,n){if(interaction_view.currentPage==t.model.iPageId||"background"==t.model.get("pagetype")){if(t.scrollstart)return;if(e&&(t.scrollview.iScroll.x+e>0&&(e=-t.scrollview.iScroll.x),t.scrollview.iScroll.x+e<-i.x&&(e=-t.scrollview.iScroll.x-i.x)),n&&(t.scrollview.iScroll.y+n>0&&(n=-t.scrollview.iScroll.y),t.scrollview.iScroll.y+n<-i.y&&(n=-t.scrollview.iScroll.y-i.y)),i.x>0){var a=Math.abs(t.scrollview.iScroll.x+e)/i.x;t.onBindingChangeTo({type:0,delta:e,deltarate:a,cdirection:0})}if(i.y>0){var a=Math.abs(t.scrollview.iScroll.y+n)/i.y;t.onBindingChangeTo({type:0,delta:n,deltarate:a,cdirection:1})}t.scrollview.iScroll.scrollBy(e,n)}}}),this.$el.addClass("hascontrols")}},getMoveRange:function(){var e=this.getLayerContentSize(),t=e.width,i=e.height,n=this.getcommon();return{x:t-n.iWidth,y:i-n.iHeight}},checkMaskPos:function(e,t){var i=(this.getdetail(),!0),n=this.getLayerContentSize(),a=n.width,o=n.height;return e.left>0&&(e.left=0,i=!1),e.top>0&&(e.top=0,i=!1),Math.abs(e.left)+t.width>a&&(e.left=-(a-t.width),i=!1),Math.abs(e.top)+t.height>o&&(e.top=-(o-t.height),i=!1),i?null:{left:e.left,top:e.top}},render:function(){},renderCentrolPos:function(e){document.getElementById(this.model.id).style.left=e.x-100+"px",document.getElementById(this.model.id).style.top=e.x-100+"px"},destroy:function(){},getAnimations:function(){var e=this.model.page.iAnimationlist.where({overlay_id:this.model.id});return e.length?e:null},getcommon:function(){var e=null;return e=this.model.get("iCommon")[iPageDirection]},getdetail:function(){return this.model.get("iDetail")},resetStatus:function(){this.$el.attr("style",this.copyelstyle),this.$el.children(".Element").attr("style",this.copyelementstyle),this.hideClass?this.$el.addClass("hide"):this.$el.removeClass("hide"),this.model.get("iSlideNumber")&&this.setSlideNumberDisplay(),this.resetOtherStatus&&this.resetOtherStatus()},sendToPreload:function(e){var t=$.extend({},{parentpageid:this.model.get("parentpageid"),overlay_id:this.model.id,elementtype:this.model.get("iType"),pageid:this.model.get("pageid"),pagetype:this.model.get("pagetype"),layerid:this.model.get("layerid")},e),i=new interaction_view.model.Preload(t);return this.preloadmodel=i,i},playTimeline:function(){if(this.autoplay){if(this.timeline){if(this.$el.children(".Element").is(":hidden"))return;this.repeat||this.timeline.time()!=this.timeline.duration()?this.timeline.play(null,!1):this.timeline.play(0,!1)}}else if(this.autoplay=!0,this.useIndex)this._setCanvasLoopSwitch(),this.timeline.play();else{if(this.timeline&&this.timeline.kill(),this.timeline=new TimelineMax({paused:!0,repeat:this.repeat,onComplete:this.setRewind}),this.setTimeline(),this.setSlideDisplayAll(),this.$el.children(".Element").is(":hidden"))return;this.timeline&&this.timeline.play(null,!1)}},pauseTimeline:function(){this.timeline&&this.timeline.pause()},stopTimeline:function(){this.autoplay=!1,this.useIndex?(this.timeline.pause(),this.currentIndex=this._start,this.ctx.clearRect(0,0,this.canvas_width,this.canvas_height),this.drawCanvas(this.img_src[this._start],this._start)):(this.timeline.kill(),this.timeline=new TimelineMax({paused:!0,repeat:this.repeat}),this.setTimeline(),this.timeline.pause(1e-5),this.setSlideElementsDisplay&&this.setSlideElementsDisplay())},setRewind:function(){if(!this.timeline)return!1;var e=this,t=this.getdetail(),i=this.delay,n=function(){setTimeout(function(){e.useIndex?(e.timeline.pause(),e.currentIndex=e._start,e.drawCanvas(e.img_src[e.currentIndex],e.currentIndex)):(e.timeline.pause(1e-5),e.currentIndex=0)},1e3*i)},a=t.iRepeat?-1:0,o=t.iRewind;return this.model.onAnimationStart&&(interaction_view.events.onAnimationEnd(this.model.onAnimationStart),this.model.onAnimationStart=null),a||!o?null:void n()},_setCanvasLoopSwitch:function(e){var t=this,i=this.delay,n=this.getdetail();this.autoplay||(i=2);var a=this._start;return!this.direction&&this.currentIndex>this._start&&this.currentIndex<this._end?a=this.currentIndex:this.direction&&this.currentIndex<this._start&&this.currentIndex>this._end&&(a=this.currentIndex),e&&this.timeline&&(this.timeline.kill(),this.timeline=null),this.timeline=interaction_view.createLoop({delay:i,paused:!0,repeat:this.repeat,onComplete:this.setRewind,duration:this.repeat?this.slidelength*i:(this.slidelength+1)*i,callback:function(){var e=n.iImg[a].picture;return t.drawCanvas(e,a),t.onTimelineUpdate(a),t.onChangeSlideTo(a),a!=t._end||t.repeat?void(a=t.direction?a-1>=t._end?a-1:t._start:a+1<=t._end?a+1:t._start):(t.timeline.pause(),void t.setRewind())},time:function(){}}),a},setNone:function(){var e=this,t=0,n=this.delay;for(this.autoplay||(n=.5),i=0;i<this.slidelength;i++){if(i==this.slidelength-1&&!this.repeat)return;var a=this.slideel.children('[data-index="'+i+'"]');this.timeline.add(TweenMax.to(a,1e-5,{css:{opacity:1}}),t),this.timeline.add(TweenMax.to(a,1e-5,{css:{opacity:0},onUpdateParams:[i+1<this.slidelength?i+1:0],onUpdate:this.onTimelineUpdate}),t+1e-5+n);var o=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]');this.timeline.add(TweenMax.to(o,1e-5,{css:{opacity:0}}),t),this.timeline.add(TweenMax.to(o,1e-5,{css:{opacity:1},onCompleteParams:[i+1<this.slidelength?i+1:0],onComplete:e.onChangeSlideTo}),t+1e-5+n),i==this.slidelength-1&&this.timeline.add(TweenMax.to(a,1e-5,{css:{opacity:0}}),t+1e-5+n),t+=n+2e-5}},setFade:function(){var e,t,n=this,a=0,o=this.delay;for(this.autoplay||(o=0),i=0;i<this.slidelength;i++)if(0==i&&(e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,0,{css:{opacity:1},onCompleteParams:[0],onComplete:n.onChangeSlideTo}),a),a+=o),i==this.slidelength-1){if(!this.repeat)break;e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:1}}),a),this.timeline.add(TweenMax.fromTo(e,.5,{opacity:1},{opacity:0,onUpdateParams:[i+1<this.slidelength?i+1:0],onUpdate:this.onTimelineUpdate,ease:"Linear.easeNone",immediateRender:!1}),a+1e-5),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),a+.50001),t=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]'),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1}}),a),this.timeline.add(TweenMax.fromTo(t,.5,{opacity:1},{opacity:1,ease:"Linear.easeNone",immediateRender:!1}),a+1e-5),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1},onCompleteParams:[i+1<this.slidelength?i+1:0],onComplete:n.onChangeSlideTo}),a+.50001),a+=o+.50002}else e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:1}}),a),this.timeline.add(TweenMax.fromTo(e,.5,{opacity:1},{opacity:1,onUpdateParams:[i+1<this.slidelength?i+1:0],onUpdate:this.onTimelineUpdate,ease:"Linear.easeNone",immediateRender:!1}),a+1e-5),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),a+.50001),t=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]'),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:0}}),a),this.timeline.add(TweenMax.fromTo(t,.5,{opacity:0},{opacity:1,ease:"Linear.easeNone",immediateRender:!1}),a+1e-5),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1},onCompleteParams:[i+1<this.slidelength?i+1:0],onComplete:n.onChangeSlideTo}),a+.50001),a+=o+.50002},setSlip:function(){var e,t,n=this,a=0,o=this.delay;for(this.autoplay||(o=0),i=0;i<this.slidelength&&(i!=this.slidelength-1||this.repeat);i++){var r=this.getParamsForSlide(i).param,s=this.getParamsForSlide(i+1<this.slidelength?i+1:0).param1;r.onUpdateParams=[i+1<this.slidelength?i+1:0],r.onUpdate=this.onTimelineUpdate,r.immediateRender=!1,s.immediateRender=!1;var l=_g.number.decimal(a,5);0==i&&(e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,0,{css:{opacity:1},immediateRender:!1,onCompleteParams:[0],onComplete:n.onChangeSlideTo}),l),a+=o);var l=_g.number.decimal(a,5),c=_g.number.decimal(a+1e-5,5),d=_g.number.decimal(a+.50001,5);e=this.slideel.children('[data-index="'+i+'"]'),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:1}}),l),this.timeline.add(TweenMax.fromTo(e,.5,{css:{left:"0%",top:"0%",ease:"Linear.easeNone"},immediateRender:!1},_.clone(r)),c),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),d),t=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]'),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1}}),l),this.timeline.add(TweenMax.fromTo(t,.5,_.clone(s),{top:"0%",left:"0%",ease:"Linear.easeNone",immediateRender:!1}),c),this.timeline.add(TweenMax.to(t,1e-5,{css:{opacity:1},onCompleteParams:[i+1<this.slidelength?i+1:0,i],onComplete:n.onChangeSlideTo}),d),i==this.slidelength-1&&this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),d),a+=o+.50002}},setFlip:function(){var e,t,n,a=this,o=0,r=this.delay,s=this.getdetail(),l=s.iSlidetype?s.iSlidetype:0,c=180;for("æ¨ªå"==l||0==Number(l)?(l=0,n={rotationY:0},TweenLite.set(this.slideel,{rotationY:0})):(l=1,n={rotationX:0},TweenLite.set(this.slideel,{rotationX:0})),this.autoplay||(r=0),TweenLite.set(this.$el.children(".Element"),{perspective:800}),TweenLite.set(this.slideel,{transformStyle:"preserve-3d"}),TweenLite.set(this.slideel.children(),{backfaceVisibility:"hidden"}),i=0;i<this.slidelength&&(i!=this.slidelength-1||this.repeat);i++){n.onUpdateParams=[i+1<this.slidelength?i+1:0],n.onUpdate=this.onTimelineUpdate,l?n.rotationX="+=180cw":n.rotationY="-=180cw",0==i&&(e=this.slideel.children('[data-index="'+i+'"]'),l?this.timeline.add(TweenMax.to(e,0,{rotationX:180==c?0:180,opacity:1,onCompleteParams:[0],onComplete:a.onChangeSlideTo}),o):this.timeline.add(TweenMax.to(e,0,{rotationY:180==c?0:180,opacity:1,onCompleteParams:[0],onComplete:a.onChangeSlideTo}),o),o+=r);var d=_g.number.decimal(o,5),h=_g.number.decimal(o+1e-5,5),u=_g.number.decimal(o+.50001,5);e=this.slideel.children('[data-index="'+i+'"]'),t=this.slideel.children('[data-index="'+(i+1<this.slidelength?i+1:0)+'"]'),l?this.timeline.add(TweenMax.to(e,1e-5,{rotationX:180==c?0:180,opacity:1}),d):this.timeline.add(TweenMax.to(e,1e-5,{rotationY:180==c?0:180,opacity:1}),d),this.timeline.add(TweenMax.to(this.slideel,.5,_.clone(n)),h),this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),u),l?this.timeline.add(TweenMax.to(t,1e-5,{css:{rotationX:c,opacity:1}}),d):this.timeline.add(TweenMax.to(t,1e-5,{css:{rotationY:c,opacity:1}}),d),this.timeline.add(TweenMax.to(t,1e-5,{onCompleteParams:[i+1<this.slidelength?i+1:0],onComplete:a.onChangeSlideTo}),u),i==this.slidelength-1&&this.timeline.add(TweenMax.to(e,1e-5,{css:{opacity:0}}),u),o+=r+.50002,c=180==c?0:180}},setFlow:function(){function e(e){t.onTimelineUpdate(e),t.setElementTo(e),!t.getdetail().iRepeat&&t.getdetail().iRewind&&e>=t.slidelength-1&&TweenMax.to(t.slideel.find('[data-index="'+e+'"]'),.3,{opacity:1,onComplete:function(){t.CoverFlow.coverflow("select",0)}})}var t=this,n=0,a=this.delay;for(this.autoplay||(a=0),i=0;i<this.slidelength&&(i!=this.slidelength-1||this.repeat);i++){0==i&&(n+=a);var o=this.slideel.find('[data-index="'+i+'"]');this.timeline.add(TweenMax.to(o,.3,{opacity:1,onUpdateParams:[i+1<t.slidelength?i+1:0],onUpdate:e}),n),n+=a+.3}},onBindingChangeTo:function(e){interaction_view.events.onBingChangeTo({type:e.type,page_id:this.model.page.id?this.model.page.id:this.model.get("layerid"),id:this.model.id,delta:e.delta,deltarate:e.deltarate,cdirection:e.cdirection})},onTimelineUpdate:function(){var e=this.timeline.time();interaction_view.events.onBingChangeTo({type:0,page_id:this.model.page.id?this.model.page.id:this.model.get("layerid"),id:this.model.id,delta:-1,deltarate:e/this.timeline.duration(),cdirection:null})},onChangeSlideTo:function(e){this.currentIndex=e,this.model.trigger("slideTo",e),this.model.get("iSlideNumber")&&this.changeSlideNumber()},changeSlideNumber:function(){var e=this.$el.parent().children('nav.slidenumber[data-id="'+this.model.id+'"]').children(":nth-child("+(this.currentIndex+1)+")");e.each(function(){$(this).addClass("active").siblings().removeClass("active")})},onExecuteBinding:function(e){if("LayerRef"==this.model.get("iType"))return void this.onExecuteBindingForLayerRef(e);var t=this;if(this.slideel&&this.slidelength>1&&this.timeline){var i=this.timeline.duration();if(singletime=this.repeat?i/this.slidelength:i/(this.slidelength-1),0==e.type){t.useIndex||t.setSlideDisplayAll(),a=e.deltarate*i;var n=parseInt(a/singletime,10);t.slideChangePatch(e.delta,n),t.onChangeSlideTo(n),t.useIndex?(t.indexTime=a,t.drawCanvas(t.img_src[n],n),t.autoplay&&(t.autoplay=!1,t.timeline.pause(a))):t.timeline.seek(a)}else{if(t.useIndex)var a=t.indexTime;else var a=t.timeline.time();console.log("stop at delta"+e.delta),"CycleImage"!=t.model.get("iType")&&(a/singletime-parseInt(a/singletime,10)<.2?(a=parseInt(a/singletime,10)*singletime,n=parseInt(a/singletime,10)):a/singletime-parseInt(a/singletime,10)>.8?(a=(parseInt(a/singletime,10)+1)*singletime,n=parseInt(a/singletime,10)):(a=parseInt(a/singletime,10)*singletime,n=parseInt(a/singletime,10),e.delta<0&&i>a&&(a+=singletime,n=parseInt(a/singletime,10)))),console.log(a),(0==a||1e-5==a)&&(a=1e-5,e.reset&&e.revert&&(a=t.repeat?1e-5:t.timeline.duration(),n=parseInt(a/singletime,10))),n>t.slidelength-1&&(n=0),t.useIndex?(t.indexTime=a,void 0!=n&&t.drawCanvas(t.img_src[n],n)):t.timeline.seek(a),t.useIndex||t.setSlideDisplay(n),t.onChangeSlideTo(n)}}},setSlideDisplay:function(e,t){this.autoplay||(this.slideel.children('[data-index="'+e+'"]').css({display:"block",opacity:1}),t&&this.slideel.children('[data-index="'+e+'"]').css("opacity",1),"LayerSlide"==this.model.get("iType")&&(this.onShow(e),this.onBeforeHide(e)),this.slideel.children('[data-index="'+e+'"]').siblings().hide(),t&&this.slideel.children('[data-index="'+e+'"]').siblings().css("opacity",0),"LayerSlide"==this.model.get("iType")&&this.onHide(e))},setSlideDisplayAll:function(){this.slideel.children().css("display","block")},setElementTo:function(e){var t=this,i=this.getdetail();if("Flow"==i.iFade){var n=t.CoverFlow.children(".ui-state-active").index(),a=i.iImg.length-1;return"prev"==e?e=0>=n?a:n-1:"next"==e?e=n>=a?0:n+1:"first"==e?e=0:"last"==e&&(e=a),0>e&&(e=0),e>a&&(e=a),void t.CoverFlow.coverflow("select",e)}if(_.include(["first","last","prev","next"],e));else{if(0/0==Number(e)||this.currentIndex==Number(e))return;
e=Number(e)}var o,r=i.iRepeat,s=!1,l=null;if(this.slidelength&&!(e>=this.slidelength)){var c=_g.number.decimal(this.timeline.duration(),5);if(o=r?_g.number.decimal(c/this.slidelength,5):_g.number.decimal(c/(this.slidelength-1),5),"first"==e)l=1e-5;else if("last"==e)l=(this.slidelength-1)*o;else if("prev"==e){s=!0;var d=!0;if(!r&&0==this.currentIndex)return!1;var h=0==this.currentIndex?this.slidelength-1:this.currentIndex-1;l=h*o,1e-5==l&&(l=0)}else if("next"==e){s=!0;var u=!0;if(!r&&this.currentIndex==this.slidelength-1)return!1;var h=this.currentIndex==this.slidelength-1?0:this.currentIndex+1;l=h*o,1e-5==l&&(l=0)}else{if(!(Number(e)>=0&&Number(e)<this.slidelength))return!1;l=o*parseInt(e,10)+1e-5}if(console.log(l),0==l&&(l=1e-5),e=parseInt(l/o,10),e>this.slidelength-1&&(e=0),"None"!=this.iFade&&"LoopSwitch"!=this.iFade&&s){if(t.setSlideDisplayAll(),u)var p=1e-5==l?c:l;if(d){var m=_g.number.decimal(t.timeline.time(),5);(0==m||1e-5==m)&&t.timeline.seek(c);var p=l}this.timeline.tweenTo(p,{onComplete:function(){u&&1e-5==l&&t.timeline.seek(1e-5),console.log("stop at "+t.timeline.time()),t.setSlideDisplay(e),t.onChangeSlideTo(e),t.onBindingChangeTo({type:1,delta:0})}})}else{t.useIndex?(t.indexTime=l,t.drawCanvas(t.img_src[e],e),t.autoplay&&(t.autoplay=!1,t.timeline.pause(l))):t.timeline.seek(l,!1);{Math.abs(this.timeline.time()/this.timeline.duration())}t.useIndex||this.setSlideDisplay(e),this.onChangeSlideTo(e),this.onBindingChangeTo({type:1,delta:0})}}},slideChangePatch:function(e,t){var n=this;if(e>0)for(i=n.currentIndex;i>t;i--)0>i&&(i=n.slidelength-1),i!=n.currentIndex&&n.onChangeSlideTo(i);if(0>e)for(i=n.currentIndex;t>i;i++)i>n.slidelength-1&&(i=0),i!=n.currentIndex&&n.onChangeSlideTo(i)},addControlClass:function(){var e=this.getdetail(),t=e.iSlidetype?e.iSlidetype:0;this.$el.children(".Element").addClass("iMouseWheel"),this.$el.children(".Element").addClass("æ¨ªå"==t||0==Number(t)?"enableMouseWheelX disableDragX":"enableMouseWheelY disableDragY")},removeControlClass:function(){this.$el.children(".Element").removeClass("iMouseWheel").removeClass("enableMouseWheelX disableDragX").removeClass("enableMouseWheelY disableDragY")},control:function(){if(this.controled)return void(this.canSlip?this.addControlClass():this.removeControlClass());var e=(_g.touch.support,"touchstart"),t="touchmove",i="touchend";eCancel="touchcancel";var n,a=this,o=this.getdetail(),r=0,s=0;this.indexTime=0;var l,c=0,d=0,h=0,u=0,p=!1,m=!1,f=null,v=null,g=null,w=this.$el.children(".Element").width(),_=o.iSlidetype?o.iSlidetype:0,y=this.timeline.duration(),b="æ¨ªå"==_||0==Number(_)?0:1;n=this.singletime=this.repeat?y/this.slidelength:y/(this.slidelength-1);var x=this.repeat,S=function(){("Slide"!=a.model.get("iType")||a.canSlip)&&(l=0,u=0,a.autoplay&&(a.indexTime=a.timeline.time()),r=a.useIndex?a.indexTime:a.timeline.time(),p=!0,g=a.slideel.children(":visible").first().index(),console.log("control start"))},T=function(e,t,i){if("Slide"!=a.model.get("iType")||a.canSlip){a.useIndex||a.setSlideDisplayAll(),e>y&&(x?e-=y:(u+=1,u>5&&a.model.get("iSlideNumber")&&a.$el.children(".Element").addClass(0==b?"is_exceededX":"is_exceededY"),e=y)),0>e&&(x?e=y+e:(u+=1,console.log(y-e),u>5&&a.model.get("iSlideNumber")&&a.$el.children(".Element").addClass(0==b?"is_exceededX":"is_exceededY"),e=1e-5));var o=e/y;if(a.onBindingChangeTo({type:0,delta:t,deltarate:o,cdirection:b}),"CycleImage"==a.model.get("iType")){var s=parseInt(e/n);if(s>a.slidelength-1&&(s=0),s==a.currentIndex)return e;i||a.slideChangePatch(t,s),a.onChangeSlideTo(s)}return console.log(e),a.useIndex?(a.indexTime=e,a.drawCanvas(a.img_src[s],s),a.autoplay&&(a.autoplay=!1,a.timeline.pause(r))):a.timeline.seek(e),e}},C=function(e){if(("Slide"!=a.model.get("iType")||a.canSlip)&&"CycleImage"!=a.model.get("iType")){var t;r=a.useIndex?a.indexTime:a.timeline.time(),"CycleImage"!=a.model.get("iType")?(1e-5==r&&(r=0),r/n-parseInt(r/n,10)<.2?(r=parseInt(r/n,10)*n,t=parseInt(r/n,10)):r/n-parseInt(r/n,10)>.8?(r=(parseInt(r/n,10)+1)*n,t=parseInt(r/n,10)):(r=parseInt(r/n,10)*n,t=parseInt(r/n,10),0>e&&y>r&&(r+=n,t+=1)),r=Math.round(r/n)*n+1e-5):t=parseInt(r/n,10),console.log("final time is"+r),0==r&&(r=1e-5),t>a.slidelength-1&&(t=0),a.useIndex?(a.drawCanvas(a.img_src[t],t),a.onChangeSlideTo(t),a.onBindingChangeTo({type:1,delta:e})):a.timeline.tweenTo(r,{onComplete:function(){a.useIndex||a.setSlideDisplay(t),a.onChangeSlideTo(t),a.onBindingChangeTo({type:1,delta:e})}})}};if(_g.touch.support){var k,P,E;this.$el.children(".Element").on(e,function(e){if(e=e.originalEvent.touches[0],!a.testControl(e.target))return!1;if(!$(this).hasClass("is_exceededX")&&!$(this).hasClass("is_exceededY")){f=c=e.pageX,v=d=e.pageY,k=e.pageX,P=e.pageY,E=!0;var t=e.target;s=0,S(),setTimeout(function(){k!==c||E||P!==d||$(t).trigger("click")},200)}}),this.$el.children(".Element").on(t,function(e){if(e=e.originalEvent.touches[0],$(this).hasClass("is_exceededX")||$(this).hasClass("is_exceededY"))return void(p=!1);if(p&&null!=f){if(l="æ¨ªå"==_||0==Number(_)?e.pageX-f:e.pageY-v,h="æ¨ªå"==_||0==Number(_)?e.pageX-c:e.pageY-d,moveOppositeDirection="æ¨ªå"==_||0==Number(_)?e.pageY-d:e.pageX-c,console.log("direction"+h),console.log("oppsite"+moveOppositeDirection),Math.abs(h)<=2&&Math.abs(moveOppositeDirection)>12){var t="æ¨ªå"==_||0==Number(_)?"is_exceededX":"is_exceededY";return void $(this).addClass(t)}if(c=e.pageX,d=e.pageY,0==l)return;return s="CycleImage"==a.model.get("iType")?r-l/w*y:r-l/w*n,T(s,h),!1}}),this.$el.children(".Element").on(i,function(e){return e=e.originalEvent.touches[0],E=!1,p?(0!=l?(C(l),$(Reveal.options.containment).hammer("reset")):(a.setSlideDisplay(g),interaction_view.ismobile&&a.$el.children(".Element").trigger("click")),p=!1,console.log("control stop"),$(Reveal.options.containment).hammer().trigger("dragend"),!1):($(this).removeClass("is_exceededX"),$(this).removeClass("is_exceededY"),void(u=0))}),this.$el.children(".Element").on(eCancel,function(e){return e=e.originalEvent.touches[0],p?(0!=l?(C(l),$(Reveal.options.containment).hammer("reset")):a.setSlideDisplay(g),p=!1,console.log("control cancel"),!1):($(this).removeClass("is_exceededX"),$(this).removeClass("is_exceededY"),void(u=0))})}if(this.$el.children(".Element").on("mousedown",function(e){return a.testControl(e.target)?void($(this).hasClass("is_exceededX")||$(this).hasClass("is_exceededY")||(s=0,f=c=e.pageX,v=d=e.pageY,S())):!1}),this.$el.children(".Element").on("mousemove",function(e){if($(this).hasClass("is_exceededX")||$(this).hasClass("is_exceededY"))return void(p=!1);if(p&&null!=f){if(l="æ¨ªå"==_||0==Number(_)?e.pageX-f:e.pageY-v,h="æ¨ªå"==_||0==Number(_)?e.pageX-c:e.pageY-d,c=e.pageX,d=e.pageY,0==l)return;return s="CycleImage"==a.model.get("iType")?r-l/w*y:r-l/w*n,T(s,h),e.preventDefault(),!1}}),this.$el.children(".Element").on("mouseup",function(e){return p?(0!=l?(C(l),e.preventDefault(),e.stopPropagation(),$(Reveal.options.containment).hammer("reset")):(a.setSlideDisplay(g),$(e.currentTarget).trigger("click")),p=!1,console.log("control stop"),!1):($(this).removeClass("is_exceededX"),$(this).removeClass("is_exceededY"),void(u=0))}),this.$el.children(".Element").on("mouseleave",function(e){return p?(0!=l?(C(l),e.preventDefault(),$(Reveal.options.containment).hammer("reset")):a.setSlideDisplay(g),p=!1,console.log("control cancel"),!1):($(this).removeClass("is_exceededX"),$(this).removeClass("is_exceededY"),void(u=0))}),this.$el.children(".Element").on("wheelstart",function(e){$(e.target).is(this)&&(s=0,f=c=0,v=d=0,l=0,r=a.useIndex?a.indexTime:a.timeline.time(),g=a.slideel.children(":visible").first().index(),m=!0,console.log("control start"))}),this.$el.children(".Element").on("wheelmove",function(e,t){if($(e.target).is(this)){if(!m)return!1;var i=_g.mousewheel.getMouseWheel(t),o=i.x,u=i.y;if(void 0!=o||void 0!=u){var p=Math.max(-1,Math.min(1,o)),f=Math.max(-1,Math.min(1,u)),v=30;console.log("before currentX is "+c),c+=p*v,d+=f*v,console.log("after currentX is "+c),console.log("wheelX is"+p),l="æ¨ªå"==_||0==Number(_)?p:f,console.log("control moving");var g=1;if(l){h="æ¨ªå"==_||0==Number(_)?p:f;var w="æ¨ªå"==_||0==Number(_)?c:d;if(w){"CycleImage"==a.model.get("iType")&&(g=a.slidelength>50?a.slidelength/50:1);var b="æ¨ªå"==_||0==Number(_)?g*$(this).width():g*$(this).height();w>b&&(w=b),-b>w&&(w=-b),"æ¨ªå"==_||0==Number(_)?c=w:d=w,s="CycleImage"==a.model.get("iType")?r-w/b*y:r-w/$(this).width()*n,T(s,h)}}}}}),this.$el.children(".Element").on("wheelend",function(){if(!m)return!1;var e="æ¨ªå"==_||0==Number(_)?c:d;C(e),console.log("control end"),c=d=0,m=!1}),"CycleImage"==a.model.get("iType")&&o.iGravity){var D=a.slidelength>50?a.slidelength/50:1;_g.orientation.orientationEvents.push({scrollX:"æ¨ªå"==_||0==Number(_),scrollY:!("æ¨ªå"==_||0==Number(_)),page_id:a.model.iPageId,speed:1,func:function(e,t){if(interaction_view.currentPage==a.model.iPageId){var i=a.$el.children(".Element"),n="æ¨ªå"==_||0==Number(_)?e:t;if(!n)return;n=parseInt(n),deltaend=-n;var o="æ¨ªå"==_||0==Number(_)?D*i.width():D*i.height();s=r-deltaend/o*y,console.log(s),a.indexTime=r=T(s,n,!0)}}})}this.controled=!0},getParamsForFade:function(){param.opacity=1,param1.opacity=0},getParamsForSlide:function(e){var t=this.getdetail(),i=t.iSlidetype?t.iSlidetype:0,n=this.slideel.children('[data-index="'+e+'"]');_.include(["Slide","Gallery","CycleImage"],this.model.get("iType"))&&(n=this.slideel);var a={ease:"Linear.easeNone"},o={ease:"Linear.easeNone"};return"æ¨ªå"==i||0==Number(i)?(a.opacity=1,a.left="-100%",o.left="100%",o.opacity=1):(a.opacity=1,a.top="-"+n.css("height"),o.top=n.css("height"),o.opacity=1),{param:a,param1:o}},getParamsForSlip:function(){return param},getSlideDuration:function(){{var e;this.getdetail()}return 0==this.slidelength?0:e="CycleImage"!=this.model.get("iType")?(this.delay+.50002)*this.slidelength:(this.delay+2e-5)*this.slidelength},onShow:function(){this.model.get("iSlideNumber")&&this.setSlideNumberDisplay(),_.include(["Slide","LayerSlide"],this.model.get("iType"))&&this.autoplay&&this.playTimeline(),_.include(["PageIndex","Gallery","Grid"],this.model.get("iType"))&&this.resetOtherStatus(),this.otherOnShow&&this.otherOnShow()},onBeforeHide:function(){_.include(["Slide","LayerSlide"],this.model.get("iType"))&&this.timeline&&(this.timeline.paused()||this.timeline.pause())},onHide:function(){this.model.get("iSlideNumber")&&this.setSlideNumberDisplay(),this.otherOnHide&&this.otherOnHide()},loadSubOverlay:function(e){var t=require("interaction_view/view/subcontainer");t=_g.mvc.createView(t),this.subview=new t({model:this.model}),this.preloadmodel=e,this.subview.afterload()},clearPreload:function(){this.$el.children(".Element").length&&this.$el.children(".Element").find("img").each(function(){$(this).attr("src","")})}})}},window.iOverlaylist=new interaction_view.collection.Base,interaction_view.iOverlaylist=new interaction_view.collection.list,interaction_view.currentPage=null}),define("interaction_view/model/action",["interaction_view/model/base"],function(){interaction_view.model.Action=interaction_view.model.Base.extend({defaults:{page_id:null,ref_id:null,index:null,layer_id:null,overlay_id:null},setcollection:function(){},setview:function(){if(this.pageid=this.get("pageid"),this.parentpageid=this.get("parentpageid"),this.iPage_id=this.pageid,this.app_id=this.get("app_id"),"LayerRef"==this.get("pagetype")){var e=this.get("parentpageid"),t=this.get("layerid"),i=interaction_view.getParentpage(e);this.parentpage=i,this.page=i.iOverlaylist.get(this.pageid).layer[t],this.iPage_id=e}else this.get("path")?(this.path=this.get("path"),this.page=interaction_view.getContainerModelByPath(this.path)):this.page=interaction_view.getParentpage(this.pageid);this.iview=new interaction_view.view.Action({model:this})},setsyncmodel:function(){},actionpatch:function(){var e=this,t=this.get("iDetail");"LayerRef"==this.get("pagetype")&&(this.get("layer_id")||this.set("layer_id",this.get("layerid"))),5!=t.results[0].iAction&&t.results[0].iAction<7&&(6==t.results[0].iAction&&"string"==typeof t.results[0].values&&(t.results[0].values=[{id:t.results[0].values,page_id:e.pageid}]),t.results[0].values=_.map(t.results[0].values,function(t){return"object"!=typeof t?{id:t,page_id:e.pageid}:t})),this.set("iDetail",t)}}),interaction_view.collection.Action=interaction_view.collection.Base.extend({initialize:function(){this.setonadd(),this.setonremove()},model:interaction_view.model.Action,setonadd:function(){this.on("add",function(){})},onSingleComplete:function(){},onUpdate:function(){},onTotalComplete:function(){},resetStatus:function(){this.each(function(e){e.iview.resetStatus()})}}),interaction_view.view.Action=interaction_view.view.Base.extend({initstart:function(){},renderanimations:function(){this.timeline&&this.timeline.kill()&&this.timeline.clear(!0);var e=this,t=(this.model.toJSON(),this.values);t&&t.length&&(e.timeline=animateTimeline.generateTimeline({onStart:null,ids:t,iPage_id:this.model.iPage_id,page:this.model.page,paused:!0,foraction:!0}),e.timeline&&e.timeline.play(0))},onComplete:function(){},events:{},renderDynamicElement:function(){},getClassification:function(){if(!this.ref_id){if(_.isNumber(this.index)&&this.overlaymodel)return 4;if(this.animation_id)return 5;if(!_.isNumber(this.index)&&this.overlaymodel)return 1;if(!this.overlaymodel){if(this.overlay_id==this.model.page.id)return 2;if(interaction_view.ilayerlist.get(this.overlay_id)||interaction_view.iComponentlist.get(this.overlay_id))return 3}}if(this.ref_id&&"LayerRef"==this.model.get("pagetype")&&this.model.pageid==this.ref_id&&this.model.parentpageid==this.page_id){if(_.isNumber(this.index)&&this.overlaymodel)return 4;if(this.animation_id)return 5;if(!_.isNumber(this.index)&&this.overlaymodel)return 1;if(!this.overlaymodel){if(this.overlay_id==this.model.page.id)return 2;if(interaction_view.ilayerlist.get(this.overlay_id)||interaction_view.iComponentlist.get(this.overlay_id))return 3}}return 0},render:function(e){e||(e={});var t=this.model.toJSON();this.app_id=t.app_id,this.iType=t.iType,this.overlay_id=t.overlay_id,this.page_id=t.page_id,this.ref_id=t.ref_id,this.index=t.index,this.animation_id=t.animation_id,this.layer_id=t.layer_id;var i=t.iDetail;if(i&&i.results){var n=this;if(this.actiontype=i.results[0].iAction,this.values=i.results[0].values,this.app_id)return void this.renderforapplication();if(120!=this.iType&&150!=this.iType&&151!=this.iType){if(this.overlaymodel=this.model.page?this.model.page.iOverlaylist.get(this.overlay_id):null,99==this.iType){if(this.customType=i.customType,this.customType&&interaction_view.PluginManage.Actions[this.customType]){var a={type:this.customType,view:this,func:function(){n.executeAction(n)}};interaction_view.PluginManage.Actions[this.customType](a,e)}}else{var o=this.getClassification();if(!o)return;switch(o){case 1:this.renderforoverlay();break;case 2:this.renderforpage();break;case 3:this.renderforlayer();break;case 4:this.renderforslideindex();break;case 5:this.renderforanimationaction()}}var r=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[];if(r&&interaction_view.PluginManage.ActionExecutes[this.actiontype]&&interaction_view.PluginManage.ActionExecutes[n.actiontype].setExecuteActions&&interaction_view.PluginManage.ActionExecutes[n.actiontype].setExecuteActions(n,r,e),this.preloadactions=[],101==this.actiontype&&(this.preloadactions=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[],this.preloadactions.length&&(this.preload_hash="pre_"+_g.uuid(3),_e.preloadpage.renderActions(this.preloadactions,this.preload_hash))),102==this.actiontype){var s=[],l=this.model.toJSON().id,c=this.page_id;s=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[];for(var d=0;d<s.length;d++){var h=$.extend(!0,{},s[d]),u=new interaction_view.model.Action(h);u.iview.render(),function(e){var t={userdatasave_hash:c+"_"+l,func:function(){e.iview.executeAction(e.iview)}};interaction_view.events.userdataSaveEvents.push(t)}(u)}}if(82==this.actiontype){var p=[],l=this.model.toJSON().id;p=i.results[0].iActionDetail?i.results[0].iActionDetail.actions||[]:[];for(var d=0;d<p.length;d++){var h=$.extend(!0,{},p[d]),u=new interaction_view.model.Action(h);u.iview.render(),function(e){var t={sharedatasave_hash:l,func:function(){e.iview.executeAction(e.iview)}};interaction_view.events.sharedataSaveEvents.push(t)}(u)}}}}},renderforoverlay:function(){var e=this,t={type:this.iType,page_id:this.page_id,overlay_id:this.overlay_id,layer_id:this.layer_id,func:function(){e.executeAction(e)}};switch(this.iType){case 8:case 9:case 10:case 11:case 12:t.drop_type=this.iType,t.path=this.path,_.include([11,12],this.iType)?(t.type="dragdropgroup",interaction_view.events.dragDropGroupEvents.push(t)):(t.type="dragdrop",interaction_view.events.dragDropEvents.push(t));break;case 18:case 19:case 16:case 17:t.condition=String(this.model.attributes.condition),interaction_view.events.timerEvents.push(t);break;case 22:t.condition=String(this.model.attributes.condition),interaction_view.events.variableEvents.push(t);break;case 23:interaction_view.events.voteEvents.push(t);break;case 54:interaction_view.events.paragraphEvents.push(t);break;case 41:interaction_view.events.eraserEvents.push(t);break;case 71:case 72:interaction_view.events.WeixinCameraEvents.push(t);break;case 73:interaction_view.events.collisionEvents.push(t);break;case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:interaction_view.events.userListEvents.push(t);break;case 82:case 83:interaction_view.events.contactFormEvents.push(t);break;case 100:case 101:case 102:case 103:case 104:case 105:case 110:case 111:case 140:case 141:case 130:case 131:interaction_view.events.systemVariableEvents.push(t);break;default:var i="tap",n=this.overlaymodel.iview.$el;if(20==this.iType?i="mouseenter":21==this.iType?i="mouseleave":(14==this.iType||15==this.iType)&&(i="hold"),this.overlaymodel.iview.$el.css("cursor","pointer"),this.overlaymodel.iview.$el.addClass("hasaction"),_.include(["Slide","LayerSlide","CycleImage","Vote"],this.overlaymodel.iview.iType)&&(n=n.children(".Element")),_.include(["Button"],this.overlaymodel.iview.iType)&&console.log("button"),1==this.iType&&(n=this.overlaymodel.iview.$el.find("img.iconNormal")),2==this.iType&&(n=this.overlaymodel.iview.$el.find("img.iconActive")),!n)return;if(!n.hammer)return;n.hammer().on(i,function(t){if(0==e.iType&&_.include(["Paragraph"],e.overlaymodel.iview.iType)&&interaction_view.environment.Paragraph.state()&&!e.overlaymodel.attributes.iDetail.iStaticImage)return!1;if(_.include(["Slide","LayerSlide","CycleImage","Button","Vote"],e.overlaymodel.iview.iType)&&e.overlaymodel.iview.slipable&&!$(t.target).is(t.currentTarget))return!1;if(15==e.iType){var n=!1;$(document).one("mouseup touchend touchcancel",function(){!n&&e.executeAction(e)&&(n=!0)})}else e.executeAction(e);return"hold"==i?(t.gesture.preventDefault(),!1):void 0})}},renderforanimationaction:function(){var e=this,t=this.model.page.iAnimationlist.get(this.animation_id);if(t){var i={type:"animation",page_id:this.page_id,overlay_id:this.overlay_id,animation_id:this.animation_id,path:this.path,layer_id:this.layer_id,func:function(){e.executeAction(e)}};6==this.iType&&interaction_view.events.animationStartEvents.push(i),7==this.iType&&interaction_view.events.animationEndEvents.push(i)}},renderforlayer:function(){var e=this,t=this.model.get("layerid"),i=this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).toJSON().iDetail.layer_ids.indexOf(t);return-1==i?!1:(0==this.iType&&this.model.parentpage&&this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).iview.$el.children(".Element").on("click",function(t){return!$(t.target).is(t.currentTarget)&&$(t.currentTarget).find(".layer-content").first().children().length>1?!1:void(e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex==i&&e.testControlforLayer(t)&&e.executeAction(e))}),3==this.iType&&interaction_view.events.pageStartEvents.push({type:"page",page_id:e.model.pageid,layer_id:this.model.get("layerid"),func:function(){e.executeAction(e)}}),void(4==this.iType&&this.model.parentpage&&(this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).iview.$el.addClass("hasDblClick"),this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).iview.$el.children(".Element").on("dblclick",function(t){$(t.target).closest(".layer-item").index()==e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex&&e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex==i&&e.testControlforLayer(t)&&e.executeAction(e)}),interaction_view.touchview&&this.model.parentpage.iOverlaylist.get(this.model.get("pageid")).iview.$el.children(".Element").hammer().on("doubletap",function(t){$(t.target).closest(".layer-item").index()==e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex&&e.model.parentpage.iOverlaylist.get(e.model.get("pageid")).iview.currentIndex==i&&e.testControlforLayer(t)&&e.executeAction(e)}))))},renderforpage:function(){var e=this;0==this.iType&&interaction_view.events.pageClickEvents.push({type:interaction_view.getPageType(e),page_id:e.model.page.id,func:function(){e.executeAction(e)}}),3==this.iType&&interaction_view.events.pageStartEvents.push({type:"page",page_id:e.model.page.id,func:function(){e.executeAction(e)}}),4==this.iType&&interaction_view.events.pageDblClickEvents.push({type:interaction_view.getPageType(e),page_id:e.model.page.id,func:function(){e.executeAction(e)}}),51==this.iType&&interaction_view.events.pageWXShareSuccessEvents.push({type:interaction_view.getPageType(e),page_id:e.model.page.id,func:function(){e.executeAction(e)}}),_.include([36,37,38,39],this.iType)&&interaction_view.events.pageSwipeEvents.push({type:interaction_view.imasterlist.length&&e.model.page.id==interaction_view.imasterlist.at(0).id?"master":"page",page_id:e.model.page.id,func:function(){e.executeAction(e)},swipeType:this.iType}),_.include([40],this.iType)&&interaction_view.events.pageShakeEvents.push({type:interaction_view.imasterlist.length&&e.model.page.id==interaction_view.imasterlist.at(0).id?"master":"page",page_id:e.model.page.id,func:function(){e.executeAction(e)}})},renderforslideindex:function(){if("CycleImage"!=this.overlaymodel.iview.iType&&"Slide"!=this.overlaymodel.iview.iType,!(this.overlaymodel.iview.slideel&&this.overlaymodel.iview.slidelength>0&&this.overlaymodel.iview.slidelength>this.index))return!1;var e=this;0==this.iType&&(this.overlaymodel.iview.slideel.find('[data-index="'+this.index+'"]').addClass("hasaction"),this.overlaymodel.iview.useIndex&&this.overlaymodel.iview.$el.children(".Element").addClass("hasaction"),"Flow"==this.overlaymodel.iview.detail.iFade?this.overlaymodel.iview.slideel.find('[data-index="'+this.index+'"]').hammer().on("tap",function(){e.overlaymodel.iview.currentIndex!=e.index||e.overlaymodel.iview.CoverFlow.data("CoverFlowDisableClick")||setTimeout(function(){e.executeAction(e)},300)}):this.overlaymodel.iview.$el.children(".Element").on("click",function(t){return e.overlaymodel.iview.slipable&&!$(t.target).is(t.currentTarget)?!1:void(e.overlaymodel.iview.currentIndex==e.index&&setTimeout(function(){e.executeAction(e)},300))})),5==this.iType&&interaction_view.events.elementChangeToEvents.push({type:"slide",page_id:e.model.pageid,overlay_id:this.overlaymodel.id,index:this.index,func:function(){e.executeAction(e)}}),4==this.iType&&(this.overlaymodel.iview.$el.addClass("hasDblClick"),this.overlaymodel.iview.useIndex?(this.overlaymodel.iview.$el.children(".Element").on("dblclick",function(){e.overlaymodel.iview.currentIndex==e.index&&e.executeAction(e)}),interaction_view.ismobile&&this.overlaymodel.iview.$el.children(".Element").hammer().on("doubletap",function(){e.overlaymodel.iview.currentIndex==e.index&&e.executeAction(e)})):(this.overlaymodel.iview.slideel.find('[data-index="'+this.index+'"]').on("dblclick",function(){e.executeAction(e)}),interaction_view.ismobile&&this.overlaymodel.iview.slideel.find('[data-index="'+this.index+'"]').hammer().on("doubletap",function(){e.executeAction(e)})))},renderforapplication:function(){var e=this;70==this.iType&&interaction_view.events.formSubmitEvents.push({type:70,id:this.app_id,func:function(){e.executeAction(e)}})},executeAction:function(e){if("undefined"!=typeof Reveal&&Reveal&&Reveal.isOverview()&&3!=e.iType)return!1;if(0==e.actiontype&&interaction_view.queue.immediate(e.renderanimations),1==e.actiontype&&interaction_view.queue.immediate(e.rendershow),2==e.actiontype&&interaction_view.queue.immediate(e.renderhide),6==e.actiontype&&interaction_view.queue.immediate(e.setElementTo),5==e.actiontype&&(interaction_view.foredit?global.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderpage)),7==e.actiontype&&(interaction_view.foredit?global.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderoverview)),8==e.actiontype&&(interaction_view.foredit?global.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.rendershare)),10==e.actiontype&&(interaction_view.foredit?global.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderurl)),16==e.actiontype&&(interaction_view.foredit?global.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.rendertel)),15==e.actiontype&&_g.device.android()&&window.collecting&&window.collecting.startFunction){var t=function(){var e=interaction_view.currentPage,t=interaction_view.ipagelist.getPage(e);if(t){var i=t.toJSON().nav&&t.toJSON().nav.thumbnail?t.toJSON().nav.thumbnail:null,n=interaction_view.doc.toJSON().title;window.collecting.startFunction(n,i,e)}};interaction_view.queue.immediate(t)}this.overlaymodel&&"Button"==this.overlaymodel.toJSON().iType&&this.overlaymodel.get("isTabBarButton")&&interaction_view.queue.immediate(e.syncTabButtons),_.include([17,18,19,20,21,52,53,60,72,73,100],e.actiontype)&&interaction_view.queue.immediate(function(){e.renderNormal(e.actiontype)}),_.include([50],e.actiontype)&&interaction_view.queue.immediate(e.renderWXShareImg),_.include([51],e.actiontype)&&interaction_view.queue.immediate(function(){e.renderWXShare(e.actiontype)}),_.include([56,57],e.actiontype)&&interaction_view.queue.immediate(function(){e.renderParagraph(e.actiontype)}),_.include([58],e.actiontype)&&interaction_view.queue.immediate(function(){e.setButtonToActive(e.actiontype)}),70==e.actiontype&&interaction_view.queue.immediate(function(){window.setTimeout(function(){e.submitForm(e.actiontype)},500)}),71==e.actiontype&&interaction_view.queue.immediate(function(){e.setFormValue(e.actiontype)}),_.include([59],e.actiontype)&&interaction_view.queue.immediate(e.renderreplaceresource),61==e.actiontype&&e.playElementTo(),80==e.actiontype&&(interaction_view.foredit?interaction.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderSharePage)),81==e.actiontype&&(interaction_view.foredit?interaction.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(function(){e.renderShareMode(e.actiontype)})),82==e.actiontype&&(interaction_view.foredit?interaction.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderSharedataSubmit)),90==e.actiontype&&(interaction_view.foredit?interaction.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderEvents)),110==e.actiontype&&(interaction_view.foredit?interaction.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderJS)),101==e.actiontype&&(interaction_view.foredit?interaction.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderPreloadPages)),102==e.actiontype&&(interaction_view.foredit?interaction.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½"):interaction_view.queue.immediate(e.renderUserdataSubmit)),interaction_view.PluginManage.ActionExecutes[e.actiontype]&&interaction_view.PluginManage.ActionExecutes[e.actiontype].exec&&interaction_view.PluginManage.ActionExecutes[e.actiontype].exec(e)},rendershare:function(){interaction_view.ismobile||share(interaction_view.doc.toJSON().title,context_url+"/player")},renderoverview:function(){Reveal.toggleOverview(!0)},renderclick:function(){},rendershow:function(){var e=this,t=this.values;t&&_.each(t,function(t){var i=t.page_id,n=interaction_view.getAnimationPage(i,e.model.page),a=n.iOverlaylist.get(t.id);a&&a.iview&&a.iview.$el&&(a.iview.onBeforeShow&&a.iview.onBeforeShow(),a.iview.$el.removeClass("hide"),a.iview.onShow&&a.iview.onShow())})},renderhide:function(){var e=this,t=this.values;t&&_.each(t,function(t){var i=t.page_id,n=interaction_view.getAnimationPage(i,e.model.page),a=n.iOverlaylist.get(t.id);a&&a.iview&&a.iview.$el&&(a.iview.onBeforeHide&&a.iview.onBeforeHide(),a.iview.$el.addClass("hide"),a.iview.onHide&&a.iview.onHide())})},renderpage:function(){var e=this.model.toJSON().iDetail,t=this.values,i=e.results[0].iActionDetail?e.results[0].iActionDetail.transition:0,i=e.results[0].iActionDetail&&e.results[0].iActionDetail.transition?e.results[0].iActionDetail.transition:0,n=interaction_view.getVarsOp(interaction_view.currentPage,[0,2]);if(n.beginWithAT(t)){var a=interaction_view.ipagelist.getPages().length;t=Math.round(n.var2val(t)),0>t&&(t=0),t>a-1&&(t=a-1),t=interaction_view.ipagelist.getPages()[t]?interaction_view.ipagelist.getPages()[t].id:null}t&&presentation.gotopagebyargs(t,i)},renderSharePage:function(){var e=(this.model.toJSON().iDetail,this.values),t=e||"first";("current"==t||interaction_view.share_page_id!=t)&&(interaction_view.share_page_id=t,interaction_view.weixin.share())},renderShareMode:function(e){switch(e){case 81:interaction_view.environment.Sharedata.reset()}},renderurl:function(){if(0!=this.values.length&&!_.isEmpty(this.values[0].url)){var e,t=this.values[0].url;if(e=t.match(/(http:\/\/|https:\/\/)([\w.:]+)/),0==t.indexOf("@"))return void window.open(t,"_blank");if(["/","."].indexOf(t[0])>-1)return void(window.location.href=t);if(e&&e.length>2&&e[2]==window.location.host)return void(window.location.href=t);if(-1==t.indexOf("://")&&(t="http://"+t),window.location.href.indexOf("query_string")>0&&(t+=t.indexOf("?")>=0&&"&"+window.location.search.replace("?","")||window.location.search),e=t.match(/\w+:\/\//),e&&-1==["https://","http://"].indexOf(t.match(/\w+:\/\//)[0]))return void(window.location.href=t);if(interaction_view.ismobile){var i=window.location.href;i=_g.changeURLPar(i,"return","1"),window.history.pushState({},"",i),window.location.href=t}else window.open(t,"_blank")}},rendertel:function(){if(interaction_view.ismobile&&0!=this.values.length&&!_.isEmpty(this.values[0].url)){var e=this.values[0].url,t=interaction_view.getVarsOp(interaction_view.currentPage,[0,1,2],interaction_view.environment.Votes.get()),i=t.var2val(e,!0);window.location="tel:"+i}},renderNormal:function(e){var t=this,i=this.values;i&&_.each(i,function(i){var n=i.page_id,a=interaction_view.getAnimationPage(n,t.model.page),o=a.iOverlaylist.get(i.id);if(o&&o.iview)switch(e){case 17:o.iview.startTimer();break;case 18:o.iview.stopTimerSimple();break;case 19:o.iview.resetTimer();break;case 20:if(o.iview.setVariable)o.iview.setVariable(i.oper,i.value);else if(o.iview.updateText){var r=interaction_view.expression.id2values(i.value);o.iview.updateText(r,addtourl=1)}break;case 21:interaction_view.events.onVariableChanged(o.iview);break;case 52:interaction_view.media.play(o);break;case 53:interaction_view.media.pause(o);break;case 60:o.iview.activeEdit&&setTimeout(function(){o.iview.activeEdit(!0)},500);break;case 72:o.iview.getInfo();break;case 73:o.iview.postInfo();break;case 100:interaction_view.events.onSystemVariableChanged(o.iview)}})},renderWXShare:function(){var e=this.values;if(e){var t=(e.page_id,e.value);console.log("set sharing: "+t),(_g.device.mobile()||_g.device.tablet())&&(t=interaction_view.expression.id2values(t)),t=t.replace(/<br>+/g,"\n").replace(/"+/g,"'").replace(/<\/div><div>/g,"\n").replace(/<div>/g,"").replace(/<\/div>/g,""),shareTitle=t,msgContent=shareTitle,interaction_view.weixin.share()}},renderParagraph:function(e){switch(e){case 56:interaction_view.environment.Paragraph.enable();
break;case 57:interaction_view.environment.Paragraph.disable()}},renderJS:function(){if(0!=this.values.length)if(this.values[0].api&&"undefined"!=typeof e_api)try{e_api.custom[this.values[0].api]&&e_api.custom[this.values[0].api]()}catch(e){console.log(e)}else if(!_.isEmpty(this.values[0].code)){var code=_.unescape(this.values[0].code);eval(code)}},setButtonToActive:function(){if(this.values&&0!=this.values.length){var e=this,t=(this.model.toJSON().iDetail,this.values[0].id),i=this.values[0].page_id,n=interaction_view.getAnimationPage(i,e.model.page);if(t){var a=n.iOverlaylist.get(t);a&&!a.iview.active&&a.iview.$el.find("img.iconNormal").length&&a.iview.$el.find("img.iconNormal").trigger("click")}}},renderreplaceresource:function(){if(this.values&&0!=this.values.length){var e,t=this,i=this.model.toJSON().iDetail;if(overlay_id=this.values[0]?this.values[0].id:"",pageid=this.values[0]?this.values[0].page_id:"",page=interaction_view.getAnimationPage(pageid,t.model.page),overlay_id&&(e=page.iOverlaylist.get(overlay_id))){var n=e.get("iType"),a=i.results[0].iActionDetail?i.results[0].iActionDetail.replace:null,o=i.results[0].iActionDetail?i.results[0].iActionDetail.url:null;if(a){if(1==a&&"ImageBlock"==n&&("undefined"!=typeof wx_permissions&&wx_permissions.chooseImage?interaction_view.localIds?setTimeout(function(){e.iview.setweixinimage(interaction_view.localIds[0])},100):interaction_view.weixin.chooseimage(function(t){t&&(interaction_view.localIds=t,e.iview.setweixinimage(t[0]))}):interaction_view.errorAlert(_g.device.isWeixin()?"å¼å¯å¾®ä¿¡åè½å¤±è´¥":"è¯·å¨å¾®ä¿¡ä¸­æä½")),2==a&&"Audio"==n)if("undefined"!=typeof wx_permissions&&wx_permissions.startRecord){var r=function(){if(interaction_view.voicelocalId){var t=e.iview.getdetail();e.voicelocalId!=interaction_view.voicelocalId&&interaction_view.voiceUploader(interaction_view.voicelocalId,function(i){e.media&&(interaction_view.media.changeSrc(e,i),interaction_view.media.play(e)),e.voicelocalId=interaction_view.voicelocalId,e.voiceUrl=i,t.iFile[0].file=i,e.iview.addToUrl(i)})}};interaction_view.voicelocalId?r(interaction_view.voicelocalId):interaction_view.voiceEditor(function(){r()})}else interaction_view.errorAlert(_g.device.isWeixin()?"å¼å¯å¾®ä¿¡åè½å¤±è´¥":"è¯·å¨å¾®ä¿¡ä¸­æä½");if(3==a||4==a){if(!o)return;if("ImageBlock"==n){var s=e.iview.$el.children(".Element").find("img"),l=e.iview.getdetail();"reset"==o?("undefined"!=typeof l.iImg[0].origin?(s.attr("src",l.iImg[0].origin),l.iImg[0].picture=l.iImg[0].origin):(s.attr("src",""),l.iImg[0].picture=""),"undefined"!=typeof e.iview.removeFromUrl&&e.iview.removeFromUrl()):(s.attr("src",o),l.iImg[0].picture=o,e.iview.addToUrl(o,0,0,1,0))}else if("Audio"==n){var l=e.iview.getdetail();e.media&&(interaction_view.media.changeSrc(e,o),interaction_view.media.play(e)),l.iFile[0].file=o,e.iview.addToUrl(o)}}if(5==a&&"ImageBlock"==n&&"undefined"!=typeof epub360_userinfo){var s=e.iview.$el.children(".Element").find("img"),l=e.iview.getdetail(),o=epub360_userinfo.portrait;s.attr("src",o),l.iImg[0].picture=o,e.iview.addToUrl(o,0,0,1,0)}}}}},renderWXShareImg:function(){var e=this,t=this.values;if(t){if("å¾®ä¿¡å¤´å"==t[0].id)"undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.portrait&&(imgUrl=epub360_userinfo.portrait);else{var i=t[0].page_id,n=interaction_view.getAnimationPage(i,e.model.page),a=n.iOverlaylist.get(t[0].id);if(a&&a.iview&&a.iview.$el){var o=a.iview.$el.find("img");if(o.length>0){var r=o.attr("src");if(0==r.indexOf("http://"))imgUrl=r;else{var s=a.iview.getdetail();imgUrl=s.iImg[0].picture}}else if(o=a.iview.$el.find(".bk_full"),o.length>0){var l=o.css("background-image"),c=/\url\((\S+)\)/.exec(l);null!=c&&(imgUrl=c[1])}}}interaction_view.weixin.share()}},renderEvents:function(){var e=this.values,t="www.epub360.com";if(current_host=window.location.host,-1!=current_host.indexOf("tu960")&&(t=current_host),e.length&&e[0].opt_label&&interaction_view.book_id){var i=e[0].opt_label,n=e[0].opt_action,a="http://"+t+"/manage/book/"+interaction_view.book_id+"/event.gif?opt_category=custom&opt_action="+n+"&opt_label="+i+"&t="+_g.uuid(),o=document.createElement("img");o.src=a,o.onload=function(){}}},setElementTo:function(){if(this.values&&0!=this.values.length){var e=this,t=this.model.toJSON().iDetail,i=this.values[0].id,n=this.values[0].page_id,a=interaction_view.getAnimationPage(n,e.model.page),o=t.results[0].iActionDetail?t.results[0].iActionDetail.index:null,r=interaction_view.getVarsOp(n,[0,2]);if(r.beginWithAT(o)&&(o=r.var2val(o)),i){var s=a.iOverlaylist.get(i);s&&s.iview&&s.iview.setElementTo(o)}if(this.overlaymodel&&"Button"==this.overlaymodel.toJSON().iType){var l=this.syncbuttons(a,this.model.toJSON().overlay_id,this.values[0]);l>0&&(this.overlaymodel.iview.groupcontrol=!0)}}},playElementTo:function(){if(this.values&&0!=this.values.length){var e=this,t=this.model.toJSON().iDetail,i=this.values[0].id,n=this.values[0].page_id,a=interaction_view.getAnimationPage(n,e.model.page),o=t.results[0].iActionDetail?t.results[0].iActionDetail.mode:0,r=t.results[0].iActionDetail&&t.results[0].iActionDetail.repeat?-1:0,s=t.results[0].iActionDetail?t.results[0].iActionDetail.p_from:0,l=t.results[0].iActionDetail?t.results[0].iActionDetail.p_to:0;if(i){var c=a.iOverlaylist.get(i);if(c&&c.iview){if(4==o&&c.iview.timeline&&c.iview.timeline.pause(),0==o||1==o){var d=c.toJSON().iDetail.iImg.length;if(!d)return;0==o?(c.iview._start=0,c.iview._end=d-1,c.iview.direction=0):(c.iview.direction=1,c.iview._start=d-1,c.iview._end=0),c.iview.autoplay=!0,c.iview.repeat=r;var h=c.iview._setCanvasLoopSwitch(!0);c.iview.timeline.play(h)}if(2==o){c.iview._start=s,c.iview._end=l,c.iview.direction=s-l>0?1:0,c.iview.autoplay=!0,c.iview.repeat=r;var h=c.iview._setCanvasLoopSwitch(!0);c.iview.timeline.play(h)}if(3==o){c.iview.currentIndex||(c.iview.currentIndex=0),c.iview._start=c.iview.currentIndex,c.iview._end=l,c.iview.direction=c.iview.currentIndex-l>0?1:0,c.iview.autoplay=!0,c.iview.repeat=r;var h=c.iview._setCanvasLoopSwitch(!0);c.iview.timeline.play(h)}}}}},syncbuttons:function(e,t,i){var n=this,a=0,o=_.filter(this.model.page.iActionlist.toJSON(),function(e){return n.model.page.iOverlaylist.get(e.overlay_id)&&"Button"==n.model.page.iOverlaylist.get(e.overlay_id).get("iType")&&6==e.iDetail.results[0].iAction});return _.each(o,function(e){if(e.overlay_id!=t){var o=n.model.page.iOverlaylist.get(e.overlay_id);o&&o.toJSON().iDetail.isSwitch&&e.iDetail.results&&e.iDetail.results[0].values[0].id==i.id&&e.iDetail.results[0].values[0].page_id==i.page_id&&(a+=1,o.iview.resetButtonStatus())}}),a},syncTabButtons:function(){var e=this,t=this.overlaymodel.get("path"),i=interaction_view.getContainerModelByPath(t);i.iOverlaylist.each(function(t){t.id!=e.overlaymodel.id&&t.iview.resetButtonStatus()})},resetStatus:function(){this.overlaymodel.iview.$el.off("click")},testControlforLayer:function(e){var t=$(e.target).closest(".iView");if($(e.target).closest(".iView").hasClass("hasaction"))return!1;if(t){var i=t.attr("data-type");if(("Slide"==i||"CycleImage"==i)&&t.attr("data-iSlipable"))return!1}return!0},submitForm:function(){return this.values?void interaction_view.application.submitForm(this.values):!1},setFormValue:function(){var e=this.model.toJSON().iDetail;if(!this.values)return!1;var t=e.results[0].cid,i=e.results[0].vT,n=e.results[0].vV;n=interaction_view.expression.id2values(n),interaction_view.application.setFormData(this.values,t,Number(i),n)},renderPreloadPages:function(){if(this.values||this.values.length){{this.model.toJSON().iDetail}_e.preloadpage.preload(this.values,this.preload_hash)}},renderUserdataSubmit:function(){var e=this;if(interaction_view.environment.Userdata.share(),this.values&&this.values.length){for(var t=[],i=0;i<this.values.length;i++){var n=this.values[i].page_id,a=interaction_view.getAnimationPage(n,e.model.page),o=this.values[i].id;if(o){var r=a.iOverlaylist.get(o);r&&r.iview&&t.push(r.iview)}}interaction_view.environment.Userdata.setitems(t,function(){interaction_view.events.onUserdataSave(e)})}},renderSharedataSubmit:function(){var e=this;interaction_view.environment.Sharedata.setitems(function(){interaction_view.events.onSharedataSave(e)})}}),interaction_view.iActionlist=new interaction_view.collection.Action}),define("interaction_view/model/animation_view",["interaction_view/model/base"],function(){interaction_view.model.Animation=interaction_view.model.Base.extend({defaults:{},setcollection:function(){},setmodel:function(){}}),interaction_view.collection.Animation=interaction_view.collection.Base.extend({initialize:function(){},model:interaction_view.model.Animation,setonadd:function(){this.on("add",function(){})},setParams:function(){if(this.repeatTweens=[],0!=this.where({iKind:0}).length){var e=this;if(this.cssAnimations=[],this.Animations=[],this.each(function(t){t.tween=null;var i=t.toJSON();return i.iType>0&&i.iType<100?void e.cssAnimations.push(i):void((0!=i.iKind||e.page.iOverlaylist.get(i.overlay_id))&&"undefined"!=typeof animation&&(e.Animations.push(t),t._animation=new animation({collection:e,animation:t.toJSON()})))}),this.cssAnimations.length&&"undefined"!=typeof Animate){this.cssitems=[];for(var t=0;t<this.cssAnimations.length;t++){var i=e.page.iOverlaylist.get(this.cssAnimations[t].overlay_id);if(i){var n={el:i.iview.$el.children(".Element"),type:this.cssAnimations[t].iType,delay:this.cssAnimations[t].iTiming.delay,duration:this.cssAnimations[t].iTiming.duration,repeat:this.cssAnimations[t].iTiming.repeat,onShow:i.iview.onShow};this.cssitems.push(n)}}this.css_timeline=new Animate({items:this.cssitems})}}},setPlay:function(){if(this.Animations&&0!=this.Animations.length){var e=function(){};this.timeline=animateTimeline.generateTimeline({onStart:e,animations:this.Animations,iPage_id:this.iPage_id,page:this.page,paused:!0})}},play:function(){0!=this.length&&(this.setPlay(),this.timeline&&this.timeline.play(0))},playMain:function(){0!=this.length&&(this.setParams(),this.setPlay(),this.timeline&&this.timeline.play(0,!1),this.afterTimeLineCreated&&this.afterTimeLineCreated())},AddClickTween:function(e,t,i,n){interaction_view.SinglePreview||(e.pause(n),console.log(n),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","pointer"),interaction_view.events.pageClickEvents.push({type:"waitaction",page_id:t,func:function(){console.log(i),_.include([101,102,103,104],i.attributes.iType)&&(i.attributes.iTiming.delay?_g.device.android()&&101==i.attributes.iType&&window.setTimeout(function(){i._animation.showelement()},i.attributes.iTiming.delay):i._animation.showelement()),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","auto"),e.resume()}}))},AddPageSwipeTween:function(e,t,i,n,a){interaction_view.SinglePreview||(console.log(a),e.pause(a),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","pointer"),interaction_view.events.pageSwipeEvents.push({type:"waitaction",page_id:t,func:function(){_.include([101,102,103,104],n.attributes.iType)&&(n.attributes.iTiming.delay?_g.device.android()&&101==n.attributes.iType&&window.setTimeout(function(){n._animation.showelement()},n.attributes.iTiming.delay):n._animation.showelement()),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","auto"),e.resume()},swipeType:i+33}))},AddPageShakeTween:function(e,t,i,n,a){interaction_view.SinglePreview||(console.log(a),e.pause(a),interaction_view.events.pageShakeEvents.push({type:"waitaction",page_id:t,func:function(){_.include([101,102,103,104],n.attributes.iType)&&(n.attributes.iTiming.delay?_g.device.android()&&101==n.attributes.iType&&window.setTimeout(function(){n._animation.showelement()},n.attributes.iTiming.delay):n._animation.showelement()),$('section[id="'+t+'"]').children(".interaction-view").css("cursor","auto"),e.resume()}}))},AddRepeatClickTween:function(e,t,i,n){interaction_view.SinglePreview||($('section[id="'+t+'"]').children(".interaction-view").css("cursor","pointer"),interaction_view.events.pageClickEvents.push({type:"waitaction",page_id:t,func:function(){$('section[id="'+t+'"]').children(".interaction-view").css("cursor","auto"),i.pause(),n._animation.stop(i)}}))},AddMediaTween:function(e){var t=e.collection.page;if(interaction_view.SinglePreview){var i=t.iAnimationlist.timeline.getLabelTime(interaction_view.PreviewItemId+"_start"),n=t.iAnimationlist.timeline.getLabelTime(e.id+"_start");if(i>n)return}var a=t.iOverlaylist.get(e.get("overlay_id")),o=e.get("iType");a.onAnimationStart={overlay_id:e.get("overlay_id"),animation_id:e.id,page_id:t.id,layer_id:e.collection.layerid},interaction_view.events.onAnimationStart(a.onAnimationStart),501==o&&("Audio"==a.get("iType")||"Video"==a.get("iType")||"QQVideo"==a.get("iType")?interaction_view.media.play(a):a.iview.playTimeline()),502==o&&("Audio"==a.get("iType")||"Video"==a.get("iType")||"QQVideo"==a.get("iType")?a.loaded&&(interaction_view.media.pause(a),a.iview.slider&&a.iview.sliderstop()):a.iview.pauseTimeline()),503==o&&("Audio"==a.get("iType")||"Video"==a.get("iType")||"QQVideo"==a.get("iType")?a.loaded&&a.media&&(a.iview.resetOtherStatus(),a.iview.slider&&(a.iview.sliderstop(),a.iview.onSliderChange(0))):a.iview.stopTimeline()),(502==o||503==o)&&a.onAnimationStart&&(interaction_view.events.onAnimationEnd(a.onAnimationStart),a.onAnimationStart=null),t.iAnimationlist.onComplete(e.id)},getMediaTime:function(e){var t=0,i=e.collection.page.iOverlaylist.get(e.toJSON().overlay_id);return i.media?("Audio"==i.get("iType")||"Video"==i.get("iType"))&&(t=i.hls?i.media.getDuration():i.media.duration):_.include(["CycleImage","Slide","LayerSlide"],i.get("iType"))&&(t=i.iview.getSlideDuration()),t},onSingleComplete:function(){},onUpdate:function(){},onTotalComplete:function(){},onComplete:function(){},resetAnimationStatus:function(){_.each(this.repeatTweens,function(e){e.kill()}),this.repeatTweens=[],this.timeline&&this.timeline.pause(0)}}),interaction_view.view.Animation=interaction_view.view.Base.extend({initstart:function(){}})}),define("text!interaction_view/template/audiocontrol.js",[],function(){return'<div class="audiobar disableDragX disableDragY" style="height: 31px;width: 100%;position: absolute;">\n  <span class="audio-control status-play"></span>\n  <% if((iCommon[iPageDirection].iWidth-45)>0){%>\n  <span class="ui-slider-green ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" aria-disabled="false" style="width:<%=(iCommon[iPageDirection].iWidth-45)>0?(iCommon[iPageDirection].iWidth-45):0%>px;left: 45px;">\n    <div class="ui-slider-range ui-widget-header ui-corner-all ui-slider-range-min g-slider-range" style="width: 0%;background-color: #444444;">\n    </div>\n    <a class="ui-slider-handle ui-state-default ui-corner-all g-slider-handle" href="#" style="left: 0%;">\n    </a>\n  </span>\n  <% } %>\n</div>'}),define("interaction_view/model/audio",["interaction_view/model/base","text!interaction_view/template/audiocontrol.js"],function(){var e=require("text!interaction_view/template/audiocontrol.js");interaction_view.model.Audio=interaction_view.model.Base.extend({defaults:{iType:"Audio",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Audio({model:this})},setsyncmodel:function(){}}),interaction_view.view.Audio=interaction_view.view.Base.extend({events:{},bindSliderControl:function(){var e=this;this.$el.find(".audio-control").css("cursor","pointer"),this.$el.find(".audio-control").on("click",function(){return $(this).hasClass("status-play")?e.model.media&&interaction_view.media.play(e.model):$(this).hasClass("status-pause")&&(e.model.media&&interaction_view.media.pause(e.model),e.sliderstop()),!1})},render:function(){var t=this.getdetail();t.iControl&&this.file&&(this.$el.children(".Element").append(_.template(e,this.model.toJSON())),this.$el.removeClass("hide"))},preload:function(){var e=this.getdetail();this.model.played=!1,this.model.time=0;var t;e.iFile&&e.iFile[0]&&(audio_url_src=this.getFromUrl(),t=""!=audio_url_src?audio_url_src:"undefined"!=typeof epub360&&epub360.settings&&epub360.settings.disable_stream_media?e.iFile[0].file:"undefined"==typeof cbt_data||interaction_view.forpreview?"1"==_g.getUrlParameterByName("-playmode")?(e.iFile[0].file||e.iFile[0].content)+"_audio.m3u8":"2"==_g.getUrlParameterByName("-playmode")?e.iFile[0].file||e.iFile[0].content+"?avthumb/mp3/ab/32k":e.iFile[0].file||e.iFile[0].content+"?avthumb/mp3/ab/32k":e.iFile[0].file||e.iFile[0].content,this.sendToPreload({file:t}),this.file=t)},setOtherDisplay:function(){var e=this.getdetail(),t=this;e.iControl&&this.file&&_g.slider&&(this.slider=new _g.slider({containment:this.$el,onChange:function(e){t.model.media&&interaction_view.media.seek(t.model,null,e)}}),this.bindSliderControl())},resetStatus:function(){this.resetOtherStatus()},resetOtherStatus:function(){return this.model.isBgsound?void this.$el.find(".status-play").addClass("status-pause").removeClass("status-play"):void(this.model.media&&(this.model.hls?interaction_view.media.audio.resetH(this.model):interaction_view.media.audio.reset(this.model),this.slider&&(this.sliderstop(),this.onSliderChange(0))))},sliderplay:function(){this.$el.find(".audio-control").addClass("status-pause").removeClass("status-play")},sliderstop:function(){this.$el.find(".audio-control").removeClass("status-pause").addClass("status-play")},onSliderChange:function(e){console.log("time change "+e),this.slider.change(e)},getFromUrl:function(){var e=_g.getUrlParameterByName(this.model.id,message_link);if(e||(e=_g.getHashParameterByName(this.model.id)),null==e&&"epub360"==epub360_domain&&""!=interaction_view.environment.Sharedata.id)if(1==interaction_view.environment.Sharedata.status)interaction_view.environment.Sharedata.addView(this);else{var t=this.model.get("pageid"),i=interaction_view.environment.Sharedata.getitem(t,this.model.id);i&&(e=i.value)}return decodeURI(e||"")},addToUrl:function(e){var t=this.getdetail();if(e==t.iFile[0].origin)return!1;var i=this.model.id+"="+encodeURI(e),n=_g.getUrlParameterByName(this.model.id,message_link),a=0,o=message_link;if(n)encodeURI(n)!=encodeURI(e)?o=_g.replaceUrlParameterByName(this.model.id,i,message_link):a=1;else{var r="?";message_link.indexOf("?")>=0&&(r="&"),o+=r+i}if("epub360"==epub360_domain&&!a&&this.model.id!=bgsound_id&&interaction_view.environment.Sharedata.enabled&&interaction_view.environment.Sharedata.setitem(this,{value:encodeURI(e)}),a||(message_link=o,interaction_view.weixin.share()),!interaction_view.forpreview){var s=_g.getHashParameterByName(this.model.id);s?encodeURI(s)!=encodeURI(e)?window.history.replaceState({},"",_g.replaceHashParameterByName(this.model.id,i)):a=1:window.history&&(document.location.hash?window.history.replaceState({},"",document.location.hash+="&"+i):window.history.replaceState({},"","#"+i))}return a?!1:!0}})}),define("interaction_view/model/cycleimage",["interaction_view/model/base","_g/base"],function(){interaction_view.model.CycleImage=interaction_view.model.Base.extend({defaults:{iType:"CycleImage",iLock:!0,iVisibility:!0,iCommon:{},iDetail:{},iSync:!1,isSlide:!0,iZindex:"-1",iUrl:null,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.loaded=[],this.loaded_index=0,this.iImgs=[],this.iview=new interaction_view.view.CycleImage({model:this})},setsyncmodel:function(){}}),interaction_view.view.CycleImage=interaction_view.view.Base.extend({events:{},render:function(){{var e=this;this.getdetail()}this.currentSlideIndex=null,this.model.on("slideTo",function(t){return null!=e.currentSlideIndex&&e.currentSlideIndex==t?!1:void(e.preloaded&&(interaction_view.events.onChangeTo(e.model.iPageId,e.model.id,t),e.currentSlideIndex=t))})},preload:function(){var e=this;this.preloaded=!1;var t,i=this.getdetail();this.img_src=[],this.img_loaded=[];if(i.iImg&&i.iImg.length){this.model._img_preload=!0;for(var n=0;n<i.iImg.length;n++)t=i.iImg[n].picture,e.img_src.push(t),e.img_loaded.push(!1);e.useIndex=!0}},afterpreload:function(){this.slideel=this.$el.children(".Element").find(".slidecontent").first(),this.setZindex(),this.setElementDisplay(),this.renderCanvas(),this.playAnimation(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style"),this.preloaded=!0},playAnimation:function(){var e=this,t=this.detail,i=t.iSlidetype;null==i&&(i=0),this.delay=Number(t.iInterval)||.01,this.autoplay=t.iAutoplay;var n=t.iRepeat?-1:0;this.slidelength=t.iImg&&t.iImg.length||0,this.repeat=this.init_repeat=n,this.iRewind=t.iRewind,this.slipable=t.iSlipable,this.p_mode=t.p_mode||0,this.p_from=Number(t.p_from)||0,this.p_to=Number(t.p_to)||0,this.direction=this.init_direction=0,this.slidelength&&(this.p_to<0&&(this.p_to=0),this.p_from<0&&(this.p_from=0),this.p_to>this.slidelength-1&&(this.p_to=this.slidelength-1),this.p_from>this.slidelength-1&&(this.p_from=this.slidelength-1),this.p_mode||(this.p_from=0,this.p_to=this.slidelength-1),1==this.p_mode&&(this.direction=this.init_direction=1,this.p_from=this.slidelength-1,this.p_to=0),2==this.p_mode&&(this.direction=this.init_direction=this.p_from-this.p_to>0?1:0),this._start=this.p_from,this._end=this.p_to,this.setTimeline(),this.autoplay&&(this.model._autoplay=!0),this.img_preload(20,null,function(){e.drawCanvas(e.img_src[e.p_from],e.p_from),e.img_preload()}),this.onChangeSlideTo(this.p_from),this.slipable&&(this.control(),this.autoplay||this.$el.attr("data-iSlipable",!0)),this.model._reset=!0)},_autoplay:function(){this.timeline&&(this.$el.children(".Element").is(":hidden")||this.timeline.play())},exeutePlay:function(){},setTimeline:function(){this.iFade="LoopSwitch",this._setCanvasLoopSwitch()},testControl:function(){return!0},resetOtherStatus:function(){if(this.slideel){var e=this.getdetail();this.autoplay=e.iAutoplay,this.repeat=this.init_repeat,this.direction=this.init_direction,this._start=this.p_from,this._end=this.p_to,this.currentIndex=this.p_from,this.useIndex&&(this.indexTime=this.p_from),this.timeline&&(this._setCanvasLoopSwitch(!0),this.ctx.clearRect(0,0,this.canvas_width,this.canvas_height),this.drawCanvas(this.img_src[this.p_from],this.p_from))}},renderCanvas:function(){var e=this.getcommon();this.canvasId="canvas_"+_g.uuid(),this.slideel.append('<canvas id="'+this.canvasId+'" width="'+2*e.iWidth+'" height="'+2*e.iHeight+'" style="pointer-events:none;width:'+e.iWidth+"px;height:"+e.iHeight+'px;"></canvas>'),this.canvas=document.getElementById(this.canvasId),this.canvas_width=e.iWidth,this.canvas_height=e.iHeight,this.canvas&&(this.ctx=this.canvas.getContext("2d")),this.useIndex&&this.slideel.children("img").hide()},drawCanvas:function(e,t){if(e&&""!=e){var i=this;if(this.ctx||(this.ctx=this.canvas.getContext("2d")),!this.ctx)return!1;ctx=this.ctx,interaction_view.drawImg(i,e,t,ctx)}},otherOnShow:function(){this.img_src.length&&(this._setCanvasLoopSwitch(),this.drawCanvas(this.img_src[this.currentIndex],this.currentIndex),this.autoplay&&this.timeline.play())},img_preload:function(e,t,i){var n=this;if(n.slidelength){var a=n.model.loaded_index,o=1;1==n.slidelength&&(o=0);if(a>n.slidelength-1)return void(n.model.loaded_all=!0);var r=n.slidelength-a>=20?a+20-1:n.slidelength-1;n.model.loaded_index=r+1;for(var s=0,l=r-a+1;r>=a;a++)interaction_view.iImgs[n.img_src[a]]?(n.model.iImgs[a]=interaction_view.iImgs[n.img_src[a]],n.model.loaded[a]=!0,i&&s==o&&i(),++s>=l&&(t&&t(),e||n.img_preload())):(n.model.iImgs[a]=new Image,n.model.iImgs[a].onload=function(){n.model.loaded[a]=!0,interaction_view.iImgs[this.src]=this,i&&s==o&&i(),++s>=l&&(e||n.img_preload())},n.model.iImgs[a].src=n.img_src[a])}}})}),define("text!interaction_view/template/imageitem.js",[],function(){return'<%if(iDetail.iImg&&iDetail.iImg[0]){%>\n    <%if(typeof isSubOverlay!="undefined"&&isSubOverlay&&(typeof isLayerOverlay=="undefined"||!isLayerOverlay)){%>\n        <% if(iDetail.iMask){%>\n            <img draggable="false" class="Context" src="<%=iDetail.iImg[0].thumbnail%>" style="width:<%=iDetail.iMask_data.width%>px;height:<%=iDetail.iMask_data.height%>px;position:absolute;max-width:none;">\n        <%}else{%>\n            <img draggable="false" class="Context" src="<%=iDetail.iImg[0].thumbnail%>" style="width:100%;height:100%;position:absolute;">\n        <% } %>\n    <%}else{ %>\n        <% if(iDetail.iMask){%>\n            <img draggable="false" class="Context" src="<%=iDetail.iImg[0].picture%>" style="width:<%=iDetail.iMask_data.width%>px;height:<%=iDetail.iMask_data.height%>px;position:absolute;max-width:none;">\n        <%}else{%>\n            <img draggable="false" class="Context" src="<%=iDetail.iImg[0].picture%>" style="width:100%;height:100%;position:absolute;">\n        <% } %>\n    <%}%>\n<%}%>'}),define("interaction_view/model/image",["interaction_view/model/base","text!interaction_view/template/imageitem.js"],function(){require("text!interaction_view/template/imageitem.js");interaction_view.model.Image=interaction_view.model.Base.extend({defaults:{iType:"Image",iLock:!0,iVisibility:!0,iCommon:null,iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParentModel:null,iTemplate:null,iParentdiv:".interaction-view",iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Image({model:this})},setsyncmodel:function(){}}),interaction_view.view.Image=interaction_view.view.Base.extend({events:{},render:function(){this.renderMask(),this.renderDraggable(),this.firstRender=!0,this.isEraserSet=!1,this.detail.isMasterArrow&&this.$el.addClass("master_arrow_icon")},renderMask:function(){var e=this.getdetail();e.iMask&&(this.$el.children(".Element").find("img").first().css({translate:[e.iMask_data.x,e.iMask_data.y]}),this.iScrollview&&this.iScrollview.scrollTo(e.iMask_data.x,e.iMask_data.y))},preload:function(){},getLayerContentSize:function(){var e=this.getdetail(),t={};return e.iImg&&e.iImg.length>0?(t.width=e.iMask_data.width,t.height=e.iMask_data.height,t):null},setOtherDisplay:function(){var e=this.getdetail();e.iImg&&e.iImg.length>0&&e.iMask&&e.iMask_data.iSlipable&&(this.renderMask(),this.setMaskSlipable({items:this.$el.children(".Element").find("img").first(),containment:this.$el.children(".Element").children(),contentel:this.$el.children(".Element").find("img").first(),content_x:e.iMask_data.x,content_y:e.iMask_data.y})),e.iDisplay&&e.iImg&&e.iImg.length>0&&_g.ui.fitImage(this.$el.children(".Element").find("img").length?{fit:Number(e.iDisplay),width:e.iImg[0].width,height:e.iImg[0].height,items:this.$el.children(".Element").find("img"),parentHeight:parseInt(this.$el.children(".Element").css("height")),parentWidth:parseInt(this.$el.children(".Element").css("width"))}:{fit:Number(e.iDisplay),containment:this.$el.children(".Element").find(".image_wrap").first()}),e.iFullview&&this.fullview(),e.iEraser&&(this.model._reset=!0,this.el_str=this.$el.children(".Element").html(),this.setEraser())},resetOtherStatus:function(){this.$el.removeClass("invisible noevents"),this.resetEraser(),this.resetDragDrop()},fullview:function(){if("undefined"==typeof wx_permissions||!wx_permissions.previewImage){var e=this,t=this.getdetail();t.iImg&&t.iImg.length>0&&(this.$el.addClass("hasaction"),this.$el.children(".Element").on("click",function(){opts={picture:t.iImg[0].picture,width:t.iImg[0].width,height:t.iImg[0].height,model:e.getGalleryModel(),index:e.model.get("GalleryIndex")},e.setFullView(opts)}))}},setEraser:function(){var e=this.getdetail();if(e.iEraser){var t=this.getcommon();this.$el.children(".Element").css("cursor","pointer"),this.$el.children(".Element").addClass("disableDragX disableDragY"),this.$el.find("img").first().is(":hidden")?this.isEraserSet=!1:(_e.eraser&&_e.eraser.set(this.$el.find("img").first(),t.iWidth,t.iHeight,this),this.isEraserSet=!0)}},resetEraser:function(){this.firstRender||this.onShow(),this.isEraserSet||this.setEraser(),this.firstRender=!1},isFullSwitch:function(){return null!=this.model.get("GalleryIndex")?!0:void 0},getGalleryModel:function(){var e=[];for(i=0;i<this.path.length;i++){if("Gallery"==this.path[i].type){e.push(this.path[i]);break}e.push(this.path[i])}var t=interaction_view.getContainerModelByPath(e);return t},repaint:function(){this.$el.children(".Element").html(this.el_str)},onShow:function(){var e=this.getdetail();e.iEraser&&(this.repaint(),this.setEraser())},getDragCopy:function(){var e=$("<div></div>").addClass("DragCopy").attr({id:this.model.id+"_drag_copy"}).css({position:"absolute",opacity:this.$el.css("opacity")});return e.html($("<div/>").attr({style:this.$el.children(".Element").attr("style")})),e.children().html(this.$el.children(".Element").children().clone()),e},getClientXY:function(e){return"ontouchend"in document?{x:e.clientX,y:e.clientY}:{x:e.gesture.center.pageX,y:e.gesture.center.pageY}},resetDragDrop:function(){if(this.getdetail().draggable){var e=this;"undefined"==typeof e.DragDrops&&(e.DragDrops=e.model.page.iOverlaylist.where({iType:"DragDrop"}),!e.DragDrops.length&&(e.DragDrops=!1)),e.DragDrops&&("undefined"==typeof e.MaxZindex&&(e.MaxZindex=e.model.page.iOverlaylist.models.length+1e3),e.Status=0,1==this.getdetail().dragend&&(e.Status=2)),e.Pos={left:e.x,top:e.y},e.Drag_opacity=.8999,e.$el.siblings(".DragCopy").remove()}},setDraggable:function(e,t,i,n){function a(){h&&(u=e.css("z-index"),h=!1),interaction_view.events.onDragStart(p),s=e.position(),l=e.css("opacity"),e.css({"z-index":c.MaxZindex+100,opacity:e.css("opacity")>=1?c.Drag_opacity:e.css("opacity")}),i(e),e.stop(!0,!0),c.resetDragDropStatus()}function o(t,i,n){if(s&&s.left){{var a,o=$.zoom?$.zoom:1,r=s.left+t/o,l=s.top+i/o,h=e.css("transform")||e.css("-webkit-transform");h.split(",")}a="vertical"==d.limit?{y:l}:"horizontal"==d.limit?{x:r}:{x:r,y:l},interaction_view.setPos(e,_.extend(a,{force3D:interaction_view.force3D})),interaction_view.events.onDragging(p),c.activeDragDrop(e,n)}}function r(){interaction_view.events.onDragEnd(p),e.css({"z-index":u,opacity:e.css("opacity")-c.Drag_opacity<1e-5?l:e.css("opacity")}),n(e)}var s,l,c=this,d=this.getdetail(),h=!0,u=e.css("z-index");e.data({Drop:t}).addClass("disableDragX disableDragY");var p={page_id:c.model.page.id,overlay_id:c.model.id,layer_id:c.model.get("layer_id")};if("ontouchend"in document){var m=!1,f=0,v=0;e.on("touchstart",function(e){e=e.originalEvent.touches[0],m=!0,f=e.clientX,v=e.clientY,a()}).on("touchmove",function(e){return e=e.originalEvent.touches[0],o(e.clientX-f,e.clientY-v,e),!1}).on("touchend touchcancel",function(e){e=e.originalEvent.touches[0],m&&r(),m=!1})}else e.hammer().on("dragstart",a).on("drag",function(e){o(e.gesture.deltaX,e.gesture.deltaY,e)}).on("dragend",r)},activeDragDrop:function(e,t){if(this.DragDrops){var i=this,n=$.zoom?$.zoom:1,a=this.getClientXY(t);$.each(i.DragDrops,function(e,t){var o=t.iview.$el.children(".Element"),r={x:o.offset().left*n,y:o.offset().top*n},s={x:r.x+o.width()*n,y:r.y+o.height()*n};a.x>=r.x&&a.x<=s.x&&a.y>=r.y&&a.y<=s.y?(0!=i.$el.parent().children("#"+i.model.id+t.id).length||t.iview.active||i.trigger_dragin_event(t),t.iview.changeStatus(!1)):t.iview.changeStatus(!0)})}},getDropXY:function(e){var t=e.iview.getcommon(),i=e.iview.$el.children(".Element").offset(),n=e.iview.$el.parents(".interaction-area:first").offset();return{x:i.left-n.left+t.iWidth/2,y:i.top-n.top+t.iHeight/2}},resetDragDropStatus:function(){var e=this;$.each(e.DragDrops,function(t,i){i.iview.Status=0;var n=e.$el.parent().children("[data-drop="+i.id+"]");if(n.length){i.iview.Status=2;var a=n.attr("data-drag");_.include(i.iview.getdetail().element_ids,a)&&(i.iview.Status=1)
}})},renderDraggable:function(){function e(e){if(1==n.dragstart){var t=i.getDragCopy();e.before(t),TweenMax.to(t,0,{x:e.position().left,y:e.position().top,force3D:interaction_view.force3D})}0==i.Status&&(i.Pos=e.position())}function t(e){var t=0;$.each(i.DragDrops,function(a,o){if(o.iview.active){o.iview.changeStatus();var r=o.iview.getdetail(),s=i.$el.parent().children("#"+i.model.id+o.id);if(r.onlyright&&!_.include(r.element_ids,i.model.id)||0!=s.length)return t=1,0!=s.length&&0==n.dragin&&(t=3,e.css({"z-index":parseInt(o.iview.$el.css("z-index"))+1}),TweenMax.to(e,.4,i.getDropXY(o))),!1;t=2,0!=o.iview.Status&&i.old_transit_back(o),i.drag_dragin(o)}}),2>t&&i.drag_dragend(1==t?1:null)}var i=this,n=this.getdetail();n.draggable&&(this.model._reset=!0,i.setDraggable(i.$el,null,e,t))},drag_dragend:function(e){var t=this.$el,i=t.position(),n=t.parent().children("#"+this.model.id+"_drag_copy");1==this.Status&&(this.Status=0),this.lastCopy&&this.lastCopy.remove()&&(this.lastCopy=null),1==(e||parseInt(this.getdetail().dragend))?(i=this.Pos,TweenMax.to(t,.4,{x:i.left,y:i.top})):0==this.Status&&(this.Pos=t.position()),TweenMax.to(n,.4,{x:i.left,y:i.top,opacity:0,force3D:interaction_view.force3D,onComplete:function(){n.remove()}})},drag_dragin:function(e){var t=this,i=this.getdetail(),n=t.$el.parent().children("#"+t.model.id+"_drag_copy");switch(parseInt(i.dragin)){case 0:if(0==t.Status&&(t.Status=1),0==t.$el.parent().children("#"+t.model.id+e.id).length){t.lastCopy&&t.lastCopy.remove()&&t.resetDragDropStatus();var a=t.getDragCopy().attr({id:t.model.id+e.id,"data-drop":e.id,"data-drag":t.model.id}).hide();t.$el.before(a),t.lastCopy=a}t.$el.css("z-index",parseInt(e.iview.$el.css("z-index"))+1),TweenMax.to(t.$el,.4,_.extend(t.getDropXY(e),{force3D:interaction_view.force3D,onComplete:function(){t.trigger_drop_event(e)}})),1==i.dragstart&&TweenMax.to(n,.4,_.extend(t.getDropXY(e),{opacity:0,force3D:interaction_view.force3D,onComplete:function(){n.remove()}}));break;case 1:1!=i.dragstart&&(n=t.getDragCopy(),t.$el.before(n)),n.attr({id:t.model.id+e.id,"data-drop":e.id,"data-drag":t.model.id}).css({"z-index":parseInt(e.iview.$el.css("z-index"))+1,opacity:n.css("opacity")-t.Drag_opacity<1e-5?1:n.css("opacity")}),TweenMax.to(n,0,{x:t.$el.position().left,force3D:interaction_view.force3D,y:t.$el.position().top}),TweenMax.to(t.$el,.4,{x:t.Pos.left,y:t.Pos.top,force3D:interaction_view.force3D}),TweenMax.to(n,.4,_.extend(t.getDropXY(e),{force3D:interaction_view.force3D,onComplete:function(){t.trigger_drop_event(e),t.renderCopyDraggable(e,n)}}));break;case 2:n.remove(),n=t.getDragCopy().attr({id:t.model.id+e.id,"data-drop":e.id,"data-drag":t.model.id}).hide(),t.$el.before(n),TweenMax.to(t.$el,0,{x:t.Pos.left,y:t.Pos.top,force3D:interaction_view.force3D,onComplete:function(){t.trigger_drop_event(e)}})}},renderCopyDraggable:function(e,t){function i(){0==n.getdetail().dragstart&&n.$el.hide()}var n=this;this.setDraggable(t,e,i,n.copy_dragend)},copy_dragend:function(e){var t=this,i=this.getdetail(),n=e.data("Drop"),a=0;if($.each(t.DragDrops,function(i,o){if(o.id==n.id)o.iview.active&&(TweenMax.to(e,.4,t.getDropXY(n)),o.iview.changeStatus(),a=1);else if(o.iview.active){n.iview.Status=0,o.iview.changeStatus();var r=o.iview.getdetail();if(r.onlyright&&!_.include(r.element_ids,t.model.id))return a=1,t.old_transit_back(n,t.model.id),!1;0!=o.iview.Status&&t.old_transit_back(o),TweenMax.to(e,.4,t.getDropXY(o)),t.$el.siblings("#"+t.model.id+o.id).remove(),e.attr({id:t.model.id+o.id,"data-drop":o.id,"data-drag":t.model.id}).css("z-index",parseInt(o.iview.$el.css("z-index"))+1),e.data("Drop",o),a=1,t.trigger_drop_event(o)}}),0==i.dragstart&&t.$el.show(),0==a){var o=e.position();0==i.dragend&&1==i.dragstart?(TweenMax.to(e,.4,{opacity:0,force3D:interaction_view.force3D,onComplete:function(){e.remove()}}),TweenMax.to(t.$el,.4,{x:o.left,y:o.top,force3D:interaction_view.force3D})):(TweenMax.to(t.$el,0,{x:e.position().left,y:e.position().top,force3D:interaction_view.force3D}),1==i.dragend&&1==i.dragstart?TweenMax.to(e,0,{x:t.Pos.left,y:t.Pos.top,force3D:interaction_view.force3D,onComplete:function(){TweenMax.to(e,.4,{opacity:0,force3D:interaction_view.force3D,onComplete:function(){e.remove()}})}}):e.remove()),t.drag_dragend()}},old_transit_back:function(e,t){var i=e.iview.$el.parent().children("[data-drop="+e.id+"]"),t=t||i.attr("data-drag");i.attr("id",t+"_drag_copy"),this.model.page.iOverlaylist.where({id:t})[0].iview.drag_dragend(1)},trigger_dragin_event:function(e){interaction_view.events.onDragDrop(e,this.model,0)},trigger_drop_event:function(e){interaction_view.events.onDragDrop(e,this.model),interaction_view.events.onDragDropGroup(e)}})}),define("interaction_view/model/page",["_g/mvc","interaction_view/view/page"],function(){var e={defaults:{iType:"Page",position:0,description:"",title:"untitled",picture:null,preview:'<img src="/staticfs/admin-epub360/img/thumb.png">',thumbnail:null,width:null,height:null,bg_color:"#FFFFFF",bg_opacity:1,show_master:!0},autoIndex:!0,callback:function(){"page_group"!=this.get("type")&&(this.iOverlaylist=new interaction_view.collection.list,this.iAnimationlist=new interaction_view.collection.Animation,this.iActionlist=new interaction_view.collection.Action,this.ipreloadlist=new interaction_view.collection.Preload,this.ipreloadlist.pageid=this.iOverlaylist.pageid=this.iAnimationlist.pageid=this.iActionlist.pageid=this.id,this.iAnimationlist.iPage_id=this.id,this.iAnimationlist.page=this)},overlays:[],actions:[],animations:[]};return _g.mvc.createModel(e)}),define("interaction_view/collection/page",["_g/mvc","interaction_view/model/page"],function(){var e={enableSync:!1,model:require("interaction_view/model/page"),getTreeModels:function(e){var t=[];return e.each(function(e){if(t.push(e),e.icollection)for(var i=_g.mvc.getTreeModels(e.icollection),n=0;n<i.length;n++)t.push(i[n])}),t},getPageModels:function(){return this.pagemodels?this.pagemodels:(this.pagemodels=this.getTreeModels(this),this.pagemodels)},getPages:function(){var e=this.getPageModels();return e=_.reject(e,function(e){return"page_group"==e.toJSON().type})},getPagesJSON:function(){var e=this.getPageModels();return e=_.reject(e,function(e){return"page_group"==e.toJSON().type}),e=_.map(e,function(e){return e.toJSON()})},getPage:function(e){var t=this.getPageModels();return _.find(t,function(t){return t.id==e})},getIndexPages:function(){var e=this.getPages();return _.filter(e,function(e){return e.get("is_index")})},getElement:function(e,t,i){if(interaction_view.ipagelist.getPage(t)||interaction_view.imasterlist.get(t)){var n=interaction_view.ipagelist.getPage(t)||interaction_view.imasterlist.get(t);return n.iOverlaylist.get(i)}return e.iOverlaylist.get(i)}};return _g.mvc.createCollection(e)}),define("interaction_view/model/layer",["interaction_view/model/page"],function(){var e=require("interaction_view/model/page"),t=e.extend({defaults:{iType:"Layer",position:0,description:"",title:"untitled",picture:null,preview:'<img src="/staticfs/admin-epub360/img/thumb.png">',thumbnail:null,width:null,height:null,layer_width:1024,layer_height:768,bg_color:"#FFFFFF",bg_opacity:1},callback:function(){this.actions=this.get("actions"),this.animations=this.get("animations"),this.overlays=this.get("overlays")}});return t}),define("interaction_view/collection/layer",["interaction_view/collection/page","interaction_view/model/layer"],function(){var e=require("interaction_view/collection/page"),t=e.extend({model:require("interaction_view/model/layer")});return t}),define("interaction_view/model/master",["interaction_view/model/page"],function(){var e=require("interaction_view/model/page"),t=e.extend({defaults:{iType:"Master",position:0,description:"",title:"untitled",picture:null,preview:'<img src="/staticfs/admin-epub360/img/thumb.png">',thumbnail:null,width:null,height:null,bg_color:"#FFFFFF",bg_opacity:1,pageno_horizontal:{show:!1,x:500,y:20},pageno_vertical:{show:!1,x:20,y:300}}});return t}),define("interaction_view/view/master",["interaction_view/view/page"],function(){var e=require("interaction_view/view/page"),t=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!1,position:1,parseData:null,isMaster:!0});return t}),define("interaction_view/collection/master",["interaction_view/collection/page","interaction_view/model/master","interaction_view/view/master"],function(){var e=require("interaction_view/collection/page"),t=e.extend({model:require("interaction_view/model/master")});return t}),define("interaction_view/model/background",["interaction_view/model/page"],function(){var e=require("interaction_view/model/page"),t=e.extend({defaults:{iType:"Background",position:0,description:"",title:"untitled",picture:null,preview:'<img src="/staticfs/admin-epub360/img/thumb.png">',thumbnail:null,width:null,height:null,bg_color:"#FFFFFF",bg_opacity:1,pageno_horizontal:{show:!1,x:500,y:20},pageno_vertical:{show:!1,x:20,y:300}}});return t}),define("interaction_view/view/background",["interaction_view/view/page"],function(){var e=require("interaction_view/view/page"),t=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!1,position:1,parseData:null,isBackground:!0,prepareLoad:function(){var e=this,t=this.model;t&&(e.animations=_.map(e.animations,function(t){return t.pageid=e.model.id,t.pagetype="background",t}),e.model.iAnimationlist.reset(e.animations),overlays=_.filter(e.overlays,function(t){return t.pageid=e.model.id,t.pagetype="background",interaction_view.model[t.iType]}),overlays=_.map(overlays,function(e){return new interaction_view.model[e.iType](e)}),e.model.iOverlaylist.reset(overlays),e.model.iOverlaylist.each(function(e){e.iview.setZindex()}),e.actions=_.map(e.actions,function(t){return t.pageid=e.model.id,t.pagetype="background",t}),e.model.iActionlist.reset(e.actions))}});return t}),define("interaction_view/collection/background",["interaction_view/collection/page","interaction_view/model/background","interaction_view/view/background"],function(){var e=require("interaction_view/collection/page"),t=e.extend({model:require("interaction_view/model/background")});return t}),define("interaction_view/model/component",["interaction_view/model/page"],function(){var e=require("interaction_view/model/page"),t=e.extend({defaults:{iType:"Component",bg_color:"#FFFFFF",bg_opacity:1},callback:function(){this.actions=this.get("actions"),this.animations=this.get("animations"),this.overlays=this.get("overlays")}});return t}),define("interaction_view/collection/component",["interaction_view/collection/page","interaction_view/model/component"],function(){var e=require("interaction_view/collection/page"),t=e.extend({model:require("interaction_view/model/component")});return t}),define("interaction_view/model/doc",["_g/mvc","interaction_view/collection/page","interaction_view/view/page","interaction_view/collection/layer","interaction_view/collection/master","interaction_view/collection/background","interaction_view/collection/component"],function(){var e={defaults:{id:"doc",play_mode:0},autoUpdate:!1,fetchUrl:context_url+"index.json",staticFetchUrl:"/staticfs/common/js/interaction_view/data/index.json",parse:function(e){return console.log("fetch data:"+e),200==e.code?e.data?(interaction_view.size={x:e.data.width||1024,y:e.data.height||768},interaction_view.screen_mode=e.data.screen_mode,interaction_view.force3D=e.data.force_3d&&interaction_view.ismobile?"auto":!1,this.initShareApp(e),this.initEnvironment(),this.initMasters(e),workEnd("-------- 1.1.1 touchinit 1 initMasters --------"),this.initBackgrounds(e),workEnd("-------- 1.1.2 touchinit 1 initBackgrounds --------"),this.initLayers(e),workEnd("-------- 1.1.3 touchinit 1 initLayers --------"),this.initPages(e),workEnd("-------- 1.1.4 touchinit 1 initPages --------"),this.initComponents(e),this.initApplications(e),"undefined"!=typeof e_api&&this.initApi(e),this.initDbs(e),workEnd("-------- 1.1.5 touchinit 1 initApplications --------"),interaction_view.ismobile||interaction_view.forpreview||(e.data.bg_color=void 0!=e.data.desktop_bg_color?e.data.desktop_bg_color:e.data.bg_color,e.data.bg_opacity=void 0!=e.data.desktop_bg_opacity?e.data.desktop_bg_opacity:e.data.bg_opacity,e.data.screen_mode=void 0!=e.data.desktop_screen_mode?e.data.desktop_screen_mode:e.data.screen_mode,e.data.show_excontent=void 0!=e.data.desktop_show_excontent?e.data.desktop_show_excontent:e.data.show_excontent,e.data.adapt=void 0!=e.data.desktop_adapt?e.data.desktop_adapt:e.data.adapt),_.omit(e.data,"layers","masters","chapter","organization","applications")):{}:void 0},initMasters:function(e){var t=require("interaction_view/collection/master");e.data.masters||(e.data.masters=[]),interaction_view.imasterlist=_g.mvc.createTreeByData({collection:t,data:e.data.masters})},initBackgrounds:function(e){var t=require("interaction_view/collection/master");e.data.backgrounds||(e.data.backgrounds=[]),interaction_view.ibackgroundlist=_g.mvc.createTreeByData({collection:t,data:e.data.backgrounds})},initLayers:function(e){var t=require("interaction_view/collection/layer");e.data.layers||(e.data.layers=[]),interaction_view.ilayerlist=_g.mvc.createTreeByData({collection:t,data:e.data.layers})},initComponents:function(e){var t=require("interaction_view/collection/component");e.data.components||(e.data.components=[]),interaction_view.iComponentlist=_g.mvc.createTreeByData({collection:t,data:e.data.components})},initPages:function(e){var t,i=require("interaction_view/collection/page");t=e.data.chapter,workEnd("-------- 1.1.4.2 touchinit pagedata parseOrgnization--------"),interaction_view.ipagelist=_g.mvc.createTreeByData({collection:i,data:t}),workEnd("-------- 1.1.4.3 touchinit interaction_view ipagelist--------"),_g.mvc.createTreeView({collection:interaction_view.ipagelist,view:require("interaction_view/view/page"),containment:"div.slides",wrap:null}),workEnd("-------- 1.1.4.4 touchinit interaction_view createTreeView--------")},initApplications:function(e){interaction_view.applications=e.data.applications,interaction_view.actionforapp={},interaction_view.application.buttons=[],interaction_view.application.buttonGroups=[],_.each(interaction_view.applications,function(e){"form"==e.type&&interaction_view.application.initForm(e),e.actions&&e.actions.length&&(interaction_view.actionforapp[e.id]=new interaction_view.collection.Action,interaction_view.actionforapp[e.id].add(e.actions),interaction_view.actionforapp[e.id].each(function(e){e.iview.render()}))})},initShareApp:function(e){interaction_view.shareapp={id:""},e.data.shareapp&&""!=e.data.shareapp.id&&(interaction_view.shareapp=e.data.shareapp,interaction_view.environment.Shareapp.init())},initEnvironment:function(){interaction_view.environment.Sharedata.init(),interaction_view.environment.Userdata.init()},initApi:function(e){e_api._initialize(e.data.api_data||[])},initDbs:function(e){var e=e.data.dbs,t=Backbone.Model.extend({defaults:{id:"",querys:[],sheet_id:"",fields:[]}}),i=Backbone.Collection.extend({model:t});interaction_view.dblist=new i,_.each(e,function(e){interaction_view.dblist.add({id:e.id,querys:e.iDetail.querys,sheet_id:e.iDetail.sheet_id,fields:e.iDetail.fields})});var n=new dboperate;n.query()},callback:function(){}};return _g.mvc.createModel(e)}),define("text!interaction_view/template/preload.js",[],function(){return'<img src="<%=file%>" width="1" height="1" id="<%=id%>"/>'}),define("interaction_view/model/preload",["interaction_view/model/base","text!interaction_view/template/preload.js"],function(){require("text!interaction_view/template/preload.js");interaction_view.model.Preload=interaction_view.model.Base.extend({defaults:{iType:"Preload",iCommon:null,iDetail:null,iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!0,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,loaded:!1},setcollection:function(){if(this.pageid=this.get("pageid"),"LayerRef"==this.get("pagetype")){var e=this.get("parentpageid"),t=this.get("layerid"),i=interaction_view.getParentpage(e);this.page=i.iOverlaylist.get(this.pageid).layer[t]}else this.get("isSubOverlay")?(this.path=this.get("path"),this.page=interaction_view.getContainerModelByPath(this.path)):this.page=interaction_view.getParentpage(this.pageid);this.page.ipreloadlist.get(this.id)||this.page.ipreloadlist.add(this)},setview:function(){if(this.pageid=this.get("pageid"),"LayerRef"==this.get("pagetype")){var e=this.get("parentpageid"),t=this.get("layerid"),i=interaction_view.getParentpage(e);this.page=i.iOverlaylist.get(this.pageid).layer[t]}else this.get("isSubOverlay")?(this.path=this.get("path"),this.page=interaction_view.getContainerModelByPath(this.path)):this.page=interaction_view.getParentpage(this.pageid);"master"==this.get("pagetype")&&(this.isMasterOverlay=!0),this.iview=new interaction_view.view.Preload({model:this})},setsyncmodel:function(){}}),interaction_view.collection.Preload=interaction_view.collection.Base.extend({preloadcheck:function(e,t,i){this.where({loaded:!0});if(interaction_view.ismobile||0!=t||console.log("file:"+e+" load failed!"),i.iview.afterpreload(e),0==this.where({loaded:!1}).length)if("LayerRef"==this.pagetype){var n=this.parentpageid,a=this.layerid,o=interaction_view.getParentpage(n);refmodel=o.iOverlaylist.get(this.pageid),refmodel.iview.afterlayerload(a)}else if(this.subcontainer){var r=interaction_view.getContainerModelByPath(this.path);r.iview.afterSubOverlayPreload()}else interaction_view.finishPagePreload(this.pageid)},preload:function(){this.each(function(e){e.get("loaded")||e.iview.render()})}}),interaction_view.view.Preload=interaction_view.view.Base.extend({events:{},initstart:function(){},renderDynamicElement:function(){},render:function(){var e=this,t=this.elementmodel=e.model.page.iOverlaylist.get(this.model.get("overlay_id")),i=this.model.get("elementtype");if("Audio"==i)console.info("Audio"),this.audioPreload();else if("Video"==i)this.videoPreload();else if("QQVideo"==i)this.qqVideoPreload();else if("LayerRef"==i||"LayerSlide"==i||"ComponentRef"==i)this.layerPreload(this.model);else if(this.model.get("subcontainer"))this.subcontainerPreload(this.model);else{var n=e.model.toJSON().file;$('img[id="'+this.model.id+'"]').length>0&&($('img[id="'+this.model.id+'"]')[0].onload=function(){interaction_view.iImgs[n]=this},$('img[id="'+this.model.id+'"]')[0].src=n),e.model.set("loaded",!0),workEnd("-------- 4 "+this.model.id+" = "+n),e.model.page.ipreloadlist.preloadcheck(e.model.toJSON().file,!0,t)}},audioPreload:function(){interaction_view.media.audio.init(this.model,this.elementmodel,this.model.isMasterOverlay)},videoPreload:function(){interaction_view.media.video.init(this.model,this.elementmodel,this.model.toJSON().file)},qqVideoPreload:function(){var e=this,t=this.model.toJSON().vid,i="http://h5vv.video.qq.com/geturl?otype=json&platform=1&ran=0%2E9652906153351068&callback=tvp_request_getinfo_callback_605089&vid="+t;$.ajax({url:i,dataType:"jsonp",data:"",jsonp:"callback",timeout:3e3,success:function(t){try{var i=t.vd.vi[0].url;interaction_view.media.video.init(e.model,e.elementmodel,i)}catch(n){console.log(n),e.elementmodel.loaded=!0,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.elementmodel.toJSON().file,!0,e.elementmodel)}},error:function(t){console.log(t),e.elementmodel.loaded=!0,e.model.set("loaded",!0),e.model.page.ipreloadlist.preloadcheck(e.elementmodel.toJSON().file,!0,e.elementmodel)}})},layerPreload:function(){this.elementmodel.iview.loadLayer(this.model)},subcontainerPreload:function(){this.elementmodel.iview.loadSubOverlay(this.model)}}),interaction_view.ipreloadlist=new interaction_view.collection.Preload}),define("interaction_view/model/richtext",["interaction_view/model/base"],function(){interaction_view.model.RichText=interaction_view.model.Base.extend({defaults:{iType:"RichText",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.RichText({model:this})},setsyncmodel:function(){}}),interaction_view.view.RichText=interaction_view.view.Base.extend({events:{},render:function(){interaction_view.ismobile,this.scrollEl=this.$el.children(".Element"),this.model._reset=!0},resetOtherStatus:function(){var e=this;if(_g.ui.isOverflowed(this.$el.children(".Element")).y){if(!this.$el.children(".Element").hasClass("disableDragY")){var t=this.$el.children(".Element").height();this.$el.children(".Element").wrapInner('<div class="iContent"></div>');var i=_g.ui.isOverflowed(this.$el.children(".Element")).y-t;this.scrollView=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,click:!0,probeType:3}),this.scrollView.on("scroll",function(){console.log(this.y),i&&i>0&&(this.y>0?this.y>30&&e.scrollEl.addClass("is_exceededY"):Math.abs(this.y)-i>30&&e.scrollEl.addClass("is_exceededY"))}),this.scrollEl=this.$el.children(".Element"),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY")}this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY")}},otherOnShow:function(){this.resetOtherStatus()}})}),define("interaction_view/model/slide",["interaction_view/model/base"],function(){interaction_view.model.Slide=interaction_view.model.Base.extend({defaults:{iType:"Slide",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSlideNumber:!0,isSlide:!0,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){var e=this.get("iDetail");e.show_title&&this.setSubOverlays(),this.iview=new interaction_view.view.Slide({model:this})},setsyncmodel:function(){}}),interaction_view.view.Slide=interaction_view.view.Base.extend({events:{},render:function(){var e=this,t=this.getdetail();this.renderBackGroud(),this.currentSlideIndex=null,this.model.on("slideTo",function(i){return null!=e.currentSlideIndex&&e.currentSlideIndex==i?!1:(e.preloaded&&(interaction_view.events.onChangeTo(e.model.get("pageid"),e.model.id,i),e.currentSlideIndex=i,e.setTitle(i)),e.rmbLast=i,void(t.iRememberLast&&interaction_view.environment.Paragraph.state()&&e.addToUrl(i)))}),this.model._reset=!0},getSlideLength:function(){var e=this.getdetail();return e.iImg?e.iImg.length:0},preload:function(){var e,t=this,i=this.getdetail();this.checkImglist=_.pluck(i.iImg,"1"==_g.getUrlParameterByName("-playmode")?"thumbnail":"picture"),this.preloaded=!1;var n=[];i.iImg&&i.iImg.length&&(_.each(i.iImg,function(i){e="1"==_g.getUrlParameterByName("-playmode")?i.thumbnail:i.picture;var a=t.sendToPreload({file:e});n.push(a.id)}),i.show_title&&this.sendToPreload({file:null,subcontainer:!0,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")})),this.model.set("preload_id",n)},checkImgload:function(e){return this.checkImglist=_.reject(this.checkImglist,function(t){return t==e}),0==this.checkImglist.length?!0:!1},afterpreload:function(e){if((!e||!this.preloaded)&&(e&&(this.preloaded=this.checkImgload(e)),this.preloaded)){var t=this,i=this.getdetail();if(i.show_title&&this.preloadmodel.get("loaded"))return;if(this.setZindex(),this.setElementDisplay(),this.setSlideImageDisplay(),this.slideel=this.$el.children(".Element").find(".slidecontent").first(),this.slidelength=this.getdetail().iImg.length,this.fullview(),this.playAnimation(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style"),i.iRememberLast&&"Flow"!=i.iFade)return t.rmbLast=t.getFromUrl(),void t.setElementTo(t.rmbLast)}},afterSubOverlayPreload:function(){this.preloadmodel&&(this.model.iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.iActionlist.each(function(e){e.iview.render()}),this.setTitle(0),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model))},playAnimation:function(){this.timeline&&this.timeline.clear();var e=this.getdetail(),t=(e.iSlidetype,!1);this.$el.children(".Element").is(":hidden")&&(t=!0),this.delay=Number(e.iInterval)||2,this.autoplay=e.iAutoplay;var i=e.iRepeat?-1:0;this.iFade=e.iFade||0,this.timeline=new TimelineMax({paused:!0,repeat:i,onComplete:this.setRewind}),this.repeat=i,this.iRewind=e.iRewind,this.slipable=e.iSlipable,this.canSlip=!0,this.iDisplay=e.iDisplay,this.setTimeline(),"Flow"!=e.iFade&&(this.autoplay?this.model._autoplay=!0:this.setSlideDisplay(0),this.onChangeSlideTo(0),this.slipable&&(this.control(),this.autoplay||this.$el.attr("data-iSlipable",!0)))},_autoplay:function(){var e=!1;this.$el.children(".Element").is(":hidden")&&(e=!0),this.timeline&&(!e||interaction_view.ismobile||this.model.isMasterOverlay)&&this.timeline.play(0)},setTimeline:function(){if("Fade"==this.iFade)this.setFade();else if("Slip"==this.iFade)this.slideel.css("overflow","hidden"),this.setSlip();else if("None"==this.iFade)this.setNone();else{if("Flip"!=this.iFade)return"Flow"==this.iFade?void this.setFlowAll():void 0;2==this.iDisplay&&(this.slideel.wrapInner('<div class="slidewrap" style="width:100%;height:100%;position:absolute;"></div>'),this.slideel=this.slideel.children(".slidewrap")),this.slideel.hasClass("overflowhidden")&&(this.slideel.removeClass("overflowhidden"),this.slideel.parent().addClass("overflowhidden").css("border",this.slideel.css("border")).css("border-radius",this.slideel.css("border-radius")),this.slideel.css("border","none").css("border-radius","0")),this.setFlip()}this.slideel.children().first().css({opacity:1,left:0,top:0}).nextAll().css("opacity",0)},setFlowAll:function(){function e(e){var t=$(e).height()||r/e.width*e.height,i=$("<canvas></canvas>").attr({width:r,height:t}).css({"float":"left"});$(e).after(i),TweenMax.to(i,0,{transform:"matrix(1, 0, 0, -1, 0, 0)"});var n=i[0].getContext("2d");n.drawImage(e,0,0,r,t);var a=n.createLinearGradient(0,0,0,t);n.globalCompositeOperation="destination-in",a.addColorStop(1,"rgba(0,0,0,0.4)"),a.addColorStop(.6,"rgba(0,0,0,0)"),a.addColorStop(0,"rgba(0,0,0,0)"),n.fillStyle=a,n.fillRect(0,0,r,t)}function t(){if(c++,n.slidelength<=c){n.slideel.children().find("img").css({width:r}).each(function(t,i){e(i)}),n.slideel.children().animate({opacity:1});var t=n.slideel.parents("section.Presentation:first").attr("style");n.slideel.parents("section.Presentation:first").css({display:"block",visibility:"hidden"}),n.CoverFlow=n.slideel.children().coverflow({active:Math.floor((n.slidelength-1)/2),overlap:.3,perspectiveY:22,duration:300,beforeselect:function(e,t){n.model.trigger("slideTo",t.index)},select:function(e,t){n.currentIndex=t.index}}).width("+=100").height("100%"),n.slideel.children().children().each(function(e,t){var i=$(t).find("img").height();$(t).width(r),$(t).children().css({position:"absolute"}),$(t).find("img").css({bottom:.3*a+"px"}),$(t).find("canvas").css({bottom:.3*a-i+"px"})}),n.slideel.parents("section.Presentation:first").attr("style",t),n.setFlow(),i(),s.iRememberLast&&(n.rmbLast=n.getFromUrl(),n.setElementTo(n.rmbLast))}}function i(){if(n.slipable){var e=["mousedown","mousemove","mouseup"];n.isTouch()&&(e=["touchstart","touchmove","touchend touchcancel"]);var t=n.CoverFlow.parent().width();n.CoverFlow.on(e[0],function(i){function a(e){n.isTouch()&&(e=e.originalEvent.touches[0]);var i=(e.clientX-o)/t;return n.isTouch()&&(i*=2),i=Math.round(i*n.slidelength),i=s-i,0>i&&(i=0),i>=n.slidelength&&(i=n.slidelength-1),n.CoverFlow.coverflow("select",i),r=!0,!1}n.isTouch()&&(i=i.originalEvent.touches[0]);var o=i.clientX,r=!1,s=n.CoverFlow.children(".ui-state-active").index();return $(document).on(e[1],a),$(document).one(e[2],function(){function t(){n.CoverFlow.data("CoverFlowDisableClick",!1)}return $(document).off(e[1],a),r&&n.CoverFlow.data("CoverFlowDisableClick",!0)&&setTimeout(t,10),!1}),n.isTouch()&&!r&&n.CoverFlow.coverflow("select",$(i.target).parent().index()),n.isTouch()?void 0:!1});var i=n.getdetail().iSlidetype?n.getdetail().iSlidetype:0;n.$el.children(".Element").addClass("æ¨ªå"==i||0==Number(i)?"enableMouseWheelX disableDragX":"enableMouseWheelY disableDragY")}}var n=this,a=this.getcommon().iHeight,o=this.getcommon().iWidth,r=.7*o,s=this.getdetail();n.slideel.children().removeAttr("style").wrap("<div></div>"),n.slideel.wrapInner("<div></div>"),n.slideel.children().css({opacity:0});var l=_.pluck(s.iImg,"1"==_g.getUrlParameterByName("-playmode")?"thumbnail":"picture");_.each(l,function(e){var i=new Image;i.src=e,i.onload=function(){i.height/i.width*r>.7*a&&(r=.7*a/i.height*i.width),t()}});var c=0},isTouch:function(){return"ontouchstart"in document},testControl:function(){return!0},resetOtherStatus:function(){if(this.slideel){var e=this,t=this.getdetail();if("Flow"!=t.iFade&&this.slideel.children().first().css({opacity:1,left:0,top:0}),this.autoplay=t.iAutoplay,this.currentIndex=0,this.currentSlideIndex=null,this.hasSlideNumber&&(this.setSlideNumberPosition(),this.changeSlideNumber()),this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY"),this.timeline){var i=Math.floor((this.slidelength-1)/2);if(this.timeline.pause(1e-5),t.iRememberLast)return e.rmbLast=e.getFromUrl(),void e.setElementTo(e.rmbLast);if("Flow"==t.iFade&&this.CoverFlow){this.currentIndex=i;try{this.CoverFlow.coverflow("select",i),this.currentIndex=i}catch(n){}}if(!this.autoplay||this.$el.children(".Element").is(":hidden")&&!interaction_view.ismobile)this.setSlideDisplay(0);else{if("Flow"==t.iFade)return void this.timeline.play(.3*(i-1)+i*this.delay);this.timeline.play(0)}}}},fullview:function(){var e=this,t=this.getdetail();if(t.iFullview&&t.iImg&&t.iImg.length){if(this.$el.addClass("hasaction"),"Flow"==t.iFade)return void(e.isTouch()?e.slideel.hammer().on("tap",".ui-state-active",function(){e.fullviewIndex($(this).index())}):e.slideel.on("click",".ui-state-active",function(){e.fullviewIndex($(this).index())}));this.$el.children(".Element").on("click",function(t){return e.stopFullviewByFlow?(e.stopFullviewByFlow=!1,!1):e.slipable&&!$(t.target).is(t.currentTarget)?!1:(null!=e.currentIndex&&"undefined"!=e.currentIndex&&e.fullviewIndex(e.currentIndex),!1)})}},isFullSwitch:function(){var e=this.getdetail();return e.iSlipable},preview_left:function(e){e>0&&this.fullviewIndex(e-1)},preview_right:function(e){var t=this.getdetail();e<t.iImg.length-1&&this.fullviewIndex(e+1)},setTitle:function(e){var t=this.getdetail();if(t.show_title&&t.iImg&&t.iImg.length&&t.iImg[e]){var i=this.model.get("suboverlays"),n=interaction_view.formatLabel({text:t.iImg[e].title,font_size:i[0].iDetail.font_size,text_color:i[0].iDetail.text_color,iPosition:i[0].iDetail.iPosition});this.$el.find(".iTextLabel.Element").html(n)}},getFromUrl:function(e){var t=_g.getUrlParameterByName(this.model.id,e);if(t||(t=_g.getHashParameterByName(this.model.id)),null==t&&"epub360"==epub360_domain&&""!=interaction_view.environment.Sharedata.id)if(1==interaction_view.environment.Sharedata.status)interaction_view.environment.Sharedata.addView(this);else{var i=this.model.get("pageid"),n=interaction_view.environment.Sharedata.getitem(i,this.model.id);n&&(t=n.value)}return t},addToUrl:function(e){var t=this.getdetail();if(!t.iRememberLast)return!1;"undefined"==typeof message_link&&(message_link=document.location.href,interaction_view.weixin.share()),"undefined"==typeof e&&(e=this.currentIndex);
var i=this.model.id+"="+encodeURI(e),n=_g.getUrlParameterByName(this.model.id,message_link),a=0,o=message_link;if(n)encodeURI(n)!=encodeURI(e)?o=_g.replaceUrlParameterByName(this.model.id,i,message_link):a=1;else{var r="?";message_link.indexOf("?")>=0&&(r="&"),o+=r+i}if("epub360"==epub360_domain&&!a&&interaction_view.environment.Sharedata.enabled&&interaction_view.environment.Sharedata.setitem(this,{value:encodeURI(e)}),a||(message_link=o,interaction_view.weixin.share()),!interaction_view.forpreview){var s=_g.getHashParameterByName(this.model.id);s?encodeURI(s)!=encodeURI(e)?window.history.replaceState({},"",_g.replaceHashParameterByName(this.model.id,i)):a=1:window.history&&(document.location.hash?window.history.replaceState({},"",document.location.hash+="&"+i):window.history.replaceState({},"","#"+i))}return a?!1:!0},setControl:function(e){this.getdetail();this.addToUrl(),this.control(),this.canSlip=!0,e||this.slipable||(this.canSlip=!1)}})}),define("interaction_view/model/video",["interaction_view/model/base"],function(){interaction_view.model.Video=interaction_view.model.Base.extend({defaults:{iType:"Video",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,iBackground:"rgba(62,189,255,0.5)",iResourcesProperties:[{id:"iImg",type:"single"}],iAnimationProperties:[{id:"iAnimation",type:"object"}]},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Video({model:this})},setsyncmodel:function(){},getFile:function(){var e=this.get("iDetail");return e.iFile&&e.iFile[0]?e.iFile[0].file:null}}),interaction_view.view.Video=interaction_view.view.Base.extend({events:{},render:function(){this.file,this.model._reset=!0},setOtherDisplay:function(){this.model.media&&interaction_view.media.pause(this.model)},preload:function(){var e,t=this.getdetail();t.iFile&&t.iFile[0]&&(e="undefined"!=typeof epub360&&epub360.settings&&epub360.settings.disable_stream_media?t.iFile[0].file:"undefined"==typeof cbt_data||interaction_view.forpreview?"1"==_g.getUrlParameterByName("-playmode")?(t.iFile[0].file||t.iFile[0].content)+"_video.m3u8":"2"==_g.getUrlParameterByName("-playmode")?(t.iFile[0].file||t.iFile[0].content)+"":interaction_view.ismobile?(t.iFile[0].file||t.iFile[0].content)+"_origin.mp4":(t.iFile[0].file||t.iFile[0].content)+"_videohd.m3u8":t.iFile[0].file||t.iFile[0].content,this.file=e),this.file&&(this.preloadmodel=this.sendToPreload({file:this.file}))},resetOtherStatus:function(){if(!this.model.hided&&this.model.media){this.model.hls?interaction_view.media.video.resetH(this.model,this):interaction_view.media.video.reset(this.model);var e=this.model.get("iDetail").iAutohide;if(null==e&&(e=!0),e){if(this.model.hls&&this.model.reseted)return;this.$el.addClass("hide")}else this.model.get("iDetail").iControl&&this.$el.find(".jwdisplayIcon").css({opacity:1})}}})}),define("interaction_view/model/button",["interaction_view/model/base"],function(){interaction_view.model.Button=interaction_view.model.Base.extend({defaults:{iType:"Button",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){var e=this.get("iDetail");e.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.Button({model:this})},setsyncmodel:function(){}}),interaction_view.view.Button=interaction_view.view.Base.extend({events:{},render:function(){this.model._reset=!0},preload:function(){this.preloaded=!1,this.checkImglist=[];var e=this.getdetail(),t=[null,null];if(e.iconNormal&&e.iconNormal[0]){this.checkImglist.push(e.iconNormal[0].picture);var i=this.sendToPreload({file:e.iconNormal[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[0]=i.id}if(e.iconActive&&e.iconActive[0]){this.checkImglist.push(e.iconActive[0].picture);var i=this.sendToPreload({file:e.iconActive[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[1]=i.id}this.model.set("preload_id",t)},checkImgload:function(e){return this.checkImglist=_.reject(this.checkImglist,function(t){return t==e}),0==this.checkImglist.length?!0:!1},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");var t=this.getdetail();if(t.isSwitch)t.isMasterAudio&&(this.$el.addClass("master_audio_icon"),this.$el.find(".iconNormal").addClass("animated infinite rotate c-time-20"),"undefined"!=typeof bgsound_autostart&&bgsound_autostart||(this.init_reverse=!0)),this.$el.on("click",function(){e.changeStatus(),void 0!=t.linktype&&interaction_view.renderLink(t.linktype,t)});else{if(interaction_view.ismobile)var i="touchstart",n="touchend";else var i="mousedown",n="mouseup";this.$el.on(i,function(){e.buttonon=!0,e.changeStatus(),void 0!=t.linktype&&interaction_view.renderLink(t.linktype,t)}),this.$el.on(n,function(){e.buttonon&&(e.buttonon=!1,e.changeStatus())})}},changeStatus:function(){var e=this.getdetail(),t=this;if(t.active){if(t.groupcontrol&&e.isSwitch)return;if(t.model.get("isTabBarButton"))return;if(t.$el.find("img.iconActive").hide(),t.$el.find("img.iconNormal").show(),t.active=!1,e.isMasterAudio)try{var i=interaction_view.bgsound||interaction_view.imasterlist.at(0).iOverlaylist.where({iType:"Audio"})[0];interaction_view.media.play(i)}catch(n){console.log(n)}}else if(t.$el.find("img.iconActive").show(),t.$el.find("img.iconNormal").hide(),t.active=!0,e.isMasterAudio)try{var i=interaction_view.bgsound||interaction_view.imasterlist.at(0).iOverlaylist.where({iType:"Audio"})[0];interaction_view.media.pause(i)}catch(n){console.log(n)}},setActiveStatus:function(){var e=this;e.$el.find("img.iconActive").show(),e.$el.find("img.iconNormal").hide(),e.active=!0},resetOtherStatus:function(){this.resetButtonStatus()},resetButtonStatus:function(){this.init_reverse?(this.$el.find("img.iconActive").show(),this.$el.find("img.iconNormal").hide(),this.active=!0):(this.$el.find("img.iconActive").hide(),this.$el.find("img.iconNormal").show(),this.active=!1)}})}),define("interaction_view/model/map",["interaction_view/model/base"],function(){interaction_view.model.Map=interaction_view.model.Base.extend({defaults:{iType:"Map",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Map({model:this})},setsyncmodel:function(){}}),interaction_view.view.Map=interaction_view.view.Base.extend({events:{},render:function(){}})}),define("interaction_view/model/pay",["interaction_view/model/base"],function(){interaction_view.model.Pay=interaction_view.model.Base.extend({defaults:{iType:"Pay",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Pay({model:this})},setsyncmodel:function(){}}),interaction_view.view.Pay=interaction_view.view.Base.extend({events:{},render:function(){}})}),define("interaction_view/model/link",["interaction_view/model/base"],function(){interaction_view.model.Link=interaction_view.model.Base.extend({defaults:{iType:"Link",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Link({model:this})},setsyncmodel:function(){}}),interaction_view.view.Link=interaction_view.view.Base.extend({events:{},render:function(){var e=this.getdetail();this.$el.on("click",function(){void 0!=e.linktype&&interaction_view.renderLink(e.linktype,e)})}})}),define("interaction_view/view/layer",["interaction_view/view/page"],function(){var e=require("interaction_view/view/page"),t=$.extend({},e,{template:null,className:null,containment:null,wrap:null,wrapClassName:null,autoRender:!1,position:1,parseData:null,afterload:function(){var e=this,t=this.model.get("iDetail").layer_ids,i=this.model.offset?this.model.offset:{x:0,y:0};t&&0!=t.length&&(_.each(t,function(t){var n=interaction_view.ilayerlist.get(t)||interaction_view.iComponentlist.get(t);n&&(e.animations=_.map(n.animations,function(i){return i.pageid=e.model.id,i.parentpageid=e.model.get("pageid"),i.pagetype="LayerRef",i.layerid=t,i}),e.model.layer[t].iAnimationlist.reset(e.animations),overlays=_.filter(n.overlays,function(e){return interaction_view.model[e.iType]}),overlays=_.map(overlays,function(n){var a=$.extend(!0,{},n);return a.pageid=e.model.id,a.parentpageid=e.model.get("pageid"),a.pagetype="LayerRef",a.layerid=t,a.path=e.model.layer[t].iOverlaylist.path,a.isSubOverlay=!0,a.isLayerOverlay=!0,i.x&&(a._offset_x=i.x),i.y&&(a._offset_y=i.y),a.iCommon.landscape.iStarty=a.iCommon.landscape.iStarty+i.y,a.iCommon.landscape.iStartx=a.iCommon.landscape.iStartx+i.x,new interaction_view.model[n.iType](a)}),e.model.layer[t].iOverlaylist.reset(overlays),e.model.layer[t].iOverlaylist.each(function(e){e.iview.setZindex()}),e.actions=_.map(n.actions,function(i){return i.pageid=e.model.id,i.parentpageid=e.model.get("pageid"),i.pagetype="LayerRef",i.layerid=t,i}),e.model.layer[t].iActionlist.reset(n.actions))}),e.startLayerLoad())},startLayerLoad:function(){var e=this;_.each(this.model.layer,function(t,i){0==t.ipreloadlist.length?e.model.iview.afterlayerload(i):t.ipreloadlist.preload()})}});return t}),define("interaction_view/model/layerref",["interaction_view/model/base","interaction_view/view/layer"],function(){interaction_view.model.LayerRef=interaction_view.model.Base.extend({defaults:{iType:"LayerRef",iCommon:null,iDetail:null,iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){var e=this.get("iDetail"),t=this;t.layer={},this.filterlayers(),e.layer_ids&&e.layer_ids.length>0&&_.each(e.layer_ids,function(e){t.layer[e]={},t.layer[e].iOverlaylist=new interaction_view.collection.list,t.layer[e].iAnimationlist=new interaction_view.collection.Animation,t.layer[e].iActionlist=new interaction_view.collection.Action,t.layer[e].ipreloadlist=new interaction_view.collection.Preload,t.layer[e].subcontainer=t.layer[e].ipreloadlist.subcontainer=t.layer[e].iOverlaylist.subcontainer=t.layer[e].iAnimationlist.subcontainer=t.layer[e].iActionlist.subcontainer=t.id,t.layer[e].ipreloadlist.path=t.layer[e].iOverlaylist.path=t.layer[e].iAnimationlist.path=t.layer[e].iActionlist.path=t.createPath(e),t.layer[e].ipreloadlist.pageid=t.layer[e].iOverlaylist.pageid=t.layer[e].iAnimationlist.pageid=t.layer[e].iActionlist.pageid=t.id,t.layer[e].ipreloadlist.pagetype=t.layer[e].iOverlaylist.pagetype=t.layer[e].iAnimationlist.pagetype=t.layer[e].iActionlist.pagetype="LayerRef",t.layer[e].ipreloadlist.parentpageid=t.layer[e].iOverlaylist.parentpageid=t.layer[e].iAnimationlist.parentpageid=t.layer[e].iActionlist.parentpageid=t.get("pageid"),t.layer[e].ipreloadlist.layerid=t.layer[e].iOverlaylist.layerid=t.layer[e].iAnimationlist.layerid=t.layer[e].iActionlist.layerid=e,t.layer[e].iAnimationlist.page=t.layer[e],t.layer[e].iAnimationlist.iPage_id=t.get("pageid")}),this.setiview()},createPath:function(e){var t=interaction_view.createPath({path:this.get("path"),isSubOverlay:this.get("isSubOverlay"),page_id:this.get("pageid"),model:this,layer_id:e});return t},setiview:function(){this.iview=new interaction_view.view.LayerRef({model:this})},setsyncmodel:function(){},filterlayers:function(){var e=this.get("iDetail"),t=e.layer_ids;e.layer_ids&&e.layer_ids.length>0&&(t=_.filter(t,function(e){return interaction_view.ilayerlist.get(e)})),e.layer_ids=t,this.set("iDetail",e)}}),interaction_view.view.LayerRef=interaction_view.view.Base.extend({events:{},render:function(){this.renderMask(),this.model._reset=!0},renderMask:function(){var e=this.getdetail();e.layer_ids&&e.layer_ids.length>0&&(this.$el.children(".Element").children().children().css({translate:[e.x,e.y]}),this.scrollview&&(this.$el.children(".Element").children().removeClass("is_exceededX"),this.$el.children(".Element").children().removeClass("is_exceededY"),this.scrollview.iScroll.scrollTo(e.x,e.y)))},preload:function(){var e=this.model.get("iDetail");e.layer_ids&&e.layer_ids.length>0&&this.sendToPreload({file:null})},loadLayer:function(e){var t=this.getdetail();this.layerCheckList=_.clone(t.layer_ids),this.firstlayer=t.layer_ids?t.layer_ids[0]:null,this.preloadmodel=e;var i=require("interaction_view/view/layer");i=_g.mvc.createView(i),this.layerview=new i({model:this.model}),this.layerview.afterload()},afterlayerload:function(e){if(console.log(e),this.preloadmodel){this.layerCheckList=_.reject(this.layerCheckList,function(t){return t==e}),this.model.layer[e].iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.layer[e].iActionlist.each(function(e){e.iview.render()});{this.model.toJSON().iDetail.iHidden||!1}0==this.layerCheckList.length&&(this.$el.addClass("hide").css("opacity",""),this.slideel=this.$el.find(".layer-content").first(),this.slideel.children(".layer-item").first().show(),this.slidestyle=this.slideel.attr("style"),this.playAnimation(),this.firstlayer&&"LayerRef"==this.model.get("iType")&&(this.model.layer[this.firstlayer].isLayer=!0),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model))}},playLayer:function(){this.firstlayer&&interaction_view.play(this.model.layer[this.firstlayer])},playAnimation:function(){var e=this.getdetail();this.$el.find(".layer-content").children().css("opacity",1);var t=this.getLayerContentSize(),i=this.getcommon();return t.width==i.iWidth&&t.height==i.iHeight?!1:void this.setMaskSlipable({items:this.$el.find(".layer-content"),containment:this.$el.children(".Element").children(),contentel:this.$el.children(".Element").children().children(),content_x:e.x,content_y:e.y})},onExecuteBindingForLayerRef:function(e){var t=this.getMoveRange();1!=e.type&&(e.cdirection||t.x>0&&this.scrollview&&this.scrollview.iScroll.scrollTo(-e.deltarate*t.x,this.getCurrentPosition().top),e.cdirection&&t.y>0&&this.scrollview&&this.scrollview.iScroll.scrollTo(this.getCurrentPosition().left,-e.deltarate*t.y))},getCurrentPosition:function(){if(this.$el.find(".layer-content").length>0){var e={left:0,top:0};return this.scrollview&&(e={left:this.scrollview.iScroll.x,top:this.scrollview.iScroll.y}),e}return{left:0,top:0}},getCurrentPositionRate:function(){var e=0,t=0,i=this.getMoveRange(),n=this.getCurrentPosition();return i.x&&(e=-n.left/i.x),i.y&&(t=-n.top/i.y),{left:e,top:t}},getLayerContentSize:function(){var e=this.getdetail(),t={};if(!e.layer_ids||e.layer_ids.length>0){var i=_.map(e.layer_ids,function(e){return interaction_view.ilayerlist.get(e).toJSON()});return t.width=_.max(_.pluck(i,"layer_width")),t.height=_.max(_.pluck(i,"layer_height")),t}return null},stoplayer:function(){var e=this,t=this.getdetail();t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(t){e.model.layer[t].iAnimationlist.timeline&&e.model.layer[t].iAnimationlist.timeline.pause(0),e.model.layer[t].iAnimationlist.css_timeline&&e.model.layer[t].iAnimationlist.css_timeline.stop(),e.model.layer[t].iOverlaylist.resetViewStatus(),interaction_view.bezierPatch&&interaction_view.bezierPatch(e.model.layer[t])})},resetlayer:function(){var e=this,t=this.getdetail();t.layer_ids&&t.layer_ids.length>0&&(_.each(t.layer_ids,function(t){e.model.layer[t].iAnimationlist.resetAnimationStatus(),e.model.layer[t].iOverlaylist.resetViewStatus()}),!this.model.bindingfixed&&this.slideel&&this.slideel.attr("style",this.slidestyle),e.currentIndex=0)},resetOtherStatus:function(){this.resetlayer(),"LayerRef"==this.model.get("iType")&&this.renderMask()},onShow:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){i.model.layer[n].iOverlaylist.each(e&&t.layer_ids.indexOf(n)==e?function(e){e.iview.onShow()}:function(e){e.iview.onShow()})})},onBeforeHide:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e||i.model.layer[n].iOverlaylist.each(function(e){e.iview.onBeforeHide(),_.include(["RichText","Region"],e.get("iType"))&&e.iview.resetOtherStatus()})})},onHide:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e||i.model.layer[n].iOverlaylist.each(function(e){e.iview.onHide()})})},onSizeAdaptChange:function(){this.$el.children(".Element").children(".layer-mask").css({width:this.originWidth,height:this.originHeight})}})}),define("interaction_view/model/layerslide",["interaction_view/model/layerref"],function(){interaction_view.model.LayerSlide=interaction_view.model.LayerRef.extend({defaults:{iType:"LayerSlide",iCommon:null,iDetail:null,iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSlideNumber:!0,isSlide:!0,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setiview:function(){this.iview=new interaction_view.view.LayerSlide({model:this})}}),interaction_view.view.LayerSlide=interaction_view.view.LayerRef.extend({render:function(){var e=this,t=this.getdetail();this.currentSlideIndex=null,this.model.on("slideTo",function(i){if(console.log(i),null!=e.currentSlideIndex&&e.currentSlideIndex==i)return!1;if(null!=e.currentSlideIndex&&e.currentSlideIndex!=i){var n=t.layer_ids[e.currentSlideIndex];interaction_view.stopPlay(e.model.layer[n])}if(e.preloaded){var a=t.layer_ids[i];if(!e.model.layer[a])return;e.model.layer[a].isLayer=!0,interaction_view.play(e.model.layer[a]),e.currentSlideIndex=i,e.model.layer[a].playFinished=!0}}),this.model._reset=!0},playAnimation:function(){{var e=this,t=this.getdetail();t.iSlidetype}this.delay=Number(t.iInterval)||2,this.autoplay=t.iAutoplay;var i=t.iRepeat?-1:0;return this.iFade=t.iFade||0,this.iRewind=t.iRewind,this.timeline=new TimelineMax({paused:!0,repeat:i,onComplete:this.setRewind}),this.slideel=e.$el.children(".Element").find(".layer-content").first(),this.slidelength=t.layer_ids.length,this.slidelength<2?!1:(this.repeat=i,this.slipable=t.iSlipable,this.setTimeline(),this.autoplay?!this.timeline||this.$el.children(".Element").is(":hidden")&&!interaction_view.ismobile||this.timeline.play(0):this.setSlideDisplay(0),void(this.slipable?(this.control(),this.$el.addClass("hascontrols")):this.slideel&&this.slideel.on("click",function(){e.$el.children(".Element").trigger("click")})))},playLayer:function(){this.autoplay&&this.timeline&&!this.$el.children(".Element").is(":hidden")&&this.timeline.play(0),this.slidelength>0&&this.model.trigger("slideTo",0)},setTimeline:function(){if("Fade"==this.iFade)this.setFade();else if("Slip"==this.iFade)this.setSlip();else{if("None"!=this.iFade)return;this.setNone()}this.slideel.children().first().css({opacity:1,left:0,top:0}).nextAll().css("opacity",0)},getSlipeInterval:function(){},getLayerContentSize:function(){var e=this.getdetail(),t={};if(!e.layer_ids||e.layer_ids.length>0){var i=_.map(e.layer_ids,function(e){return interaction_view.ilayerlist.get(e).toJSON()});return t.width=_.max(_.pluck(i,"layer_width")),t.height=_.max(_.pluck(i,"layer_height")),t}return null},getStartPoint:function(){return this.delay+(this.delay+.500002)*this.delay},getEndPoint:function(e){return(this.delay+.500002)*e+1e-5},getCurrentIndex:function(e){var t=this.timeline.duration(),i=t/this.slidelength;return parseInt(e/i,10)},testControl:function(e){var t=$(e).closest(".iView");if(t.hasClass("hasaction"))return!1;if(t){var i=t.attr("data-type");return"Slide"!=i&&"CycleImage"!=i||!t.attr("data-iSlipable")?!0:!1}return!0},resetOtherStatus:function(){this.resetlayer();var e=this,t=this.getdetail();t.layer_ids&&0!=t.layer_ids.length&&(this.slideel.children().first().css({opacity:1,left:0,top:0}),this.autoplay=t.iAutoplay,e.currentIndex=0,e.currentSlideIndex=null,this.hasSlideNumber&&(this.setSlideNumberPosition(),this.changeSlideNumber()),this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY"),this.timeline&&(this.timeline.pause(1e-5),!this.autoplay||this.$el.children(".Element").is(":hidden")&&!interaction_view.ismobile?this.setSlideDisplay(0):this.timeline.play(0)))},getSlideLength:function(){var e=this.getdetail();return e.layer_ids?e.layer_ids.length:0}})}),define("interaction_view/model/binding",["interaction_view/model/base"],function(){interaction_view.model.Binding=interaction_view.model.Base.extend({defaults:{iType:"Binding",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Binding({model:this})},setsyncmodel:function(){}}),interaction_view.view.Binding=interaction_view.view.Base.extend({events:{},renderDynamicElement:function(){},render:function(){},preload:function(){},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);var n=this,a=this.getdetail();if(this.bindings=a.iBindings,this.bindings.length>1){{this.getControlBinding()}_.each(this.bindings,function(e){interaction_view.events.bindingEvents.push({id:e.id,page_id:e.page_id,direction:e.direction,func:function(e){n.executeBinding(n,e)}})})}this.preloaded=!0},getControlBinding:function(){return _.find(this.bindings,function(e){return e.isControl})?_.find(this.bindings,function(e){return e.isControl}):(this.bindings[0].isControl=!0,this.bindings[0])},getOperateBindings:function(){return _.reject(this.bindings,function(e){return e.isControl})},getBindingElement:function(e,t){var i;return i=interaction_view.getParentpage(e)?interaction_view.getParentpage(e):this.model.page,i.iOverlaylist.get(t)},getDirection:function(e,t){var i=this.getControlBinding();return t.id==i.id?e.direction?1:-1:e.id==i.id?t.direction?1:-1:t.direction==e.direction?1:-1},resetBindingStatus:function(){var e,t=this;_.each(this.bindings,function(i){var n=interaction_view.ipagelist.getElement(t.model.page,i.page_id,i.id);if(n)if(i.isControl)if("offset"==i.property){var a=n.iview.getCurrentPositionRate();interaction_view.events.onBingChangeTo({type:0,page_id:n.get("pageid"),id:n.id,delta:-1,deltarate:a.left,cdirection:0}),interaction_view.events.onBingChangeTo({type:0,page_id:n.get("pageid"),id:n.id,delta:-1,deltarate:a.top,cdirection:1})}else e=n.iview.singletime?n.iview.singletime:1e-5,interaction_view.events.onBingChangeTo({type:1,page_id:n.get("pageid"),id:n.id,delta:e/n.iview.timeline.duration(),reset:!0});else"offset"==i.property&&(n.bindingfixed=!0)})},executeBinding:function(e,t){_.each(this.bindings,function(i){if(i.id!=t.id){var n=e.getDirection(i,t),a=e.getBindingElement(i.page_id,i.id);if(a){var o=$.extend(!0,{},t);o.direction=n,o.delta=n*o.delta,o.deltarate=1==n?o.deltarate:e.getRevertRate(a,o.deltarate),o.revert=1==n?!1:!0,a.iview.onExecuteBinding(o)}}})},getRevertRate:function(e,t){if("LayerRef"==e.get("iType"))return 1-t;var i=(e.iview.slidelength,1-t);return i},resetStatus:function(){}})}),define("interaction_view/model/SubContainer",["interaction_view/model/base","interaction_view/view/subcontainer"],function(){interaction_view.model.SubContainer=interaction_view.model.Base.extend({defaults:{iType:"SubContainer",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.setSubOverlays(),this.patchGridSize(),this.setiview()},createPath:function(){var e=interaction_view.createPath({path:this.get("path"),isSubOverlay:this.get("isSubOverlay"),page_id:this.get("pageid"),model:this});return e},setiview:function(){this.iview=new interaction_view.view.SubContainer({model:this})},setsyncmodel:function(){},GridPatch:!0,patchGridSize:function(){if(this.GridPatch){var e=this.get("iCommon"),t=this.get("iDetail"),i=this.get("suboverlays");e[iPageDirection].iWidth=(t.iCols+1)*t.iColspace+i[0].iCommon[iPageDirection].iWidth*t.iCols,e[iPageDirection].iHeight=(t.iRows+1)*t.iRowspace+i[0].iCommon[iPageDirection].iHeight*t.iRows,this.set("iCommon",e)}},getSubOverlays:function(){var e=(this.get("iCommon"),this.get("iDetail")),t=[],n=this.get("suboverlays"),a=n[0],o=e.iRows,r=e.iCols;for(i=0;o>i;i++)for(j=0;r>j;j++)overlay=$.extend(!0,{},a),overlay.id=overlay.id+i+j,overlay.iCommon[iPageDirection].iStartx=e.iColspace*(j+1)+j*overlay.iCommon[iPageDirection].iWidth,overlay.iCommon[iPageDirection].iStarty=e.iRowspace*(i+1)+i*overlay.iCommon[iPageDirection].iHeight,t.push(overlay);return t},createImageSubOverlay:function(e){var t=(e.iFullview,{iType:"Image",iDetail:{iMask:!1,iFullview:e.iFullview,title:e.iImg[0].title,ratiofixxed:!1,iHidden:!1,iImg:e.iImg,iAdapt:!1,iDisplay:e.iDisplay||0},iCommon:{portait:{iWidth:e.iWidth,iHeight:e.iHeight,iStartx:e.iStartx,iStarty:e.iStarty},landscape:{iWidth:e.iWidth,iHeight:e.iHeight,iStartx:e.iStartx,iStarty:e.iStarty}},id:"Img"+_g.uuid(),iHidden:e.iHidden||!1,GalleryIndex:e.index});return t},GridReverse:function(){var e=this.get("iDetail");return e.iSlidetype?!1:!0},getOverlayPositionX:function(e,t,i,n){return this.GridReverse()?t*(i+1)+i*e.iCommon[iPageDirection].iWidth:t*(n+1)+n*e.iCommon[iPageDirection].iWidth},getOverlayPositionY:function(e,t,i,n){return this.GridReverse()?t*(n+1)+n*e.iCommon[iPageDirection].iHeight:t*(i+1)+i*e.iCommon[iPageDirection].iHeight}}),interaction_view.view.SubContainer=interaction_view.view.Base.extend({events:{},render:function(){this.renderBackGroud()},subPreLoadCheck:function(){},preload:function(){this.model.get("iDetail");this.sendToPreload({file:null,subcontainer:!0,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")})},afterSubOverlayPreload:function(){console.log("preloadok"),this.preloadmodel&&(this.model.iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.iActionlist.each(function(e){e.iview.render()}),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model)),interaction_view.ismobile&&_g.ui.isOverflowed(this.$el.children(".Element")).y&&this.$el.children(".Element").addClass("iMouseWheel disableMouseWheelY disableDragY"),this.otherAfterSubOverlayPreload&&this.otherAfterSubOverlayPreload()},allowScroll:!0,resetOtherStatus:function(){return this.allowScroll?void 0:!1}})}),define("interaction_view/model/gallery",["interaction_view/model/SubContainer"],function(){interaction_view.model.Gallery=interaction_view.model.SubContainer.extend({defaults:{iType:"Gallery",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSlideNumber:!0,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setiview:function(){this.iview=new interaction_view.view.Gallery({model:this})},getSubOverlays:function(){var e=this.get("iDetail"),t=this.get("iCommon"),n=[],a=this.get("suboverlays"),o=a[0],r=e.iRows,s=e.iCols;if(e.iMode||(e.iSlidetype?r=100:s=100),this.GridReverse()){var l=r;r=s,s=l}var c=0,d=0;if(e.iImg&&e.iImg.length){for(i=0;!(c>=e.iImg.length);i++){for(i==r&&(i=0,d+=1),j=0;s>j&&!(c>=e.iImg.length);j++){overlay=$.extend(!0,{},o),overlay.id=overlay.id+i+j+c,overlay.parent_index=d,overlay.suboverlays[0].iDetail.iText=interaction_view.formatLabel({text:_g.string.getUrlNameWithOutExt(e.iImg[c].title),font_size:overlay.suboverlays[0].iDetail.font_size,text_color:overlay.suboverlays[0].iDetail.text_color,iPosition:overlay.suboverlays[0].iDetail.iPosition}),void 0==e.show_title||e.show_title||overlay.suboverlays.shift();var h=this.createImageSubOverlay({iImg:[e.iImg[c]],iFullview:e.iFullscreen,iWidth:o.iCommon[iPageDirection].iWidth,iHeight:o.iCommon[iPageDirection].iHeight,iStartx:0,iStarty:0,iDisplay:Number(e.iDisplay),index:e.iSlipable?c:null});overlay.suboverlays.unshift(h),overlay.iCommon[iPageDirection].iStartx=this.getOverlayPositionX(overlay,e.iColspace,i,j),overlay.iCommon[iPageDirection].iStarty=this.getOverlayPositionY(overlay,e.iRowspace,i,j),overlay.iCommon[iPageDirection].iStartx>t[iPageDirection].iWidth&&(e.overflow_x=!0),overlay.iCommon[iPageDirection].iStarty>t[iPageDirection].iHeight&&(e.overflow_y=!0),n.push(overlay),c+=1}e.overflow_length=i+1}e.overflow_x&&(e.overflow_x=o.iCommon[iPageDirection].iWidth*e.overflow_length+e.iColspace*(e.overflow_length+1)),e.overflow_y&&(e.overflow_y=o.iCommon[iPageDirection].iHeight*e.overflow_length+e.iRowspace*(e.overflow_length+1)),d+=1}return e.slidelength=d,this.set("iDetail",e),n},patchGridSize:function(){if(this.GridPatch){var e=this.get("iCommon"),t=this.get("iDetail"),i=this.get("suboverlays");
(t.iMode||!t.iMode&&t.iSlidetype)&&(e[iPageDirection].iWidth=(t.iCols+1)*t.iColspace+i[0].iCommon[iPageDirection].iWidth*t.iCols),(t.iMode||!t.iMode&&!t.iSlidetype)&&(e[iPageDirection].iHeight=(t.iRows+1)*t.iRowspace+i[0].iCommon[iPageDirection].iHeight*t.iRows),this.set("iCommon",e)}}}),interaction_view.view.Gallery=interaction_view.view.SubContainer.extend({otherAfterSubOverlayPreload:function(){var e=this.getSlideLength(),t=this.getdetail(),n=t.iCols*t.iRows;if(t.iMode||(n=t.iImg?t.iImg.length:0),e){var a=this.$el.children(".Element").children().detach(),o=0;for(i=0;e>i;i++)for(this.$el.children(".Element").append('<div class="gallery-content" data-index="'+i+'"></div>'),j=0;n>j;j++){var r=this.$el.children(".Element").children().eq(i);r.append(a[o]),o+=1}this.setSlidePosition()}},getSlideLength:function(){var e=this.getdetail();return e.slidelength||0},setSlidePosition:function(){var e=this.getdetail(),t=this.getcommon();e.iMode?(this.$el.children(".Element").addClass("hasSlide"),this.$el.children(".Element").css({overflow:"hidden"}),this.$el.children(".Element").children().each(function(){$(this).index();$(this).css({position:"absolute",width:"100%",height:"100%"})}),this.playAnimation()):e.iSlidetype?(this.$el.children(".Element").css({overflow:"hidden"}),this.$el.children(".Element").children().each(function(){var e=$(this).index();$(this).css({position:"absolute",left:0,top:e*t.iHeight,width:"100%",height:"100%"})}),this.galleryFlow().y&&(this.$el.children(".Element").addClass("iMouseWheel disableMouseWheelY disableDragY"),this.scrollview=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,probeType:3,scrollX:!1,scrollY:!0,click:!0,wrapperWidth:t.iWidth,wrapperHeight:t.iHeight,scrollerWidth:t.iWidth,scrollerHeight:e.overflow_y}))):(this.$el.children(".Element").css({overflow:"hidden"}),this.$el.children(".Element").children().each(function(){var e=$(this).index();$(this).css({position:"absolute",left:e*t.iWidth,top:0,width:"100%",height:"100%"})}),this.galleryFlow().x&&(this.$el.children(".Element").addClass("iMouseWheel disableMouseWheelX disableDragX"),this.scrollview=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,probeType:3,scrollX:!0,scrollY:!1,click:!0,wrapperWidth:t.iWidth,wrapperHeight:t.iHeight,scrollerWidth:e.overflow_x,scrollerHeight:t.iHeight})))},playAnimation:function(){{var e=this,t=this.getdetail();t.iSlidetype}this.delay=Number(t.iInterval)||2,this.autoplay=t.iAutoplay,this.iFade="Slip";var i=0;this.timeline=new TimelineMax({paused:!0,repeat:i,onComplete:this.setRewind}),this.slideel=e.$el.children(".Element").first(),this.slidelength=this.getSlideLength(),this.repeat=i,this.iRewind=t.iRewind,this.slipable=!0,this.setTimeline(),this.autoplay?this.$el.children(".Element").is(":hidden")||this.timeline.play(0):this.setSlideDisplay(0),this.onChangeSlideTo(0),this.slipable&&(this.control(),this.autoplay||this.$el.attr("data-iSlipable",!0))},setTimeline:function(){if("Fade"==this.iFade)this.setFade();else if("Slip"==this.iFade)this.setSlip();else{if("None"!=this.iFade)return;this.setNone()}this.slideel.children().first().css({opacity:1,left:0,top:0}).nextAll().css("opacity",0)},testControl:function(){return!0},preview_left:function(e){e>0&&this.model.iOverlaylist.at(e-1).iOverlaylist.at(0).iview.$el.children(".Element").trigger("click")},preview_right:function(e){e<this.model.iOverlaylist.length-1&&this.model.iOverlaylist.at(e+1).iOverlaylist.at(0).iview.$el.children(".Element").trigger("click")},galleryFlow:function(){var e={x:!1,y:!1},t=(this.getcommon(),this.getdetail());return t.overflow_x&&(e.x=!0),t.overflow_y&&(e.y=!0),e},resetOtherStatus:function(){var e=this;return this.allowScroll?(this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY"),void("undefined"!=typeof wx_permissions&&wx_permissions.previewImage&&e.$el.find(".iImage.Element").click(function(){var t=e.$el.find(".iImage.Element").index($(this));e.fullviewIndex(t)}))):!1}})}),define("interaction_view/model/Grid",["interaction_view/model/gallery"],function(){interaction_view.model.Grid=interaction_view.model.Gallery.extend({defaults:{iType:"Grid",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},getSubOverlays:function(){var e=this.get("iDetail"),t=this.get("iCommon"),n=[],a=this.get("suboverlays"),o=a[0],r=e.iRows,s=e.iCols,l=0,c=0;for(i=0;r>i;i++)for(j=0;s>j;j++)overlay=$.extend(!0,{},o),overlay.id=overlay.id+i+j+l,overlay.parent_index=c,overlay.suboverlays=_.map(overlay.suboverlays,function(t){return("TextLabel"==t.iType||"BookButton"==t.iType)&&(t.iDetail.iText=interaction_view.formatLabel({text:t.iDetail.iText,font_size:t.iDetail.font_size,text_color:t.iDetail.text_color,iPosition:t.iDetail.iPosition,radius:t.iDetail.corner_radius,border_color:t.iDetail.border_color,bg_color:t.iDetail.bg_color,border_size:t.iDetail.border_size})),"Image"==t.iType&&(t.iDetail.iDisplay=e.iDisplay),t}),overlay.suboverlays=_.reject(overlay.suboverlays,function(t){return(e.show_title||"title"!=t.iDetail.iValue)&&(e.show_description||"description"!=t.iDetail.iValue)?void 0:!0}),overlay.iCommon[iPageDirection].iStartx=this.getOverlayPositionX(overlay,e.iColspace,i,j),overlay.iCommon[iPageDirection].iStarty=this.getOverlayPositionY(overlay,e.iRowspace,i,j),overlay.iCommon[iPageDirection].iStartx>t[iPageDirection].iWidth&&(e.overflow_x=!0),overlay.iCommon[iPageDirection].iStarty>t[iPageDirection].iHeight&&(e.overflow_y=!0),n.push(overlay),l+=1;return e.slidelength=c,this.set("iDetail",e),n},setiview:function(){this.iview=new interaction_view.view.Grid({model:this})}}),interaction_view.view.Grid=interaction_view.view.Gallery.extend({allowScroll:!1})}),define("interaction_view/model/Cell",["interaction_view/model/SubContainer"],function(){interaction_view.model.Cell=interaction_view.model.SubContainer.extend({defaults:{iType:"Cell",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null,isStatic:!0},setiview:function(){this.iview=new interaction_view.view.Cell({model:this})},GridPatch:!1,getSubOverlays:function(){var e=(this.get("iDetail"),this.get("suboverlays"));return e}}),interaction_view.view.Cell=interaction_view.view.SubContainer.extend({allowScroll:!1})}),define("interaction_view/model/TextLabel",["interaction_view/model/base"],function(){interaction_view.model.TextLabel=interaction_view.model.Base.extend({defaults:{iType:"TextLabel",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.TextLabel({model:this})},setsyncmodel:function(){}}),interaction_view.view.TextLabel=interaction_view.view.Base.extend({events:{},render:function(){this.model.get("iDetail")}})}),define("interaction_view/model/TabBar",["interaction_view/model/SubContainer"],function(){interaction_view.model.TabBar=interaction_view.model.SubContainer.extend({defaults:{iType:"TabBar",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setiview:function(){this.iview=new interaction_view.view.TabBar({model:this})},GridPatch:!1,getSubOverlays:function(){var e=(this.get("iDetail"),this.get("suboverlays"));return e=_.map(e,function(e){return e.isTabBarButton=!0,e})}}),interaction_view.view.TabBar=interaction_view.view.SubContainer.extend({allowScroll:!1})}),define("interaction_view/model/SearchInput",["interaction_view/model/base"],function(){interaction_view.model.SearchInput=interaction_view.model.Base.extend({defaults:{iType:"SearchInput",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.SearchInput({model:this})},setsyncmodel:function(){}}),interaction_view.view.SearchInput=interaction_view.view.Base.extend({events:{},render:function(){}})}),define("text!interaction_view/template/Tree_content.js",[],function(){return'<div class="treeview category-bookshelf inited">\n                <ul>\n                  <li>\n                    <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">ææ</a></h4></div>\n                  </li>\n                  <li>\n                    <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">æªåç±»</a></h4></div>\n                  </li>\n                  <li class="hasmenu unfold">\n                    <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">åç±» 1</a></h4><div class="hitarea"></div></div>\n                    <ul>\n                      <li class="active">\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;background:<%=iDetail.selected_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">åç±» 1.1</a></h4></div>\n                      </li>\n                      <li>\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="">åç±» 1.2</a></h4></div>\n                      </li>\n                      <li>\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">åç±» 1.3</a></h4></div>\n                      </li>\n                    </ul>\n                  </li>\n                  <li class="hasmenu unfold">\n                    <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">åç±» 2</a></h4><div class="hitarea"></div></div>\n                    <ul>\n                      <li>\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">åç±» 2.1</a></h4></div>\n                      </li>\n                      <li>\n                        <div class="wraparea" style="border-bottom: 1px solid <%=iDetail.line_color%>;"><h4><a href="#" style="color:<%=iDetail.text_color%>;">åç±» 2.2</a></h4></div>\n                      </li>\n                    </ul>\n                  </li>\n                </ul>\n              </div>'}),define("interaction_view/model/Tree",["interaction_view/model/base","text!interaction_view/template/Tree_content.js"],function(){var e=require("text!interaction_view/template/Tree_content.js");interaction_view.model.Tree=interaction_view.model.Base.extend({defaults:{iType:"Tree",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Tree({model:this})},setsyncmodel:function(){}}),interaction_view.view.Tree=interaction_view.view.Base.extend({events:{},render:function(){var t=this.getdetail();if(t.is_expandable){var i='<img src="'+t.iImg+'" width="41px" height="38px"><img>';this.$el.children(".Element").html(i)}else this.$el.children(".Element").html(_.template(e,this.model.toJSON()))}})}),define("interaction_view/model/PageIndex",["interaction_view/model/SubContainer"],function(){interaction_view.model.PageIndex=interaction_view.model.SubContainer.extend({defaults:{iType:"PageIndex",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setiview:function(){this.iview=new interaction_view.view.PageIndex({model:this})},getSubOverlays:function(){var e=this.get("iDetail"),t=this.get("iCommon"),n=[],a=this.get("suboverlays"),o=a[0],r=(e.iRows,e.iCols),s=0;if(this.indexpages=interaction_view.foredit?iPagelist.getIndexPages():interaction_view.ipagelist.getIndexPages(),this.indexpages.length){for(i=0;!(s>=this.indexpages.length);i++)for(j=0;r>j&&!(s>=this.indexpages.length);j++){overlay=$.extend(!0,{},o),overlay.id=overlay.id+i+j,overlay.suboverlays[1].iDetail.iText=interaction_view.formatLabel({text:this.indexpages[s].get("title"),font_size:overlay.suboverlays[1].iDetail.font_size,text_color:overlay.suboverlays[1].iDetail.text_color,iPosition:overlay.suboverlays[0].iDetail.iPosition});var l=this.indexpages[s].get("nav");overlay.suboverlays[0].iDetail.iImg=l&&l.thumbnail?[l]:[],overlay.suboverlays[0].iDetail.iDisplay=1,this.get("iDetail").show_thumb||overlay.suboverlays.shift(),this.get("iDetail").show_title||overlay.suboverlays.shift(),overlay.iCommon[iPageDirection].iStartx=e.iColspace*(j+1)+j*overlay.iCommon[iPageDirection].iWidth,overlay.iCommon[iPageDirection].iStarty=e.iRowspace*(i+1)+i*overlay.iCommon[iPageDirection].iHeight,n.push(overlay),s+=1}e.overflow_y=(this.indexpages.length+1)*e.iRowspace+overlay.iCommon[iPageDirection].iHeight*this.indexpages.length,e.overflow_y=e.overflow_y>t[iPageDirection].iHeight?e.overflow_y:null,this.set("iDetail",e,{silent:!0})}return n},patchGridSize:function(){if(this.GridPatch){var e=this.get("iCommon"),t=this.get("iDetail");t.iRows=this.indexpages.length;var i=this.get("suboverlays");e[iPageDirection].iWidth=(t.iCols+1)*t.iColspace+i[0].iCommon[iPageDirection].iWidth*t.iCols;{(t.iRows+1)*t.iRowspace+i[0].iCommon[iPageDirection].iHeight*t.iRows}this.set("iCommon",e),this.set("iDetail",t)}}}),interaction_view.view.PageIndex=interaction_view.view.SubContainer.extend({otherAfterSubOverlayPreload:function(){var e=this.model.indexpages;this.$el.children(".Element").find("[data-type=Cell]").each(function(){var t=e[$(this).index()].id;$(this).children(".Element").css({cursor:"pointer"}),interaction_view.foredit||$(this).children(".Element").on("click",function(){presentation.gotopage(t,9)})});var t=this.getdetail(),i=this.getcommon();t.overflow_y&&(this.$el.children(".Element").addClass("iMouseWheel disableMouseWheelY disableDragY"),this.$el.children(".Element").wrapInner('<div class="iContent"></div>'),this.scrollview=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,probeType:3,scrollX:!1,scrollY:!0,click:!0,wrapperWidth:i.iWidth,wrapperHeight:i.iHeight,scrollerWidth:i.iWidth,scrollerHeight:t.overflow_y}))}})}),define("text!interaction_view/template/offline_info.js",[],function(){return'<div class="offline-shadow" style="background: rgba(218,218,218,0.7);left:0;top:0;width:100%;height:100%;position:absolute;display: block;">\n <div class="offline-text" style="line-height:<%=iCommon[iPageDirection].iHeight%>px;text-align: center;">\n   <i class="icon-warning-sign icon-4x" style="display: inline-block;">\n    <br>\n    <span style="background: #444444;color: #FFFFFF;padding: 8px;font-size: 14px;">è¯·å¨èç½çç¶æä¸ä½¿ç¨</span>\n   </i>\n </div>\n</div>\n '}),define("interaction_view/model/webcontent",["interaction_view/model/base","text!interaction_view/template/offline_info.js"],function(){var e=require("text!interaction_view/template/offline_info.js");interaction_view.model.WebContent=interaction_view.model.Base.extend({defaults:{iType:"WebContent",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.WebContent({model:this})},setsyncmodel:function(){}}),interaction_view.view.WebContent=interaction_view.view.Base.extend({events:{},render:function(){this.model.renderWebContent=!0},renderWebContent:function(){var e=this,t=this.detail;if(!this.result){var i=this.result||interaction_view.getWebContentSrc(t);this.result=i}this.result&&(this.result.src||this.result.content)&&(this.iframeStyle?(this.$el.children(".Element").html("<iframe></iframe>"),this.$el.children(".Element").children("iframe").attr("style",this.iframeStyle)):this.iframeStyle=this.$el.children(".Element").children("iframe").attr("style"),i=this.result,i&&i.src?this.$el.children(".Element").children("iframe")[0].src=i.src:i&&i.content&&(this.hasContent=i.content,this.$el.children(".Element").children("iframe")[0].contentWindow.document.write(i.content)),t.iOnline&&(interaction_view.isOnline||(null==interaction_view.isOnline?_g.device.online("http://www.epub360.com/staticfs/diazo/img/favicon.png",function(){interaction_view.isOnline=!0},function(){interaction_view.isOnline=!1,e.renderOfflineInfo()}):e.renderOfflineInfo())))},renderOfflineInfo:function(){this.$el.children(".Element").append(_.template(e,this.model.toJSON()))},clearWebContent:function(){this.$el.children(".Element").children("iframe").remove()}})}),define("interaction_view/model/formview",["interaction_view/model/webcontent"],function(){interaction_view.model.FormView=interaction_view.model.WebContent.extend({defaults:{iType:"FormView",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.FormView({model:this})},setsyncmodel:function(){}}),interaction_view.view.FormView=interaction_view.view.Base.extend({resetOtherStatus:function(){},onSizeAdaptChange:function(){this.$el.children(".Element").children("iframe").css({width:this.originWidth,height:this.originHeight})},otherOnShow:function(){}})}),define("interaction_view/model/shape",["interaction_view/model/base"],function(){interaction_view.model.Shape=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Shape({model:this})},setsyncmodel:function(){}}),interaction_view.view.Shape=interaction_view.view.Base.extend({events:{},render:function(){var e=this.$el.find(".Element").width()+.5,t=this.$el.find(".Element").height()+.5;this.$el.find("svg").width(e),this.$el.find("svg").height(t)},resetOtherStatus:function(){},otherOnShow:function(){this.resetOtherStatus()}})}),define("interaction_view/model/BookButton",["interaction_view/model/TextLabel"],function(){interaction_view.model.BookButton=interaction_view.model.TextLabel.extend({defaults:{iType:"BookButton",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setiview:function(){this.iview=new interaction_view.view.BookButton({model:this})}}),interaction_view.view.BookButton=interaction_view.view.TextLabel.extend({allowScroll:!1})}),define("interaction_view/model/dragdrop",["interaction_view/model/base"],function(){interaction_view.model.DragDrop=interaction_view.model.Base.extend({defaults:{iType:"DragDrop",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.DragDrop({model:this})},setsyncmodel:function(){}}),interaction_view.view.DragDrop=interaction_view.view.Base.extend({events:{},render:function(){this.model._reset=!0},preload:function(){this.preloaded=!1,this.checkImglist=[];var e=this.getdetail(),t=[null,null];if(e.iconNormal&&e.iconNormal[0]){this.checkImglist.push(e.iconNormal[0].picture);var i=this.sendToPreload({file:e.iconNormal[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[0]=i.id}if(e.iconActive&&e.iconActive[0]){this.checkImglist.push(e.iconActive[0].picture);var i=this.sendToPreload({file:e.iconActive[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[1]=i.id}this.model.set("preload_id",t)},checkImgload:function(e){return this.checkImglist=_.reject(this.checkImglist,function(t){return t==e}),0==this.checkImglist.length?!0:!1},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.Status=0},changeStatus:function(e){var t=(this.getdetail(),this);"undefined"!=typeof e&&(t.active=e),t.active?(t.$el.find("img.iconActive").hide(),t.$el.find("img.iconNormal").show(),t.active=!1):(t.$el.find("img.iconActive").show(),t.$el.find("img.iconNormal").hide(),t.active=!0)},resetOtherStatus:function(){var e=this;e.resetButtonStatus(),e.DragDropGroups=[],$.each(e.model.page.iOverlaylist.where({iType:"DragDropGroup"}),function(t,i){_.include(i.iview.getdetail().element_ids,e.model.id)&&e.DragDropGroups.push(i)})},resetButtonStatus:function(){this.$el.find("img.iconActive").hide(),this.$el.find("img.iconNormal").show(),this.active=!1}})}),define("interaction_view/model/dragdropgroup",["interaction_view/model/base"],function(){interaction_view.model.DragDropGroup=interaction_view.model.Base.extend({defaults:{iType:"DragDropGroup",iVisibility:!0,iCommon:null,iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iOptions:{createfocus:!0},iParentModel:null,iDraggable:!1,iResizable:!1,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.DragDropGroup({model:this})},setsyncmodel:function(){}}),interaction_view.view.DragDropGroup=interaction_view.view.Base.extend({events:{},renderDynamicElement:function(){},render:function(){this.model._reset=!0},preload:function(){},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0}})}),define("interaction_view/model/variable",["interaction_view/model/base"],function(){interaction_view.model.Variable=interaction_view.model.Base.extend({defaults:{},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Variable({model:this})},setsyncmodel:function(){}}),interaction_view.view.Variable=interaction_view.view.Base.extend({events:{},resetOtherStatus:function(){this.showRandom(),this.updateText(this.origin,addtourl=0)},updateText:function(e,t){var i=this.getdetail();e&&(i.initial=e),this.isKindNum()&&(i.initial=(Number(i.initial)||0).toFixed(Number(i.precision)||0)),this.$el.find(".Element").html(i.initial),t&&this.addToUrl()},render:function(){var e=this.getdetail();this.iHorizontal=["left","center","right"],e.iEditable&&(e.initial=this.getFromUrl()),""!=$.trim(e.randlist)&&(e.randlist=_.compact(e.randlist.split(/[^0-9]/g))),this.isKindRandom()&&e.iRepeatable&&(this.Random={available:[],used:[]}),this.updateText("",addtourl=0),this.$el.find(".Element").css("font-size",e.font_size).css("color",e.font_color).css("text-align",this.iHorizontal[e.iPosition]),this.origin=e.initial,this.model._reset=!0},setVariable:function(e,t){var i=this,n=this.getdetail();if((!this.isKindText()||1!=e&&2!=e&&3!=e)&&!(this.isKindRandom()&&3!=e||!this.isKindRandom()&&3==e||this.isKindNum()&&"NaN"==Number(t).toString()&&!interaction_view.expression.isVar(t))){switch(e=Number(e),this.isKindNum()&&(n.initial=Number(n.initial)),e){case 0:n.initial=interaction_view.expression.id2values(t);break;case 1:n.initial+=interaction_view.expression.id2values(t);break;case 2:n.initial-=interaction_view.expression.id2values(t);break;case 3:this.setRandom()}i.updateText("",addtourl=0),i.triggerVarChange()}},triggerVarChange:function(){var e=this.getdetail();1==e.immediate&&interaction_view.events.onVariableChanged(this)},isKindNum:function(){var e=this.getdetail();return 0==e.iKind},isKindText:function(){var e=this.getdetail();return 1==e.iKind},isKindRandom:function(){var e=this.getdetail();return 2==e.iKind},showRandom:function(){this.isKindRandom()&&(this.origin=this.setRandom())},setRandom:function(){var e=this.getdetail();if(e.iRepeatable){this.isUseup(e);var t;do t=this.getRandom(e);while(_.contains(this.Random.used,t));this.Random.used.push(t),e.initial=t}else e.initial=this.getRandom(e);return e.initial},isUseup:function(e){(!e.randlist&&this.Random.used.length>=e.range[1]-e.range[0]+1||e.randlist&&this.Random.used.length>=e.randlist.length)&&(this.Random.used=[])},getRandom:function(e){return e.randlist?e.randlist[_.random(0,e.randlist.length-1)]:_.random(e.range[0],e.range[1])},getFromUrl:function(e){var t=_g.getUrlParameterByName(this.model.id,e);if(t||0==t||(t=_g.getHashParameterByName(this.model.id)),t||0==t||(t=this.getdetail().initial),"epub360"==epub360_domain&&""!=interaction_view.environment.Userdata.id)if(1==interaction_view.environment.Userdata.status)interaction_view.environment.Userdata.addView(this);else{var i=this.model.get("pageid"),n=interaction_view.environment.Userdata.getitem(i,this.model.id);n&&(t=n.value)}return t},addToUrl:function(e){var t=this.getdetail();if(!t.iEditable)return!1;if("undefined"==typeof message_link&&(message_link=document.location.href,interaction_view.weixin.share()),"undefined"==typeof e&&(e=t.initial),"epub360"==epub360_domain&&""!=interaction_view.environment.Userdata.id){{this.model.get("pageid")}return interaction_view.environment.Userdata.setitem(this,{value:e}),!0}return exist?!1:!0}})}),define("interaction_view/model/timer",["interaction_view/model/base"],function(){interaction_view.model.Timer=interaction_view.model.Base.extend({defaults:{},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Timer({model:this})},setsyncmodel:function(){}}),interaction_view.view.Timer=interaction_view.view.Base.extend({events:{},render:function(){var e=this.getdetail();this.iHorizontal=["left","center","right"],this.$el.find(".Element").css("font-size",e.font_size).css("color",e.font_color).css("text-align",this.iHorizontal[e.iPosition]),this.updateTimerDom(e.formatTime),this.model._reset=!0},resetOtherStatus:function(){var e=this.getdetail();this.clearTimer(),this.Interval=!1,this.Status=-1,this.Suspend=!1,this.frame=0==e.format||2==e.format?1:.01},startTimer:function(){if(1!=this.Status&&3!=this.Status){if(-1==this.Status)return void(this.Suspend=!0);var e=this,t=this.getdetail(),i=function(){e.updateTimer(),e.Actions_16.length&&interaction_view.events.onTimerCountTo(e),e.currentTime!=t.initial&&e.Actions_18.length&&interaction_view.events.onTimerInterval(e,e.currentTime-t.initial)},n=function(){if(e.Interval){if(e.currentTime<=0)return e.currentTime=0,e.updateTimer(),void e.stopTimer();e.currentTime-=e.frame,r(n,e.frame),i()}},a=function(){e.Interval&&(e.currentTime+=e.frame,r(a,e.frame),i())},o=function(){e.Interval=!0,1==t.iKind?n():a()},r=function(e,t){setTimeout(e,1e3*t)};r(o,e.frame),e.Actions_16.length&&interaction_view.events.onTimerCountTo(e),interaction_view.events.onTimerStart(this),this.Status=1}},stopTimerSimple:function(){return 2==this.Status||3==this.Status||-1==this.Status?!1:(this.clearTimer(),this.Status=2,!0)},stopTimer:function(){this.stopTimerSimple()&&(interaction_view.events.onTimerStop(this),this.Status=3)},resetTimer:function(){function e(e,i){return e.overlay_id!=t.model.id||e.type!=i?!1:t.model.page.isLayer?e.layer_id==t.model.page.iOverlaylist.layerid:e.page_id==t.model.page.id}var t=this,i=this.getdetail();this.clearTimer(),this.currentTime=i.initial=Number(Number(i.initial).toFixed(2)),this.Status=0,this.updateTimer(),this.gotTimerActions||(this.Actions_16=_.filter(interaction_view.events.timerEvents,function(t){return e(t,16)&&t.condition>=0}),this.Actions_18=_.filter(interaction_view.events.timerEvents,function(t){return e(t,18)&&t.condition>0}),this.Actions_17=_.filter(interaction_view.events.timerEvents,function(t){return e(t,17)}),this.Actions_19=_.filter(interaction_view.events.timerEvents,function(t){return e(t,19)}),t.Actions_18.forEach(function(e){e.condition=Number(Number(e.condition).toFixed(2))}),this.gotTimerActions=!0),(i.iAutoStart||this.Suspend)&&this.startTimer(),this.Suspend=!1},updateTimer:function(){var e=this.getdetail();e.formatTime=this.getFormatTime(this.currentTime,e.format),this.updateTimerDom(e.formatTime)},updateTimerDom:function(e){this.$el.find(".Element").html(e)},clearTimer:function(){this.Interval=!1},getFormatTime:function(e,t){var i,n,a,o;switch(e=Number(Number(e).toFixed(2)),0>=e?i=n=a=o=0:(i=Math.floor(e/3600),n=Math.floor((e-3600*i)/60),a=Math.floor(e-3600*i-60*n)),Number(t)){case 0:return(10>n?"0"+n:n)+":"+(10>a?"0"+a:a);case 1:return o=Math.round(100*(e-Math.floor(e))),(10>n?"0"+n:n)+":"+(10>a?"0"+a:a)+":"+(10>o?"0"+o:o);case 2:return(10>i?"0"+i:i)+":"+(10>n?"0"+n:n)+":"+(10>a?"0"+a:a);
case 3:return o=Math.round(100*(e-Math.floor(e))),(10>i?"0"+i:i)+":"+(10>n?"0"+n:n)+":"+(10>a?"0"+a:a)+":"+(10>o?"0"+o:o)}}})}),function(){var e={readCookie:function(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var a=i[n];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null},load:function(e,t){return _g.ajax.get(e,t)},get:function(e,t){var i={url:null,dataType:"JSON",staticUrl:null,callback:null,parseData:null,debug:!1,name:null,retry:!1,retrydelay:0};"string"==typeof e?(i.url=e,i.callback=t,e=i):e=e?$.extend(!0,{},i,e):$.extend(!0,{},i),_g.debug&&_g.debug.enabled&&(e.name||(e.name=e.url),_g.debug.data[e.name]={});var n="undefined"!=typeof _gDebug&&_gDebug||e.debug,a=n?_g.debug&&_g.debug.query_user_data(e.name)?_g.debug.query_user_data(e.name):e.staticUrl||e.url:e.url;if(!a)return!1;var o=$.ajax({url:a,type:"GET",data:"",dataType:e.dataType,beforeSend:e.beforeSend,success:function(t){_g.debug&&_g.debug.enabled&&(_g.debug.data[e.name].data=$.extend(!0,{},t)),n&&e.parseData&&(t=e.parseData(t)),e.callback&&e.callback(t)},error:function(){_g.error.serverError(),e.onError&&e.onError(0)},timeout:1e5});return o},post:function(e,t,i){var n={url:null,data:null,dataType:"JSON",staticUrl:null,callback:null,debug:!1,name:null,retry:!1,retrydelay:0,type:"POST"};"string"==typeof e?(n.url=e,n.callback=i,n.data=t,e=n):e=e?$.extend(!0,{},n,e):$.extend(!0,{},n),_g.debug&&_g.debug.enabled&&(e.name||(e.name=e.url),_g.debug.data[e.name]={}),e.type=e.type||"POST";var a="undefined"!=typeof _gDebug&&_gDebug||e.debug,o=a?_g.debug&&_g.debug.query_user_data(e.name)?_g.debug.query_user_data(e.name):e.staticUrl||e.url:e.url;if(!o)return!1;var r=$.ajax({url:o,type:a?"GET":e.type,data:e.data,dataType:e.dataType,traditional:e.traditional,beforeSend:e.beforeSend,success:function(t){_g.debug&&_g.debug.enabled&&(_g.debug.data[e.name].data=$.extend(!0,{},t)),e.callback&&e.callback(t)},error:function(){_g.error.serverError(e.name),e.onError&&e.onError(0)},timeout:1e5});return r},"delete":function(e,t){var i={url:null,data:null,dataType:"JSON",staticUrl:null,callback:null,debug:!1,name:null,retry:!1,retrydelay:0},n={};"string"==typeof e?(i.url=e,i.callback=t,i.data=n,e=i):e=e?$.extend(!0,{},i,e):$.extend(!0,{},i),_g.debug&&_g.debug.enabled&&(e.name||(e.name=e.url),_g.debug.data[e.name]={});var a="undefined"!=typeof _gDebug&&_gDebug||e.debug,o=a?_g.debug&&_g.debug.query_user_data(e.name)?_g.debug.query_user_data(e.name):e.staticUrl||e.url:e.url;if(!o)return!1;var r=$.ajax({url:o,type:"DELETE",data:e.data,dataType:e.dataType,traditional:e.traditional,beforeSend:e.beforeSend,success:function(t){_g.debug&&_g.debug.enabled&&(_g.debug.data[e.name].data=$.extend(!0,{},t)),e.callback&&e.callback(t)},error:function(){_g.error.serverError(e.name),e.onError&&e.onError(0)},timeout:1e5});return r},dataGenerate:function(e){var t={dataSource:null,map:null,key:null,count:0};if(e=e?$.extend(!0,{},t,e):$.extend(!0,{},t),!e.dataSource||!e.map)return e.dataSource;var n=e.key?e.dataSource[e.key]:e.dataSource;if(!n[0])return e.dataSource;for(i=0;i<e.count;i++){var a={},o=n[0];_.each(o,function(t,i){var n;if(e.map[i]){switch(e.map[i]){case"uuid":n=_g.uuid();break;case"randompick":n=_g.array.randomPick(o[i]);break;case"string":n=_g.string.randomGenerate(10);break;case"number":n=_g.number.randomInt();break;case"boolean":n=_g.boolean.randomPick();break;default:n=o[i]}a[i]=n}else a[i]=o[i]}),n.push(a)}return n.shift(),e.key?e.dataSource[e.key]=n:e.dataSource=n,e.dataSource},testSpeed:function(e){function t(){{var e=(a-n)/1e3,t=8*r,i=(t/e).toFixed(2),o=(i/1024).toFixed(2);(o/1024).toFixed(2)}}var i={file:null,fileSize:0,callback:null};if(e=e?$.extend(!0,{},i,e):$.extend(!0,{},i),!e.file)return!1;var n,a,o=e.file+"?n="+Math.random(),r=e.fileSize,s=new Image;s.onload=function(){a=(new Date).getTime(),t()},n=(new Date).getTime(),s.src=o}};"undefined"==typeof require?(window._g||(window._g={}),window._g.ajax=e,e=void 0):define("_g/ajax",["jquery","_g/base","_g/error"],function(){return window._g.ajax=e,e=void 0,window._g.ajax})}(window),define("interaction_view/model/vote",["_g/ajax","interaction_view/model/base"],function(){interaction_view.model.Vote=interaction_view.model.Base.extend({defaults:{iType:"Vote",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.get("iDetail");this.setSubOverlays(),this.iview=new interaction_view.view.Vote({model:this})},setsyncmodel:function(){}}),interaction_view.view.Vote=interaction_view.view.Base.extend({events:{},getInitialValue:function(){return parseInt(this.model.get("iDetail").initial)||0},render:function(){var e=this;this.voteUrl||(this.voteUrl=encodeURI(context_url+this.model.iPageId+"/vote/"+e.model.id+"/")),this.noVoted()&&(this.waitForVoted=!0,this.$el.hide()),this.$el.addClass("hasaction"),this.resetOtherStatus(),interaction_view.environment.Votes.add(this.model)},preload:function(){this.preloaded=!1,this.checkImglist=[];var e=this.getdetail(),t=[null,null];if(e.iconNormal&&e.iconNormal[0]){this.checkImglist.push(e.iconNormal[0].picture);var i=this.sendToPreload({file:e.iconNormal[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[0]=i.id}if(e.iconActive&&e.iconActive[0]){this.checkImglist.push(e.iconActive[0].picture);var i=this.sendToPreload({file:e.iconActive[0].picture,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")});t[1]=i.id}this.sendToPreload({file:null,subcontainer:!0,path:this.model.get("path"),isSubOverlay:this.model.get("isSubOverlay")}),this.model.set("preload_id",t)},checkImgload:function(e){return this.checkImglist=_.reject(this.checkImglist,function(t){return t==e}),0==this.checkImglist.length?!0:!1},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.$el.css("cursor","pointer")},bindClick:function(){var e=this;e.vote||(e.vote=function(){e.model.get("suboverlays")[0].iDetail.iValue+=1,e.changeStatus(),_g.ajax.post({dataType:"JSON",url:e.voteUrl,data:{value:1},callback:function(t){var i=e.getInitialValue();t.num_votes&&(e.model.get("suboverlays")[0].iDetail.iValue=t.num_votes+i,interaction_view.environment.Votes.update(e.model),e.model.set("value",t.num_votes+i),e.model.set("voted",1),e.model.set("position",t.position+i),e.changeStatus())}})});var t="tap";this.isVoted()?this.$el.hammer().off(t,e.vote):(this.binded||this.$el.hammer().one(t,e.vote),this.binded=!0)},changeStatus:function(){this.waitForVoted||(this.$el.show(),this.isVoted()?(this.$el.find("img.iconActive").show(),this.$el.find("img.iconNormal").hide(),this.active=!0):(this.$el.find("img.iconActive").hide(),this.$el.find("img.iconNormal").show(),this.active=!1)),this.setTitle()},resetOtherStatus:function(){var e=this;this.isVoted()&&this.$el.show(),_g.ajax.get({dataType:"JSON",url:e.voteUrl,callback:function(t){e.waitForVoted=!1;var i=e.getInitialValue();t.num_votes?(e.model.get("suboverlays")[0].iDetail.iValue=t.num_votes+i,e.model.set("value",t.num_votes+i),e.model.set("voted",t.vote_value),e.model.set("position",t.position+i)):(e.model.get("suboverlays")[0].iDetail.iValue=i,e.model.set("value",i),e.model.set("voted",0),e.model.set("position",i)),e.bindClick(),e.changeStatus(),e.waitForVoted2&&(e.triggerVoted(),e.waitForVoted2=!1)}})},triggerVoted:function(){this.noVoted()?this.waitForVoted2=!0:this.isVoted()&&interaction_view.events.onVoted(this)},setTitle:function(){var e=(this.getdetail(),this.model.get("suboverlays")),t=e[0].iDetail.iValue,i=interaction_view.formatLabel({text:"Jason"==t?"Name":t,font_size:e[0].iDetail.font_size,text_color:e[0].iDetail.text_color,iPosition:e[0].iDetail.iPosition});this.$el.find(".iTextLabel.Element").html(i)},afterSubOverlayPreload:function(){this.preloadmodel&&(this.model.iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.iActionlist.each(function(e){e.iview.render()}),this.setTitle(),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model))},isVoted:function(){return this.model.get("voted")},noVoted:function(){return"undefined"==typeof this.model.get("voted")}})}),define("text!interaction_view/template/prompt.js",[],function(){return'<div class="<%=class_name%>" style="display:none;">\n	<div class="modalArea" style="position: fixed;top: 50%;left: 50%;z-index: 10003;background: white;box-shadow: 0 0 60px rgba(0, 0, 0, .25); width: 480px;height: 235px; margin-left: -240px;margin-top: -120px;text-align: center;">\n		<div class="alert" style="text-align:left; margin-bottom: 0px;">è¾å¥æå­ :</div>\n		<div style="padding: 10px 10px 10px;">\n			<textarea style="resize: none; width: 96%;height: 120px;border: 0px;" autofocus="autofocus"></textarea>\n			<div style="margin: 10px;">\n				<button type="button" style="margin-right: 40px;border-radius: 18px 18px;padding: 7px 28px;" class="btn btn-default cancel">åæ¶</button>\n				<button type="button" style="border-radius: 18px 18px;padding: 7px 28px;" class="btn btn-danger ok">ç¡®è®¤</button>\n			</div>\n		</div>\n	</div>\n	<div class="modal-backdrop fade in" style="z-index: 10002;"></div>\n</div>'}),define("interaction_view/model/paragraph",["interaction_view/model/base","text!interaction_view/template/prompt.js"],function(){var e=require("text!interaction_view/template/prompt.js");interaction_view.model.Paragraph=interaction_view.model.Base.extend({defaults:{iType:"Paragraph",iLock:!0,iVisibility:!0,iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{iAdapt:!1,iFullview:!1,iImg:null,iAnimation:[]},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Paragraph({model:this})},setsyncmodel:function(){}}),interaction_view.view.Paragraph=interaction_view.view.Base.extend({events:{},render:function(){if(this.scrollEl=this.$el.children(".Element"),this.textel=this.$el.find(".iText"),this.originContent=this.model.attributes.iDetail.iText,"undefined"==typeof this.userContent&&(this.userContent=this.originContent),"undefined"==typeof message_link&&(message_link=location.href,interaction_view.weixin.share()),this.model.attributes.iDetail.iEditable){var e=this.model.attributes.iDetail.iEditable?message_link:data_link,t=_g.getUrlParameterByName(this.model.id,e);if(null==t&&(t=_g.getHashParameterByName(this.model.id)),null==t&&"epub360"==epub360_domain&&""!=interaction_view.environment.Sharedata.id)if(1==interaction_view.environment.Sharedata.status)interaction_view.environment.Sharedata.addView(this);else{var i=this.model.get("pageid"),n=interaction_view.environment.Sharedata.getitem(i,this.model.id);n&&(t=n.iText)}t&&this.updateText(t,addtourl=0)}this.renderEdit(),this.model.attributes.iDetail.iEditable&&this.$el.find(".iParagraph").addClass("editable"),this.renderlink&&this.renderlink(),this.model._reset=!0},resetOtherStatus:function(){var e=this;if(this.$el.children(".Element").find(".paragraph").length){if(this.$el.children(".Element").find(".paragraph").first().children("div").length&&_g.ui.isOverflowed(this.$el.children(".Element").find(".paragraph").first().children("div")).y){if(!this.$el.children(".Element").hasClass("disableDragY")){var t=this.$el.find(".paragraph").first().children("div"),i=t.height();t.wrapInner('<div class="iContent" style="font-size: inherit;color: inherit;font-family: inherit;font-weight:inherit;"></div>');var n=_g.ui.isOverflowed(t).y-i;this.scrollView=new IScroll(t[0],{mouseWheel:!0,click:!0,probeType:3,wrapperHeight:i,HWCompositing:!1}),this.scrollView.on("scroll",function(){console.log(this.y),n&&n>0&&(this.y>0?this.y>30&&e.scrollEl.addClass("is_exceededY"):Math.abs(this.y)-n>30&&e.scrollEl.addClass("is_exceededY"))}),this.scrollEl=this.$el.children(".Element"),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY")}this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY")}}else if(_g.ui.isOverflowed(this.$el.children(".Element")).y){if(!this.$el.children(".Element").hasClass("disableDragY")){var i=this.$el.children(".Element").height();this.$el.children(".Element").wrapInner('<div class="iContent"></div>');var n=_g.ui.isOverflowed(this.$el.children(".Element")).y-i;this.scrollView=new IScroll(this.$el.children(".Element")[0],{mouseWheel:!0,click:!0,probeType:3}),this.scrollView.on("scroll",function(){console.log(this.y),n&&n>0&&(this.y>0?this.y>30&&e.scrollEl.addClass("is_exceededY"):Math.abs(this.y)-n>30&&e.scrollEl.addClass("is_exceededY"))}),this.scrollEl=this.$el.children(".Element"),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY")}this.$el.children(".Element").removeClass("is_exceededX"),this.$el.children(".Element").removeClass("is_exceededY")}},otherOnShow:function(){this.resetOtherStatus()},renderEdit:function(){var t=this,i=this.getdetail();if(!i.iStaticImage&&i.iEditable){var n="ParagraphInput",a=_.template(e,{class_name:n});t.activeEdit=function(e){if(interaction_view.environment.Paragraph.state()||e){var i=$("."+n);i.length||(i=$(a).appendTo("body")),i.show().attr("paragraph-id",t.model.id);var o=i.find(".modalArea");interaction_view.ismobile&&o.width($(document).width()),_g.ui.center({Item:o}),i.find("button.cancel").one("click",function(){i.remove()}),i.find("button.ok").one("click",function(){i.attr("paragraph-id")==t.model.id&&(i.remove(),t.updateText("<div>"+i.find("textarea").val().replace(/\n/g,"</div><div>")+"</div>",addtourl=1))}),i.find("textarea").val(t.userContent.replace(/<br>/g,"\n").replace(/<\/div><div>/g,"\n").replace("<div>","").replace("</div>",""));var r=function(){i.find("textarea").focus().click(function(){$(this).focus()})};setTimeout(r,300)}},t.$el.on("click",function(){t.activeEdit()})}},updateText:function(e,t){if("undefined"!=typeof e){e=""+e,this.userContent=e;var i=e.replace(/<div>/g,"(div)").replace(/<\/div>/g,"(/div)");i=_g.util.htmlspecialchars(i);var n=i.replace(/\(div\)/g,"<div>").replace(/\(\/div\)/g,"</div>");this.textel.html(n);var a=!1;t&&(this.addToUrl(e),a=!0),this.model.attributes.iDetail.iText=n,this.resetOtherStatus(),a&&interaction_view.events.onParagraphChanged(this)}},addToUrl:function(e){var t=this.model.id+"="+encodeURI(e),i=this.model.attributes.iDetail.iEditable?message_link:data_link,n=_g.getUrlParameterByName(this.model.id,i),a=0;if(n)encodeURI(n)!=encodeURI(e)?i=_g.replaceUrlParameterByName(this.model.id,t,i):a=1;else{var o="?";i.indexOf("?")>=0&&(o="&"),i+=o+t}if("epub360"==epub360_domain&&!a&&interaction_view.environment.Sharedata.enabled&&interaction_view.environment.Sharedata.setitem(this,{iText:e}),a||(this.model.attributes.iDetail.iEditable?(message_link=i,interaction_view.weixin.share()):data_link=i),!interaction_view.forpreview&&!interaction_view.weixin.shareable()&&this.model.attributes.iDetail.iEditable){var r=_g.getHashParameterByName(this.model.id);r?encodeURI(r)!=encodeURI(e)?window.history.replaceState({},"",_g.replaceHashParameterByName(this.model.id,t)):a=1:window.history&&(document.location.hash?window.history.replaceState({},"",document.location.hash+="&"+t):window.history.replaceState({},"","#"+t))}return a?!1:!0}})}),define("interaction_view/model/input",["interaction_view/model/base"],function(){interaction_view.model.Input=interaction_view.model.Base.extend({defaults:{iType:"Input",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Input({model:this})},setsyncmodel:function(){}}),interaction_view.view.Input=interaction_view.view.Base.extend({events:{},render:function(){var e=this;this.$el.find("input").on("input",function(){console.log($(this).val()),interaction_view.events.onFormEvent(e.model,$(this).val())});var t=interaction_view.events.onFormButtonRender(this.model);t.value&&this.$el.find("input").val(t.value),this.setFormFieldType(t.field)},resetOtherStatus:function(){var e=interaction_view.events.onFormButtonRender(this.model);e.value&&this.$el.find("input").val(e.value)},setFormFieldType:function(e){if(e&&interaction_view.ismobile){var t="text";console.log(e);var i=e.i.field_type;"number"==i&&(t="number"),"email"==i&&(t="email"),"url"==i&&(t="url"),"text"!=t&&this.$el.find("input")[0].setAttribute("type",t)}}})}),define("interaction_view/model/textarea",["interaction_view/model/base"],function(){interaction_view.model.Textarea=interaction_view.model.Base.extend({defaults:{iType:"Textarea",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Textarea({model:this})},setsyncmodel:function(){}}),interaction_view.view.Textarea=interaction_view.view.Base.extend({events:{},render:function(){var e=this;this.$el.find("textarea").on("input",function(){console.log($(this).val()),interaction_view.events.onFormEvent(e.model,$(this).val())});var t=interaction_view.events.onFormButtonRender(this.model);t.value&&this.$el.find("textarea").html(t),this.model._reset=!0},resetOtherStatus:function(){var e=interaction_view.events.onFormButtonRender(this.model);e.value&&this.$el.find("textarea").html(e)}})}),define("interaction_view/model/selectbutton",["interaction_view/model/button"],function(){interaction_view.model.SelectButton=interaction_view.model.Button.extend({defaults:{iType:"SelectButton",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setview:function(){var e=this.get("iDetail");e.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.SelectButton({model:this})}}),interaction_view.view.SelectButton=interaction_view.view.Button.extend({events:{},render:function(){var e=interaction_view.events.onFormButtonRender(this.model);e.value&&this.setActiveStatus()},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");var t=this.getdetail();if(t.isSwitch)this.$el.on("click",function(){e.changeStatus()});else{if(interaction_view.ismobile)var i="touchstart",n="touchend";else var i="mousedown",n="mouseup";this.$el.on(i,function(){e.buttonon=!0,e.changeStatus()}),this.$el.on(n,function(){e.buttonon&&(e.buttonon=!1,e.changeStatus())})}},changeStatus:function(){var e=this.getdetail(),t=this;if(t.active){if(t.groupcontrol&&e.isSwitch)return;if(interaction_view.application.isBindingButton(t.model))return;if(t.model.get("isTabBarSelectButton"))return;t.$el.find("img.iconActive").hide(),t.$el.find("img.iconNormal").show(),t.active=!1,interaction_view.events.onFormEvent(t.model,t.active)}else t.$el.find("img.iconActive").show(),t.$el.find("img.iconNormal").hide(),t.active=!0,e.isSwitch&&interaction_view.events.onFormEvent(t.model,t.active)},resetOtherStatus:function(){this.resetButtonStatus()},resetButtonStatus:function(){this.$el.find("img.iconActive").hide(),this.$el.find("img.iconNormal").show(),this.active=!1;var e=interaction_view.events.onFormButtonRender(this.model);e.value&&this.setActiveStatus()}})}),define("interaction_view/model/submitbutton",["interaction_view/model/button"],function(){interaction_view.model.SubmitButton=interaction_view.model.Button.extend({defaults:{iType:"SubmitButton",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0},setview:function(){var e=this.get("iDetail");e.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.SubmitButton({model:this})}}),interaction_view.view.SubmitButton=interaction_view.view.Button.extend({events:{},render:function(){},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");var t=this.getdetail();if(t.isSwitch)this.$el.on("click",function(){e.changeStatus(),interaction_view.events.onFormEvent(e.model)});else{if(interaction_view.ismobile)var i="touchstart",n="touchend";else var i="mousedown",n="mouseup";this.$el.on(i,function(){e.buttonon=!0,e.changeStatus()}),this.$el.on(n,function(){e.buttonon&&(e.buttonon=!1,e.changeStatus(),window.setTimeout(function(){interaction_view.events.onFormEvent(e.model)},500))})}},changeStatus:function(){var e=this.getdetail(),t=this;if(t.active){if(t.groupcontrol&&e.isSwitch)return;if(t.model.get("isTabBarSubmitButton"))return;t.$el.find("img.iconActive").hide(),t.$el.find("img.iconNormal").show(),t.active=!1}else t.$el.find("img.iconActive").show(),t.$el.find("img.iconNormal").hide(),t.active=!0},resetOtherStatus:function(){this.resetSubmitButtonStatus()},resetSubmitButtonStatus:function(){this.$el.find("img.iconActive").hide(),this.$el.find("img.iconNormal").show(),this.active=!1}})}),define("interaction_view/model/selectbox",["interaction_view/model/base"],function(){interaction_view.model.SelectBox=interaction_view.model.Base.extend({defaults:{iType:"SelectBox",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iParent:"",iChild:"",iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,iAutofocus:!1,iKeyscontrol:!0,callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.SelectBox({model:this})},setsyncmodel:function(){}}),interaction_view.view.SelectBox=interaction_view.view.Base.extend({events:{},render:function(){var e=this;this.$el.find("input").on("change",function(){var t=$(this).is(":checked");if(interaction_view.events.onFormEvent(e.model,t),$(this).closest(".layer-mask").length){var i=this;setTimeout(function(){t?$(i).attr("checked","checked"):$(i).removeAttr("checked")},100)}});var t=interaction_view.events.onFormButtonRender(this.model);t.value&&this.$el.find("input").attr("checked","checked"),null!=t.field&&"radio"==t.field.i.field_type&&this.$el.find("input")[0].setAttribute("type","radio")},resetOtherStatus:function(){this.resetButtonStatus()},resetButtonStatus:function(){interaction_view.application.isBindingButton(this.model)&&(this.isRadio=!0,this.$el.find("input")[0].setAttribute("type","radio"));var e=interaction_view.events.onFormButtonRender(this.model);e.value?this.$el.find("input").attr("checked","checked"):this.$el.find("input").removeAttr("checked")}})}),define("interaction_view/model/imageblock",["interaction_view/model/image"],function(){interaction_view.model.ImageBlock=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.ImageBlock({model:this})},setsyncmodel:function(){}}),interaction_view.view.ImageBlock=interaction_view.view.Base.extend({render:function(){this.renderMask(),this.renderDraggable(),this.firstRender=!0,this.isEraserSet=!1,this.renderEdit();var e=this.$el.find(".Element");e.css("-moz-border-radius-topleft",e.css("border-top-left-radius")),e.css("-moz-border-radius-topright",e.css("border-top-right-radius")),e.css("-moz-border-radius-bottomleft",e.css("border-bottom-left-radius")),e.css("-moz-border-radius-bottomright",e.css("border-bottom-right-radius")),e.css("-webkit-border-top-left-radius",e.css("border-top-left-radius")),e.css("-webkit-border-top-right-radius",e.css("border-top-right-radius")),e.css("-webkit-border-bottom-left-radius",e.css("border-bottom-left-radius")),e.css("-webkit-border-bottom-right-radius",e.css("border-bottom-right-radius"));var t=this.getdetail();void 0!=t.linktype&&e.on("click",function(){interaction_view.renderLink(t.linktype,t)})},getArgs:function(){var e=this,t=this.getdetail();if(t.iEditable){var i=e.getFromUrl().split(",");if(i.length<5)return;t.iImg[0].picture=i[0]||t.iImg[0].picture,e.args=i,e.model._rotate=i[4],e.model._scale=i[3],e.model._x=i[1],e.model._y=i[2]}},preload:function(){this.getArgs()},setOtherDisplay:function(){var e=this.getdetail(),t=this.$el.children(".Element").find("img").first();if(this.args){this.$el.find("img").attr("src")!=this.args[0]&&this.$el.find("img").attr("src",this.args[0]);var i=this.args[4],n=this.args[3],a=this.args[1],o=this.args[2],r="rotate("+i+"deg) scale("+n+") skew(0deg) translate("+a+"px ,"+o+"px)";return t.css({"-webkit-transform":r,width:"100%",height:"auto"}),void t.parent().css({overflow:"hidden"})}var e=this.getdetail();e.iImg&&e.iImg.length>0&&e.iMask&&e.iMask_data.iSlipable&&(this.renderMask(),this.setMaskSlipable({items:this.$el.children(".Element").find("img").first(),containment:this.$el.children(".Element").children(),contentel:this.$el.children(".Element").find("img").first(),content_x:e.iMask_data.x,content_y:e.iMask_data.y})),e.iDisplay&&e.iImg&&e.iImg.length>0&&_g.ui.fitImage(this.$el.children(".Element").find("img").length?{fit:Number(e.iDisplay),width:e.iImg[0].width,height:e.iImg[0].height,items:this.$el.children(".Element").find("img"),parentHeight:parseInt(this.$el.children(".Element").css("height")),parentWidth:parseInt(this.$el.children(".Element").css("width"))}:{fit:Number(e.iDisplay),containment:this.$el.children(".Element").find(".image_wrap").first()}),e.iFullview&&this.fullview(),e.iEraser&&(this.model._reset=!0,this.el_str=this.$el.children(".Element").html(),this.setEraser())},getFromUrl:function(){var e=_g.getUrlParameterByName(this.model.id,message_link);if(e||(e=_g.getHashParameterByName(this.model.id)),null==e&&"epub360"==epub360_domain&&""!=interaction_view.environment.Sharedata.id)if(1==interaction_view.environment.Sharedata.status)interaction_view.environment.Sharedata.addView(this);else{var t=this.model.get("pageid"),i=interaction_view.environment.Sharedata.getitem(t,this.model.id);i&&(e=i.value)}return decodeURI(e||"")},removeFromUrl:function(){var e=_g.getUrlParameterByName(this.model.id,message_link);e&&(message_link=_g.replaceUrlParameterByName(this.model.id,"",message_link),message_link=message_link.replace("&&","&").replace("?&","?"),interaction_view.weixin.share());var t=_g.getHashParameterByName(this.model.id);if(t){var i=_g.replaceHashParameterByName(this.model.id,"");window.history.replaceState({},"",i.replace("#&","#").replace("&&","&"))}return e||t?!0:!1},addToUrl:function(e,t,i,n,a){var o=this.getdetail(),r=(e==o.iImg[0].origin?"":e)+","+t+","+i+","+n+","+a,s=this.model.id+"="+encodeURI(r),l=_g.getUrlParameterByName(this.model.id,message_link),c=0,d=message_link;if(l)encodeURI(l)!=encodeURI(s)?d=_g.replaceUrlParameterByName(this.model.id,s,message_link):c=1;else{var h="?";message_link.indexOf("?")>=0&&(h="&"),d+=h+s}if("epub360"==epub360_domain&&!c&&interaction_view.environment.Sharedata.enabled&&interaction_view.environment.Sharedata.setitem(this,{value:encodeURI(r)}),c||this.model.attributes.iDetail.iEditable&&(message_link=d,interaction_view.weixin.share()),!interaction_view.forpreview){var u=_g.getHashParameterByName(this.model.id);u?encodeURI(u)!=encodeURI(s)?window.history.replaceState({},"",_g.replaceHashParameterByName(this.model.id,s)):c=1:window.history&&(document.location.hash?window.history.replaceState({},"",document.location.hash+="&"+s):window.history.replaceState({},"","#"+s))}return c?!1:!0},renderMask:function(){var e=this.getdetail();e.iMask&&(this.$el.children(".Element").find("img").first().css({translate:[e.iMask_data.x,e.iMask_data.y]}),this.iScrollview&&this.iScrollview.scrollTo(e.iMask_data.x,e.iMask_data.y))},renderEdit:function(){var e=this,t=this.getdetail();t.iEditable&&(e.activeEdit=function(t){(interaction_view.environment.Paragraph.state()||t)&&"undefined"!=typeof wx_permissions&&wx_permissions.chooseImage&&(interaction_view.localIds?setTimeout(function(){e.setweixinimage(interaction_view.localIds[0])},100):interaction_view.weixin.chooseimage(function(t){t&&(interaction_view.localIds=t,e.setweixinimage(t[0]))}))},e.$el.children(".Element").on("click",function(){e.activeEdit(!0)}))},setweixinimage:function(e){var t=this,i=e;this.$el.find("img").attr("src",i);var n=this.getcommon(),a=n.iWidth,o=n.iHeight,r=this.model;interaction_view.imageEditor(this.model,a,o,i,function(e,n,a,o){var s=t.$el.children(".Element").find("img").first();return r._x=e,r._y=n,r._scale=a,r._rotate=o,t.model.localId&&t.model.localId==i?void t.addToUrl(t.model.pic,e,n,a,o):(_g.device.ios()&&s.attr("src",i),void interaction_view.imageUploader(i,function(r){_g.device.android()&&s.attr("src",r),t.model.localId=i,t.model.pic=r;var l=t.getdetail();l.iImg[0].picture=r,t.addToUrl(r,e,n,a,o)}))},t.setweixinimage)},resetOtherStatus:interaction_view.view.Image.prototype.resetOtherStatus,fullview:interaction_view.view.Image.prototype.fullview,getLayerContentSize:interaction_view.view.Image.prototype.getLayerContentSize,setEraser:interaction_view.view.Image.prototype.setEraser,resetEraser:interaction_view.view.Image.prototype.resetEraser,isFullSwitch:interaction_view.view.Image.prototype.isFullSwitch,getGalleryModel:interaction_view.view.Image.prototype.getGalleryModel,repaint:interaction_view.view.Image.prototype.repaint,onShow:interaction_view.view.Image.prototype.onShow,getDragCopy:interaction_view.view.Image.prototype.getDragCopy,getClientXY:interaction_view.view.Image.prototype.getClientXY,resetDragDrop:interaction_view.view.Image.prototype.resetDragDrop,setDraggable:interaction_view.view.Image.prototype.setDraggable,activeDragDrop:interaction_view.view.Image.prototype.activeDragDrop,getDropXY:interaction_view.view.Image.prototype.getDropXY,resetDragDropStatus:interaction_view.view.Image.prototype.resetDragDropStatus,renderDraggable:interaction_view.view.Image.prototype.renderDraggable,drag_dragend:interaction_view.view.Image.prototype.drag_dragend,drag_dragin:interaction_view.view.Image.prototype.drag_dragin,renderCopyDraggable:interaction_view.view.Image.prototype.renderCopyDraggable,copy_dragend:interaction_view.view.Image.prototype.copy_dragend,old_transit_back:interaction_view.view.Image.prototype.old_transit_back,trigger_dragin_event:interaction_view.view.Image.prototype.trigger_dragin_event,trigger_drop_event:interaction_view.view.Image.prototype.trigger_drop_event})
}),define("interaction_view/model/weixincamera",["interaction_view/model/button"],function(){interaction_view.model.WeixinCamera=interaction_view.model.Button.extend({defaults:{iType:"WeixinCamera",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null},setview:function(){var e=this.get("iDetail");e.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.WeixinCamera({model:this})}}),interaction_view.view.WeixinCamera=interaction_view.view.Button.extend({events:{},render:function(){},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");this.getdetail();if(interaction_view.ismobile)var t="touchstart",i="touchend";else var t="mousedown",i="mouseup";this.$el.on(t,function(){e.buttonon=!0,e.changeStatus()}),this.$el.on(i,function(){e.buttonon&&(e.buttonon=!1,e.changeStatus(),_g.device.isWeixin()?window.setTimeout(function(){interaction_view.weixin.chooseimage(function(t){t?(interaction_view.localIds=t,interaction_view.events.onWeixinEvent(e,71)):interaction_view.events.onWeixinEvent(e,72)})},500):interaction_view.errorAlert("è¯·å¨å¾®ä¿¡ä¸­æä½"))})},changeStatus:function(){var e=(this.getdetail(),this);e.active?(e.$el.find("img.iconActive").hide(),e.$el.find("img.iconNormal").show(),e.active=!1):(e.$el.find("img.iconActive").show(),e.$el.find("img.iconNormal").hide(),e.active=!0)},resetOtherStatus:function(){this.resetWeixinCameraStatus()},resetWeixinCameraStatus:function(){this.$el.find("img.iconActive").hide(),this.$el.find("img.iconNormal").show(),this.active=!1}})}),define("interaction_view/model/weixinvoice",["interaction_view/model/button"],function(){interaction_view.model.WeixinVoice=interaction_view.model.Button.extend({defaults:{iType:"WeixinVoice",iVisibility:!0,iCommon:null,iDetail:null,iOptions:{createfocus:!0},iParentModel:null,iDraggable:!0,iResizable:!0,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null},setview:function(){var e=this.get("iDetail");e.isSwitch&&(this.isSwitch=!0),this.iview=new interaction_view.view.WeixinVoice({model:this})}}),interaction_view.view.WeixinVoice=interaction_view.view.Button.extend({events:{},render:function(){},afterpreload:function(e){e&&this.preloaded||(e&&!this.preloaded&&(this.preloaded=this.checkImgload(e)),this.preloaded&&(this.setZindex(),this.setElementDisplay(),this.setOtherDisplay(),this.copyelstyle=this.$el.attr("style"),this.copyelementstyle=this.$el.children(".iElement").attr("style")))},setOtherDisplay:function(){this.active=!1,this.buttonon=!1;var e=this;this.$el.css("cursor","pointer");this.getdetail();if(interaction_view.ismobile)var t="touchstart",i="touchend";else var t="mousedown",i="mouseup";this.$el.on(t,function(){e.buttonon=!0,e.changeStatus()}),this.$el.on(i,function(){e.buttonon&&(e.buttonon=!1,e.changeStatus(),_g.device.isWeixin()?window.setTimeout(function(){interaction_view.voiceEditor(function(t){t?(interaction_view.voicelocalId=t,interaction_view.events.onWeixinEvent(e,71)):interaction_view.events.onWeixinEvent(e,72)})},500):interaction_view.errorAlert("è¯·å¨å¾®ä¿¡ä¸­æä½"))})},changeStatus:function(){var e=(this.getdetail(),this);e.active?(e.$el.find("img.iconActive").hide(),e.$el.find("img.iconNormal").show(),e.active=!1):(e.$el.find("img.iconActive").show(),e.$el.find("img.iconNormal").hide(),e.active=!0)},resetOtherStatus:function(){this.resetWeixinVoiceStatus()},resetWeixinVoiceStatus:function(){this.$el.find("img.iconActive").hide(),this.$el.find("img.iconNormal").show(),this.active=!1}})}),define("text!interaction/template/infoList_content.js",[],function(){return'<%\n	var position = ["left", "center", "right", "justify"],\n		strokeType = ["", "solid", "dotted", "dashed"],\n		boderStr;\n	if(iDetail.stroke_type == 0)\n		boderStr = "none";\n	else\n		boderStr = (iDetail.stroke_width>=0?iDetail.stroke_width:1)+"px "+strokeType[iDetail.stroke_type>=1?iDetail.stroke_type:1];\n	_.each(infolist, function(v,i){ %>\n<table style="margin: 0;<%=(page&&i==0)?"":"border-top:"+boderStr+";"%> <%=(infolist.length==i+1)?"border-bottom:"+boderStr+";":""%>border-color:<%=iDetail.stroke_color%>">\n	<tr>\n		<td style="width: 50px; vertical-align: top;<%=iDetail.iPortrait?"":"display:none"%>">\n			<div style="background-image: url(<%=v.portrait||"/staticfs/diazo/img/avatar.png"%>);width: 30px;height: 30px;margin: 10px;background-size: cover;	background-position: 50% 50%;border-radius: 40px;"></div>\n		</td>\n		<td style="vertical-align: top;padding: 5px;">\n			<p style="margin: 0;font-size: 13px;font-weight: bold;<%=iDetail.iNickname?"":"display:none;"%> color:<%=iDetail.nickname_color%>; min-height:21px;"><%=_g.util.htmlspecialchars(v.nickname||"")%></p>\n			<p style="color:<%=iDetail.font_color%>;font-size:<%=iDetail.font_size%>px;text-align:<%=position[iDetail.iPosition]%>;"><%=_g.util.htmlspecialchars(v[iDetail.iField])%></p>\n		</td>\n	</tr>\n</table>\n<%})%>'}),define("interaction_view/model/infoList",["interaction_view/model/base","text!interaction/template/infoList_content.js","text!interaction_view/template/prompt.js"],function(){var e=require("text!interaction/template/infoList_content.js"),t=require("text!interaction_view/template/prompt.js");interaction_view.model.InfoList=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.InfoList({model:this})},setsyncmodel:function(){}}),interaction_view.view.InfoList=interaction_view.view.Base.extend({render:function(){this.totalInfoPage=0,this.currentPage=1,this.pullUpInfo=["ä¸æå è½½æ´å¤","éæ¾æ´æ°"],this.model._reset=!0},resetOtherStatus:function(){this.getInfo()},renderUrl:function(e){var t=this.getdetail(),i=t.iAppUrl+"infolist.json";return i+="?iField="+t.iField,i+=this.currentPage>1&&!e?"&size="+t.size*this.currentPage:"&size="+t.size,i+="&sort_by="+t.sort_by,i+="&sort_order="+(t.sord_order?1:-1),1==t.sort_by&&(i+="&unique="+t.unique),e&&(i+="&page="+e),t.iKind&&2==t.iKind&&("undefined"!=typeof epub360_sourceinfo&&void 0!=epub360_sourceinfo.openid?i+="&source_openid="+epub360_sourceinfo.openid:"undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.openid&&(i+="&source_openid="+epub360_userinfo.openid)),i},getInfo:function(t){var i,n=this,a=this.getdetail(),o=!1;t?(this.currentPage<this.totalInfoPage?this.currentPage++:o=!0,i=n.renderUrl(this.currentPage)):i=n.renderUrl(),o||_g.ajax.get({dataType:"JSON",url:i,callback:function(i){if(200==i.code){n.totalInfoPage=Math.ceil(i.data.sum/a.size);var o=_.template(e,{infolist:i.data.results,iDetail:a,page:t}),r={x:0,y:0};t?(r=n.scrollview.iScroll.getComputedPosition(),n.$el.find(".info-content .lists").append(o)):n.$el.find(".info-content .lists").html(o),n.renderScroll(r),n.updatePullUpInfo()}else n.$el.find(".info-content .lists").html("ç©º")}})},postInfo:function(){console.log("postinfo");var e=this,i=this.getdetail(),n="InfoListInput",a=_.template(t,{class_name:n}),o=$("."+n);o.length||(o=$(a).appendTo("body")),o.show().attr("infolist-id",e.model.id);var r=o.find(".modalArea");interaction_view.ismobile&&r.width($(document).width()),_g.ui.center({Item:r}),o.find("textarea").val("");var s=function(){o.find("textarea").focus().click(function(){$(this).focus()})};o.find("button.cancel").one("click",function(){o.remove()}),o.find("button.ok").one("click",function(){if(o.attr("infolist-id")==e.model.id){o.remove();var t={};t[i.iField]=o.find("textarea").val(),_g.ajax.post({dataType:"JSON",url:i.iAppUrl+"?format=json",data:t,callback:function(t){200==t.code&&e.getInfo()}})}}),s(),setTimeout(s,500)},updatePullUpInfo:function(){this.pullUpInfo=this.currentPage>=this.totalInfoPage?["æ²¡ææ´å¤äº","æ²¡ææ´å¤äº"]:["ä¸æå è½½æ´å¤","éæ¾æ´æ°"],this.$el.find(".info-content .pullUp").html(this.pullUpInfo[0]).text(this.pullUpInfo[0])},getLayerContentSize:function(){var e,t={width:0,height:0};return t.width=this.$el.find(".info-content .lists").width(),t.height=this.$el.find(".info-content .lists").height(),e=this.$el.find(".Element").height(),t.height<=e&&(t.height=e),t.height+=10,t},renderScroll:function(e){this.scrollview&&this.scrollview.iScroll.destroy();var t=this,i=this.getMoveRange(),n=this.$el.find(".Element"),a=0;this.scrollview=new _g.scrollview({containment:n,contentel:this.$el.find(".info-content"),mask_width:n.width(),mask_height:n.height(),content_width:this.getLayerContentSize().width,content_height:this.getLayerContentSize().height,content_x:0,content_y:e.y,scrollY:i.y>0?!0:!1,onScrolling:function(e){if(i.y>0){if(e.deltaY>0&&t.$el.find(".info-content .pullUp").hide(),e.deltaY<-5-i.y&&t.$el.find(".info-content .pullUp").show(),-e.deltaY>i.y+30)a=1,t.$el.find(".info-content .pullUp").html(t.pullUpInfo[1]).text(t.pullUpInfo[1]);else{if(!(e.deltaY>30))return t.$el.find(".info-content .pullUp").html(t.pullUpInfo[0]).text(t.pullUpInfo[0]),void t.$el.find(".info-content .pullDown").html("ä¸æå·æ°").text("ä¸æå·æ°");a=2,t.$el.find(".info-content .pullDown").html("éæ¾æ´æ°").text("éæ¾æ´æ°")}n.addClass("is_exceededY")}},onScrollend:function(){a>0&&t.getInfo(1==a),n.removeClass("is_exceededY"),t.$el.find(".info-content").find(".pullUp").hide()}}),this.$el.addClass("hascontrols")}})}),define("text!interaction/template/chartList_content.js",[],function(){return'<div style="color:<%=iDetail.font_color%>;font-size:<%=iDetail.font_size%>px;">\n   <p style="font-weight:bold;margin:2px;"><%=iDetail.label%></p>\n   <p style="text-align:right;margin:2px;">åä¸äººæ°ï¼<span><%=infolist.sum%></span></p>\n   <%\n		var position = ["left", "center", "right", "justify"],\n			strokeType = ["", "solid", "dotted", "dashed"],\n			boderStr;\n		if(iDetail.stroke_type == 0)\n			boderStr = "none";\n		else\n			boderStr = (iDetail.stroke_width>=0?iDetail.stroke_width:1)+"px "+strokeType[iDetail.stroke_type>=1?iDetail.stroke_type:1];\n		_.each(infolist.items, function(v,i){ %>\n	<table style="width: 100%; margin: 0;border-top: <%=boderStr%>;<%=(infolist.length==i+1)?"border-bottom:"+boderStr+";":""%>border-color:<%=iDetail.stroke_color%>">\n		<tr>\n			<td style="width:20px;text-align:left;padding: 2px;"><%=i+1%>.</td>\n			<td style="text-align:<%=position[iDetail.iPosition]%>;font-size:<%=iDetail.font_size%>px;"><%=v.value%></td>\n		</tr>\n		<tr>\n			<td colspan="2">\n				<div style="width:100%;height:13px;background-color:#D9D9D9">\n					<div style="width: <%=(v.count/infolist.sum*100).toFixed(2)%>%;background-color:<%=Colors[i%10]%>;height:100%"></div>\n				</div>\n			</td>\n		</tr>\n		<tr><td colspan="2" style="text-align:right;padding: 2px;"><%=v.count%>äºº <%=(v.count/infolist.sum*100).toFixed(2)%>%</td></tr>\n	</table>\n   <%})%>\n</div>'}),define("interaction_view/model/chartList",["interaction_view/model/base","text!interaction/template/chartList_content.js"],function(){var e=require("text!interaction/template/chartList_content.js");interaction_view.model.ChartList=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.ChartList({model:this})},setsyncmodel:function(){}}),interaction_view.view.ChartList=interaction_view.view.Base.extend({render:function(){this.Colors=["#50d92b","#5dbc5e","#9fb5ef","#a5cbd6","#d743b3","#e2fea9","#fd7a99","#fce096","#e6f63b","#e7ab6d"],this.model._reset=!0},resetOtherStatus:function(){this.getInfo()},renderUrl:function(){var e=this.getdetail(),t=e.iAppUrl+"chartlist.json";return t+="?iField="+e.iField},getInfo:function(){var e=this,t=this.getdetail();_g.ajax.get({dataType:"JSON",url:e.renderUrl(),callback:function(i){if(200==i.code&&i.data.results.length>0){var n={sum:i.data.sum,items:i.data.results.length?i.data.results[0].items:[]};(t.sort_by=1)&&n.items.sort(function(e,i){return t.sord_order?parseInt(e.count)>parseInt(i.count):parseInt(e.count)<parseInt(i.count)}),e.renderChart(n),e.renderScroll()}else e.$el.find(".info-content .lists").html("ç©º")}})},renderChart:function(t){var i,n=this,a=this.getdetail();if(0==a.iKind)i=_.template(e,{infolist:t,iDetail:a,Colors:n.Colors}),n.$el.find(".info-content .lists").html(i);else{{var o=[];n.getcommon().iWidth,n.getcommon().iHeight}_.each(t.items,function(e){o.push([e.value,Number(e.count)])}),n.$el.find(".info-content .lists").highcharts({chart:{backgroundColor:null,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1},title:{text:a.label},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{itemStyle:{"font-size":a.font_size+"px",color:a.font_color}},series:[{type:"pie",name:"å æ¯",data:o}]}),n.$el.find(".info-content .lists .highcharts-button").hide(),n.$el.find(".info-content .lists .highcharts-title").css("font-size",a.font_size)}},getLayerContentSize:function(){var e,t={width:0,height:0};return t.width=this.$el.find(".info-content .lists").width(),t.height=this.$el.find(".info-content .lists").height(),e=this.$el.find(".Element").height(),t.height<=e&&(t.height=e),t.height*=1.03,t},renderScroll:function(){this.scrollview&&this.scrollview.iScroll.destroy();var e=this,t=this.getMoveRange(),i=this.$el.find(".Element"),n=0;this.scrollview=new _g.scrollview({containment:i,contentel:this.$el.find(".info-content"),mask_width:i.width(),mask_height:i.height(),content_width:this.getLayerContentSize().width,content_height:this.getLayerContentSize().height,content_x:0,content_y:0,scrollY:t.y>0?!0:!1,onScrolling:function(a){if(t.y>0){if(!(a.deltaY>30))return void e.$el.find(".info-content .pullDown").html("ä¸æå·æ°").text("ä¸æå·æ°");n=1,e.$el.find(".info-content .pullDown").html("éæ¾æ´æ°").text("éæ¾æ´æ°"),i.addClass("is_exceededY")}},onScrollend:function(){n>0&&e.getInfo(),i.removeClass("is_exceededY")}}),this.$el.addClass("hascontrols")}})}),define("interaction_view/model/componentref",["interaction_view/model/layerref"],function(){interaction_view.model.ComponentRef=interaction_view.model.LayerRef.extend({defaults:{iType:"ComponentRef",iDraggable:!0,iResizable:!0,iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,callback:null,isStatic:!0},setiview:function(){var e=this.get("iCommon");this.offset=this.getOffset(e),e.landscape.iStartx=0,e.landscape.iStarty=0,e.landscape.iWidth=interaction_view.size.x,e.landscape.iHeight=interaction_view.size.y,this.iview=new interaction_view.view.ComponentRef({model:this})},setsyncmodel:function(){},filterlayers:function(){var e=this,t=this.get("iDetail"),i=t.layer_ids;this.components={},t.layer_ids&&t.layer_ids.length>0&&(i=_.filter(i,function(t){var i=interaction_view.iComponentlist.get(t);return i&&(e.components[t]=i),i})),t.layer_ids=i,this.set("iDetail",t)},getOffset:function(e){var t={x:0,y:0},i=this.get("iDetail");if(i.layer_ids&&i.layer_ids.length){var n=i.layer_ids[0],a=this.getComponentSize(n);t={x:e.landscape.iStartx-a.left,y:e.landscape.iStarty-a.top}}return t},getComponentSize:function(e,t){t||(t={w:200,h:200,left:null,top:null,bottom:null,right:null});var i=this.components[e];if(i){var n=i.overlays;_.each(n,function(e){null==t.left?(t.left=e.iCommon[iPageDirection].iStartx,t.top=e.iCommon[iPageDirection].iStarty,t.right=e.iCommon[iPageDirection].iStartx+e.iCommon[iPageDirection].iWidth,t.bottom=e.iCommon[iPageDirection].iStarty+e.iCommon[iPageDirection].iHeight):(t.left=t.left<e.iCommon[iPageDirection].iStartx?t.left:e.iCommon[iPageDirection].iStartx,t.top=t.top<e.iCommon[iPageDirection].iStarty?t.top:e.iCommon[iPageDirection].iStarty,t.right=t.right>e.iCommon[iPageDirection].iStartx+e.iCommon[iPageDirection].iWidth?t.right:e.iCommon[iPageDirection].iStartx+e.iCommon[iPageDirection].iWidth,t.bottom=t.bottom>e.iCommon[iPageDirection].iStarty+e.iCommon[iPageDirection].iHeight?t.bottom:e.iCommon[iPageDirection].iStarty+e.iCommon[iPageDirection].iHeight)})}return null!=t.left&&null!=t.top&&(t.w=t.right-t.left,t.h=t.bottom-t.top),t}}),interaction_view.view.ComponentRef=interaction_view.view.LayerRef.extend({events:{},render:function(){this.$el.css({width:"100%",height:"100%"}),this.renderMask(),this.model._reset=!0},renderMask:function(){},preload:function(){var e=this.model.get("iDetail");e.layer_ids&&e.layer_ids.length>0&&this.sendToPreload({file:null})},loadLayer:function(e){var t=this.getdetail();this.layerCheckList=_.clone(t.layer_ids),this.firstlayer=t.layer_ids?t.layer_ids[0]:null,this.preloadmodel=e;var i=require("interaction_view/view/layer");i=_g.mvc.createView(i),this.layerview=new i({model:this.model}),this.layerview.afterload()},afterlayerload:function(e){if(console.log(e),this.preloadmodel){this.layerCheckList=_.reject(this.layerCheckList,function(t){return t==e}),this.model.layer[e].iOverlaylist.each(function(e){e.iview.preloaded||e.iview.afterpreload()}),this.model.layer[e].iActionlist.each(function(e){e.iview.render()});{this.model.toJSON().iDetail.iHidden||!1}0==this.layerCheckList.length&&(this.$el.addClass("hide").css("opacity",""),this.slideel=this.$el.find(".layer-content").first(),this.slideel.children(".layer-item").first().show(),this.slidestyle=this.slideel.attr("style"),this.playAnimation(),this.firstlayer&&"ComponentRef"==this.model.get("iType")&&(this.model.layer[this.firstlayer].isLayer=!0),this.preloadmodel.set("loaded",!0),this.preloadmodel.page.ipreloadlist.preloadcheck(null,!0,this.model))}},playLayer:function(){this.firstlayer&&interaction_view.play(this.model.layer[this.firstlayer])},playAnimation:function(){this.getdetail();this.$el.find(".layer-content").children().css("opacity",1)},onExecuteBindingForComponentRef:function(e){var t=this.getMoveRange();1!=e.type&&(e.cdirection||t.x>0&&this.scrollview&&this.scrollview.iScroll.scrollTo(-e.deltarate*t.x,this.getCurrentPosition().top),e.cdirection&&t.y>0&&this.scrollview&&this.scrollview.iScroll.scrollTo(this.getCurrentPosition().left,-e.deltarate*t.y))},getCurrentPosition:function(){if(this.$el.find(".layer-content").length>0){var e={left:0,top:0};return this.scrollview&&(e={left:this.scrollview.iScroll.x,top:this.scrollview.iScroll.y}),e}return{left:0,top:0}},getCurrentPositionRate:function(){var e=0,t=0,i=this.getMoveRange(),n=this.getCurrentPosition();return i.x&&(e=-n.left/i.x),i.y&&(t=-n.top/i.y),{left:e,top:t}},getLayerContentSize:function(){var e=this.getdetail(),t={};return!e.layer_ids||e.layer_ids.length>0?(t.width=interaction_view.size.x,t.height=interaction_view.size.y,t):null},resetlayer:function(){var e=this,t=this.getdetail();t.layer_ids&&t.layer_ids.length>0&&(_.each(t.layer_ids,function(t){e.model.layer[t].iAnimationlist.resetAnimationStatus(),e.model.layer[t].iOverlaylist.resetViewStatus()}),!this.model.bindingfixed&&this.slideel&&this.slideel.attr("style",this.slidestyle),e.currentIndex=0)},resetOtherStatus:function(){this.resetlayer()},onShow:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){i.model.layer[n].iOverlaylist.each(e&&t.layer_ids.indexOf(n)==e?function(e){e.iview.onShow()}:function(e){e.iview.onShow()})})},onBeforeHide:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e||i.model.layer[n].iOverlaylist.each(function(e){e.iview.onBeforeHide(),_.include(["RichText","Region"],e.get("iType"))&&e.iview.resetOtherStatus()})})},onHide:function(e){var t=this.getdetail(),i=this;t.layer_ids&&t.layer_ids.length>0&&_.each(t.layer_ids,function(n){e&&t.layer_ids.indexOf(n)==e||i.model.layer[n].iOverlaylist.each(function(e){e.iview.onHide()})})},onSizeAdaptChange:function(){}})}),define("interaction_view/model/textbutton",["interaction_view/model/paragraph"],function(){interaction_view.model.TextButton=interaction_view.model.Paragraph.extend({defaults:{iType:"TextButton",iSync:!1},setview:function(){this.iview=new interaction_view.view.TextButton({model:this})}}),interaction_view.view.TextButton=interaction_view.view.Paragraph.extend({renderlink:function(){if(interaction_view.forpreview)return!1;var e=this.model.get("iDetail");this.$el.children(".Element").on("click",function(){void 0!=e.linktype&&interaction_view.renderLink(e.linktype,e)})}})}),define("interaction_view/model/collision",["interaction_view/model/base"],function(){interaction_view.model.Collision=interaction_view.model.Base.extend({defaults:{},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Collision({model:this})},setsyncmodel:function(){}}),interaction_view.view.Collision=interaction_view.view.Base.extend({resetOtherStatus:function(){},render:function(){this.peers=this.getPeers(),this.bindHitDetect(),this.hitState={},this.cachePos={}},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0},getPeers:function(){var e=this.getdetail(),t=[];return _.each(e.target_ids,function(i){_.each(e.source_ids,function(e){e!=i&&t.push([e,i])})}),t},bindHitDetect:function(){var e=this;_.each(e.peers,function(t){_.each(t,function(i){var n=interaction_view.getParentpage(e.model.page.id),a=n.iAnimationlist.where({overlay_id:i});_.each(a,function(n){var a={type:"animation",page_id:e.model.page.id,overlay_id:i,animation_id:n.id,layer_id:e.model.get("layer_id"),_label:"collision"};a.func=function(){e.hitDetect(t[0],t[1],i)},interaction_view.events.animationUpdateEvents.push(a),a={type:"animation",page_id:e.model.page.id,overlay_id:i,animation_id:n.id,layer_id:e.model.get("layer_id"),_label:"collision"},a.func=function(){setTimeout(e.hitDetect(t[0],t[1],i),1)},interaction_view.events.animationEndEvents.push(a)});var o=n.get("overlays").filter(function(e){return e.id==i});if(o.length&&o[0].iDetail.draggable){var r={page_id:e.model.page.id,overlay_id:i,layer_id:e.model.get("layer_id"),_label:"collision"};r.func=function(){e.hitDetect(t[0],t[1],i)},interaction_view.events.draggingEvents.push(r)}})})},setHitState:function(e,t,i){this.hitState[e+t]=i,this.hitState[t+e]=i},getHitState:function(e,t){return this.hitState[e+t]},hitDetect:function(e,t,i){if(this.cachePos[i]=[!1,{}],this.isHit(e,t)){var n=this.getdetail(),a=!0;"once"==n.trigger&&this.getHitState(e,t)&&(a=!1),a&&(n.hide_source&&this.getModel(e).iview.$el.addClass("hide"),interaction_view.events.onCollision(this)),this.setHitState(e,t,!0)}else this.setHitState(e,t,!1)},isHit:function(e,t){var i=this,n=this.getdetail(),a=i.getModel(e),o=i.getModel(t);return a&&o?(a=a.iview.$el,o=o.iview.$el,0==a.css("opacity")||0==o.css("opacity")||"none"==a.css("display")||"none"==o.css("display")?!1:"center"==n.source_offset_type?"center"==n.target_offset_type?i.isHitCC(a,o):i.isHitCR(a,o):"center"==n.target_offset_type?i.isHitRC(a,o):i.isHitRR(a,o)):!1},getModel:function(e){return interaction_view.getParentpage(interaction_view.currentPage).iOverlaylist.where({id:e})[0]},isHitCC:function(e,t){var i=this,n=this.getdetail(),a=i.getCoord(e,"circle",n.source_offset),o=i.getCoord(t,"circle",n.target_offset);return i.isCircleHitCircle(a,o)},isHitCR:function(e,t){var i=this,n=this.getdetail(),a=i.getCoord(e,"circle",n.source_offset),o=i.getCoord(t,"rect",n.target_offset);return i.isCircleHitRect(a,o)},isHitRC:function(e,t){var i=this,n=this.getdetail(),a=i.getCoord(e,"rect",n.source_offset),o=i.getCoord(t,"circle",n.target_offset);return i.isCircleHitRect(o,a)},isHitRR:function(e,t){var i=this,n=this.getdetail(),a=i.getCoord(e,"rect",n.source_offset),o=i.getCoord(t,"rect",n.target_offset);return i.isRectHitRect(a,o)},getCoord:function(e,t,i){{var n=this;this.getdetail()}if(n.cachePos[e[0].id]&&n.cachePos[e[0].id][0])return n.cachePos[e[0].id][1];var a=n.getOffsetXY(e);e.hasClass("static")&&(a={x:a.x+e.children().width()/2,y:a.y+e.children().height()/2});var o;switch(t){case"circle":o={o:a,r:i};break;case"rect":var r=e.children().width(),s=e.children().height(),l=n.getDomRotation(e),c={x:a.x-r/2,y:a.y-s/2},d={x:c.x+r,y:c.y},h={x:c.x+r,y:c.y+s},u={x:c.x,y:c.y+s};c=n.getRotatedCoord(a,{x:c.x-i,y:c.y-i},l),d=n.getRotatedCoord(a,{x:d.x+i,y:d.y-i},l),h=n.getRotatedCoord(a,{x:h.x+i,y:h.y+i},l),u=n.getRotatedCoord(a,{x:u.x-i,y:u.y+i},l);var p=[c,d,h,u];o={o:a,vertex:p,w:r,h:s}}return n.cachePos[e[0].id]=[!0,o],o},getOffsetXY:function(e){var t=e.offset();return{x:t.left,y:t.top}},getDomRotation:function(e){function t(e,t){e=parseFloat(e),t=parseFloat(t);var i=(180*Math.asin(e)/Math.PI+360)%360;return e>=0&&t>=0?i:e>=0&&0>=t?180-i:0>=e&&t>=0?i:0>=e&&0>=t?540-i:void 0}function i(){var i,n=e.children().css("transform")||e.children().css("-webkit-transform");return n.split("(")[1]?(i=n.split("(")[1].split(","),t(i[1],i[0])):0}var n,a=e.children().css("transform")||e.children().css("-webkit-transform");if(a.split("(")[1]){var o=a.split("(")[1].split(",");n=t(o[1],o[0]),n||(n=i())}else n=i();return n},getRotatedCoord:function(e,t,i){var n=t;i=i/180*Math.PI;var a=(n.x-e.x)*Math.cos(i)-(n.y-e.y)*Math.sin(i)+e.x,o=(n.x-e.x)*Math.sin(i)+(n.y-e.y)*Math.cos(i)+e.y;return{x:a,y:o}},distPP:function(e,t){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},distPL:function(e,t,i){var n=i.y-t.y,a=t.x-i.x,o=i.x*t.y-t.x*i.y;return Math.abs(n*e.x+a*e.y+o)/Math.sqrt(n*n+a*a)},isCircleHitCircle:function(e,t){var i=this.distPP(e.o,t.o);return i<=e.r+t.r},isCircleHitRect:function(e,t){var i=t.w/2,n=t.h/2,a={x:(t.vertex[0].x+t.vertex[1].x)/2,y:(t.vertex[0].y+t.vertex[1].y)/2},o={x:(t.vertex[2].x+t.vertex[1].x)/2,y:(t.vertex[2].y+t.vertex[1].y)/2},r=this.distPL(e.o,t.o,a),s=this.distPL(e.o,t.o,o);return r>i+e.r?!1:s>n+e.r?!1:i>=r?!0:n>=s?!0:(r-i)*(r-i)+(s-n)*(s-n)<=e.r*e.r},isRectHitRect:function(e,t){var i=!0,n=[{x:e.vertex[0].x-e.vertex[3].x,y:e.vertex[0].y-e.vertex[3].y},{x:e.vertex[0].x-e.vertex[1].x,y:e.vertex[0].y-e.vertex[1].y},{x:t.vertex[0].x-t.vertex[3].x,y:t.vertex[0].y-t.vertex[3].y},{x:t.vertex[0].x-t.vertex[1].x,y:t.vertex[0].y-t.vertex[1].y}];return $.each(n,function(n,a){var o,r,s,l,c=[];return _.each(e.vertex,function(e){var t=e.x*a.x+e.y*a.y;c.push(t)}),o=_.min(c),r=_.max(c),c=[],_.each(t.vertex,function(e){var t=e.x*a.x+e.y*a.y;c.push(t)}),s=_.min(c),l=_.max(c),r>=s&&l>=o?void 0:(i=!1,!1)}),i}})}),define("interaction_view/model/usersvg",["interaction_view/model/base"],function(){interaction_view.model.UserSVG=interaction_view.model.Base.extend({defaults:{},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.UserSVG({model:this})},setsyncmodel:function(){}}),interaction_view.view.UserSVG=interaction_view.view.Base.extend({resetOtherStatus:function(){},render:function(){var e=this.model.page.iAnimationlist.where({overlay_id:this.model.id,iType:702});if(e.length>0){if("undefined"==typeof TweenMax)return;TweenMax.set(this.$el.find("svg").find("path"),{display:"none"}),this.$el.find("svg").append("<g id='cloneArea' style='display:none;'></g>"),this.$el.find("svg #cloneArea").append(this.$el.find("svg").find("path").clone()),this.$el.find("svg #cloneArea path").each(function(e,t){t.id="clone_"+t.id,$(t).attr("data-attr","morphCloneElement")});var t=e[0].attributes.iDetail.pathIndex;if(!_.isEmpty(t)){if(t.find)var i=t.find(function(e){return null!=e.selected});else var i=_.find(t,function(e){return null!=e.selected});if(i){{i.id}TweenMax.set(this.$el.find("svg").find("path#"+i.id),{display:"block"})}}}}})}),define("interaction_view/model/avatarList",["_g/ajax","interaction_view/model/infoList"],function(){interaction_view.model.AvatarList=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.get("iDetail");this.iview=new interaction_view.view.AvatarList({model:this})},setsyncmodel:function(){}}),interaction_view.view.AvatarList=interaction_view.view.Base.extend({render:function(){var e=[30,40,50],t=["Hiragino Sans GB,Microsoft YaHei,SimHei,STHeiti","SimSun,å®ä½,STSong","andale mono,times","arial,helvetica,sans-serif","arial black,avant garde","book antiqua,palatino","comic sans ms,sans-serif","courier new,courier","georgia,palatino","helvetica","impact,chicago","tahoma,arial,helvetica,sans-serif","terminal,monaco","times new roman,times","trebuchet ms,geneva","verdana,geneva"];this.$el.find(".avatar").css({width:e[this.model.attributes.iDetail.thumb_size]}),this.$el.find(".avatar .thumb").css({"border-radius":this.model.attributes.iDetail.cr+"px"}),this.$el.find(".avatar .title").css({color:this.model.attributes.iDetail.font_color,"font-size":this.model.attributes.iDetail.font_size+"px","font-family":t[this.model.attributes.iDetail.font_face]}),this.model.attributes.iDetail.show_title?this.$el.find(".avatar .title").show():this.$el.find(".avatar .title").hide(),this.$avatar=this.$el.find(".info-template .avatar").clone(),this.url="",this.totalInfoPage=0,this.currentPage=1,this.pullUpInfo=["ä¸æå è½½æ´å¤","éæ¾æ´æ°"],this.model._reset=!0},resetOtherStatus:function(){this.delayShowel(),this.model.attributes.iDetail.RelationID||this.renderScroll()},delayShowel:function(){function e(){t.$el.find(".Element").css("visibility","visible")}var t=this;setTimeout(e,0)},renderScroll:function(){this.scrollview&&this.scrollview.iScroll.destroy();var e=this.getMoveRange(),t=this.$el.find(".Element");this.scrollview=new _g.scrollview({containment:t,contentel:this.$el.find(".info-content"),mask_width:t.width(),mask_height:t.height(),content_width:this.getLayerContentSize().width,content_height:this.getLayerContentSize().height,content_x:0,content_y:0,scrollY:e.y>0?!0:!1}),this.$el.addClass("hascontrols")},getLayerContentSize:function(){var e,t,i,n,a={width:0,height:0};i=this.$el.find(".Element").width(),n=this.$el.find(".Element").height();var o=2*parseInt(this.$el.find(".avatar:first").css("padding"));return e=this.$el.find(".avatar:first").width()+o,t=this.$el.find(".avatar:first").height(),0==t&&(this.$el.removeClass("hide"),t=this.$el.find(".avatar:first").height(),t>0?this.$el.addClass("hide"):t=60),t+=o,a.width=i,a.height=Math.ceil(this.$el.find(".avatar").size()/Math.floor(i/e))*t,this.$el.find(".info-content").css({width:a.width,height:a.height}),a.height<=t&&(a.height=t),a.height+=10,this.$el.find(".info-content .lists").height(a.height),a},updatePullUpInfo:interaction_view.view.InfoList.prototype.updatePullUpInfo,renderPagingScroll:interaction_view.view.InfoList.prototype.renderScroll,getInfo:function(e){var t=this,i=(this.getdetail(),this.url),n=!1;e&&(this.currentPage<this.totalInfoPage?this.currentPage++:n=!0,i+="&page="+this.currentPage),n||_g.ajax.get({dataType:"JSON",url:i,callback:function(i){if(200==i.code){t.totalInfoPage=i.data.numpages;var n={x:0,y:0},a=t.$el.find(".info-content .lists"),o=t.$el.find(".info-template .avatar .title").height();e?n=t.scrollview.iScroll.getComputedPosition():a.empty(),$.each(i.data.results,function(e,i){var n=t.$avatar.clone();n.find(".thumb").css("background-image","url("+i.portrait+")"),n.find(".title").html(i.nickname).attr("title",i.nickname),a.append(n)}),a.find(".avatar .title").height(o),t.renderPagingScroll(n),t.updatePullUpInfo()}else t.$el.find(".info-content .lists").html("ç©º")}})}})}),define("interaction_view/model/avatar",["_g/ajax","interaction_view/model/vote","interaction_view/model/avatarList"],function(){interaction_view.model.Avatar=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)
},setview:function(){this.get("iDetail");this.setSubOverlays(),this.iview=new interaction_view.view.Avatar({model:this})},setsyncmodel:function(){}}),interaction_view.view.Avatar=interaction_view.view.Base.extend({render:function(){this.model._reset=!0},resetOtherStatus:function(){if(this.delayShowel(),!this.model.attributes.iDetail.RelationID){var e,t;void 0!=this.model.attributes.iDetail.iKind&&1==this.model.attributes.iDetail.iKind?"undefined"!=typeof epub360_sourceinfo&&epub360_sourceinfo.portrait&&(e=epub360_sourceinfo.portrait,t=epub360_sourceinfo.nickname):"undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.portrait&&(e=epub360_userinfo.portrait,t=epub360_userinfo.nickname),e&&this.$el.find(".thumb").css({"background-image":"url("+e+")","background-size":"cover"}),t&&this.$el.find(".iTextLabel p").html(t)}this.model.attributes.iDetail.iNickname?this.$el.find(".iTextLabel").show():this.$el.find(".iTextLabel").hide()},delayShowel:interaction_view.view.AvatarList.prototype.delayShowel,preload:interaction_view.view.Vote.prototype.preload,checkImgload:interaction_view.view.Vote.prototype.checkImgload,afterpreload:interaction_view.view.Vote.prototype.afterpreload,setTitle:function(){if(this.model.attributes.iDetail.iNickname){var e=(this.getdetail(),this.model.get("suboverlays")),t=e[0].iDetail.iValue,i=interaction_view.formatLabel({text:"Jason"==t?"Name":t,font_size:e[0].iDetail.font_size,text_color:e[0].iDetail.text_color,iPosition:e[0].iDetail.iPosition});this.$el.find(".iTextLabel.Element").html(i)}},afterSubOverlayPreload:interaction_view.view.Vote.prototype.afterSubOverlayPreload})}),define("interaction_view/model/initButton",["interaction_view/model/button"],function(){interaction_view.model.InitButton=interaction_view.model.Button.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.InitButton({model:this})},setsyncmodel:function(){}}),interaction_view.view.InitButton=interaction_view.view.Button.extend({render:function(){var e=this,t=interaction_view.environment.Shareapp.slug,i="tap";e.$el.find("img.iconNormal").hammer().on(i,function(){_g.ajax.post({dataType:"JSON",url:"/share/"+t+"/create",callback:function(t){if(200==t.code){var i=t.data.results[0].shareinfo.id;message_link=_g.replaceUrlParameterByName("shareid","shareid="+i,message_link),interaction_view.environment.Shareapp.shareinfo=t.data.results[0].shareinfo,interaction_view.environment.Shareapp.id=i,2!=interaction_view.environment.Shareapp.status&&(interaction_view.environment.Shareapp.status=2,interaction_view.environment.Shareapp.appinfo={target_num:0,help_rule:0}),epub360_userinfo.hasOwnProperty("openid")&&(interaction_view.environment.Shareapp.helperinfo=epub360_userinfo,interaction_view.environment.Shareapp.helperinfo.help_num=0,interaction_view.environment.Shareapp.helperinfo.help_num_today=0);var n=_.filter(interaction_view.getAnimationPage(interaction_view.currentPage).iOverlaylist.models,function(e){return"UserList"==e.attributes.iType});if(n.length>0){var a=t.data.results[0].shareinfo.nickname,o=t.data.results[0].shareinfo.portrait,r=n[0];0==r.iview.status?r.iview.resetOtherStatus():r.iview.setShareAppInfo(i,a,o)}interaction_view.weixin.share(),interaction_view.events.onUserList(e,78)}else interaction_view.events.onUserList(e,79)},onError:function(){interaction_view.events.onUserList(e,79)}})}),this.model._reset=!0}})}),define("interaction_view/model/userList",["interaction_view/model/base"],function(){interaction_view.model.UserList=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.UserList({model:this})},setsyncmodel:function(){}}),interaction_view.view.UserList=interaction_view.view.Base.extend({render:function(){this.model._reset=!0,this.binded=!1,this.status=0,interaction_view.environment.Shareapp.add(this)},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0},resetOtherStatus:function(){var e=this;interaction_view.environment.Shareapp.status<2||(this.avatar=this.getRelationOverlay(0),this.avatarList=this.getRelationOverlay(1),this.button=this.getRelationOverlay(2),this.avatar&&this.avatarList&&this.button&&(2==interaction_view.environment.Shareapp.status?(e.getAvatar(),e.getAvatarList(),!e.binded&&e.bindSupportTrigger()):this.avatarList.renderScroll(),this.model._reset=!1,this.status=2,this.binded=!0))},getAvatar:function(){var e=this;2==interaction_view.environment.Shareapp.status&&(e.setAvatar(interaction_view.environment.Shareapp.shareinfo.nickname,interaction_view.environment.Shareapp.shareinfo.portrait),interaction_view.environment.Shareapp.shareinfo.total>=interaction_view.environment.Shareapp.appinfo.target_num&&("undefined"!=typeof epub360_userinfo&&epub360_userinfo.openid==interaction_view.environment.Shareapp.shareinfo.openid&&interaction_view.events.onUserList(e,74),interaction_view.environment.Shareapp.helperinfo&&interaction_view.environment.Shareapp.helperinfo.help_num>0&&interaction_view.events.onUserList(e,75)))},setShareAppInfo:function(e,t,i){var n=this;n.share_id=e,n.setAvatar(t,i),n.getAvatarList()},setAvatar:function(e,t){var i=this;i.avatar.$el.find(".thumb").css({"background-image":"url("+t+")","background-size":"cover"}),i.avatar.$el.find(".iTextLabel p").html(e)},getAvatarList:function(){var e=this;e.avatarList.url="/share/"+interaction_view.environment.Shareapp.slug+"/list?id="+interaction_view.environment.Shareapp.id,e.resetAvatarList(),e.avatarList.getInfo()},resetAvatarList:function(){var e=this,t=e.avatarList.$el.find(".info-content .lists");t.empty()},bindSupportTrigger:function(){var e=this,t=1,i="tap";e.button.$el.find("img.iconNormal").hammer().on(i,function(){if(interaction_view.environment.Shareapp.helperinfo&&interaction_view.environment.Shareapp.helperinfo.help_num>0)if(0==interaction_view.environment.Shareapp.appinfo.help_rule){if(interaction_view.environment.Shareapp.helperinfo&&interaction_view.environment.Shareapp.helperinfo.help_num>0)return void interaction_view.errorAlert("æ¨å·²ç»æ¯æè¿ï¼è°¢è°¢!")}else if(interaction_view.environment.Shareapp.appinfo.help_rule<=interaction_view.environment.Shareapp.helperinfo.help_num_today)return void interaction_view.errorAlert("æ¨ä»å¤©çæ¬¡æ°å·²ç»ç¨å®!");_g.ajax.post({dataType:"JSON",url:"/share/"+interaction_view.environment.Shareapp.slug+"/help",data:{share_id:interaction_view.environment.Shareapp.id,amount:t},callback:function(t){if(200==t.code){if("undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.portrait){var i=e.avatarList.$el.find(".info-content .lists"),n=e.avatarList.$avatar.clone();n.find(".thumb").css("background-image","url("+epub360_userinfo.portrait+")"),n.find(".title").html(epub360_userinfo.nickname).attr("title",epub360_userinfo.nickname),n.find(".title").css("height","18px"),i.prepend(n),interaction_view.environment.Shareapp.helperinfo=epub360_userinfo,interaction_view.environment.Shareapp.helperinfo.help_num=1,_g.ajax.get({dataType:"JSON",url:"/share/"+interaction_view.environment.Shareapp.slug+"/info?id="+interaction_view.environment.Shareapp.id,callback:function(t){200==t.code&&(interaction_view.environment.Shareapp.helperinfo=t.data.results[0].helperinfo,interaction_view.environment.Shareapp.shareinfo.total=interaction_view.environment.Shareapp.shareinfo.total+1,interaction_view.environment.Shareapp.shareinfo.total>=interaction_view.environment.Shareapp.appinfo.target_num&&interaction_view.events.onUserList(e,75))}})}interaction_view.events.onUserList(e.button,76)}else interaction_view.events.onUserList(e.button,77)},onError:function(){interaction_view.events.onUserList(e.button,77)}})})},getRelationOverlay:function(e){var t=this.model.get("iDetail").RelationID;t=t.replace(t.split("_")[0],"t"+e);var i=_.filter(interaction_view.getAnimationPage(interaction_view.currentPage).iOverlaylist.models,function(e){return e.id&&e.get("iDetail").RelationID&&e.get("iDetail").RelationID==t});return i.length>0?i[0].iview:null}})}),define("interaction_view/model/infoForm",["interaction_view/model/userList"],function(){interaction_view.model.InfoForm=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.InfoForm({model:this})},setsyncmodel:function(){}}),interaction_view.view.InfoForm=interaction_view.view.Base.extend({render:function(){this.model._reset=!0,this.binded=!1},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0},getRelationOverlay:interaction_view.view.UserList.prototype.getRelationOverlay,resetOtherStatus:function(){if(!this.binded){var e=this,t=_g.getUrlParameterByName("shareid"),i=interaction_view.shareapp.id;this.input_fullname=this.getRelationOverlay(0),this.input_mobile=this.getRelationOverlay(1),this.input_address=this.getRelationOverlay(2),this.input_email=this.getRelationOverlay(3),this.input_memo=this.getRelationOverlay(4),this.button=this.getRelationOverlay(5),e.bindSubmitTrigger(t,i),this.model._reset=!1,this.binded=!0}},isValid:function(e,t,i,n){var a=this;if(!$.trim(e))return alert("è¯·è¾å¥å§åï¼"),!1;if(!$.trim(t))return alert("è¯·è¾å¥ææºå·ç ï¼"),!1;var o=/^0?1[3|4|5|7|8][0-9]\d{8}$/;return o.test(t)?(t&&(epub360_userinfo=epub360_userinfo||{},epub360_userinfo.mobile=t),a.model.get("iDetail").show_address&&!$.trim(i)?(alert("è¯·è¾å¥å°åä¿¡æ¯ï¼"),!1):a.model.get("iDetail").show_email&&!$.trim(n)?(alert("è¯·è¾å¥çµå­é®ç®±ä¿¡æ¯ï¼"),!1):!0):(alert("è¯·è¾å¥æ­£ç¡®ææºå·ç ï¼"),!1)},bindSubmitTrigger:function(e,t){var i=this,n="tap";i.button.$el.find("img.iconNormal").hammer().on(n,function(){if(!t)return void alert("ä»éåå©åæ´»å¨ä½¿ç¨ï¼ç»å®å©ååºç¨åçæï¼");var n=i.input_fullname&&i.input_fullname.$el.find("input").val(),a=i.input_mobile&&i.input_mobile.$el.find("input").val(),o=i.input_address&&i.input_address.$el.find("input").val(),r=i.input_email&&i.input_email.$el.find("input").val(),s=i.input_memo&&i.input_memo.$el.find("textarea").val();i.isValid(n,a,o,r)&&_g.ajax.post({dataType:"JSON",url:"/share/"+t+"/signup",data:{share_id:e,fullname:n,mobile:a,address:o,email:r,memo:s},callback:function(e){200==e.code?(interaction_view.events.onUserList(i.button,80),"function"==typeof epub360FromSubmited&&epub360FromSubmited()):interaction_view.events.onUserList(i.button,81)},onError:function(){interaction_view.events.onUserList(i.button,81)}})})}})}),define("interaction_view/model/contactForm",["interaction_view/model/infoForm"],function(){interaction_view.model.ContactForm=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.ContactForm({model:this})},setsyncmodel:function(){}}),interaction_view.view.ContactForm=interaction_view.view.InfoForm.extend({bindSubmitTrigger:function(e){var t=this,i="tap";t.button.$el.find("img.iconNormal").hammer().on(i,function(){var i=t.input_fullname&&t.input_fullname.$el.find("input").val(),n=t.input_mobile&&t.input_mobile.$el.find("input").val(),a=t.input_address&&t.input_address.$el.find("input").val(),o=t.input_email&&t.input_email.$el.find("input").val(),r=t.input_memo&&t.input_memo.$el.find("textarea").val();t.isValid(i,n,a,o)&&_g.ajax.post({dataType:"JSON",url:"/manage/book/"+interaction_view.doc.id+"/form/",data:{id:t.model.get("id"),title:t.model.get("iDetail").title,share_id:e,fullname:i,mobile:n,address:a,email:o,memo:r},callback:function(e){200==e.code?(interaction_view.events.onContactFormSubmit(t.button,82),"function"==typeof epub360FromSubmited&&epub360FromSubmited()):interaction_view.events.onContactFormSubmit(t.button,83)},onError:function(){interaction_view.events.onContactFormSubmit(t.button,83)}})})}})}),define("interaction_view/model/plugin",["interaction_view/model/base","text!interaction_view/template/offline_info.js"],function(){require("text!interaction_view/template/offline_info.js");interaction_view.model.Plugin=interaction_view.model.Base.extend({defaults:{iType:"Plugin",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Plugin({model:this})},setsyncmodel:function(){}}),interaction_view.view.Plugin=interaction_view.view.Base.extend({events:{},render:function(){var e=this.getdetail();this.$el.children(".Element").html(e.iSource),this.model.renderWebContent=!0},renderWebContent:function(){this.getdetail()},clearWebContent:function(){}})}),define("interaction_view/model/select",["interaction_view/model/base"],function(){interaction_view.model.Select=interaction_view.model.Base.extend({defaults:{iType:"Select",iCommon:{portait:{iStartx:400,iStarty:200,iWidth:200,iHeight:200},landscape:{iStartx:400,iStarty:200,iWidth:200,iHeight:200}},iDetail:{},iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1",callback:null},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.Select({model:this})},setsyncmodel:function(){}}),interaction_view.view.Select=interaction_view.view.Base.extend({events:{},render:function(){var e=this,t=this.getdetail();this.$el.find("select").on("change",function(){console.log($(this).val()),interaction_view.events.onFormEvent(e.model,$(this).val())});var i=interaction_view.events.onFormButtonRender(this.model);if(console.log(i),this.$el.find("select").empty(),t.placeholder&&this.$el.find("select").append("<option>"+t.placeholder+"</option>"),i.field){for(var n=i.field.i.field_options.options,a=0;a<n.length;a++)this.$el.find("select").append("<option value="+n[a].label+">"+n[a].label+"</option>");i.value&&this.$el.find("select").val(i.value)}},resetOtherStatus:function(){var e=interaction_view.events.onFormButtonRender(this.model);e.value&&this.$el.find("select").val(e.value)}})}),define("interaction_view/model/systemvariable",["interaction_view/model/base"],function(){interaction_view.model.SystemVariable=interaction_view.model.Base.extend({defaults:{iType:"SystemVariable",iVisibility:!0,iCommon:null,iDetail:{},iParentModel:null,iTemplate:null,iParentdiv:".interaction-view",iAutoindex:!1,iSync:!1,iZindex:"-1"},setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.SystemVariable({model:this})},setsyncmodel:function(){}}),interaction_view.view.SystemVariable=interaction_view.view.Base.extend({events:{},renderDynamicElement:function(){},render:function(){this.model._reset=!0},preload:function(){},afterpreload:function(){if(this.model.pageid=this.model.get("pageid"),this.model.parentpageid=this.model.get("parentpageid"),"LayerRef"==this.model.get("pagetype")){var e=this.model.get("parentpageid"),t=this.model.get("layerid"),i=interaction_view.getParentpage(e);this.model.parentpage=i,this.model.page=i.iOverlaylist.get(this.model.pageid).layer[t]}else this.model.page=interaction_view.getParentpage(this.model.pageid);this.preloaded=!0},triggerVarChange:function(){var e=this.getdetail();1==e.immediate&&interaction_view.events.onSystemVariableChanged(this)}})}),define("interaction_view/model/qqvideo",["interaction_view/model/video"],function(){interaction_view.model.QQVideo=interaction_view.model.Video.extend({defaults:{iType:"QQVideo",iLock:!0,iVisibility:!0,iCommon:{},iDetail:{},iAutoindex:!1,iSync:!1,iZindex:"-1",iUrl:null,callback:null},setview:function(){this.iview=new interaction_view.view.QQVideo({model:this})}}),interaction_view.view.QQVideo=interaction_view.view.Video.extend({events:{},render:function(){this.file,this.model._reset=!0},setOtherDisplay:function(){this.model.media&&interaction_view.media.pause(this.model)},preload:function(){var e=this.getdetail();e.vid&&(this.preloadmodel=this.sendToPreload({vid:e.vid}))},resetOtherStatus:function(){this.model.hided||this.model.media&&(interaction_view.media.video.reset(this.model),this.model.get("iDetail").iControl&&this.$el.find(".jwdisplayIcon").css({opacity:1}))}})}),define("interaction_view/model/MobileValid",["interaction_view/model/userList"],function(){interaction_view.model.MobileValid=interaction_view.model.Base.extend({setcollection:function(){iOverlaylist.get(this.id)||iOverlaylist.add(this)},setview:function(){this.iview=new interaction_view.view.MobileValid({model:this})},setsyncmodel:function(){}}),interaction_view.view.MobileValid=interaction_view.view.Base.extend({render:function(){this.model._reset=!0,this.binded=!1},getRelationOverlay:interaction_view.view.UserList.prototype.getRelationOverlay,resetOtherStatus:function(){this.binded||(this.input_mobile=this.getRelationOverlay(0),this.input_valid=this.getRelationOverlay(1),this.button=this.getRelationOverlay(2),this.input_valid.$el.find("input")[0].type="number",this.bindSubmitTrigger(),this.binded=!0)},isValid:function(e){if(!$.trim(e))return interaction_view.application.errorAlert("è¯·è¾å¥ææºå·ç ï¼"),!1;var t=/^0?1[3|4|5|7|8][0-9]\d{8}$/;return t.test(e)?!0:(interaction_view.application.errorAlert("è¯·è¾å¥æ­£ç¡®ææºå·ç ï¼"),!1)},bindSubmitTrigger:function(){var e=this,t=this.input_mobile.model.attributes.iDetail.app_id;if(t){var i="tap",n=[e.button.$el.find(".iText>div").text(),"ç§åéæ°åé"];e.button.$el.hammer().on(i,function(){if(e.button.$el.find(".iText>div").text()==n[0]){var i=e.input_mobile&&e.input_mobile.$el.find("input").val();e.isValid(i)&&(e.input_valid.$el.find("input").val(""),_g.ajax.post({dataType:"JSON",url:"/form/"+t+"/verifymobile/",data:{mobile:i},callback:function(t){function i(e){0==a?e.text(n[0]):(e.text(a+"ç§åéæ°è·åéªè¯ç "),a--,setTimeout(function(){i(e)},1e3))}if(400==t.code)interaction_view.application.errorAlert("ææºå·æè¯¯ï¼");else if(409==t.code)interaction_view.application.errorAlert("æ­¤ææºå·å·²ç»åä¸è¿ï¼è¯·ä½¿ç¨å¶ä»å·ç ï¼");else if(200==t.code){var a=60;i(e.button.$el.find(".iText>div"))}else interaction_view.application.errorAlert(t.msg)},onError:function(){interaction_view.application.errorAlert("ç³»ç»éè¯¯ï¼è¯·éè¯ï¼")}}))}}),interaction_view.environment.otherFormValue.veriyCode="",e.input_valid.$el.find("input").change(function(){interaction_view.environment.otherFormValue.veriyCode={value:$(this).val(),errMsg:"è¯·è¾å¥éªè¯ç ï¼"}})}}})}),epub360.PlayerPlugins.push({config:{type:"ContentTemplate",template:"Paragraph"},render:function(){this.updateTemplate()},updateTemplate:function(){var e=this.getdetail(),t=this.$el.find(".iParagraph>.paragraph>div"),i=_.find(e.templates,function(t){return t.id==e.styleIndex});if(i&&i.detail)if(0!=e.data.length&&e.data){t.html("<div class='contentList'></div>"),t=t.find(".contentList");var n=$("<div></div>");n.html(i.detail),_.each(e.data,function(i){var a=n.clone();a.find("[es-title]").each(function(t,n){var o=$(n).attr("es-title"),r=_.find(e.structure,function(e){return e.title==o}),s=_.indexOf(e.structure,r);if("text"==r.type||"paragraph"==r.type?$(n).text(i[s].value):"img"==r.type&&$(n).css("background-image","url("+i[s].value+")"),r.show&&i[s].show||a.find("[es-order="+r.order+"]").hide(),i[s].show&&_.include(["0","1","2"],i[s].linktype+"")){var l={page_id:i[s].linkvalue,url:i[s].linkvalue};$(n).removeAttr("href").addClass("hasaction"),$(n).hammer().on("tap",function(){interaction_view.renderLink(i[s].linktype,l)})}}),t.append(a)})}else t.html("<div class='contentList'>"+i.detail+"</div>"),_.each(e.structure,function(e){e.show||t.find("[es-order="+e.order+"]").hide()})},renderScroll:function(){this.scrollview&&this.scrollview.destroy();var e=this.$el.find(".iParagraph>.paragraph>div"),t=e.height();this.scrollView=new IScroll(e[0],{mouseWheel:!0,click:!0,probeType:3,wrapperHeight:t,HWCompositing:!1}),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY"),this.$el.addClass("hasaction")},immediateRender:function(){this.renderScroll(),console.log("åç´ å¼å§å¨é¡µé¢æ­æ¾")},setotherdisplay:function(){},otherOnShow:function(){this.renderScroll()},otherOnHide:function(){console.log("element hided")}}),define("interaction_view/components/contenttemplate",function(){}),epub360.PlayerPlugins.push({config:{type:"StaticList",template:"Paragraph"},render:function(){this.updateTemplate()},updateTemplate:function(){var e=this.getdetail(),t=this.$el.find(".iParagraph>.paragraph>div"),i=_.find(e.templates,function(t){return t.id==e.styleIndex});if(i&&i.detail)if(0!=e.data.length&&e.data){t.html("<div class='contentList'></div>"),t=t.find(".contentList");var n=$("<div></div>");n.html(i.detail),_.each(e.data,function(i){var a=n.clone();a.find("[es-title]").each(function(t,n){var o=$(n).attr("es-title"),r=_.find(e.structure,function(e){return e.title==o}),s=_.indexOf(e.structure,r);if("text"==r.type||"paragraph"==r.type?$(n).text(i[s].value):"img"==r.type&&$(n).css("background-image","url("+i[s].value+")"),r.show&&i[s].show||a.find("[es-order="+r.order+"]").hide(),i[s].show&&_.include(["0","1","2"],i[s].linktype+"")){var l={page_id:i[s].linkvalue,url:i[s].linkvalue};$(n).removeAttr("href").addClass("hasaction"),$(n).hammer().on("tap",function(){interaction_view.renderLink(i[s].linktype,l)})}}),t.append(a)})}else t.html("<div class='contentList'>"+i.detail+"</div>"),_.each(e.structure,function(e){e.show||t.find("[es-order="+e.order+"]").hide()})},renderScroll:function(){this.scrollview&&this.scrollview.iScroll.destroy();var e=this,t=this.$el.find(".contentList"),i=t.parent(),n=t.outerHeight(),a=_g.ui.isOverflowed(i).y,o=n-i.height();a&&(this.scrollview=new _g.scrollview({containment:i,contentel:t,mask_width:i.width(),mask_height:i.height(),content_width:i.width,content_height:n,content_x:0,content_y:0,scrollY:!0,HWCompositing:!1,onScrolling:function(t){a&&(Math.abs(t.deltaY)>o+30||t.deltaY>30)&&(i.addClass("is_exceededY"),e.$el.children(".Element").removeClass("disableDragY iMouseWheel disableMouseWheelY"))},onScrollend:function(){a&&i.removeClass("is_exceededY")}}),this.$el.children(".Element").addClass("disableDragY iMouseWheel disableMouseWheelY"))},immediateRender:function(){this.renderScroll(),console.log("åç´ å¼å§å¨é¡µé¢æ­æ¾")},setotherdisplay:function(){},otherOnShow:function(){console.log("element shown"),this.renderScroll()},otherOnHide:function(){console.log("element hided")}}),define("interaction_view/components/staticlist",function(){}),epub360.PlayerPlugins.push({config:{type:"Puzzle",Model:"ImageBlock",template:['<div class="iView dynamic hide <%=isMasterOverlay?"masterhide":""%>" data-type="<%=iType%>" id="<%=id%>" style="width: 0px; height: 0px; backgroud-repeat:no-repeat;background-postion:center;">','<div class="iPuzzle Element" style="position:absolute;left: -<%=iCommon[iPageDirection].iWidth/2%>px; top: -<%=iCommon[iPageDirection].iHeight/2%>px;width:<%=iCommon[iPageDirection].iWidth%>px;height:<%=iCommon[iPageDirection].iHeight%>px;">','<div class="el_wrap bk_full" style="position:absolute;left:0;top:0;width:100%;height:100%;position:absolute;<%=iDetail.iStyle%>">',"</div>","</div>","</div>"].join("")},render:function(){var e=this.getdetail();if("Puzzle"==this.model.get("iType")){var t=this.model.id;$(this.container).find("#"+t).find(".el_wrap").html(e.itemplateOn);var i=$(this.container).find("#"+t).find("[es-type=img]");_.each(i,function(t,i){var n=e.iImg;n&&n[i]&&$(t).css({"background-image":"url("+n[i].picture+")","background-position":n[i].iStyle}),e.templateStyle&&$(t).css("border-radius",e.templateStyle.borderRadius).parent().css("padding",e.templateStyle.blockpadding)}),console.log("åç´ å·²ç»å®æå¨é¡µé¢çå±ç°")}},immediateRender:function(){console.log("åç´ å¼å§å¨é¡µé¢æ­æ¾")},setOtherDisplay:function(){var e=this.getdetail();e.iFullview&&this.fullview()},otherOnShow:function(){console.log("element shown")},otherOnHide:function(){console.log("element hided")},fullview:function(){var e=this,t=this.getdetail();if(this.$el.addClass("hasaction"),"undefined"!=typeof wx_permissions&&wx_permissions.previewImage)wx.previewImage({current:t.iImg[index].picture,urls:_.map(t.iImg,function(e){return e.picture})});else if(t.iImg&&t.iImg.length>0){var i=e.$el.children(".Element").find("[es-type=img]");_.each(i,function(i,n){$(i).on("click",function(){var i=n;if(!(i>=t.iImg.length)){var a={picture:t.iImg[i].picture,width:t.iImg[i].width,height:t.iImg[i].height,model:e.model,index:i};e.setFullView(a)}})})}},isFullSwitch:function(){return!1}}),define("interaction_view/components/puzzle/puzzle",function(){}),epub360.PlayerPlugins.push({config:{type:"Linkage",template:"others"},render:function(){var e=this.getdetail(),t=e.end-e.start||0;if((0!=e.range||0!=t)&&e.iBindings&&e.iBindings.length){if(this.iBindings=e.iBindings,this.range=e.range||Math.abs(e.end-e.start),this.start=e.delay||0,this.end=this.start+this.range,this.control_start=0,this.stretch=e.stretch||0,this.control_end=this.end+(e.stretch||0),this._current=e.init_position||0,this.current=this._current,this._delta=0,this.axis=e.axis,this.oneway=e.oneway,this.orientation=e.axis<=1,this.init_progress=null,this.inertia=e.inertia,this.tmp_current=this._current,this.current>=this.start&&this.current<=this.end&&(this.init_progress=(this.current-this.start)/this.range),1===this.axis||3===this.axis)var i="disableDragY iMouseWheel disableMouseWheelY dragConnector";else var i="disableDragX iMouseWheel disableMouseWheelX dragConnector";this.$el.closest(".Presentation").addClass(i),this.$el.closest(".Presentation").data("dragfuncs")||this.$el.closest(".Presentation").data("dragfuncs",[]),this.$el.closest(".Presentation").data("dragfuncs").push({func:this.control,start:this.start,end:this.end,axis:this.axis}),this._init_progress=this.init_progress}},renderBindings:function(){if(this.iBindings&&this.iBindings.length){this.timelines=[];for(var e=0;e<this.iBindings.length;e++){var t=[],i=this.iBindings[e];if("maintimeline"==i.id)var n=this.model.page.iAnimationlist.timeline;else{t=[i];var n=animateTimeline.generateTimeline({onStart:null,ids:t,iPage_id:i.page_id,page:this.model.page,paused:!0,foraction:!0})}n&&this.timelines.push({timeline:n,type:0,id:i.id,page_id:i.page_id})}null!=this.init_progress&&this.progress(this.init_progress,!0)}},control:function(e,t,i){if(this.range&&(console.log(e),this.timelines&&this.timelines.length)){if(i){if(!this.inertia)return;this.orientation||(t=-t);var n=this.current-t;if(this.oneway&&this.tmp_current&&n<this.tmp_current)return;if(n<this.control_start?n=this.control_start:n>this.control_end&&(n=this.control_end),n==this.current)return;if(this.current=n,this.tmp_current=n,n>=this.start&&n<=this.end){var a=Math.abs(n-this.start)/this.range;this.progress(a)}return null}if("dragend"==e.type){var n=this.current-this._delta;if(this._delta=0,n<this.control_start?n=this.control_start:n>this.control_end&&(n=this.control_end),n==this.current)return;if(this.current=n,this.oneway){if(this.current<this.tmp_current)return void(this.current=this.tmp_current);this.tmp_current=this.current}if(n>=this.start&&n<=this.end){var a=Math.abs(n-this.start)/this.range;this.progress(a)}return null}this.orientation||(t=-t);var o=this.orientation?1:-1;this._delta=t;var n=this.current-t;if(n!==this.current&&!(this.oneway&&this.tmp_current&&n<this.tmp_current)){if(n>=this.control_start&&n<=this.control_end){if(this.tmp_current=n,n>=this.start&&n<=this.end){var a=Math.abs(n-this.start)/this.range;this.progress(a)}return 0}return n<this.control_start?(n-this.control_start)*o:n>this.control_end?(n-this.control_end)*o:void 0}}},progress:function(e,t){this.inverse&&(e=1-e);for(var i=0;i<this.timelines.length;i++){var n=this.timelines[i].timeline;if(t||n.pause(),console.log(e),n.totalProgress(e),e>0&&1>e&&n.elements.length)for(var a=0;a<n.elements.length;a++)$(n.elements[a]).removeClass("hide")}},resetOtherStatus:function(){console.log("åç´ ç¶æéç½®äº")},immediateRender:function(){console.log("åç´ å¼å§å¨é¡µé¢æ­æ¾")},onInitialize:function(){console.log("åç´ åå§å")},onEpubReady:function(){console.log("Epubå·²ç»åå§åå®æ")},onStop:function(){if(console.log("åç´ å¨å½åé¡µåæ­¢æ­æ¾"),this.timelines&&this.timelines.length){for(var e=0;e<this.timelines.length;e++){var t=this.timelines[e].timeline;t.pause(0),t.kill()}this.timelines=[]}this.current=this._current,this._delta=0,this.tmp_current=this._current,this.init_progress=this._init_progress},onPlay:function(){this.renderBindings()}}),define("interaction_view/components/linkage/linkage",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:200,exec:function(e){console.log(e),console.log(e.executeactions);var t=e.model.get("iDetail"),i=t.results[0].values,n=t.results[0].ani_iType;if(i&&i.length&&n){for(var a=t.results[0].ani_duration,o=t.results[0].ani_delay,r=t.results[0].ani_repeat,s=[],l=0;l<i.length;l++){var c=i[l],d=c.page_id,h=interaction_view.getAnimationPage(d,e.model.page),u=h.iOverlaylist.get(c.id);if(u&&u.iview&&u.iview.$el){var p={el:u.iview.$el.children(".Element"),type:n,delay:o,duration:a,repeat:r,onShow:u.iview.onShow};s.push(p)}}if(s.length){var m=new Animate({items:s,className:"child_Action_Element",autoClear:!0,onStart:function(){if(e.executeactions.length)for(var t=0;t<e.executeactions.length;t++){var i=e.executeactions[t];"cssanimatestart"==i.attributes.iDetail.customType&&i.iview.executeAction(i.iview)}},onEnd:function(){if(e.executeactions.length)for(var t=0;t<e.executeactions.length;t++){var i=e.executeactions[t];"cssanimateend"==i.attributes.iDetail.customType&&i.iview.executeAction(i.iview)}}});m.play()}}},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),o=new interaction_view.model.Action(a);o.iview.render(),e.executeactions.push(o)}}}}),define("interaction_view/actionexecutes/cssanimateaction/cssanimateaction",function(){}),epub360.PlayerPlugins.push({type:"actionexecute",config:{type:201,exec:function(e){console.log(e),console.log(e.executeactions);var t=e.model.get("iDetail"),i=t.results[0],n=new dboperate(i);if(n.init(),e.executeactions.length)for(var a=0;a<e.executeactions.length;a++){var o=e.executeactions[a];"dboperatesuccess"==o.attributes.iDetail.customType&&o.iview.executeAction(o.iview)}},setExecuteActions:function(e,t,i){i||(i={}),console.log(i),e.executeactions=[];for(var n=0;n<t.length;n++){var a=$.extend(!0,{},t[n]),o=new interaction_view.model.Action(a);o.iview.render(),e.executeactions.push(o)}}}}),define("interaction_view/actionexecutes/datalist/datalist",function(){}),epub360.PlayerPlugins.push({type:"action",config:{type:"customtypeaction",func:function(e,t){console.log(t),e.view.overlaymodel.iview.$el.children(".Element").on("click",function(){e.func()})}}}),define("interaction_view/actions/demo/demo",function(){}),define("interaction_view/model/main",["interaction_view/model/action","interaction_view/model/animation_view","interaction_view/model/audio","interaction_view/model/cycleimage","interaction_view/model/image","interaction_view/model/page","interaction_view/model/doc","interaction_view/model/preload","interaction_view/model/richtext","interaction_view/model/slide","interaction_view/model/video","interaction_view/model/button","interaction_view/model/map","interaction_view/model/pay","interaction_view/model/link","interaction_view/model/layerref","interaction_view/model/layerslide","interaction_view/model/binding","interaction_view/model/Grid","interaction_view/model/Cell","interaction_view/model/TextLabel","interaction_view/model/TabBar","interaction_view/model/SearchInput","interaction_view/model/Tree","interaction_view/model/gallery","interaction_view/model/PageIndex","interaction_view/model/webcontent","interaction_view/model/formview","interaction_view/model/shape","interaction_view/model/BookButton","interaction_view/model/dragdrop","interaction_view/model/dragdropgroup","interaction_view/model/variable","interaction_view/model/timer","interaction_view/model/vote","interaction_view/model/paragraph","interaction_view/model/input","interaction_view/model/textarea","interaction_view/model/selectbutton","interaction_view/model/submitbutton","interaction_view/model/selectbox","interaction_view/model/imageblock","interaction_view/model/weixincamera","interaction_view/model/weixinvoice","interaction_view/model/infoList","interaction_view/model/chartList","interaction_view/model/component","interaction_view/model/componentref","interaction_view/model/textbutton","interaction_view/model/collision","interaction_view/model/usersvg","interaction_view/model/avatar","interaction_view/model/avatarList","interaction_view/model/initButton","interaction_view/model/userList","interaction_view/model/infoForm","interaction_view/model/contactForm","interaction_view/model/plugin","interaction_view/model/select","interaction_view/model/systemvariable","interaction_view/model/qqvideo","interaction_view/model/MobileValid","interaction_view/components/contenttemplate","interaction_view/components/staticlist","interaction_view/components/puzzle/puzzle","interaction_view/components/linkage/linkage","interaction_view/actionexecutes/cssanimateaction/cssanimateaction","interaction_view/actionexecutes/datalist/datalist","interaction_view/actions/demo/demo"],function(){}),define("text!interaction_view/template/alertbox.js",[],function(){return'<div class="alert-box"><div class="alert-msg"><%=text%></div><div class="alert-title"><a class="alert-confirm" href="#">ç¡®å®</a></div></div>'
}),define("interaction_view/ui/main",["jquery","backbone","text!interaction_view/template/message.js","text!interaction_view/template/alertbox.js"],function(){var e=require("text!interaction_view/template/message.js"),t=require("text!interaction_view/template/alertbox.js");return window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelnimationFrame,{message:function(t,i,n){0==$("body").find(".msg").length&&$("body").append('<div class="msg"></div>'),n||(n=3e3),$(".msg").html(_.template(e,{type:t,msg:i})),$(".msg").fadeIn(),setTimeout(function(){$(".msg").fadeOut("slow"),$(".msg").remove()},n)},getRequest:function(e){var t=location.search,i={};if(-1!=t.indexOf("?")){var n=t.substr(1);strs=n.split("&");for(var a=0;a<strs.length;a++)i[strs[a].split("=")[0]]=unescape(strs[a].split("=")[1])}return e?i[e]:i},deviceType:function(){return"iPad"==navigator.userAgent.match(/iPad/i)?"iPad":"iPhone"==navigator.userAgent.match(/iPhone/i)?"iPhone":"Android"==navigator.userAgent.match(/Android/i)?"Android":"BlackBerry"==navigator.userAgent.match(/BlackBerry/i)?"BlackBerry":"null"},getModelById:function(e,t){var i=null;return e.icollection.each(function(e){e.id==t&&(i=e);var n=interaction_view.getModelById(e,t);n&&(i=n)}),i},model2collection:function(e,t){e.has(t)&&e.icollection.add(e.get(t))},model2tree:function(e,t,i){e.has(t)&&(e.icollection.add(e.get(t)),e.icollection.each(function(e){e.has(i)&&interaction_view.model2tree(e,i,i)}))},getPageIds:function(){var e=[];return $(".reveal").find("section").each(function(){e.push($(this).attr("id"))}),e},createPath:function(e){var t=[];return e.isSubOverlay?t=$.extend(!0,[],e.path):t.push({type:"page",id:e.page_id}),t.push({type:e.model.get("iType"),id:e.model.id}),e.layer_id&&t.push({type:"layer",id:e.layer_id}),t},hashPath:function(e){return _.pluck(e,"id").join("")},getContainerDivByPath:function(e){var t=$(".interaction-view");if(!e)return $(".interaction-view");for(i=0;i<e.length;i++)"page"==e[i].type?interaction_view.ipagelist.getPage(e[i].id)?t=$('.Presentation[id="'+e[i].id+'"]').find(".interaction-view").first():(interaction_view.imasterlist.get(e[i].id)||interaction_view.ibackgroundlist.get(e[i].id))&&(t=$('.Presentation[id="'+interaction_view.currentPage+'"]').find(".interaction-view").first()):t="layer"==e[i].type?t.find('div.layer-item[data-id="'+e[i].id+'"]').first():t.find('div.iView[id="'+e[i].id+'"]').first().children(".Element");return t},getContainerModelByPath:function(e){var t=null;for(i=0;i<e.length;i++)if(t="page"==e[i].type?interaction_view.getParentpage(e[i].id):"layer"==e[i].type?t.layer[e[i].id]:t.iOverlaylist.get(e[i].id),!t)return null;return t},formatLabel:function(e){var t,i="",n="",a="";return e.iPosition||(t="left"),1==e.iPosition&&(t="center"),2==e.iPosition&&(t="right"),void 0!=e.radius&&(i="border-top-left-radius:"+e.radius+"px; border-top-right-radius:"+e.radius+"px; border-bottom-right-radius:"+e.radius+"px; border-bottom-left-radius:"+e.radius+"px;"),void 0!=e.border_color&&e.border_size&&(n="border:"+e.border_size+"px solid "+e.border_color+";"),void 0!=e.bg_color&&(a="background-color:"+e.bg_color+";"),e.el?($(e.el).css({"font-size":e.font_size,color:e.text_color,"text-align":t}),void(i&&$(e.el).css("border-radius",e.radius+"px"))):'<p style="text-align:'+t+";font-size:"+e.font_size+"px;color:"+e.text_color+";"+i+n+a+'">'+e.text+"</p>"},getWebContentSrc:function(e){switch(e.contentType){case 0:if(e.iUrl){var t=-1!=e.iUrl.indexOf("http://")?e.iUrl:0==e.iUrl.indexOf("/")?e.iUrl:"http://"+e.iUrl;return{src:t,content:null}}return null;case 1:if(e.iFile&&e.iFile[0]&&e.iFile[0].file){if("undefined"==typeof cbt_data||interaction_view.forpreview)var t=e.iFile[0].file.replace(".zip","/");else var t=e.iFile[0].file.replace(".zip","/index.html");return{src:t,content:null}}return null;case 2:return e.iSource?{src:null,content:e.iSource}:null}},getAnimationPage:function(e,t){return interaction_view.getParentpage(e)?interaction_view.getParentpage(e):t},filterAnimations:function(e,t,i,n){var a=_.filter(e,function(e){var t=e.toJSON();return t.iTiming&&t.iTiming.waitaction&&!interaction_view.SinglePreview&&!n?!1:0==t.iKind&&t.iGroup_id&&!i?!1:t.isH5?!1:!0});return a},preloadImg:function(e){var t=new Image;t.onload=function(){},t.src=e},drawImg:function(e,t,i,n){console.log(i);try{n.clearRect(0,0,2*e.canvas_width,2*e.canvas_height),n.drawImage(e.model.iImgs[i],0,0,2*e.canvas_width,2*e.canvas_height),this.onload=null}catch(a){console.log(a)}},getOverlays:function(e,t){var i=[];if(i=0==interaction_view.imasterlist.length?iMasterlist.at(0).overlaylist.models:interaction_view.imasterlist.at(0).iOverlaylist.models,interaction_view.currentPage==t)i=_.union(i,interaction_view.getAnimationPage(interaction_view.currentPage).iOverlaylist.models);else if(interaction_view.ilayerlist.get(t)){var n=interaction_view.getAnimationPage(interaction_view.currentPage).iOverlaylist.models.filter(function(e){return"LayerRef"==e.attributes.iType&&e.layer[t]});n&&n.length&&(i=_.union(i,n[0].layer[t].iOverlaylist.models))}return _.filter(i,function(t){return t.attributes.iType==e})},getVarsOp:function(e,t,i){"undefined"!=typeof t&&t&&t.length||(t=[0,1,2]),_.each(t,function(e,i){t[i]=String(e)});var n=_.filter(interaction_view.getOverlays("Variable",e),function(e){return _.include(t,String(e.attributes.iDetail.iKind))});n=_.union(n,interaction_view.getOverlays("Paragraph",e)),i&&(n=_.union(n,i));var a="@",o=/@/g,r=/\@[^\@]+\@/g,s=function(e){if(!c(e))return e;if("@å¾®ä¿¡_ç¨æ·æµç§°@"==e)return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname?epub360_userinfo.nickname:"@å¾®ä¿¡_ç¨æ·ææ_æªå¯ç¨@";if("@å©å_ç¨æ·èº«ä»½@"==e)return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname?interaction_view.environment.Shareapp.usertype():"@å©å_ç¨æ·ææ_æªå¯ç¨@";if("@å©å_å©åæ°@"==e)return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname?interaction_view.environment.Shareapp.total():"@å©å_ç¨æ·ææ_æªå¯ç¨@";if("@å©å_æ¯å¦åèµ·@"==e)return 2==interaction_view.environment.Shareapp.status?1:0;var t;e=e.replace(o,"");var i=interaction_view.application.getFormFieldValue(e);if(null!=i)return i;if(ids=e.split("_"),ext=ids.length>1?ids[1]:"",ids.length>1&&["position","voted"].indexOf(ext)>-1?e=ids[0]:ext="",t=_.filter(n,function(t){return t.id==e}),t.length){var a=t[0],r=t[0].attributes.iDetail;if("Vote"==a.get("iType")){var s=parseInt(r.initial);return""==ext?s=a.get("value")||parseInt(r.initial):"position"==ext?s=a.get("position")||0:"voted"==ext&&(s=a.get("voted")||0),s}if("undefined"!=typeof r.initial)return String(r.initial);if("undefined"!=typeof r.iText){var l=String(t[0].iview.userContent||r.iText),d=l.replace(/<br>/g,"\n").replace(/<\/div><div>/g,"\n").replace("<div>","").replace("</div>","");return d}return String(t[0].get("suboverlays")[0].iDetail.iValue)}return"0"},l=function(e){var t=String(e),i=t.match(r);return _.each(i,function(e){t=t.replace(e,s(e))}),t},c=function(e){return e&&e[0]==a},d=function(e){var t=String(e),i=t.match(r);return i&&i.length?!0:!1};return{vars:n,var2val:function(e,t){var i=String(e),a=i.match(r);return n&&n.length||a?t?l(e):Number(s(e))||0:e},beginWithAT:c,hasAT:d}},getParentpage:function(e){return interaction_view.ipagelist.getPage(e)||interaction_view.imasterlist.get(e)||interaction_view.ibackgroundlist.get(e)},getPageType:function(e){return interaction_view.imasterlist.length&&e.model.page.id==interaction_view.imasterlist.at(0).id?"master":interaction_view.ibackgroundlist.length&&e.model.page.id==interaction_view.ibackgroundlist.at(0).id?"background":"page"},getPageType2:function(e){return e.isMasterOverlay?"master":e.isBackgroundOverlay?"background":"page"},imageEditor:function(e,t,i,n,a,o){$(".reveal").addClass("noevents");var r,s;r=$.zoom?t*$.zoom:t,s=$.zoom?i*$.zoom:i;var l=e.iview.$el.children(".Element").offset(),c=$.zoom?l.left*$.zoom:l.left,d=$.zoom?l.top*$.zoom:l.top,h=_.isNaN(Number(e._rotate))?0:Number(e._rotate),u=_.isNaN(Number(e._scale))?1:Number(e._scale),p=_.isNaN(Number(e._x))?0:Number(e._x),m=_.isNaN(Number(e._y))?0:Number(e._y),f="rotate("+h+"deg) scale("+u+") skew(0deg) translate("+p+"px ,"+m+"px)";e.iview.$el.find("img").css({"-webkit-transform":f,width:"100%",height:"auto"}),interaction_view.imageEditorClear(),interaction_view.containment.append('<div class="editor_mask" style="opacity:0;"></div>'),interaction_view.containment.append('<div class="imageeditorcontainer"><div class="imageeditor" style="position:absolute;left:'+c+"px;top:"+d+"px;width:"+r+"px;height:"+s+'px;z-index:999999999;"><img src="'+n+'" style="width:100%;opacity:0;"></div></div>'),"undefined"!=typeof epub360&&epub360.settings&&["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type)>=0&&interaction_view.containment.append('<div style=" padding-bottom: 3px;display: inline-block;z-index: 999999999;position: absolute; bottom: 10px;  text-align: center; width: 100%;"><a href="http://www.epub360.com/?utm_source=epub360&amp;utm_medium=player&amp;utm_content=%E5%85%8D%E8%B4%B9%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81&amp;utm_campaign=loading" target="_blank" style="color: #c9c9c9;font-size: 14px;padding: 8px 14px;background: #a1a1a1;border-radius: 15px; -moz-border-radius: 15px;" class="advertise">Epub360.com ææ¯æ¯æ</a></div>'),interaction_view.containment.append('<div class="imageeditorbuttons"><button class="weixinbutton chooseimage"></button><button class="weixinbutton imageconfirm"></button></div>'),interaction_view.bindImageEditor($(".imageeditor").children("img"),h,u,p,m,e),$(".imageconfirm").on("click",function(){var e=$(".imageeditor").children("img").data();return a&&a(e.x||0,e.y||0,e.scale||1,e.rotate||0),interaction_view.imageEditorClear(),$(".reveal").removeClass("noevents"),!1}),$(".chooseimage").on("click",function(){return interaction_view.weixin.chooseimage(function(e){e&&(interaction_view.localIds=e,o(e[0]))}),!1}),setTimeout(function(){$(".imageeditorcontainer").on("click",function(e){if($(e.target).is(e.currentTarget)){var t=$(".imageeditor").children("img").data();a&&a(t.x||0,t.y||0,t.scale||1,t.rotate||0),interaction_view.imageEditorClear(),$(".reveal").removeClass("noevents")}})},500)},imageEditorClear:function(){$(".editor_mask").remove(),$(".imageeditorcontainer").remove(),$(".voiceeditor").remove(),$(".imageeditor-confirm").remove(),$(".weixinbutton").remove(),$(".advertise").remove(),$(".imageeditorbuttons").remove()},bindImageEditor:function(e,t,i,n,a,o){var r=!1,s=0,l=1;e.data({rotate:t,scale:i,x:n,y:a}),e.hammer().on("drag",function(e){if(!r){var s=n+e.gesture.deltaX,l=a+e.gesture.deltaY,c="rotate("+t+"deg) scale("+i+") skew(0deg) translate("+s+"px, "+l+"px)";o.iview.$el.find("img").css({transform:c,"-webkit-transform":c}),$(".imageeditorbuttons").hide(),e.gesture.preventDefault()}}),e.hammer().on("rotate",function(c){r=!0,l=c.gesture.scale;var d=i+(l-1);s=c.gesture.rotation;var h=t+s;e.data({scale:d,rotate:h,x:n,y:a});var u="rotate("+h+"deg) scale("+d+") skew(0deg) translate("+n+"px ,"+a+"px)";o.iview.$el.find("img").css({transform:u,"-webkit-transform":u}),$(".imageeditorbuttons").hide(),c.gesture.preventDefault()}),e.hammer().on("pinch",function(c){r=!0,l=c.gesture.scale;var d=i+(l-1);s=c.gesture.rotation;var h=t+s;e.data({scale:d,rotate:h,x:n,y:a}),$(".imageeditorbuttons").hide();var u="rotate("+h+"deg) scale("+d+") skew(0deg) translate("+n+"px ,"+a+"px)";o.iview.$el.find("img").css({transform:u,"-webkit-transform":u}),c.gesture.preventDefault()}),e.hammer().on("dragend",function(o){var c=o.gesture.deltaX,d=o.gesture.deltaY;r?(t+=s,i+=l-1,e.data({rotate:t,scale:i,x:n,y:a})):(n+=c,a+=d,e.data({rotate:t,scale:i,x:n,y:a})),s=0,l=1,r=!1,$(".imageeditorbuttons").show()})},imageUploader:function(e,t){wx.uploadImage({localId:e,success:function(e){var i=context_url+"uploadimage";_g.ajax.post({url:i,data:{serverid:e.serverId},callback:function(e){200==e.code?t&&t(e.data.results[0]):interaction_view.errorAlert(e.msg)}})},fail:function(){interaction_view.errorAlert("å¾çä¸ä¼ éè¯¯")}})},voiceEditor:function(e){$(".reveal").addClass("noevents"),interaction_view.weixin.voiceauth(),interaction_view.imageEditorClear(),interaction_view.containment.append('<div class="editor_mask" style="opacity:0;"></div>'),"undefined"!=typeof epub360&&epub360.settings&&["USER_FREE","USER_BASIC"].indexOf(epub360.settings.billing_type)>=0&&interaction_view.containment.append('<div style=" padding-bottom: 3px;display: inline-block;z-index: 999999999;position: absolute; bottom: 10px;  text-align: center; width: 100%;"><a href="http://www.epub360.com/?utm_source=epub360&amp;utm_medium=player&amp;utm_content=%E5%85%8D%E8%B4%B9%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81&amp;utm_campaign=loading" target="_blank" style="color: #c9c9c9;font-size: 14px;padding: 8px 14px;background: #a1a1a1;border-radius: 15px; -moz-border-radius: 15px;" class="advertise">Epub360.com ææ¯æ¯æ</a></div>'),interaction_view.containment.append('<div class="voiceeditor absolutecenter weixin-record">    <div class="voiceeditor-control">         <button class="voicebutton" id="playVoice" style="opacity:0;"></button>         <button class="voicebutton" id="startRecord"></button>         <div class="voicetext">æä½å½é³</div>         <button class="weixincancel"></button>         <button class="weixinconfirm"></button>    </div></div>'),interaction_view.bindVoiceEditor(),$(".weixinconfirm").on("click",function(){return interaction_view.imageEditorClear(),$(".reveal").removeClass("noevents"),e&&e(interaction_view.voicelocalId),!1}),$(".weixincancel").on("click",function(){return wx.stopRecord({success:function(){},fail:function(){}}),interaction_view.imageEditorClear(),$(".reveal").removeClass("noevents"),!1})},bindVoiceEditor:function(){var e=!1,t=function(){return interaction_view.voicelocalId?(wx.playVoice({localId:interaction_view.voicelocalId}),void window.setTimeout(function(){$("#playVoice").attr("id","stopVoice")},500)):void interaction_view.errorAlert("ä½ è¿æ²¡æå½é³å¢ï¼")};$(".weixin-record").on("touchstart","#startRecord",function(){return e=!0,wx.startRecord({success:function(){e?$("div.voicetext").html("æ­£å¨å½é³...."):wx.stopRecord({})},cancel:function(){interaction_view.errorAlert("å¼å¯å¾®ä¿¡åè½å¤±è´¥")}}),window.setTimeout(function(){$("#startRecord").attr("id","stopRecord")},100),!1}),$(".weixin-record").on("touchend","#stopRecord",function(){return wx.stopRecord({success:function(e){interaction_view.voicelocalId=e.localId,$("#playVoice").css("opacity",1),t()},fail:function(){interaction_view.errorAlert("å¾®ä¿¡å½é³å¤±è´¥")}}),window.setTimeout(function(){$("#stopRecord").attr("id","startRecord")},100),e=!1,$("div.voicetext").html("æä½å½é³"),!1}),$(".weixin-record").on("touchcancel","#stopRecord",function(){return wx.stopRecord({success:function(e){interaction_view.voicelocalId=e.localId,$("#playVoice").css("opacity",1),t()},fail:function(){interaction_view.errorAlert("å¾®ä¿¡å½é³å¤±è´¥")}}),window.setTimeout(function(){$("#stopRecord").attr("id","startRecord")},100),e=!1,!1}),$(".weixin-record").on("click","#playVoice",function(){return t(),!1}),$(".weixin-record").on("click","#stopVoice",function(){return interaction_view.voicelocalId?(wx.stopVoice({localId:interaction_view.voicelocalId}),window.setTimeout(function(){$("#stopVoice").attr("id","playVoice")},500),!1):void interaction_view.errorAlert("ä½ è¿æ²¡æå½é³å¢ï¼")}),wx.onVoicePlayEnd({complete:function(){$("#stopVoice").attr("id","playVoice")}}),wx.onVoiceRecordEnd({complete:function(e){interaction_view.voicelocalId=e.localId,$("#playVoice").css("opacity",1),t(),$("#stopRecord").attr("id","startRecord")}})},voiceUploader:function(e,t){wx.uploadVoice({localId:e,isShowProgressTips:1,success:function(e){var i=(e.serverId,context_url+"uploadvoice");_g.ajax.post({url:i,data:{serverid:e.serverId},callback:function(e){200==e.code?t&&t(e.data.results[0]):interaction_view.errorAlert(e.msg)}})}})},errorAlert:function(e){if(interaction_view.foredit)return void interaction.message("warning","è¯·å¨å¾®ä¿¡ä¸­é¢è§è¯¥åè½!");if(!interaction_view.containment.children(".alert_mask").length){interaction_view.containment.append('<div class="alert_mask"></div>');var i=_.template(t,{text:e});interaction_view.containment.append(i),interaction_view.containment.find(".alert-confirm").on("click",function(){return interaction_view.containment.find(".alert_mask").remove(),interaction_view.containment.find(".alert-box").remove(),!1})}},playbgsound:function(){if(interaction_view.bgsound){var e=interaction_view.bgsound;if(!e.hasPlayed){var t=e.iview.getdetail();e.media=audio,e.iview.$el.find(".status-play").addClass("status-pause").removeClass("status-play"),e.media.paused||(e.hasPlayed=!0),$("audio#bgsound").on("loadstart",function(){}).on("error",function(){}).on("timeupdate",function(){if(e.iview.slider){var t=e.media.currentTime,i=e.media.duration,n=100*_g.number.decimal(t/i,2);e.iview.onSliderChange(n)}}),$("audio#bgsound").on("ended",function(){if(t.iRepeat)_g.device.android()&&e.media.play();else{if(e.iview.slider&&e.iview.sliderstop(),0==e.media.seekable.length)return;try{e.media.currentTime=0,interaction_view.media.pause(e)}catch(i){}e.onAnimationStart&&(interaction_view.events.onAnimationEnd(e.onAnimationStart),e.onAnimationStart=null)}})}}},createLoop:function(e){var t=1e3*e.delay,i=17,n=0,a={};a.paused=!0,a._int=null;var o=0;return a.duration=function(){return e.duration},a.play=function(){a.paused=!1;var r=function(){a&&(a._int=requestAnimationFrame(r),n*i>=t?(console.log("play"),e.callback&&e.callback(),n=1,o=o+e.delay<=e.duration?o+e.delay:0):n+=1)};r()},a.pause=function(){a._int&&window.cancelAnimationFrame(a._int)},a.kill=function(){a._int&&(window.cancelAnimationFrame(a._int),a.paused=!0),a=null},a.time=function(){return o},a},renderLink:function(e,t){if(interaction_view.foredit)return void global.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½");if(0==e&&t.page_id)interaction_view.ipagelist.getPage(t.page_id)&&presentation.gotopage(t.page_id,0);else if(1==e&&t.url){if(!t.url)return;var i=t.url;if(0==i.indexOf("@"))return void window.open(i,"_blank");-1==i.indexOf("://")&&(i="http://"+i),window.location.href.indexOf("query_string")>0&&(i+=i.indexOf("?")>=0&&"&"+window.location.search.replace("?","")||window.location.search);var n=i.match(/\w+:\/\//);if(n&&-1==["https://","http://"].indexOf(i.match(/\w+:\/\//)[0]))return void(window.location.href=i);if(interaction_view.ismobile){var a=window.location.href;a=_g.changeURLPar(a,"return","1"),window.history.pushState({},"",a),window.location.href=i}else window.open(i,"_blank")}else if(2==e&&t.url){if(!interaction_view.ismobile)return;window.location="tel:"+t.url}},setPos:function(e,t){var i=t.x,n=t.y,a=t.scale;if(interaction_view.ismobile&&"undefined"==typeof TweenMax){var o="transform";"transform"in document.documentElement.style||(o="webkitTransform");var r=e[0].style[o].match(/[,\(][^\,]+/g);void 0!=i&&void 0==n?n==parseFloat(r[5].substring(2)):void 0==i&&void 0!=n&&i==parseFloat(r[4].substring(2)),void 0!=i&&void 0!=n&&(r.pop(),r.pop(),e[0].style[o]="matrix"+temp2.join("")+", "+i+", "+n+")"),void 0!=a&&"undefined"!=typeof TweenMax&&TweenMax.set(e,{scale:a})}else(void 0!=i||void 0!=n)&&TweenMax.set(e,t),void 0!=a&&TweenMax.set(e,{scale:a})}}}),define("text!interaction_view/template/pagenumber.js",[],function(){return'<%if(presentation.getPageNumber().horizontal_count>1){ %>\n<nav class="iView master nav-horizen pagenumber" style="position:absolute;left:<%=pageno_horizontal.x%>px;top:<%=pageno_horizontal.y%>px;<%=pageno_horizontal.show?"":"display:none;"%>">\n    <%for(i=0;i<presentation.getPageNumber().horizontal_count;i++){%><li class="<%=Reveal.getIndices().h==i?"active":""%>"><a href="#" data-index="<%=i%>"></a></li><% } %>\n</nav>\n<% } %>\n<%if(presentation.getPageNumber().vertical_count>1){ %>\n<nav class="iView master nav-vertical pagenumber" style="position:absolute;left:<%=pageno_vertical.x%>px;top:<%=pageno_vertical.y%>px;<%=pageno_vertical.show?"":"display:none;"%>">\n    <%for(i=0;i<presentation.getPageNumber().vertical_count;i++){%><li class="<%=Reveal.getIndices().v==i?"active":""%>"><a href="#" data-index="<%=i%>"></a></li><% } %>\n</nav>\n<% } %>'}),define("interaction_view/ui/presentation",["_g/ui","text!interaction_view/template/pagenumber.js"],function(){var e=require("text!interaction_view/template/pagenumber.js"),t={init:function(){},masterPageReset:function(){interaction_view.imasterlist.length&&interaction_view.imasterlist.at(0).iOverlaylist.each(function(e){_.include(["Grid","PageIndex","Gallery"],e.get("iType"))&&e.iview.resetOtherStatus()})},preloadpageAudio:function(){interaction_view.ismobile&&interaction_view.imasterlist.at(0).iOverlaylist.each(function(e){"Audio"==e.get("iType")&&e.media&&(e.hasPlayed||e.get("iDetail").iAutoplay&&(e.media&&e.media.paused&&interaction_view.media.play(e),e.hasPlayed=!0))})},play:function(e){var i=null;if(i="string"==typeof e?interaction_view.getParentpage(e):e,!i.isLayer&&"page"==i.get("type")){if(1==interaction_view.environment.Shareapp.status)return void(interaction_view.environment.Shareapp.waitpage=i.id);interaction_view.environment.Shareapp.waitpage==i.id&&(interaction_view.environment.Shareapp.waitpage="")}if("Page"==interaction_view.mode&&!i.isLayer&&interaction_view.ipagelist.getPage(i.id)){t.setBackgroundDisplay(i);var n=i.get("share_page_id")||"first";("current"==n||interaction_view.share_page_id!=n)&&(interaction_view.share_page_id=n,interaction_view.weixin.share()),"undefined"!=typeof ScrollPage&&ScrollPage.bindScrollPage(interaction_view.currentPage)}1==i.playFinished&&(i.iOverlaylist.resetViewStatus(),i.iOverlaylist.resetBindings(),i.iAnimationlist.resetAnimationStatus(),i.playFinished=!1),i.iOverlaylist.each(function(e){i.playFinished||e._reset&&e.iview.resetStatus(),e.media&&(e.autoplay?interaction_view.ismobile&&e.get("isBgsound")?"undefined"==typeof bgsound_id&&(interaction_view.media.play(e),e.media.paused||(e.hasPlayed=!0)):(interaction_view.media.play(e,{autoplay:!0}),e.media.paused||(e.hasPlayed=!0)):("Video"==e.get("iType")||"QQVideo"==e.get("iType"))&&(e.get("iDetail").iHidden||(e.notallowed=!0,e.iview.$el.removeClass("hide"),e.iview.$el.css("opacity",1),e.control&&e.iview.$el.find("video").css("display","block"),e.hided=!1))),e.renderWebContent&&e.iview.renderWebContent(),e.iview.immediateRender&&e.iview.immediateRender()}),i.played=!1,interaction_view.events.clearWaitClick(),interaction_view.events.clearAnimationWaitSwipe(),i.iAnimationlist.setParams(),i.iAnimationlist.css_timeline&&i.iAnimationlist.css_timeline.play(),i.iAnimationlist.setPlay(),i.playFinished=!0,"Page"!=interaction_view.mode||interaction_view.masterplayed||i.isLayer||(interaction_view.masterplayed=!0,interaction_view.imasterlist.length&&interaction_view.play(interaction_view.imasterlist.at(0))),"Page"!=interaction_view.mode||interaction_view.backgroundplayed||i.isLayer||(interaction_view.backgroundplayed=!0,interaction_view.ibackgroundlist.length&&interaction_view.play(interaction_view.ibackgroundlist.at(0))),i.isLayer?interaction_view.events.onPageStart(i.iOverlaylist.pageid,i.iOverlaylist.layerid):interaction_view.events.onPageStart(i.id),interaction_view.events.onControllerEvent(i.id),"Page"==interaction_view.mode&&!i.isLayer&&interaction_view.ipagelist.getPage(i.id)&&t.setMasterDisplay(i),i.iAnimationlist.timeline&&i.iAnimationlist.timeline.play(0,!1),i.iOverlaylist.each(function(e){switch(e.get("iType")){case"LayerRef":case"LayerSlide":case"ComponentRef":e.iview.playLayer();break;case"Timer":e.iview.resetTimer();break;case"Vote":e.iview.triggerVoted();break;case"Variable":case"SystemVariable":e.iview.triggerVarChange()}e._autoplay&&e.iview._autoplay(),e.iview.onPlay&&e.iview.onPlay()})},pause:function(e){var t;t="string"==typeof e?interaction_view.ipagelist.getPage(e):e,t.playFinished&&t.iAnimationlist.timeline&&t.iAnimationlist.timeline.pause()},continuePlay:function(e){var t;t="string"==typeof e?interaction_view.ipagelist.getPage(e):e,t.playFinished&&t.iAnimationlist.timeline&&t.iAnimationlist.timeline.play()},stop:function(e){var t;t="string"==typeof e?interaction_view.ipagelist.getPage(e):e,t.playFinished&&(t.iAnimationlist.timeline&&(t.iAnimationlist.timeline.pause(0),t.iOverlaylist.resetViewStatus(),"string"==typeof e&&$(".interaction-view").css("cursor","auto"),interaction_view.bezierPatch(e)),t.iAnimationlist.css_timeline&&t.iAnimationlist.css_timeline.stop(),t.iActionlist.each(function(e){e.iview.timeline&&e.iview.timeline.pause(1e-5)}),t.iOverlaylist.each(function(e){e.media&&(e.iview.resetOtherStatus(),("Video"==e.iview.iType||"QQVideo"==e.iview.iType)&&(interaction_view.isAndroid&&interaction_view.media.pause(e),e.iview.$el.addClass("hide"))),("LayerRef"==e.iview.iType||"LayerSlide"==e.iview.iType||"ComponentRef"==e.iview.iType)&&e.iview.stoplayer(),("LayerRef"==e.iview.iType||"Image"==e.iview.iType||"ImageBlock"==e.iview.iType)&&e.iview.renderMask(),("Slide"==e.iview.iType||"LayerSlide"==e.iview.iType||"CycleImage"==e.iview.iType)&&e.iview.timeline&&e.iview.timeline.pause(1e-5),"Timer"==e.iview.iType&&e.iview.stopTimerSimple(),e.renderWebContent&&e.iview.clearWebContent(),e.iview.onStop&&e.iview.onStop()})),"string"==typeof e&&t.iview.$el.hasClass("dragConnector")&&connector.clearDragController(t.iview.$el)},getPageNumber:function(){var e=Reveal.getVerticalLength(),t=Reveal.getHorizontalLength();return{vertical_count:e,horizontal_count:t}},setMasterDisplay:function(e){t.setPageNumber(e),interaction_view.show_master=e.get("show_master")?!0:!1;var i=$('.Presentation[id="'+e.id+'"]').find(".interaction-view");interaction_view.touchview&&(i=$(".reveal")),interaction_view.show_master||"Master"==interaction_view.mode?i.children(".iView.master").removeClass("masterhide"):i.children(".iView.master").addClass("masterhide"),t.masterPageReset(e)},setBackgroundDisplay:function(e){interaction_view.show_background=e.get("show_background")?!0:!1;var t=$('.Presentation[id="'+e.id+'"]').find(".interaction-view");interaction_view.touchview&&(t=$(".reveal")),interaction_view.show_background||"Background"==interaction_view.mode?t.children(".iView.background").removeClass("backgroundhide"):t.children(".iView.background").addClass("backgroundhide")},setPageNumber:function(i){var n=$('.Presentation[id="'+i.id+'"]').find(".interaction-view");interaction_view.touchview&&(n=$(".reveal")),"Master"!=interaction_view.mode&&"Page"!=interaction_view.mode||!interaction_view.imasterlist.length||(n.children(".iView.master.pagenumber").remove(),n.append(_.template(e,interaction_view.imasterlist.at(0).toJSON())),t.setPageNumberPosition())},setPageNumberPosition:function(){$("nav.pagenumber").each(function(){$(this).css({left:$(this).position().left-$(this).outerWidth(!1)/2,top:$(this).position().top-$(this).outerHeight(!1)/2})})},bezierPatch:function(e){var t;t="string"==typeof e?interaction_view.ipagelist.getPage(e):e,t.iAnimationlist.each(function(e){_.include([301,302],e.get("iType"))&&e.toJSON().iDetail.autoRotate&&TweenMax.set(e._animation.obj,{rotation:"0_cw"})})},startLoad:function(){t.pagesForLoad=[],interaction_view.imasterlist&&interaction_view.imasterlist.length&&t.pagesForLoad.push(interaction_view.imasterlist.at(0).id),interaction_view.ibackgroundlist&&interaction_view.ibackgroundlist.length&&t.pagesForLoad.push(interaction_view.ibackgroundlist.at(0).id),_.each(interaction_view.ipagelist.getPages(),function(e){t.pagesForLoad.push(e.id)}),t.pagelength=t.pagesForLoad.length;var e;if(!interaction_view.forpreview||"Layer"!=interaction.doc.mode&&"Background"!=interaction.doc.mode)if(interaction_view.imasterlist&&interaction_view.imasterlist.length||interaction_view.ibackgroundlist&&interaction_view.ibackgroundlist.length){if(interaction_view.imasterlist&&interaction_view.imasterlist.length&&(e=interaction_view.imasterlist.at(0)),interaction_view.ibackgroundlist&&interaction_view.ibackgroundlist.length){var i=interaction_view.ibackgroundlist.at(0);i.iview.prepareLoad(),i.iview.startLoad(),i.isStartLoad=!0}}else e=interaction_view.ipagelist.at(0);else e=interaction_view.imasterlist&&interaction_view.imasterlist.length?interaction_view.imasterlist.at(0):interaction_view.ipagelist.at(0);e.iview.prepareLoad(),e.iview.startLoad(),e.isStartLoad=!0},pagesForLoad:[],pageLoadEvent:function(){},pageLoad:function(e){var i=interaction_view.ipagelist.getPage(e);i.isStartLoad||i.get("loaded")?interaction_view.ismobile&&t.pagePreloadCenter(e):(i.iview.prepareLoad(),i.iview.startLoad(),i.isStartLoad=!0)},bookStatus:0,foredit:function(){},forpreview:function(){interaction_view.mode="Page",interaction_view.events.clearAll(),$("body").children("preloader").remove(),$("body").append('<div id="preloader"></div>'),interaction_view.forpreview||$("body").prepend('<div class="loading progress progress-striped active"><div class="bar" style="width: 0%;"></div></div>'),interaction_view.finishPagePreload=function(e,i){if(t.pagesForLoad=_.reject(t.pagesForLoad,function(t){return t==e}),i||(i=interaction_view.ipagelist.getPage(e)||interaction_view.imasterlist.get(e)||interaction_view.ibackgroundlist.get(e)),interaction_view.donext(i),i.set("loaded",!0,{silent:!0}),(0==t.pagesForLoad.length||t.pagelength-t.pagesForLoad.length>=1)&&(0==interaction_view.imasterlist.length||interaction_view.imasterlist.at(0).get("loaded"))&&(0==interaction_view.ibackgroundlist.length||interaction_view.ibackgroundlist.at(0).get("loaded"))&&(interaction_view.preloadended||(interaction_view.preloadended=!0)),"wait"==interaction_view.playstatus&&interaction_view.preloadended){var n=interaction_view.ipagelist.getPage(interaction_view.currentPage);n.get("loaded")&&(interaction_view.playstatus="play",interaction_view.containment.children(".prejsloading").length?(clear_loading_progress_waiting=clear_loading_progress_waiting||200,200>=clear_loading_progress_waiting&&(clear_loading_progress_waiting=100),60>loading_progress_percent?(200>=clear_loading_progress_waiting&&(loading_progress_percent=66),window.loading_progress_timer1=setInterval(function(){compute_loadding_progress(),set_loading_progress()},clear_loading_progress_waiting)):(loading_progress_percent=100,set_loading_progress(),clearInterval(loading_progress_timer),workEnd("-------- 3. presentation : start clear loading 1 --------"),interaction_view.containment.children(".prejsloading").fadeOut(800,function(){interaction_view.containment.children(".prejsloading").remove(),interaction_view.play(interaction_view.currentPage),workEnd("-------- 3. presentation : start clear loading 1 --------"),window.loadAnalytics&&loadAnalytics()}))):(interaction_view.containment.children("#jswait-loading").remove(),interaction_view.play(interaction_view.currentPage)))}else if(interaction_view.preloadended&&interaction_view.transitionPagePreLoad&&e==interaction_view.transitionPagePreLoad.page_id){var a=interaction_view.transitionPagePreLoad.transition;interaction_view.transitionPagePreLoad=null,t.gotopage(e,a)}if(0==t.pagesForLoad.length?$(".loading").remove():interaction_view.ismobile||interaction_view.ipagelist.getPage(t.pagesForLoad[0])&&t.pageLoad(t.pagesForLoad[0]),interaction_view.ismobile)if(t.isFirstPageLoading){if(e==t.isFirstPageLoading&&(t.firstpageloaded=!0),t.firstpageloaded&&interaction_view.imasterlist.at(0).get("loaded")&&interaction_view.ibackgroundlist.at(0).get("loaded")){var o=t.isFirstPageLoading;t.isFirstPageLoading=null,t.preloadFourDirections(),t.pagePreloadCenter(o)}}else t.pagePreloadCenter(e)},interaction_view.setPreloadStatus=function(){var e=0,t=0;_.each(interaction_view.ipagelist.getPages(),function(i){t+=i.ipreloadlist.length,i.ipreloadlist.length>0&&(e+=i.ipreloadlist.where({loaded:!0}).length)}),interaction_view.imasterlist.length&&(t+=interaction_view.imasterlist.at(0).ipreloadlist.length,interaction_view.imasterlist.at(0).ipreloadlist.length>0&&(e+=interaction_view.imasterlist.at(0).ipreloadlist.where({loaded:!0}).length)),interaction_view.ibackgroundlist.length&&(t+=interaction_view.ibackgroundlist.at(0).ipreloadlist.length,interaction_view.ibackgroundlist.at(0).ipreloadlist.length>0&&(e+=interaction_view.ibackgroundlist.at(0).ipreloadlist.where({loaded:!0}).length)),$(".loading").children("div").css("width",String(e/t*100)+"%")
},interaction_view.donext=function(e){e.iview.afterpreload()},interaction_view.play=t.play,interaction_view.stopPlay=t.stop,interaction_view.pausePlay=t.pause,interaction_view.continuePlay=t.continuePlay,interaction_view.bezierPatch=t.bezierPatch,interaction_view.slideChange=function(e){if(Reveal&&("number"==typeof e&&Reveal.slide(e),"string"==typeof e)){var t=interaction_view.getModelById(interaction_view.iChapter,e);Reveal.slide(t.get("index"))}},interaction_view.firstPlay=!0},screencontrol:function(){window.isFullscreen=!1,window.screenLock=!1,window.screenAutoAdapt=function(){if(!window.screenLock)if(screenfull.isFullscreen){isFullscreen=!0;var e=window.screen.width/window.screen.height>=interaction_view.size.x/interaction_view.size.y?window.screen.height/interaction_view.size.y:window.screen.width/interaction_view.size.x;_g.ui.scale(".reveal",e)}else isFullscreen=!1,_g.ui.scale(".reveal",1)},!interaction_view.ismobile&&(screenfull.onchange=screenAutoAdapt)},gotopagebyargs:function(e,i){var n=null;if(_.isNumber(e)&&!_.isNaN(e))n=interaction_view.ipagelist.getPages()[e]?interaction_view.ipagelist.getPages()[e].id:null;else if(_.include(["first","last","prev","next"],e))switch(e){case"first":n=Reveal.getFirst();break;case"last":n=Reveal.getLast();break;case"prev":n=Reveal.getPrev();break;case"next":n=Reveal.getNext()}else n=e;n&&t.gotopage(n,i||0)},gotopage:function(e,i){interaction_view.transitionPagePreLoad=null;var n,a,o,r,s=null;if(e!=interaction_view.currentPage){switch(i){case 0:o=0,a="y",n="up",r=1;break;case 1:o=0,a="x",n="right",r=-1;break;case 2:o=0,a="y",n="down",r=-1;break;case 3:o=0,a="x",n="left",r=1;break;case 4:o=1,a="y",n="up",r=1;break;case 5:o=1,a="x",n="right",r=-1;break;case 6:o=1,a="y",n="down",r=-1;break;case 7:o=1,a="x",n="left",r=1;break;case 8:o=2,a="x",n="left",r=1;break;case 10:o=3,a="y",n="up",r=1;break;case 11:o=3,a="x",n="right",r=-1;break;case 12:o=3,a="y",n="down",r=-1;break;case 13:o=3,a="x",n="left",r=1;break;case 14:o=4,a="y",n="up",r=1;break;case 15:o=4,a="x",n="right",r=-1;break;case 16:o=4,a="y",n="down",r=-1;break;case 17:o=4,a="x",n="left",r=1;break;case 18:o=5,a="y",n="up",r=1;break;case 19:o=5,a="x",n="right",r=-1;break;case 20:o=5,a="y",n="down",r=-1;break;case 21:o=5,a="x",n="left",r=1}if(interaction_view.ipagelist.getPage(e)){var l=interaction_view.ipagelist.getPage(e);if(0==interaction_view.doc.toJSON().play_mode?indexh=interaction_view.ipagelist.indexOf(l):(l.icollection.length&&(l=l.icollection.at(0)),indexh=l.collection.parent.collection.indexOf(l.collection.parent),s=l.collection.indexOf(l)),!l.get("loaded"))return interaction_view.transitionPagePreLoad={page_id:e,transition:i},void t.pageLoad(e);if(Reveal.lockAction=!0,9==i)return void Reveal.slide(indexh,s);Reveal.setSingleSlideItem(indexh,s,n),Reveal.originh=Reveal.indexh,Reveal.originv=Reveal.indexv,Reveal.indexh=indexh,null!=s&&(Reveal.indexv=s),Reveal.transition.autostart(o,a,r)}}},preloadFourDirections:function(){t.touchPreloadPageList=[];var e=Reveal.getSlideDirections();e.left?t.touchPreloadPageList.push(Reveal.getLeft()):interaction_view.control.getGroupLeft(Reveal.getCurrentSlideId())&&t.touchPreloadPageList.push(interaction_view.control.getGroupLeftId(Reveal.getCurrentSlideId())),e.right?t.touchPreloadPageList.push(Reveal.getRight()):interaction_view.control.getGroupRight(Reveal.getCurrentSlideId())&&t.touchPreloadPageList.push(interaction_view.control.getGroupRightId(Reveal.getCurrentSlideId())),3==Reveal.slideType&&(e.up&&t.touchPreloadPageList.push(Reveal.getUp()),e.down&&t.touchPreloadPageList.push(Reveal.getDown())),t.touchPreloadPageList.length&&t.pagePreloadCenter()},clearPreloadPages:function(){t.touchClearPageList=[];for(var e=Reveal.getAllSlideIds(),i=0;i<e.length;i++){var n=e[i];n!=Reveal.getLeft()&&n!=Reveal.getRight()&&n!=Reveal.getUp()&&n!=Reveal.getDown()&&n!=Reveal.getCurrentSlideId()&&n!=interaction_view.control.getGroupRightId(Reveal.getCurrentSlideId())&&n!=interaction_view.control.getGroupLeftId(Reveal.getCurrentSlideId())&&t.touchClearPageList.push(n)}t.touchClearPageList.length&&t.pageClearCenter()},pagePreloadCenter:function(e){if(e&&(t.touchPreloadPageList=_.reject(t.touchPreloadPageList,function(t){return t==e})),t.touchPreloadPageList.length){var i=t.touchPreloadPageList[0];t.pageLoad(i)}},pageClearCenter:function(e){if(e&&(t.touchClearPageList=_.reject(t.touchClearPageList,function(t){return t==e})),t.touchClearPageList.length){var i=interaction_view.ipagelist.getPage(t.touchClearPageList[0]);i.iview.clearPageLoad()}},touchPreloadPageList:[],touchClearPageList:[]};window.presentation=t}),define("interaction_view/ui/control",[],function(){var e={bindArrowControls:function(){Reveal.setNavigateFuncs({navigateLeft:e.slideLeft,navigateRight:e.slideRight})},slideUp:function(){Reveal.up()},slideDown:function(){Reveal.down()},slideLeft:function(){var t=Reveal.getCurrentSlide().id,i=e.getLeft(t);i&&e.slideTo(i.id)},slideRight:function(){var t=Reveal.getCurrentSlide().id,i=e.getRight(t);i&&e.slideTo(i.id)},getGroupLeft:function(e){if(3!=Reveal.slideType)return null;var t=interaction_view.ipagelist.getPage(e);if(!t)return null;var i=(t.get("group"),t.collection.parent),n=interaction_view.ipagelist.at(interaction_view.ipagelist.indexOf(i)-1);if(n){var a=n.icollection.at(0);return a}return null},getGroupRight:function(e){if(3!=Reveal.slideType)return null;var t=interaction_view.ipagelist.getPage(e);if(!t)return null;var i=(t.get("group"),t.collection.parent),n=interaction_view.ipagelist.at(interaction_view.ipagelist.indexOf(i)+1);if(n){var a=n.icollection.at(0);return a}return null},getGroupLeftId:function(e){var t=interaction_view.control.getGroupLeft(e);return t?t.id:null},getGroupRightId:function(e){var t=interaction_view.control.getGroupRight(e);return t?t.id:null},getRight:function(e){var t=interaction_view.ipagelist.getPage(e),i=t.get("group"),n=t.collection.parent,a=interaction_view.ipagelist.at(interaction_view.ipagelist.indexOf(n)+1);if(a){var o=a.icollection.at(0),r=o.get("group");return i!=r?!1:o}return!1},getLeft:function(e){var t=interaction_view.ipagelist.getPage(e),i=t.get("group"),n=t.collection.parent,a=interaction_view.ipagelist.at(interaction_view.ipagelist.indexOf(n)-1);if(a){var o=a.icollection.at(0),r=o.get("group");return i!=r?!1:o}return!1},getCurrent:function(){},slideTo:function(e){var t=interaction_view.ipagelist.getPage(e);indexh=t.collection.parent.collection.indexOf(t.collection.parent),indexv=t.collection.indexOf(t),Reveal.slide(indexh,indexv)}};return e}),function(){var e={addEvent:function(e,t,i,n){e.addEventListener?e.addEventListener(t,i,!!n):$(e).on(t,i)},removeEvent:function(e,t,i,n){e.removeEventListener?e.removeEventListener(t,i,!!n):$(e).off(t,i)},document:{disable_contextmenu:function(e){e||(e=document),e.oncontextmenu=function(e){return e&&e.preventDefault(),!1}},enable_contextmenu:function(e){e||(e=document),e.oncontextmenu=function(){}},onCopy:function(){$(document).on("copy",function(e){console.log(e)})},disable_paste:function(){document.disable_paste=!0},enable_paste:function(){document.disable_paste=!1}}};"undefined"==typeof require?(window._g||(window._g={}),window._g.event=e):define("_g/event",["_g/base"],function(){return window._g.event=e,window._g.event})}(window),function(){var e=1,t={init:function(){_g.orientation.orientationSupport&&window.addEventListener("deviceorientation",_g.orientation.onDeviceOrientation),_g.orientation.deltaX=0,_g.orientation.deltaY=0},orientationSupport:function(){return!!window.DeviceOrientationEvent},onDeviceOrientation:function(){var t,i,n,a;if(null!==event.beta&&null!==event.gamma){this.orientationStatus=1;var o=(event.beta-30||0)/e,r=(event.gamma-30||0)/e,s=window.innerHeight>window.innerWidth;s?(t=r+30,i=o,n=180,a=90):(t=-(o+30),i=r,n=90,a=180),_.each(_g.orientation.orientationEvents,function(e){var o=t,r=i;e.scrollX||(o=0),e.scrollY||(r=0),e.func&&e.func(-o*e.speed,-r*e.speed,n,a)})}},orientationEvents:[]};"undefined"==typeof require?(window._g||(window._g={}),window._g.orientation=t):define("_g/orientation",["_g/base"],function(){return window._g.orientation=t,window._g.orientation})}(window),define("interaction_view/ui/event",["_g/ui","_g/event","_g/orientation"],function(){var events={pageStartEvents:[],pageClickEvents:[],pageDblClickEvents:[],pageWXShareSuccessEvents:[],pageSwipeEvents:[],elementChangeToEvents:[],slideClickEvents:[],slideDblClickEvents:[],animationStartEvents:[],animationEndEvents:[],animationUpdateEvents:[],bindingEvents:[],mediaEvents:[],controllerEvents:[],dragStartEvents:[],dragEndEvents:[],draggingEvents:[],dragDropEvents:[],dragDropGroupEvents:[],timerEvents:[],variableEvents:[],voteEvents:[],paragraphEvents:[],pageShakeEvents:[],formEvents:[],eraserEvents:[],formSubmitEvents:[],WeixinCameraEvents:[],collisionEvents:[],userListEvents:[],contactFormEvents:[],systemVariableEvents:[],videoAutoPlayControlPatch:[],userdataSaveEvents:[],sharedataSaveEvents:[],preloadPageEvents:[],epub360StartEvents:[],init:function(){target=$(".slides"),target.on("click",function(e){return"undefined"!=typeof Reveal&&Reveal.lockAction?(e.preventDefault(),!1):void(events.testControl(e)&&events.onClickEvent())}),target.on("dblclick",function(e){return"undefined"!=typeof Reveal&&Reveal.lockAction?(e.preventDefault(),!1):(events.testDblControl(e)&&(events.onDblClickEvent(),e.preventDefault()),void _g.ui.clearSelection())}),interaction_view.touchview&&target.hammer&&target.hammer().on("doubletap",function(e){events.testDblControl(e)&&(events.onDblClickEvent(),e.preventDefault()),_g.ui.clearSelection()}),interaction_view.ismobile||events.initWheelEvent(),interaction_view.ismobile&&_g.orientation.init(),"1"!=_g.getUrlParameterByName("-build")&&_g.event.document.disable_contextmenu(),events.initShakeEvent(),epub360.Player={},_.extend(epub360.Player,Backbone.Events)},wheelEvents:[],initWheelEvent:function(){_g.mousewheel.init()},initShakeEvent:function(){if(_g.device.mobile()&&"undefined"!=typeof Shake){var e=new Shake({threshold:_g_device.iphone()?11:25});e.start(),window.addEventListener("shake",function(){interaction_view.events.onPageShakeEvent()},!1)}},testControl:function(e){var t=$(e.target).closest(".iView");if($(e.target).closest(".iView").hasClass("hasaction"))return!1;if(t){var i=t.attr("data-type");if(("Slide"==i||"CycleImage"==i)&&t.attr("data-iSlipable"))return!1}return $(e.target).closest(".iLayerRef").length>0&&$(e.target).closest(".iLayerRef").parent(".iView").hasClass("hascontrols")?!1:!0},testDblControl:function(e){$(e.target).closest(".iView");return $(e.target).closest(".iView").hasClass("hasDblClick")?!1:!0},onPageStart:function(e,t){interaction_view.ipagelist.getPage(e)&&epub360.settings.pems.has_analytics_src&&interaction_view.analytics.set(e);var i=_.filter(interaction_view.events.pageStartEvents,function(i){return i.page_id==e&&(t?i.layer_id==t:!0)});i.length>0&&_.each(i,function(e){e.func()})},onPageSwipeEvent:function(e,t,i){var n=_.filter(interaction_view.events.pageSwipeEvents,function(n){return n.page_id==t&&(i?n.layer_id==i:!0)&&e==n.swipeType});return n.length>0?(_.each(n,function(e){e.func()}),events.clearAnimationWaitSwipe(),!0):!1},onPageShakeEvent:function(){var e=_.filter(interaction_view.events.pageShakeEvents,function(e){return e.page_id==interaction_view.currentPage||e.page_id==interaction_view.imasterlist.at(0).id});return e.length>0?(_.each(e,function(e){e.func()}),events.clearAnimationWaitShake(),!0):!1},onChangeTo:function(e,t,i){var n=_.filter(interaction_view.events.elementChangeToEvents,function(n){return n.page_id==e&&n.overlay_id==t&&n.index==i});n.length>0&&_.each(n,function(e){e.func()})},onClickEvent:function(){if(interaction_view.events.pageClickEvents.length>0){var e=_.filter(interaction_view.events.pageClickEvents,function(e){return"waitaction"==e.type});if(e.length>0)_.each(e,function(e){e.func()});else{var t=_.filter(interaction_view.events.pageClickEvents,function(e){return e.page_id==interaction_view.currentPage&&"page"==e.type});if(t.length>0)_.each(t,function(e){e.func()});else{var i=_.filter(interaction_view.events.pageClickEvents,function(e){return"master"==e.type});if(i.length>0)interaction_view.show_master&&_.each(i,function(e){e.func()});else{var n=_.filter(interaction_view.events.pageClickEvents,function(e){return"background"==e.type});interaction_view.show_background&&_.each(n,function(e){e.func()})}}}events.clearWaitClick()}},onDblClickEvent:function(){if(interaction_view.events.pageDblClickEvents.length>0){var e=_.filter(interaction_view.events.pageDblClickEvents,function(e){return e.page_id==interaction_view.currentPage&&"page"==e.type});if(e.length>0)_.each(e,function(e){e.func()});else{var t=_.filter(interaction_view.events.pageDblClickEvents,function(e){return"master"==e.type});if(t.length>0)interaction_view.show_master&&_.each(t,function(e){e.func()});else{var i=_.filter(interaction_view.events.pageDblClickEvents,function(e){return"background"==e.type});interaction_view.show_background&&_.each(i,function(e){e.func()})}}}},onSlideClickEvent:function(){},onSlideDblClickEvent:function(){},onControllerEvent:function(){},onBingChangeTo:function(e){var t=_.filter(interaction_view.events.bindingEvents,function(t){return t.id==e.id&&t.page_id==e.page_id});_.each(t,function(t){e.direction=t.direction,t.func(e)})},onAnimationStart:function(e){var t=_.filter(interaction_view.events.animationStartEvents,function(t){return e.layer_id?e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.layer_id==e.layer_id:t.animation_id==e.animation_id&&t.layer_id==e.layer_id:e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.page_id==e.page_id:t.animation_id==e.animation_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onAnimationEnd:function(e){var t=_.filter(interaction_view.events.animationEndEvents,function(t){return e.layer_id?e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.layer_id==e.layer_id:t.animation_id==e.animation_id&&t.layer_id==e.layer_id:e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.page_id==e.page_id:t.animation_id==e.animation_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onAnimationUpdate:function(e){var t=_.filter(interaction_view.events.animationUpdateEvents,function(t){return e.layer_id?e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.layer_id==e.layer_id:t.animation_id==e.animation_id&&t.layer_id==e.layer_id:e.overlay_id?t.overlay_id==e.overlay_id&&t.animation_id==e.animation_id&&t.page_id==e.page_id:t.animation_id==e.animation_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onDragStart:function(e){var t=_.filter(interaction_view.events.dragStartEvents,function(t){return e.layer_id?t.overlay_id==e.overlay_id&&t.layer_id==e.layer_id:t.overlay_id==e.overlay_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onDragEnd:function(e){var t=_.filter(interaction_view.events.dragEndEvents,function(t){return e.layer_id?t.overlay_id==e.overlay_id&&t.layer_id==e.layer_id:t.overlay_id==e.overlay_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onDragging:function(e){var t=_.filter(interaction_view.events.draggingEvents,function(t){return e.layer_id?t.overlay_id==e.overlay_id&&t.layer_id==e.layer_id:t.overlay_id==e.overlay_id&&t.page_id==e.page_id});_.each(t,function(e){e.func()})},onDragDrop:function(e,t,i){function n(t,i){return t.overlay_id!=e.id||t.drop_type!=i?!1:e.page.isLayer?t.layer_id==e.page.iOverlaylist.layerid:t.page_id==e.page.id}var a;return 0==i?(a=_.filter(interaction_view.events.dragDropEvents,function(e){return n(e,8)}),void _.each(a,function(e){e.func()})):(e.iview.Status=2,_.include(e.iview.getdetail().element_ids,t.id)?(e.iview.Status=1,a=_.filter(interaction_view.events.dragDropEvents,function(e){return n(e,9)})):a=_.filter(interaction_view.events.dragDropEvents,function(e){return n(e,10)}),void _.each(a,function(e){e.func()}))},onDragDropGroup:function(e){function t(e,t,i){return e.overlay_id!=i.id||e.drop_type!=t?!1:i.page.isLayer?e.layer_id==i.page.iOverlaylist.layerid:e.page_id==i.page.id}$.each(e.iview.DragDropGroups,function(e,i){var n=i.iview.getdetail().element_ids,a=0,o=!0;if($.each(n,function(e,t){var n=i.page.iOverlaylist.where({id:t})[0];if(n&&n.iview){if(n=n.iview,0==n.Status)return o=!1,!1;1==n.Status&&a++}}),o){var r;r=a==n.length?_.filter(interaction_view.events.dragDropGroupEvents,function(e){return t(e,11,i)}):_.filter(interaction_view.events.dragDropGroupEvents,function(e){return t(e,12,i)}),_.each(r,function(e){e.func()})}})},onTimerStart:function(e){_.each(e.Actions_19,function(e){e.func()})},onTimerStop:function(e){_.each(e.Actions_17,function(e){e.func()})},onTimerInterval:function(e,t){_.each(e.Actions_18,function(e){(0==(Math.abs(t%e.condition)-e.condition).toFixed(2)||0==Math.abs(t%e.condition).toFixed(2))&&e.func()})},onTimerCountTo:function(e){_.each(e.Actions_16,function(t){var i=e.currentTime-t.condition,n=2*Math.abs(i);(0>=i&&n<=e.frame||i>0&&n<e.frame)&&t.func()})},onVariableChanged:function(view){var detail=view.getdetail(),initial="0"==detail.iKind&&Number(detail.initial)||detail.initial,actions=_.filter(interaction_view.events.variableEvents,function(e){return interaction_view.events.filterType(view,e,22)}),VarOPobj=interaction_view.getVarsOp(interaction_view.currentPage,null,interaction_view.environment.Votes.get());_.each(actions,function(v){var cond;cond=v.condition.replace(/%@/g,"initial"),cond=VarOPobj.var2val(cond,!0),eval(cond)&&v.func()})},onSystemVariableChanged:function(e){var t=_.filter(interaction_view.events.systemVariableEvents,function(t){return interaction_view.events.filterTypeByView(e,t)});t.length&&(console.log(t),_.each(t,function(e){if(100==e.type&&interaction_view.isWeixin&&e.func(),101!=e.type||interaction_view.isWeixin||e.func(),102==e.type&&interaction_view.isAndroid&&e.func(),103==e.type&&interaction_view.isIos&&e.func(),104==e.type&&interaction_view.isWin&&e.func(),105==e.type&&interaction_view.isMac&&e.func(),"undefined"!=typeof epub360_userinfo&&void 0!=epub360_userinfo.is_subscribe){if(interaction_view.foredit)return void global.message("warning","è¯·ä½¿ç¨é¢è§å¨é¨æ¨¡å¼é¢è§è¯¥åè½");110==e.type&&epub360_userinfo.is_subscribe&&e.func(),111!=e.type||epub360_userinfo.is_subscribe||e.func()}"epub360"==epub360_domain&&(130==e.type&&0==interaction_view.environment.Sharedata.mode&&e.func(),131==e.type&&1==interaction_view.environment.Sharedata.mode&&e.func()),"epub360"==epub360_domain&&"undefined"!=typeof epub360_userinfo&&(140==e.type&&1==epub360_userinfo.visit_count&&e.func(),141==e.type&&epub360_userinfo.visit_count>1&&e.func())}))},onVoted:function(e){var t=_.filter(interaction_view.events.voteEvents,function(t){return interaction_view.events.filterType(e,t,23)});_.each(t,function(e){e.func()})},onParagraphChanged:function(e){var t=_.filter(interaction_view.events.paragraphEvents,function(t){return interaction_view.events.filterType(e,t,54)});_.each(t,function(e){e.func()})},onFormEvent:function(e,t){var i=e.createPath(),n=_.filter(interaction_view.events.formEvents,function(e){return e.overlay&&interaction_view.hashPath(i)==interaction_view.hashPath(e.overlay.path)+e.overlay.id});"Select"==e.get("iType")?_.each(n,function(e){e.key==t&&e.func(t)}):_.each(n,function(e){e.func(t)})},onFormSubmitEvent:function(e,t){var i=_.filter(interaction_view.events.formSubmitEvents,function(e){return e.id==t});_.each(i,function(e){e.func(status)})},onFormButtonRender:function(e){var t=e.createPath(),i=null,n=null,a=_.filter(interaction_view.events.formEvents,function(e){return e.overlay&&interaction_view.hashPath(t)==interaction_view.hashPath(e.overlay.path)+e.overlay.id});return _.each(a,function(t){n=t,i=interaction_view.application.getValue(t.id,t.cid,t.key),t.bindSwitch&&interaction_view.application.sendOverlayToButtonGroup(e)}),{field:n,value:i}},onEraserEvent:function(e){var t=_.filter(interaction_view.events.eraserEvents,function(t){return interaction_view.events.filterType(e,t,41)});_.each(t,function(e){e.func()})},onWeixinEvent:function(e,t){var i=_.filter(interaction_view.events.WeixinCameraEvents,function(i){return interaction_view.events.filterType(e,i,t)});_.each(i,function(e){e.func()})},onCollision:function(e){var t=_.filter(interaction_view.events.collisionEvents,function(t){return interaction_view.events.filterType(e,t,73)});_.each(t,function(e){e.func()})},onUserList:function(e,t){var i=_.filter(interaction_view.events.userListEvents,function(i){return interaction_view.events.filterType(e,i,t)});_.each(i,function(e){e.func()})},onContactFormSubmit:function(e,t){var i=_.filter(interaction_view.events.contactFormEvents,function(i){return interaction_view.events.filterType(e,i,t)});_.each(i,function(e){e.func()})},onUserdataSave:function(e){var t=_.filter(interaction_view.events.userdataSaveEvents,function(t){var i=e.model.toJSON();return t.userdatasave_hash==i.page_id+"_"+i.id});_.each(t,function(e){e.func()})},onSharedataSave:function(e){var t=_.filter(interaction_view.events.sharedataSaveEvents,function(t){return t.sharedatasave_hash==e.model.toJSON().id});_.each(t,function(e){e.func()})},clearWaitClick:function(){interaction_view.events.pageClickEvents=_.reject(interaction_view.events.pageClickEvents,function(e){return"waitaction"==e.type})},clearAnimationWaitSwipe:function(){interaction_view.events.pageSwipeEvents=_.reject(interaction_view.events.pageSwipeEvents,function(e){return"waitaction"==e.type})},clearAnimationWaitShake:function(){interaction_view.events.pageShakeEvents=_.reject(interaction_view.events.pageShakeEvents,function(e){return"waitaction"==e.type})},clearRelatedEvents:function(e){interaction_view.events.animationStartEvents=_.reject(interaction_view.events.animationStartEvents,function(t){return t.page_id==e}),interaction_view.events.animationEndEvents=_.reject(interaction_view.events.animationEndEvents,function(t){return t.page_id==e}),interaction_view.events.animationUpdateEvents=_.reject(interaction_view.events.animationUpdateEvents,function(t){return"collision"==t._label&&t.page_id==e}),interaction_view.events.draggingEvents=_.reject(interaction_view.events.draggingEvents,function(t){return"collision"==t._label&&t.page_id==e})},clearAll:function(){interaction_view.events.pageClickEvents=[],interaction_view.events.pageDblClickEvents=[],interaction_view.events.pageStartEvents=[],interaction_view.events.pageWXShareSuccessEvents=[],interaction_view.events.bindingEvents=[],interaction_view.events.elementChangeToEvents=[],interaction_view.events.animationStartEvents=[],interaction_view.events.animationEndEvents=[],interaction_view.events.animationUpdateEvents=[],interaction_view.events.slideClickEvents=[],interaction_view.events.slideDblClickEvents=[],interaction_view.events.controllerEvents=[],interaction_view.events.dragDropEvents=[],interaction_view.events.dragDropGroupEvents=[],interaction_view.events.timerEvents=[],interaction_view.events.variableEvents=[],interaction_view.events.voteEvents=[],interaction_view.events.paragraphEvents=[],interaction_view.events.pageSwipeEvents=[],interaction_view.events.pageShakeEvents=[],interaction_view.events.formEvents=[],interaction_view.events.formSubmitEvents=[],interaction_view.events.eraserEvents=[],interaction_view.events.WeixinCameraEvents=[],interaction_view.events.collisionEvents=[],interaction_view.events.dragStartEvents=[],interaction_view.events.draggingEvents=[],interaction_view.events.dragEndEvents=[],interaction_view.events.userListEvents=[],interaction_view.events.contactFormEvents=[],interaction_view.events.systemVariableEvents=[],interaction_view.events.userdataSaveEvents=[],interaction_view.events.sharedataSaveEvents=[],interaction_view.events.preloadPageEvents=[],"undefined"!=typeof Reveal&&(Reveal.wheelLock=!1,Reveal.dragLock=!1,Reveal.wheelEventLock=!1)},filterType:function(e,t,i){return t.overlay_id!=e.model.id||t.type!=i?!1:e.model.page.isLayer?t.layer_id==e.model.page.iOverlaylist.layerid:t.page_id==e.model.page.id},filterTypeByView:function(e,t){return t.overlay_id!=e.model.id?!1:e.model.page.isLayer?t.layer_id==e.model.page.iOverlaylist.layerid:t.page_id==e.model.page.id}};return events}),define("interaction_view/ui/environment",["underscore"],function(){var env={Userdata:{id:"",source_id:"",data:{},collection:{},mode:0,status:0,init:function(){if("undefined"==typeof epub360_domain||"epub360"!=epub360_domain||1==interaction_view.forpreview)return env.Userdata.status=2,!0;var e=_g.getUrlParameterByName("userdata",message_link);return _g.getUrlParameterByName("source_openid",message_link)&&(e=_g.getUrlParameterByName("source_openid",message_link)),null==e||e==epub360_userinfo.openid?(env.Userdata.status=2,epub360_userinfo.openid&&(env.Userdata.id=epub360_userinfo.openid,env.Userdata.source_id=env.Userdata.id,void 0!=epub360_userinfo.data&&epub360_userinfo.data&&env.Userdata.initData(epub360_userinfo.data)),!0):(env.Userdata.id=epub360_userinfo.openid,env.Userdata.source_id=e,env.Userdata.mode=1,env.Userdata.get(),!0)},state:function(){return env.Userdata.status},initData:function(data){for(var i=0;i<data.length;i++){var item=data[i],page_id=item.iPageid,overlay_id=item.overlay_id,userdata_page=env.Userdata.data[page_id];if(void 0==userdata_page&&(env.Userdata.data[page_id]={}),"Paragraph"==item.iType){var text=item.iDetail.iText;item.iDetail={iText:eval("'"+text+"'")}}if(env.Userdata.data[page_id][overlay_id]=item,env.Userdata.collection[page_id+"_"+overlay_id]){var view=env.Userdata.collection[page_id+"_"+overlay_id];if("Paragraph"==item.iType&&view.updateText(item.iDetail.iText,addtourl=0),"ImageBlock"==item.iType&&(view.getArgs(),view.setOtherDisplay()),"Audio"==item.iType){var detail=view.getdetail(),url=item.iDetail.value;interaction_view.media.changeSrc(view.model,url),detail.iAutoplay&&interaction_view.media.play(view.model),detail.iFile[0].file=url}"Slide"==item.iType&&(view.rmbLast=parseInt(item.iDetail.value),view.setElementTo(view.rmbLast)),"Variable"==item.iType&&view.render(),delete env.Userdata.collection[page_id+"_"+overlay_id]}}},get:function(e){env.Userdata.status=1,_g.ajax.get({dataType:"JSON",url:"userdata/"+env.Userdata.source_id+"/",callback:function(t){if(200==t.code){env.Userdata.status=2;var i=t.data.results.data;env.Userdata.initData(i),e&&e()}},onError:function(){}})},set:function(e,t){if(""!=env.Userdata.id){0==env.Userdata.initial&&(env.Userdata.initial=1);var i="userdata/"+env.Userdata.id+"/";_g.ajax.post({dataType:"JSON",data:JSON.stringify(e),url:i,callback:function(e){200==e.code&&t()},onError:function(){}})}},update:function(e,t,i,n){var a="sharedata/"+env.Userdata.id+"/"+e+"/"+t+"/";_g.ajax.post({dataType:"JSON",type:"PUT",data:JSON.stringify(i),url:a,callback:function(e){200==e.code&&(env.Userdata.share(e.data.results[0].id,t),n&&n())},onError:function(){}})},share:function(){var e=0;-1==message_link.indexOf(env.Userdata.id)&&(message_link=_g.replaceUrlParameterByName("source_openid","source_openid="+env.Userdata.id,message_link),e=1),e&&interaction_view.weixin.share()},getitem:function(e,t){if(env.Userdata.data[e]){var i=env.Userdata.data[e][t];if(i)return i.iDetail}return null},setitem:function(e,t){if(""!=env.Userdata.id){env.Userdata.id!=env.Userdata.source_id&&env.Userdata.reset();var i=e.model.get("pageid");void 0==env.Userdata.data[i]&&(env.Userdata.data[i]={});var n={overlay_id:e.model.id,iPageid:i,title:e.model.get("iDetail").title,iType:e.model.get("iType"),iDetail:t};if(env.Userdata.data[i][e.model.id])env.Userdata.update(i,e.model.id,n,function(){env.Userdata.data[i][e.model.id]=n});else{if(1==env.Userdata.initial)return void env.Userdata.setitems.push(n);env.Userdata.set([n])}}},setitems:function(e,t){if(""!=env.Userdata.id){env.Userdata.id!=env.Userdata.source_id&&env.Userdata.reset();for(var i=[],n=0;n<e.length;n++){var a=e[n],o=a.model.get("pageid");void 0==env.Userdata.data[o]&&(env.Userdata.data[o]={});var r={overlay_id:a.model.id,iPageid:o,title:a.model.get("iDetail").title,iType:a.model.get("iType")},s=a.getdetail();"Variable"==r.iType&&(r.iDetail={value:s.initial}),i.push(r),env.Userdata.data[o][a.model.id]=r}i&&env.Userdata.set(i,t)}},reset:function(){env.Userdata.source_id=env.Userdata.id,env.Userdata.mode=0,env.Userdata.status=2,env.Userdata.data=void 0!=epub360_userinfo.data&&epub360_userinfo.data||{},env.Userdata.initial=0,env.Userdata.share()},disableMode:function(){env.Userdata.mode=0},addView:function(e){var t=e.model,i=t.get("pageid");env.Userdata.collection[i+"_"+t.id]||env.Userdata.updateView(e)},updateView:function(e){var t=e.model,i=t.get("pageid");env.Userdata.collection[i+"_"+t.id]=e},getList:function(){return _.toArray(env.Userdata.collection)}},Sharedata:{id:"",source_id:"",data:{},collection:{},enabled:!0,mode:0,status:0,init:function(){if("undefined"==typeof epub360_domain||"epub360"!=epub360_domain||1==interaction_view.forpreview)return env.Sharedata.status=2,!0;message_link&&message_link.indexOf("source_openid")>-1&&(env.Sharedata.mode=1),message_link&&message_link.indexOf("disableHistoryStart")>-1&&message_link.indexOf("pageid")>-1&&(env.Sharedata.mode=1);var e=_g.getUrlParameterByName("sharedata",message_link);return null==e?(env.Sharedata.status=2,!0):(env.Sharedata.id=e,env.Sharedata.source_id=e,env.Sharedata.mode=1,env.Sharedata.get(),!0)},state:function(){return env.Sharedata.status},get:function(callback){env.Sharedata.status=1,_g.ajax.get({dataType:"JSON",url:"sharedata/"+env.Sharedata.id+"/",callback:function(result){if(200==result.code){env.Sharedata.status=2;for(var data=result.data.results.data,i=0;i<data.length;i++){var item=data[i],page_id=item.iPageid,overlay_id=item.overlay_id,sharedata_page=env.Sharedata.data[page_id];if(void 0==sharedata_page&&(env.Sharedata.data[page_id]={}),"Paragraph"==item.iType){var text=item.iDetail.iText;item.iDetail={iText:eval("'"+text+"'")}}if(env.Sharedata.data[page_id][overlay_id]=item,env.Sharedata.collection[page_id+"_"+overlay_id]){var view=env.Sharedata.collection[page_id+"_"+overlay_id];if("Paragraph"==item.iType&&view.updateText(item.iDetail.iText,addtourl=0),"ImageBlock"==item.iType&&(view.getArgs(),view.setOtherDisplay()),"Audio"==item.iType){var detail=view.getdetail(),url=item.iDetail.value;interaction_view.media.changeSrc(view.model,url),detail.iAutoplay&&interaction_view.media.play(view.model),detail.iFile[0].file=url}"Slide"==item.iType&&(view.rmbLast=parseInt(item.iDetail.value),view.setElementTo(view.rmbLast)),delete env.Sharedata.collection[page_id+"_"+overlay_id]}}callback&&callback()}},onError:function(){}})},set:function(e,t){if(""!=env.Sharedata.id&&1!=env.Sharedata.initial){(void 0==env.Sharedata.initial||0==env.Sharedata.initial)&&(env.Sharedata.initial=1);var i="sharedata/"+env.Sharedata.id+"/";_g.ajax.post({dataType:"JSON",data:JSON.stringify(e),url:i,callback:function(i){if(200==i.code){for(var n,a,o=0,r=0;r<e.length;r++)n=e[r].iPageid,a=e[r].overlay_id,env.Sharedata.data[n][a].changed=!1,o+=env.Sharedata.share(env.Sharedata.id,a);1==env.Sharedata.initial&&(env.Sharedata.initial=0),o&&interaction_view.weixin.share(),t&&t()}},onError:function(){}})}},update:function(e,t,i,n){var a="sharedata/"+env.Sharedata.id+"/"+e+"/"+t+"/";_g.ajax.post({dataType:"JSON",type:"PUT",data:JSON.stringify(i),url:a,callback:function(e){200==e.code&&(env.Sharedata.share(e.data.results[0].id,t),n&&n())},onError:function(){}})},share:function(e,t){var i=0;-1==message_link.indexOf(env.Sharedata.id)&&(message_link=_g.replaceUrlParameterByName("sharedata","sharedata="+env.Sharedata.id,message_link),i=1);var n=new RegExp("&?"+t+"=([^&])+"),a=n.exec(message_link);return a&&(message_link=message_link.replace(a[0],""),i=1),i},getitem:function(e,t){if(env.Sharedata.data[e]){var i=env.Sharedata.data[e][t];if(i)return i.iDetail}return null},setitem:function(e,t){if(env.Sharedata.id==env.Sharedata.source_id&&env.Sharedata.reset(),""!=env.Sharedata.id){var i=e.model.get("pageid");
void 0==env.Sharedata.data[i]&&(env.Sharedata.data[i]={});var n={overlay_id:e.model.id,iPageid:i,title:e.model.get("iDetail").title,iType:e.model.get("iType"),iDetail:t,changed:!0};env.Sharedata.data[i][e.model.id]=n}},setitems:function(e){var t=[];for(var i in env.Sharedata.data)for(var n in env.Sharedata.data[i])1==env.Sharedata.data[i][n].changed&&t.push(env.Sharedata.data[i][n]);env.Sharedata.set(t,e)},reset:function(){env.Sharedata.id="","object"==typeof wx_config&&wx_config.nonceStr&&(env.Sharedata.id=wx_config.nonceStr),env.Sharedata.mode=0,env.Sharedata.status=2,env.Sharedata.data={},env.Sharedata.initial=0},disableMode:function(){env.Sharedata.mode=0},addView:function(e){var t=e.model,i=t.get("pageid");env.Sharedata.collection[i+"_"+t.id]||env.Sharedata.updateView(e)},updateView:function(e){var t=e.model,i=t.get("pageid");env.Sharedata.collection[i+"_"+t.id]=e},getList:function(){return _.toArray(env.Sharedata.collection)}},Shareapp:{id:"",slug:"",shareinfo:{},helperinfo:{},appinfo:{},status:0,collection:{},init:function(){if(""==interaction_view.shareapp.id)return!1;env.Shareapp.slug=interaction_view.shareapp.id;var e=_g.getUrlParameterByName("shareid",message_link);return null==e?!1:""==interaction_view.shareapp.id?!1:(env.Shareapp.id=e,env.Shareapp.get(),!0)},get:function(e){env.Shareapp.status=1,_g.ajax.get({dataType:"JSON",url:"/share/"+env.Shareapp.slug+"/info?id="+env.Shareapp.id,callback:function(t){200==t.code?(env.Shareapp.shareinfo=t.data.results[0].shareinfo,env.Shareapp.helperinfo=t.data.results[0].helperinfo,env.Shareapp.appinfo=t.data.results[0].appinfo,1==env.Shareapp.status&&(env.Shareapp.status=2,env.Shareapp.waitpage&&env.Shareapp.waitpage==interaction_view.currentPage?interaction_view.play(interaction_view.currentPage):(console.info("env.Shareapp.get"),$.each(env.Shareapp.collection,function(e,t){var i=t;i.model.get("pageid")==interaction_view.currentPage&&2!=i.status&&i.resetOtherStatus()}))),e&&e()):env.Shareapp.status=0},onError:function(){interaction_view.environment.Shareapp.status=0}})},usertype:function(){return""==env.Shareapp.slug?"@å©å_æªå¯ç¨@":""==env.Shareapp.id?0:env.Shareapp.status<2?0:env.Shareapp.shareinfo.openid==epub360_userinfo.openid?1:interaction_view.environment.Shareapp.helperinfo.help_num>0?2:0},total:function(){return""==env.Shareapp.slug?"@å©å_æªå¯ç¨@":""==env.Shareapp.id?0:env.Shareapp.status<2?0:interaction_view.environment.Shareapp.shareinfo.total},help:function(e){e&&e()},create:function(){},add:function(e){var t=e.model;env.Shareapp.collection[t.id]||env.Shareapp.update(e)},update:function(e){var t=e.model;env.Shareapp.collection[t.id]=e},getList:function(){return _.toArray(env.Shareapp.collection)}},Votes:{collection:{},add:function(e){env.Votes.collection[e.id]||env.Votes.update(e)},update:function(e){env.Votes.collection[e.id]=e},get:function(){return _.toArray(env.Votes.collection)}},Paragraph:{editable:!1,stateChanged:function(e){_.each(interaction_view.getOverlays("Slide",interaction_view.currentPage),function(t){t.iview.setControl(e)})},enable:function(){env.Paragraph.editable=!0,$("body").addClass("ParagraghEditable"),env.Paragraph.stateChanged(!0)},disable:function(){env.Paragraph.editable=!1,$("body").removeClass("ParagraghEditable"),env.Paragraph.stateChanged(!1)},state:function(){return env.Paragraph.editable}},otherFormValue:{}};return env});var mejs=mejs||{};if(mejs.version="2.13.1",mejs.meIndex=0,mejs.plugins={silverlight:[{version:[3,0],types:["video/mp4","video/m4v","video/mov","video/wmv","audio/wma","audio/m4a","audio/mp3","audio/wav","audio/mpeg"]}],flash:[{version:[9,0,124],types:["video/mp4","video/m4v","video/mov","video/flv","video/rtmp","video/x-flv","audio/flv","audio/x-flv","audio/mp3","audio/m4a","audio/mpeg","video/youtube","video/x-youtube"]}],youtube:[{version:null,types:["video/youtube","video/x-youtube","audio/youtube","audio/x-youtube"]}],vimeo:[{version:null,types:["video/vimeo","video/x-vimeo"]}]},mejs.Utility={encodeUrl:function(e){return encodeURIComponent(e)},escapeHTML:function(e){return e.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},absolutizeUrl:function(e){var t=document.createElement("div");return t.innerHTML='<a href="'+this.escapeHTML(e)+'">x</a>',t.firstChild.href},getScriptPath:function(e){for(var t,i,n,a=0,o="",r="",s=document.getElementsByTagName("script"),l=s.length,c=e.length;l>a;a++){for(i=s[a].src,t=i.lastIndexOf("/"),t>-1?(n=i.substring(t+1),i=i.substring(0,t+1)):(n=i,i=""),t=0;c>t;t++)if(r=e[t],r=n.indexOf(r),r>-1){o=i;break}if(""!==o)break}return o},secondsToTimeCode:function(e,t,i,n){"undefined"==typeof i?i=!1:"undefined"==typeof n&&(n=25);var a=Math.floor(e/3600)%24,o=Math.floor(e/60)%60,r=Math.floor(e%60);return e=Math.floor((e%1*n).toFixed(3)),(t||a>0?(10>a?"0"+a:a)+":":"")+(10>o?"0"+o:o)+":"+(10>r?"0"+r:r)+(i?":"+(10>e?"0"+e:e):"")},timeCodeToSeconds:function(e,t,i,n){"undefined"==typeof i?i=!1:"undefined"==typeof n&&(n=25),e=e.split(":"),t=parseInt(e[0],10);var a=parseInt(e[1],10),o=parseInt(e[2],10),r=0,s=0;return i&&(r=parseInt(e[3])/n),s=3600*t+60*a+o+r},convertSMPTEtoSeconds:function(e){if("string"!=typeof e)return!1;e=e.replace(",",".");var t=0,i=-1!=e.indexOf(".")?e.split(".")[1].length:0,n=1;e=e.split(":").reverse();for(var a=0;a<e.length;a++)n=1,a>0&&(n=Math.pow(60,a)),t+=Number(e[a])*n;return Number(t.toFixed(i))},removeSwf:function(e){var t=document.getElementById(e);t&&/object|embed/i.test(t.nodeName)&&(mejs.MediaFeatures.isIE?(t.style.display="none",function(){4==t.readyState?mejs.Utility.removeObjectInIE(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))},removeObjectInIE:function(e){if(e=document.getElementById(e)){for(var t in e)"function"==typeof e[t]&&(e[t]=null);e.parentNode.removeChild(e)}}},mejs.PluginDetector={hasPluginVersion:function(e,t){var i=this.plugins[e];return t[1]=t[1]||0,t[2]=t[2]||0,i[0]>t[0]||i[0]==t[0]&&i[1]>t[1]||i[0]==t[0]&&i[1]==t[1]&&i[2]>=t[2]?!0:!1},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(e,t,i,n,a){this.plugins[e]=this.detectPlugin(t,i,n,a)},detectPlugin:function(e,t,i,n){var a,o=[0,0,0];if("undefined"!=typeof this.nav.plugins&&"object"==typeof this.nav.plugins[e]){if((i=this.nav.plugins[e].description)&&("undefined"==typeof this.nav.mimeTypes||!this.nav.mimeTypes[t]||this.nav.mimeTypes[t].enabledPlugin))for(o=i.replace(e,"").replace(/^\s+/,"").replace(/\sr/gi,".").split("."),e=0;e<o.length;e++)o[e]=parseInt(o[e].match(/\d+/),10)}else if("undefined"!=typeof window.ActiveXObject)try{(a=new ActiveXObject(i))&&(o=n(a))}catch(r){}return o}},mejs.PluginDetector.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(e){var t=[];return(e=e.GetVariable("$version"))&&(e=e.split(" ")[1].split(","),t=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]),t}),mejs.PluginDetector.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",function(e){var t=[0,0,0,0],i=function(e,t,i,n){for(;e.isVersionSupported(t[0]+"."+t[1]+"."+t[2]+"."+t[3]);)t[i]+=n;t[i]-=n};return i(e,t,0,1),i(e,t,1,1),i(e,t,2,1e4),i(e,t,2,1e3),i(e,t,2,100),i(e,t,2,10),i(e,t,2,1),i(e,t,3,1),t}),mejs.MediaFeatures={init:function(){var e,t=this,i=document,n=mejs.PluginDetector.nav,a=mejs.PluginDetector.ua.toLowerCase(),o=["source","track","audio","video"];t.isiPad=null!==a.match(/ipad/i),t.isiPhone=null!==a.match(/iphone/i),t.isiOS=t.isiPhone||t.isiPad,t.isAndroid=null!==a.match(/android/i),t.isBustedAndroid=null!==a.match(/android 2\.[12]/),t.isBustedNativeHTTPS="https:"===location.protocol&&(null!==a.match(/android [12]\./)||null!==a.match(/macintosh.* version.* safari/)),t.isIE=null!==n.appName.toLowerCase().match(/trident/gi),t.isChrome=null!==a.match(/chrome/gi),t.isFirefox=null!==a.match(/firefox/gi),t.isWebkit=null!==a.match(/webkit/gi),t.isGecko=null!==a.match(/gecko/gi)&&!t.isWebkit&&!t.isIE,t.isOpera=null!==a.match(/opera/gi),t.hasTouch="ontouchstart"in window&&null!=window.ontouchstart,t.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;for(n=0;n<o.length;n++)e=document.createElement(o[n]);t.supportsMediaTag="undefined"!=typeof e.canPlayType||t.isBustedAndroid;try{e.canPlayType("video/mp4")}catch(r){t.supportsMediaTag=!1}t.hasSemiNativeFullScreen="undefined"!=typeof e.webkitEnterFullscreen,t.hasNativeFullscreen="undefined"!=typeof e.requestFullscreen,t.hasWebkitNativeFullScreen="undefined"!=typeof e.webkitRequestFullScreen,t.hasMozNativeFullScreen="undefined"!=typeof e.mozRequestFullScreen,t.hasMsNativeFullScreen="undefined"!=typeof e.msRequestFullscreen,t.hasTrueNativeFullScreen=t.hasWebkitNativeFullScreen||t.hasMozNativeFullScreen||t.hasMsNativeFullScreen,t.nativeFullScreenEnabled=t.hasTrueNativeFullScreen,t.hasMozNativeFullScreen?t.nativeFullScreenEnabled=document.mozFullScreenEnabled:t.hasMsNativeFullScreen&&(t.nativeFullScreenEnabled=document.msFullscreenEnabled),t.isChrome&&(t.hasSemiNativeFullScreen=!1),t.hasTrueNativeFullScreen&&(t.fullScreenEventName="",t.hasWebkitNativeFullScreen?t.fullScreenEventName="webkitfullscreenchange":t.hasMozNativeFullScreen?t.fullScreenEventName="mozfullscreenchange":t.hasMsNativeFullScreen&&(t.fullScreenEventName="MSFullscreenChange"),t.isFullScreen=function(){return e.mozRequestFullScreen?i.mozFullScreen:e.webkitRequestFullScreen?i.webkitIsFullScreen:e.hasMsNativeFullScreen?null!==i.msFullscreenElement:void 0},t.requestFullScreen=function(e){t.hasWebkitNativeFullScreen?e.webkitRequestFullScreen():t.hasMozNativeFullScreen?e.mozRequestFullScreen():t.hasMsNativeFullScreen&&e.msRequestFullscreen()},t.cancelFullScreen=function(){t.hasWebkitNativeFullScreen?document.webkitCancelFullScreen():t.hasMozNativeFullScreen?document.mozCancelFullScreen():t.hasMsNativeFullScreen&&document.msExitFullscreen()}),t.hasSemiNativeFullScreen&&a.match(/mac os x 10_5/i)&&(t.hasNativeFullScreen=!1,t.hasSemiNativeFullScreen=!1)}},mejs.MediaFeatures.init(),mejs.HtmlMediaElement={pluginType:"native",isFullScreen:!1,setCurrentTime:function(e){this.currentTime=e},setMuted:function(e){this.muted=e},setVolume:function(e){this.volume=e},stop:function(){this.pause()},setSrc:function(e){for(var t=this.getElementsByTagName("source");t.length>0;)this.removeChild(t[0]);if("string"==typeof e)this.src=e;else{var i;for(t=0;t<e.length;t++)if(i=e[t],this.canPlayType(i.type)){this.src=i.src;break}}},setVideoSize:function(e,t){this.width=e,this.height=t}},mejs.PluginMediaElement=function(e,t,i){this.id=e,this.pluginType=t,this.src=i,this.events={},this.attributes={}},mejs.PluginMediaElement.prototype={pluginElement:null,pluginType:"",isFullScreen:!1,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:!0,ended:!1,seeking:!1,duration:0,error:null,tagName:"",muted:!1,volume:1,currentTime:0,play:function(){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.playVideo():this.pluginApi.playMedia(),this.paused=!1)},load:function(){null!=this.pluginApi&&("youtube"!=this.pluginType&&this.pluginApi.loadMedia(),this.paused=!1)},pause:function(){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.pauseVideo():this.pluginApi.pauseMedia(),this.paused=!0)},stop:function(){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.stopVideo():this.pluginApi.stopMedia(),this.paused=!0)},canPlayType:function(e){var t,i,n,a=mejs.plugins[this.pluginType];for(t=0;t<a.length;t++)if(n=a[t],mejs.PluginDetector.hasPluginVersion(this.pluginType,n.version))for(i=0;i<n.types.length;i++)if(e==n.types[i])return"probably";return""},positionFullscreenButton:function(e,t,i){null!=this.pluginApi&&this.pluginApi.positionFullscreenButton&&this.pluginApi.positionFullscreenButton(Math.floor(e),Math.floor(t),i)},hideFullscreenButton:function(){null!=this.pluginApi&&this.pluginApi.hideFullscreenButton&&this.pluginApi.hideFullscreenButton()},setSrc:function(e){if("string"==typeof e)this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(e)),this.src=mejs.Utility.absolutizeUrl(e);else{var t,i;for(t=0;t<e.length;t++)if(i=e[t],this.canPlayType(i.type)){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(i.src)),this.src=mejs.Utility.absolutizeUrl(e);break}}},setCurrentTime:function(e){null!=this.pluginApi&&("youtube"==this.pluginType?this.pluginApi.seekTo(e):this.pluginApi.setCurrentTime(e),this.currentTime=e)},setVolume:function(e){null!=this.pluginApi&&(this.pluginApi.setVolume("youtube"==this.pluginType?100*e:e),this.volume=e)},setMuted:function(e){null!=this.pluginApi&&("youtube"==this.pluginType?(e?this.pluginApi.mute():this.pluginApi.unMute(),this.muted=e,this.dispatchEvent("volumechange")):this.pluginApi.setMuted(e),this.muted=e)},setVideoSize:function(e,t){this.pluginElement.style&&(this.pluginElement.style.width=e+"px",this.pluginElement.style.height=t+"px"),null!=this.pluginApi&&this.pluginApi.setVideoSize&&this.pluginApi.setVideoSize(e,t)},setFullscreen:function(e){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.pluginApi.setFullscreen(e)},enterFullScreen:function(){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.setFullscreen(!0)},exitFullScreen:function(){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.setFullscreen(!1)},addEventListener:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},removeEventListener:function(e,t){if(!e)return this.events={},!0;var n=this.events[e];if(!n)return!0;if(!t)return this.events[e]=[],!0;for(i=0;i<n.length;i++)if(n[i]===t)return this.events[e].splice(i,1),!0;return!1},dispatchEvent:function(e){var t,i,n=this.events[e];if(n)for(i=Array.prototype.slice.call(arguments,1),t=0;t<n.length;t++)n[t].apply(null,i)},hasAttribute:function(e){return e in this.attributes},removeAttribute:function(e){delete this.attributes[e]},getAttribute:function(e){return this.hasAttribute(e)?this.attributes[e]:""},setAttribute:function(e,t){this.attributes[e]=t},remove:function(){mejs.Utility.removeSwf(this.pluginElement.id),mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id)}},mejs.MediaPluginBridge={pluginMediaElements:{},htmlMediaElements:{},registerPluginElement:function(e,t,i){this.pluginMediaElements[e]=t,this.htmlMediaElements[e]=i},unregisterPluginElement:function(e){delete this.pluginMediaElements[e],delete this.htmlMediaElements[e]},initPlugin:function(e){var t=this.pluginMediaElements[e],i=this.htmlMediaElements[e];if(t){switch(t.pluginType){case"flash":t.pluginElement=t.pluginApi=document.getElementById(e);break;case"silverlight":t.pluginElement=document.getElementById(t.id),t.pluginApi=t.pluginElement.Content.MediaElementJS}null!=t.pluginApi&&t.success&&t.success(t,i)}},fireEvent:function(e,t,i){var n,a;if(e=this.pluginMediaElements[e]){t={type:t,target:e};for(n in i)e[n]=i[n],t[n]=i[n];a=i.bufferedTime||0,t.target.buffered=t.buffered={start:function(){return 0},end:function(){return a},length:1},e.dispatchEvent(t.type,t)}}},mejs.MediaElementDefaults={mode:"auto",plugins:["flash","silverlight","youtube","vimeo"],enablePluginDebug:!1,httpsBasicAuthSite:!1,type:"",pluginPath:mejs.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player.min.js"]),flashName:"flashmediaelement.swf",flashStreamer:"",enablePluginSmoothing:!1,enablePseudoStreaming:!1,pseudoStreamingStartQueryParam:"start",silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,pluginVars:[],timerRate:250,startVolume:.8,success:function(){},error:function(){}},mejs.MediaElement=function(e,t){return mejs.HtmlMediaElementShim.create(e,t)},mejs.HtmlMediaElementShim={create:function(e,t){var i=mejs.MediaElementDefaults,n="string"==typeof e?document.getElementById(e):e,a=n.tagName.toLowerCase(),o="audio"===a||"video"===a,r=n.getAttribute(o?"src":"href");a=n.getAttribute("poster");var s,l=n.getAttribute("autoplay"),c=n.getAttribute("preload"),d=n.getAttribute("controls");for(s in t)i[s]=t[s];return r="undefined"==typeof r||null===r||""==r?null:r,a="undefined"==typeof a||null===a?"":a,c="undefined"==typeof c||null===c||"false"===c?"none":c,l=!("undefined"==typeof l||null===l||"false"===l),d=!("undefined"==typeof d||null===d||"false"===d),s=this.determinePlayback(n,i,mejs.MediaFeatures.supportsMediaTag,o,r),s.url=null!==s.url?mejs.Utility.absolutizeUrl(s.url):"","native"==s.method?(mejs.MediaFeatures.isBustedAndroid&&(n.src=s.url,n.addEventListener("click",function(){n.play()},!1)),this.updateNative(s,i,l,c)):""!==s.method?this.createPlugin(s,i,a,l,c,d):(this.createErrorMessage(s,i,a),this)},determinePlayback:function(e,t,i,n,a){var o,r,s,l,c=[],d={method:"",url:"",htmlMediaElement:e,isVideo:"audio"!=e.tagName.toLowerCase()};if("undefined"!=typeof t.type&&""!==t.type)if("string"==typeof t.type)c.push({type:t.type,url:a});else for(o=0;o<t.type.length;o++)c.push({type:t.type[o],url:a});else if(null!==a)s=this.formatType(a,e.getAttribute("type")),c.push({type:s,url:a});else for(o=0;o<e.childNodes.length;o++)r=e.childNodes[o],1==r.nodeType&&"source"==r.tagName.toLowerCase()&&(a=r.getAttribute("src"),s=this.formatType(a,r.getAttribute("type")),r=r.getAttribute("media"),(!r||!window.matchMedia||window.matchMedia&&window.matchMedia(r).matches)&&c.push({type:s,url:a}));if(!n&&c.length>0&&null!==c[0].url&&this.getTypeFromFile(c[0].url).indexOf("audio")>-1&&(d.isVideo=!1),mejs.MediaFeatures.isBustedAndroid&&(e.canPlayType=function(e){return null!==e.match(/video\/(mp4|m4v)/gi)?"maybe":""}),!(!i||"auto"!==t.mode&&"auto_plugin"!==t.mode&&"native"!==t.mode||mejs.MediaFeatures.isBustedNativeHTTPS&&t.httpsBasicAuthSite===!0)){for(n||(o=document.createElement(d.isVideo?"video":"audio"),e.parentNode.insertBefore(o,e),e.style.display="none",d.htmlMediaElement=e=o),o=0;o<c.length;o++)if(""!==e.canPlayType(c[o].type).replace(/no/,"")||""!==e.canPlayType(c[o].type.replace(/mp3/,"mpeg")).replace(/no/,"")){d.method="native",d.url=c[o].url;break}if("native"===d.method&&(null!==d.url&&(e.src=d.url),"auto_plugin"!==t.mode))return d}if("auto"===t.mode||"auto_plugin"===t.mode||"shim"===t.mode)for(o=0;o<c.length;o++)for(s=c[o].type,e=0;e<t.plugins.length;e++)for(a=t.plugins[e],r=mejs.plugins[a],i=0;i<r.length;i++)if(l=r[i],null==l.version||mejs.PluginDetector.hasPluginVersion(a,l.version))for(n=0;n<l.types.length;n++)if(s==l.types[n])return d.method=a,d.url=c[o].url,d;return"auto_plugin"===t.mode&&"native"===d.method?d:(""===d.method&&c.length>0&&(d.url=c[0].url),d)},formatType:function(e,t){return e&&!t?this.getTypeFromFile(e):t&&~t.indexOf(";")?t.substr(0,t.indexOf(";")):t},getTypeFromFile:function(e){return e=e.split("?")[0],e=e.substring(e.lastIndexOf(".")+1).toLowerCase(),(/(mp4|m4v|ogg|ogv|webm|webmv|flv|wmv|mpeg|mov)/gi.test(e)?"video":"audio")+"/"+this.getTypeFromExtension(e)},getTypeFromExtension:function(e){switch(e){case"mp4":case"m4v":return"mp4";case"webm":case"webma":case"webmv":return"webm";case"ogg":case"oga":case"ogv":return"ogg";default:return e}},createErrorMessage:function(e,t,i){var n=e.htmlMediaElement,a=document.createElement("div");a.className="me-cannotplay";try{a.style.width=n.width+"px",a.style.height=n.height+"px"}catch(o){}a.innerHTML=t.customError?t.customError:""!==i?'<a href="'+e.url+'"><img src="'+i+'" width="100%" height="100%" /></a>':'<a href="'+e.url+'"><span>'+mejs.i18n.t("Download File")+"</span></a>",n.parentNode.insertBefore(a,n),n.style.display="none",t.error(n)},createPlugin:function(e,t,i,n,a,o){i=e.htmlMediaElement;var r,s=1,l=1,c="me_"+e.method+"_"+mejs.meIndex++,d=new mejs.PluginMediaElement(c,e.method,e.url),h=document.createElement("div");for(d.tagName=i.tagName,r=0;r<i.attributes.length;r++){var u=i.attributes[r];1==u.specified&&d.setAttribute(u.name,u.value)}for(r=i.parentNode;null!==r&&"body"!=r.tagName.toLowerCase();){if("p"==r.parentNode.tagName.toLowerCase()){r.parentNode.parentNode.insertBefore(r,r.parentNode);break}r=r.parentNode}switch(e.isVideo?(s=t.pluginWidth>0?t.pluginWidth:t.videoWidth>0?t.videoWidth:null!==i.getAttribute("width")?i.getAttribute("width"):t.defaultVideoWidth,l=t.pluginHeight>0?t.pluginHeight:t.videoHeight>0?t.videoHeight:null!==i.getAttribute("height")?i.getAttribute("height"):t.defaultVideoHeight,s=mejs.Utility.encodeUrl(s),l=mejs.Utility.encodeUrl(l)):t.enablePluginDebug&&(s=320,l=240),d.success=t.success,mejs.MediaPluginBridge.registerPluginElement(c,d,i),h.className="me-plugin",h.id=c+"_container",e.isVideo?i.parentNode.insertBefore(h,i):document.body.insertBefore(h,document.body.childNodes[0]),n=["id="+c,"isvideo="+(e.isVideo?"true":"false"),"autoplay="+(n?"true":"false"),"preload="+a,"width="+s,"startvolume="+t.startVolume,"timerrate="+t.timerRate,"flashstreamer="+t.flashStreamer,"height="+l,"pseudostreamstart="+t.pseudoStreamingStartQueryParam],null!==e.url&&n.push("flash"==e.method?"file="+mejs.Utility.encodeUrl(e.url):"file="+e.url),t.enablePluginDebug&&n.push("debug=true"),t.enablePluginSmoothing&&n.push("smoothing=true"),t.enablePseudoStreaming&&n.push("pseudostreaming=true"),o&&n.push("controls=true"),t.pluginVars&&(n=n.concat(t.pluginVars)),e.method){case"silverlight":h.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+c+'" name="'+c+'" width="'+s+'" height="'+l+'" class="mejs-shim"><param name="initParams" value="'+n.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+t.pluginPath+t.silverlightName+'" /></object>';break;case"flash":mejs.MediaFeatures.isIE?(e=document.createElement("div"),h.appendChild(e),e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+c+'" width="'+s+'" height="'+l+'" class="mejs-shim"><param name="movie" value="'+t.pluginPath+t.flashName+"?x="+new Date+'" /><param name="flashvars" value="'+n.join("&amp;")+'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'):h.innerHTML='<embed id="'+c+'" name="'+c+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" src="'+t.pluginPath+t.flashName+'" flashvars="'+n.join("&")+'" width="'+s+'" height="'+l+'" class="mejs-shim"></embed>';break;case"youtube":t=e.url.substr(e.url.lastIndexOf("=")+1),youtubeSettings={container:h,containerId:h.id,pluginMediaElement:d,pluginId:c,videoId:t,height:l,width:s},mejs.PluginDetector.hasPluginVersion("flash",[10,0,0])?mejs.YouTubeApi.createFlash(youtubeSettings):mejs.YouTubeApi.enqueueIframe(youtubeSettings);break;case"vimeo":d.vimeoid=e.url.substr(e.url.lastIndexOf("/")+1),h.innerHTML='<iframe src="http://player.vimeo.com/video/'+d.vimeoid+'?portrait=0&byline=0&title=0" width="'+s+'" height="'+l+'" frameborder="0" class="mejs-shim"></iframe>'}return i.style.display="none",i.removeAttribute("autoplay"),d},updateNative:function(e,t){var i,n=e.htmlMediaElement;for(i in mejs.HtmlMediaElement)n[i]=mejs.HtmlMediaElement[i];return t.success(n,n),n}},mejs.YouTubeApi={isIframeStarted:!1,isIframeLoaded:!1,loadIframeApi:function(){if(!this.isIframeStarted){var e=document.createElement("script");e.src="//www.youtube.com/player_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),this.isIframeStarted=!0}},iframeQueue:[],enqueueIframe:function(e){this.isLoaded?this.createIframe(e):(this.loadIframeApi(),this.iframeQueue.push(e))},createIframe:function(e){var t=e.pluginMediaElement,i=new YT.Player(e.containerId,{height:e.height,width:e.width,videoId:e.videoId,playerVars:{controls:0},events:{onReady:function(){e.pluginMediaElement.pluginApi=i,mejs.MediaPluginBridge.initPlugin(e.pluginId),setInterval(function(){mejs.YouTubeApi.createEvent(i,t,"timeupdate")},250)},onStateChange:function(e){mejs.YouTubeApi.handleStateChange(e.data,i,t)}}})},createEvent:function(e,t,i){if(i={type:i,target:t},e&&e.getDuration){t.currentTime=i.currentTime=e.getCurrentTime(),t.duration=i.duration=e.getDuration(),i.paused=t.paused,i.ended=t.ended,i.muted=e.isMuted(),i.volume=e.getVolume()/100,i.bytesTotal=e.getVideoBytesTotal(),i.bufferedBytes=e.getVideoBytesLoaded();var n=i.bufferedBytes/i.bytesTotal*i.duration;i.target.buffered=i.buffered={start:function(){return 0},end:function(){return n},length:1}}t.dispatchEvent(i.type,i)},iFrameReady:function(){for(this.isIframeLoaded=this.isLoaded=!0;this.iframeQueue.length>0;)this.createIframe(this.iframeQueue.pop())},flashPlayers:{},createFlash:function(e){this.flashPlayers[e.pluginId]=e;var t,i="//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid="+e.pluginId+"&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";mejs.MediaFeatures.isIE?(t=document.createElement("div"),e.container.appendChild(t),t.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+e.pluginId+'" width="'+e.width+'" height="'+e.height+'" class="mejs-shim"><param name="movie" value="'+i+'" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'):e.container.innerHTML='<object type="application/x-shockwave-flash" id="'+e.pluginId+'" data="'+i+'" width="'+e.width+'" height="'+e.height+'" style="visibility: visible; " class="mejs-shim"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"></object>'},flashReady:function(e){var t=this.flashPlayers[e],i=document.getElementById(e),n=t.pluginMediaElement;n.pluginApi=n.pluginElement=i,mejs.MediaPluginBridge.initPlugin(e),i.cueVideoById(t.videoId),e=t.containerId+"_callback",window[e]=function(e){mejs.YouTubeApi.handleStateChange(e,i,n)},i.addEventListener("onStateChange",e),setInterval(function(){mejs.YouTubeApi.createEvent(i,n,"timeupdate")},250)},handleStateChange:function(e,t,i){switch(e){case-1:i.paused=!0,i.ended=!0,mejs.YouTubeApi.createEvent(t,i,"loadedmetadata");break;case 0:i.paused=!1,i.ended=!0,mejs.YouTubeApi.createEvent(t,i,"ended");break;case 1:i.paused=!1,i.ended=!1,mejs.YouTubeApi.createEvent(t,i,"play"),mejs.YouTubeApi.createEvent(t,i,"playing");break;case 2:i.paused=!0,i.ended=!1,mejs.YouTubeApi.createEvent(t,i,"pause");break;case 3:mejs.YouTubeApi.createEvent(t,i,"progress")}}},window.mejs=mejs,window.MediaElement=mejs.MediaElement,function(e,t){var i={locale:{language:"",strings:{}},methods:{}};i.locale.getLanguage=function(){return i.locale.language||navigator.language},"undefined"!=typeof mejsL10n&&(i.locale.language=mejsL10n.language),i.locale.INIT_LANGUAGE=i.locale.getLanguage(),i.methods.checkPlain=function(e){var t,i,n={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};e=String(e);for(t in n)n.hasOwnProperty(t)&&(i=RegExp(t,"g"),e=e.replace(i,n[t]));return e},i.methods.formatString=function(e,t){for(var n in t){switch(n.charAt(0)){case"@":t[n]=i.methods.checkPlain(t[n]);break;case"!":break;default:t[n]='<em class="placeholder">'+i.methods.checkPlain(t[n])+"</em>"}e=e.replace(n,t[n])}return e},i.methods.t=function(e,t,n){return i.locale.strings&&i.locale.strings[n.context]&&i.locale.strings[n.context][e]&&(e=i.locale.strings[n.context][e]),t&&(e=i.methods.formatString(e,t)),e},i.t=function(e,t,n){if("string"==typeof e&&e.length>0){var a=i.locale.getLanguage();return n=n||{context:a},i.methods.t(e,t,n)}throw{name:"InvalidArgumentException",message:"First argument is either not a string or empty."}},t.i18n=i}(document,mejs),function(e){"undefined"!=typeof mejsL10n&&(e[mejsL10n.language]=mejsL10n.strings)}(mejs.i18n.locale.strings),function(e){e.de={Fullscreen:"Vollbild","Go Fullscreen":"Vollbild an","Turn off Fullscreen":"Vollbild aus",Close:"SchlieÃen"}}(mejs.i18n.locale.strings),function(e){e.zh={Fullscreen:"å¨è¢å¹","Go Fullscreen":"å¨å±æ¨¡å¼","Turn off Fullscreen":"éåºå¨å±æ¨¡å¼",Close:"éé"}}(mejs.i18n.locale.strings),"undefined"!=typeof jQuery?mejs.$=jQuery:"undefined"!=typeof ender&&(mejs.$=ender),function(e){mejs.MepDefaults={poster:"",showPosterWhenEnded:!1,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:30,defaultSeekBackwardInterval:function(e){return.05*e.duration},defaultSeekForwardInterval:function(e){return.05*e.duration},audioWidth:-1,audioHeight:-1,startVolume:.8,loop:!1,autoRewind:!0,enableAutosize:!0,alwaysShowHours:!1,showTimecodeFrameCount:!1,framesPerSecond:25,autosizeProgress:!0,alwaysShowControls:!1,hideVideoControlsOnLoad:!1,clickToPlayPause:!0,iPadUseNativeControls:!1,iPhoneUseNativeControls:!1,AndroidUseNativeControls:!1,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],isVideo:!0,enableKeyboard:!0,pauseOtherPlayers:!0,keyActions:[{keys:[32,179],action:function(e,t){t.paused||t.ended?t.play():t.pause()}},{keys:[38],action:function(e,t){t.setVolume(Math.min(t.volume+.1,1))}},{keys:[40],action:function(e,t){t.setVolume(Math.max(t.volume-.1,0))}},{keys:[37,227],action:function(e,t){if(!isNaN(t.duration)&&t.duration>0){e.isVideo&&(e.showControls(),e.startControlsTimer());var i=Math.max(t.currentTime-e.options.defaultSeekBackwardInterval(t),0);t.setCurrentTime(i)}}},{keys:[39,228],action:function(e,t){if(!isNaN(t.duration)&&t.duration>0){e.isVideo&&(e.showControls(),e.startControlsTimer());var i=Math.min(t.currentTime+e.options.defaultSeekForwardInterval(t),t.duration);t.setCurrentTime(i)}}},{keys:[70],action:function(e){"undefined"!=typeof e.enterFullScreen&&(e.isFullScreen?e.exitFullScreen():e.enterFullScreen())}}]},mejs.mepIndex=0,mejs.players={},mejs.MediaElementPlayer=function(t,i){return this instanceof mejs.MediaElementPlayer?(this.$media=this.$node=e(t),this.node=this.media=this.$media[0],"undefined"!=typeof this.node.player?this.node.player:(this.node.player=this,"undefined"==typeof i&&(i=this.$node.data("mejsoptions")),this.options=e.extend({},mejs.MepDefaults,i),this.id="mep_"+mejs.mepIndex++,mejs.players[this.id]=this,this.init(),this)):new mejs.MediaElementPlayer(t,i)},mejs.MediaElementPlayer.prototype={hasFocus:!1,controlsAreVisible:!0,init:function(){var t=this,i=mejs.MediaFeatures,n=e.extend(!0,{},t.options,{success:function(e,i){t.meReady(e,i)},error:function(e){t.handleError(e)}}),a=t.media.tagName.toLowerCase();t.isDynamic="audio"!==a&&"video"!==a,t.isVideo=t.isDynamic?t.options.isVideo:"audio"!==a&&t.options.isVideo,i.isiPad&&t.options.iPadUseNativeControls||i.isiPhone&&t.options.iPhoneUseNativeControls?(t.$media.attr("controls","controls"),i.isiPad&&null!==t.media.getAttribute("autoplay")&&(t.media.load(),t.media.play())):i.isAndroid&&t.options.AndroidUseNativeControls||(t.$media.removeAttr("controls"),t.container=e('<div id="'+t.id+'" class="mejs-container '+(mejs.MediaFeatures.svg?"svg":"no-svg")+'"><div class="mejs-inner"><div class="mejs-mediaelement"></div><div class="mejs-layers"></div><div class="mejs-controls"></div><div class="mejs-clear"></div></div></div>').addClass(t.$media[0].className).insertBefore(t.$media),t.container.addClass((i.isAndroid?"mejs-android ":"")+(i.isiOS?"mejs-ios ":"")+(i.isiPad?"mejs-ipad ":"")+(i.isiPhone?"mejs-iphone ":"")+(t.isVideo?"mejs-video ":"mejs-audio ")),i.isiOS?(i=t.$media.clone(),t.container.find(".mejs-mediaelement").append(i),t.$media.remove(),t.$node=t.$media=i,t.node=t.media=i[0]):t.container.find(".mejs-mediaelement").append(t.$media),t.controls=t.container.find(".mejs-controls"),t.layers=t.container.find(".mejs-layers"),i=t.isVideo?"video":"audio",a=i.substring(0,1).toUpperCase()+i.substring(1),t.width=t.options[i+"Width"]>0||t.options[i+"Width"].toString().indexOf("%")>-1?t.options[i+"Width"]:""!==t.media.style.width&&null!==t.media.style.width?t.media.style.width:null!==t.media.getAttribute("width")?t.$media.attr("width"):t.options["default"+a+"Width"],t.height=t.options[i+"Height"]>0||t.options[i+"Height"].toString().indexOf("%")>-1?t.options[i+"Height"]:""!==t.media.style.height&&null!==t.media.style.height?t.media.style.height:null!==t.$media[0].getAttribute("height")?t.$media.attr("height"):t.options["default"+a+"Height"],t.setPlayerSize(t.width,t.height),n.pluginWidth=t.width,n.pluginHeight=t.height),mejs.MediaElement(t.$media[0],n),"undefined"!=typeof t.container&&t.controlsAreVisible&&t.container.trigger("controlsshown")
},showControls:function(e){var t=this;e="undefined"==typeof e||e,t.controlsAreVisible||(e?(t.controls.css("visibility","visible").stop(!0,!0).fadeIn(200,function(){t.controlsAreVisible=!0,t.container.trigger("controlsshown")}),t.container.find(".mejs-control").css("visibility","visible").stop(!0,!0).fadeIn(200,function(){t.controlsAreVisible=!0})):(t.controls.css("visibility","visible").css("display","block"),t.container.find(".mejs-control").css("visibility","visible").css("display","block"),t.controlsAreVisible=!0,t.container.trigger("controlsshown")),t.setControlsSize())},hideControls:function(t){var i=this;t="undefined"==typeof t||t,i.controlsAreVisible&&!i.options.alwaysShowControls&&(t?(i.controls.stop(!0,!0).fadeOut(200,function(){e(this).css("visibility","hidden").css("display","block"),i.controlsAreVisible=!1,i.container.trigger("controlshidden")}),i.container.find(".mejs-control").stop(!0,!0).fadeOut(200,function(){e(this).css("visibility","hidden").css("display","block")})):(i.controls.css("visibility","hidden").css("display","block"),i.container.find(".mejs-control").css("visibility","hidden").css("display","block"),i.controlsAreVisible=!1,i.container.trigger("controlshidden")))},controlsTimer:null,startControlsTimer:function(e){var t=this;e="undefined"!=typeof e?e:1500,t.killControlsTimer("start"),t.controlsTimer=setTimeout(function(){t.hideControls(),t.killControlsTimer("hide")},e)},killControlsTimer:function(){null!==this.controlsTimer&&(clearTimeout(this.controlsTimer),delete this.controlsTimer,this.controlsTimer=null)},controlsEnabled:!0,disableControls:function(){this.killControlsTimer(),this.hideControls(!1),this.controlsEnabled=!1},enableControls:function(){this.showControls(!1),this.controlsEnabled=!0},meReady:function(e,t){var i=this,n=mejs.MediaFeatures,a=t.getAttribute("autoplay");a=!("undefined"==typeof a||null===a||"false"===a);var o;if(!i.created){if(i.created=!0,i.media=e,i.domNode=t,!(n.isAndroid&&i.options.AndroidUseNativeControls||n.isiPad&&i.options.iPadUseNativeControls||n.isiPhone&&i.options.iPhoneUseNativeControls)){i.buildposter(i,i.controls,i.layers,i.media),i.buildkeyboard(i,i.controls,i.layers,i.media),i.buildoverlays(i,i.controls,i.layers,i.media),i.findTracks();for(o in i.options.features)if(n=i.options.features[o],i["build"+n])try{i["build"+n](i,i.controls,i.layers,i.media)}catch(r){}i.container.trigger("controlsready"),i.setPlayerSize(i.width,i.height),i.setControlsSize(),i.isVideo&&(mejs.MediaFeatures.hasTouch?i.$media.bind("touchstart",function(){i.controlsAreVisible?i.hideControls(!1):i.controlsEnabled&&i.showControls(!1)}):(mejs.MediaElementPlayer.prototype.clickToPlayPauseCallback=function(){i.options.clickToPlayPause&&(i.media.paused?i.media.play():i.media.pause())},i.media.addEventListener("click",i.clickToPlayPauseCallback,!1),i.container.bind("mouseenter mouseover",function(){i.controlsEnabled&&(i.options.alwaysShowControls||(i.killControlsTimer("enter"),i.showControls(),i.startControlsTimer(2500)))}).bind("mousemove",function(){i.controlsEnabled&&(i.controlsAreVisible||i.showControls(),i.options.alwaysShowControls||i.startControlsTimer(2500))}).bind("mouseleave",function(){i.controlsEnabled&&!i.media.paused&&!i.options.alwaysShowControls&&i.startControlsTimer(1e3)})),i.options.hideVideoControlsOnLoad&&i.hideControls(!1),a&&!i.options.alwaysShowControls&&i.hideControls(),i.options.enableAutosize&&i.media.addEventListener("loadedmetadata",function(e){i.options.videoHeight<=0&&null===i.domNode.getAttribute("height")&&!isNaN(e.target.videoHeight)&&(i.setPlayerSize(e.target.videoWidth,e.target.videoHeight),i.setControlsSize(),i.media.setVideoSize(e.target.videoWidth,e.target.videoHeight))},!1)),e.addEventListener("play",function(){for(var e in mejs.players){var t=mejs.players[e];t.id!=i.id&&i.options.pauseOtherPlayers&&!t.paused&&!t.ended&&t.pause(),t.hasFocus=!1}i.hasFocus=!0},!1),i.media.addEventListener("ended",function(){if(i.options.autoRewind)try{i.media.setCurrentTime(0)}catch(e){}i.media.pause(),i.setProgressRail&&i.setProgressRail(),i.setCurrentRail&&i.setCurrentRail(),i.options.loop?i.media.play():!i.options.alwaysShowControls&&i.controlsEnabled&&i.showControls()},!1),i.media.addEventListener("loadedmetadata",function(){i.updateDuration&&i.updateDuration(),i.updateCurrent&&i.updateCurrent(),i.isFullScreen||(i.setPlayerSize(i.width,i.height),i.setControlsSize())},!1),setTimeout(function(){i.setPlayerSize(i.width,i.height),i.setControlsSize()},50),i.globalBind("resize",function(){i.isFullScreen||mejs.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen||i.setPlayerSize(i.width,i.height),i.setControlsSize()}),"youtube"==i.media.pluginType&&i.container.find(".mejs-overlay-play").hide()}a&&"native"==e.pluginType&&(e.load(),e.play()),i.options.success&&("string"==typeof i.options.success?window[i.options.success](i.media,i.domNode,i):i.options.success(i.media,i.domNode,i))}},handleError:function(e){this.controls.hide(),this.options.error&&this.options.error(e)},setPlayerSize:function(t,i){if("undefined"!=typeof t&&(this.width=t),"undefined"!=typeof i&&(this.height=i),this.height.toString().indexOf("%")>0||"100%"===this.$node.css("max-width")||parseInt(this.$node.css("max-width").replace(/px/,""),10)/this.$node.offsetParent().width()===1||this.$node[0].currentStyle&&"100%"===this.$node[0].currentStyle.maxWidth){var n=this.isVideo?this.media.videoWidth&&this.media.videoWidth>0?this.media.videoWidth:this.options.defaultVideoWidth:this.options.defaultAudioWidth,a=this.isVideo?this.media.videoHeight&&this.media.videoHeight>0?this.media.videoHeight:this.options.defaultVideoHeight:this.options.defaultAudioHeight,o=this.container.parent().closest(":visible").width();n=this.isVideo||!this.options.autosizeProgress?parseInt(o*a/n,10):a,"body"===this.container.parent()[0].tagName.toLowerCase()&&(o=e(window).width(),n=e(window).height()),0!=n&&0!=o&&(this.container.width(o).height(n),this.$media.add(this.container.find(".mejs-shim")).width("100%").height("100%"),this.isVideo&&this.media.setVideoSize&&this.media.setVideoSize(o,n),this.layers.children(".mejs-layer").width("100%").height("100%"))}else this.container.width(this.width).height(this.height),this.layers.children(".mejs-layer").width(this.width).height(this.height);o=this.layers.find(".mejs-overlay-play"),n=o.find(".mejs-overlay-button"),o.height(this.container.height()-this.controls.height()),n.css("margin-top","-"+(n.height()/2-this.controls.height()/2).toString()+"px")},setControlsSize:function(){var t=0,i=0,n=this.controls.find(".mejs-time-rail"),a=this.controls.find(".mejs-time-total");this.controls.find(".mejs-time-current"),this.controls.find(".mejs-time-loaded");var o=n.siblings();this.options&&!this.options.autosizeProgress&&(i=parseInt(n.css("width"))),0!==i&&i||(o.each(function(){var i=e(this);"absolute"!=i.css("position")&&i.is(":visible")&&(t+=e(this).outerWidth(!0))}),i=this.controls.width()-t-(n.outerWidth(!0)-n.width())),n.width(i),a.width(i-(a.outerWidth(!0)-a.width())),this.setProgressRail&&this.setProgressRail(),this.setCurrentRail&&this.setCurrentRail()},buildposter:function(t,i,n,a){var o=e('<div class="mejs-poster mejs-layer"></div>').appendTo(n);i=t.$media.attr("poster"),""!==t.options.poster&&(i=t.options.poster),""!==i&&null!=i?this.setPoster(i):o.hide(),a.addEventListener("play",function(){o.hide()},!1),t.options.showPosterWhenEnded&&t.options.autoRewind&&a.addEventListener("ended",function(){o.show()},!1)},setPoster:function(t){var i=this.container.find(".mejs-poster"),n=i.find("img");0==n.length&&(n=e('<img width="100%" height="100%" />').appendTo(i)),n.attr("src",t),i.css({"background-image":"url("+t+")"})},buildoverlays:function(t,i,n,a){var o=this;if(t.isVideo){var r=e('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-loading"><span></span></div></div>').hide().appendTo(n),s=e('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-error"></div></div>').hide().appendTo(n),l=e('<div class="mejs-overlay mejs-layer mejs-overlay-play"><div class="mejs-overlay-button"></div></div>').appendTo(n).click(function(){o.options.clickToPlayPause&&(a.paused?a.play():a.pause())});a.addEventListener("play",function(){l.hide(),r.hide(),i.find(".mejs-time-buffering").hide(),s.hide()},!1),a.addEventListener("playing",function(){l.hide(),r.hide(),i.find(".mejs-time-buffering").hide(),s.hide()},!1),a.addEventListener("seeking",function(){r.show(),i.find(".mejs-time-buffering").show()},!1),a.addEventListener("seeked",function(){r.hide(),i.find(".mejs-time-buffering").hide()},!1),a.addEventListener("pause",function(){mejs.MediaFeatures.isiPhone||l.show()},!1),a.addEventListener("waiting",function(){r.show(),i.find(".mejs-time-buffering").show()},!1),a.addEventListener("loadeddata",function(){r.show(),i.find(".mejs-time-buffering").show()},!1),a.addEventListener("canplay",function(){r.hide(),i.find(".mejs-time-buffering").hide()},!1),a.addEventListener("error",function(){r.hide(),i.find(".mejs-time-buffering").hide(),s.show(),s.find("mejs-overlay-error").html("Error loading this resource")},!1)}},buildkeyboard:function(t,i,n,a){this.globalBind("keydown",function(e){if(t.hasFocus&&t.options.enableKeyboard)for(var i=0,n=t.options.keyActions.length;n>i;i++)for(var o=t.options.keyActions[i],r=0,s=o.keys.length;s>r;r++)if(e.keyCode==o.keys[r])return e.preventDefault(),o.action(t,a,e.keyCode),!1;return!0}),this.globalBind("click",function(i){0==e(i.target).closest(".mejs-container").length&&(t.hasFocus=!1)})},findTracks:function(){var t=this,i=t.$media.find("track");t.tracks=[],i.each(function(i,n){n=e(n),t.tracks.push({srclang:n.attr("srclang")?n.attr("srclang").toLowerCase():"",src:n.attr("src"),kind:n.attr("kind"),label:n.attr("label")||"",entries:[],isLoaded:!1})})},changeSkin:function(e){this.container[0].className="mejs-container "+e,this.setPlayerSize(this.width,this.height),this.setControlsSize()},play:function(){this.media.play()},pause:function(){try{this.media.pause()}catch(e){}},load:function(){this.media.load()},setMuted:function(e){this.media.setMuted(e)},setCurrentTime:function(e){this.media.setCurrentTime(e)},getCurrentTime:function(){return this.media.currentTime},setVolume:function(e){this.media.setVolume(e)},getVolume:function(){return this.media.volume},setSrc:function(e){this.media.setSrc(e)},remove:function(){var e,t;for(e in this.options.features)if(t=this.options.features[e],this["clean"+t])try{this["clean"+t](this)}catch(i){}this.isDynamic?this.$node.insertBefore(this.container):(this.$media.prop("controls",!0),this.$node.clone().show().insertBefore(this.container),this.$node.remove()),"native"!==this.media.pluginType&&this.media.remove(),delete mejs.players[this.id],this.container.remove(),this.globalUnbind(),delete this.node.player}},function(){function t(t,n){var a={d:[],w:[]};return e.each((t||"").split(" "),function(e,t){var o=t+"."+n;0===o.indexOf(".")?(a.d.push(o),a.w.push(o)):a[i.test(t)?"w":"d"].push(o)}),a.d=a.d.join(" "),a.w=a.w.join(" "),a}var i=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;mejs.MediaElementPlayer.prototype.globalBind=function(i,n,a){i=t(i,this.id),i.d&&e(document).bind(i.d,n,a),i.w&&e(window).bind(i.w,n,a)},mejs.MediaElementPlayer.prototype.globalUnbind=function(i,n){i=t(i,this.id),i.d&&e(document).unbind(i.d,n),i.w&&e(window).unbind(i.w,n)}}(),"undefined"!=typeof jQuery&&(jQuery.fn.mediaelementplayer=function(e){return this.each(e===!1?function(){var e=jQuery(this).data("mediaelementplayer");e&&e.remove(),jQuery(this).removeData("mediaelementplayer")}:function(){jQuery(this).data("mediaelementplayer",new mejs.MediaElementPlayer(this,e))}),this}),e(document).ready(function(){e(".mejs-player").mediaelementplayer()}),window.MediaElementPlayer=mejs.MediaElementPlayer}(mejs.$),function(e){e.extend(mejs.MepDefaults,{playpauseText:mejs.i18n.t("Play/Pause")}),e.extend(MediaElementPlayer.prototype,{buildplaypause:function(t,i,n,a){var o=e('<div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="'+this.id+'" title="'+this.options.playpauseText+'" aria-label="'+this.options.playpauseText+'"></button></div>').appendTo(i).click(function(e){return e.preventDefault(),a.paused?a.play():a.pause(),!1});a.addEventListener("play",function(){o.removeClass("mejs-play").addClass("mejs-pause")},!1),a.addEventListener("playing",function(){o.removeClass("mejs-play").addClass("mejs-pause")},!1),a.addEventListener("pause",function(){o.removeClass("mejs-pause").addClass("mejs-play")},!1),a.addEventListener("paused",function(){o.removeClass("mejs-pause").addClass("mejs-play")},!1)}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{stopText:"Stop"}),e.extend(MediaElementPlayer.prototype,{buildstop:function(t,i,n,a){e('<div class="mejs-button mejs-stop-button mejs-stop"><button type="button" aria-controls="'+this.id+'" title="'+this.options.stopText+'" aria-label="'+this.options.stopText+'"></button></div>').appendTo(i).click(function(){a.paused||a.pause(),a.currentTime>0&&(a.setCurrentTime(0),a.pause(),i.find(".mejs-time-current").width("0px"),i.find(".mejs-time-handle").css("left","0px"),i.find(".mejs-time-float-current").html(mejs.Utility.secondsToTimeCode(0)),i.find(".mejs-currenttime").html(mejs.Utility.secondsToTimeCode(0)),n.find(".mejs-poster").show())})}})}(mejs.$),function(e){e.extend(MediaElementPlayer.prototype,{buildprogress:function(t,i,n,a){e('<div class="mejs-time-rail"><span class="mejs-time-total"><span class="mejs-time-buffering"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-handle"></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></span></div>').appendTo(i),i.find(".mejs-time-buffering").hide();var o=this,r=i.find(".mejs-time-total");n=i.find(".mejs-time-loaded");var s=i.find(".mejs-time-current"),l=i.find(".mejs-time-handle"),c=i.find(".mejs-time-float"),d=i.find(".mejs-time-float-current"),h=function(e){e=e.pageX;var t=r.offset(),i=r.outerWidth(!0),n=0,o=n=0;a.duration&&(e<t.left?e=t.left:e>i+t.left&&(e=i+t.left),o=e-t.left,n=o/i,n=.02>=n?0:n*a.duration,u&&n!==a.currentTime&&a.setCurrentTime(n),mejs.MediaFeatures.hasTouch||(c.css("left",o),d.html(mejs.Utility.secondsToTimeCode(n)),c.show()))},u=!1;r.bind("mousedown",function(e){return 1===e.which?(u=!0,h(e),o.globalBind("mousemove.dur",function(e){h(e)}),o.globalBind("mouseup.dur",function(){u=!1,c.hide(),o.globalUnbind(".dur")}),!1):void 0}).bind("mouseenter",function(){o.globalBind("mousemove.dur",function(e){h(e)}),mejs.MediaFeatures.hasTouch||c.show()}).bind("mouseleave",function(){u||(o.globalUnbind(".dur"),c.hide())}),a.addEventListener("progress",function(e){t.setProgressRail(e),t.setCurrentRail(e)},!1),a.addEventListener("timeupdate",function(e){t.setProgressRail(e),t.setCurrentRail(e)},!1),o.loaded=n,o.total=r,o.current=s,o.handle=l},setProgressRail:function(e){var t=void 0!=e?e.target:this.media,i=null;t&&t.buffered&&t.buffered.length>0&&t.buffered.end&&t.duration?i=t.buffered.end(0)/t.duration:t&&void 0!=t.bytesTotal&&t.bytesTotal>0&&void 0!=t.bufferedBytes?i=t.bufferedBytes/t.bytesTotal:e&&e.lengthComputable&&0!=e.total&&(i=e.loaded/e.total),null!==i&&(i=Math.min(1,Math.max(0,i)),this.loaded&&this.total&&this.loaded.width(this.total.width()*i))},setCurrentRail:function(){if(void 0!=this.media.currentTime&&this.media.duration&&this.total&&this.handle){var e=Math.round(this.total.width()*this.media.currentTime/this.media.duration),t=e-Math.round(this.handle.outerWidth(!0)/2);this.current.width(e),this.handle.css("left",t)}}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{duration:-1,timeAndDurationSeparator:"<span> | </span>"}),e.extend(MediaElementPlayer.prototype,{buildcurrent:function(t,i,n,a){e('<div class="mejs-time"><span class="mejs-currenttime">'+(t.options.alwaysShowHours?"00:":"")+(t.options.showTimecodeFrameCount?"00:00:00":"00:00")+"</span></div>").appendTo(i),this.currenttime=this.controls.find(".mejs-currenttime"),a.addEventListener("timeupdate",function(){t.updateCurrent()},!1)},buildduration:function(t,i,n,a){i.children().last().find(".mejs-currenttime").length>0?e(this.options.timeAndDurationSeparator+'<span class="mejs-duration">'+(this.options.duration>0?mejs.Utility.secondsToTimeCode(this.options.duration,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25):(t.options.alwaysShowHours?"00:":"")+(t.options.showTimecodeFrameCount?"00:00:00":"00:00"))+"</span>").appendTo(i.find(".mejs-time")):(i.find(".mejs-currenttime").parent().addClass("mejs-currenttime-container"),e('<div class="mejs-time mejs-duration-container"><span class="mejs-duration">'+(this.options.duration>0?mejs.Utility.secondsToTimeCode(this.options.duration,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25):(t.options.alwaysShowHours?"00:":"")+(t.options.showTimecodeFrameCount?"00:00:00":"00:00"))+"</span></div>").appendTo(i)),this.durationD=this.controls.find(".mejs-duration"),a.addEventListener("timeupdate",function(){t.updateDuration()},!1)},updateCurrent:function(){this.currenttime&&this.currenttime.html(mejs.Utility.secondsToTimeCode(this.media.currentTime,this.options.alwaysShowHours||this.media.duration>3600,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25))},updateDuration:function(){this.container.toggleClass("mejs-long-video",this.media.duration>3600),this.durationD&&(this.options.duration>0||this.media.duration)&&this.durationD.html(mejs.Utility.secondsToTimeCode(this.options.duration>0?this.options.duration:this.media.duration,this.options.alwaysShowHours,this.options.showTimecodeFrameCount,this.options.framesPerSecond||25))}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{muteText:mejs.i18n.t("Mute Toggle"),hideVolumeOnTouchDevices:!0,audioVolume:"horizontal",videoVolume:"vertical"}),e.extend(MediaElementPlayer.prototype,{buildvolume:function(t,i,n,a){if(!mejs.MediaFeatures.hasTouch||!this.options.hideVolumeOnTouchDevices){var o=this,r=o.isVideo?o.options.videoVolume:o.options.audioVolume,s="horizontal"==r?e('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+o.id+'" title="'+o.options.muteText+'" aria-label="'+o.options.muteText+'"></button></div><div class="mejs-horizontal-volume-slider"><div class="mejs-horizontal-volume-total"></div><div class="mejs-horizontal-volume-current"></div><div class="mejs-horizontal-volume-handle"></div></div>').appendTo(i):e('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+o.id+'" title="'+o.options.muteText+'" aria-label="'+o.options.muteText+'"></button><div class="mejs-volume-slider"><div class="mejs-volume-total"></div><div class="mejs-volume-current"></div><div class="mejs-volume-handle"></div></div></div>').appendTo(i),l=o.container.find(".mejs-volume-slider, .mejs-horizontal-volume-slider"),c=o.container.find(".mejs-volume-total, .mejs-horizontal-volume-total"),d=o.container.find(".mejs-volume-current, .mejs-horizontal-volume-current"),h=o.container.find(".mejs-volume-handle, .mejs-horizontal-volume-handle"),u=function(e,t){if(l.is(":visible")||"undefined"!=typeof t)if(e=Math.max(0,e),e=Math.min(e,1),0==e?s.removeClass("mejs-mute").addClass("mejs-unmute"):s.removeClass("mejs-unmute").addClass("mejs-mute"),"vertical"==r){var i=c.height(),n=c.position(),a=i-i*e;h.css("top",Math.round(n.top+a-h.height()/2)),d.height(i-a),d.css("top",n.top+a)}else i=c.width(),n=c.position(),i*=e,h.css("left",Math.round(n.left+i-h.width()/2)),d.width(Math.round(i));else l.show(),u(e,!0),l.hide()},p=function(e){var t=null,i=c.offset();if("vertical"==r){if(t=c.height(),parseInt(c.css("top").replace(/px/,""),10),t=(t-(e.pageY-i.top))/t,0==i.top||0==i.left)return}else t=c.width(),t=(e.pageX-i.left)/t;t=Math.max(0,t),t=Math.min(t,1),u(t),a.setMuted(0==t?!0:!1),a.setVolume(t)},m=!1,f=!1;s.hover(function(){l.show(),f=!0},function(){f=!1,!m&&"vertical"==r&&l.hide()}),l.bind("mouseover",function(){f=!0}).bind("mousedown",function(e){return p(e),o.globalBind("mousemove.vol",function(e){p(e)}),o.globalBind("mouseup.vol",function(){m=!1,o.globalUnbind(".vol"),!f&&"vertical"==r&&l.hide()}),m=!0,!1}),s.find("button").click(function(){a.setMuted(!a.muted)}),a.addEventListener("volumechange",function(){m||(a.muted?(u(0),s.removeClass("mejs-mute").addClass("mejs-unmute")):(u(a.volume),s.removeClass("mejs-unmute").addClass("mejs-mute")))},!1),o.container.is(":visible")&&(u(t.options.startVolume),0===t.options.startVolume&&a.setMuted(!0),"native"===a.pluginType&&a.setVolume(t.options.startVolume))}}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{usePluginFullScreen:!0,newWindowCallback:function(){return""},fullscreenText:mejs.i18n.t("Fullscreen")}),e.extend(MediaElementPlayer.prototype,{isFullScreen:!1,isNativeFullScreen:!1,isInIframe:!1,buildfullscreen:function(t,i,n,a){if(t.isVideo){t.isInIframe=window.location!=window.parent.location,mejs.MediaFeatures.hasTrueNativeFullScreen&&(n=function(){t.isFullScreen&&(mejs.MediaFeatures.isFullScreen()?(t.isNativeFullScreen=!0,t.setControlsSize()):(t.isNativeFullScreen=!1,t.exitFullScreen()))},mejs.MediaFeatures.hasMozNativeFullScreen?t.globalBind(mejs.MediaFeatures.fullScreenEventName,n):t.container.bind(mejs.MediaFeatures.fullScreenEventName,n));var o=this,r=e('<div class="mejs-button mejs-fullscreen-button"><button type="button" aria-controls="'+o.id+'" title="'+o.options.fullscreenText+'" aria-label="'+o.options.fullscreenText+'"></button></div>').appendTo(i);if("native"===o.media.pluginType||!o.options.usePluginFullScreen&&!mejs.MediaFeatures.isFirefox)r.click(function(){mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen()||t.isFullScreen?t.exitFullScreen():t.enterFullScreen()});else{var s=null;if(function(){var e=document.createElement("x"),t=document.documentElement,i=window.getComputedStyle;return"pointerEvents"in e.style?(e.style.pointerEvents="auto",e.style.pointerEvents="x",t.appendChild(e),i=i&&"auto"===i(e,"").pointerEvents,t.removeChild(e),!!i):!1}()&&!mejs.MediaFeatures.isOpera){var l=!1,c=function(){if(l){for(var e in d)d[e].hide();r.css("pointer-events",""),o.controls.css("pointer-events",""),o.media.removeEventListener("click",o.clickToPlayPauseCallback),l=!1}},d={};i=["top","left","right","bottom"];var h,u=function(){var e=r.offset().left-o.container.offset().left,t=r.offset().top-o.container.offset().top,i=r.outerWidth(!0),n=r.outerHeight(!0),a=o.container.width(),s=o.container.height();for(h in d)d[h].css({position:"absolute",top:0,left:0});d.top.width(a).height(t),d.left.width(e).height(n).css({top:t}),d.right.width(a-e-i).height(n).css({top:t,left:e+i}),d.bottom.width(a).height(s-n-t).css({top:t+n})};for(o.globalBind("resize",function(){u()}),h=0,n=i.length;n>h;h++)d[i[h]]=e('<div class="mejs-fullscreen-hover" />').appendTo(o.container).mouseover(c).hide();r.on("mouseover",function(){if(!o.isFullScreen){var e=r.offset(),i=t.container.offset();a.positionFullscreenButton(e.left-i.left,e.top-i.top,!1),r.css("pointer-events","none"),o.controls.css("pointer-events","none"),o.media.addEventListener("click",o.clickToPlayPauseCallback);for(h in d)d[h].show();u(),l=!0}}),a.addEventListener("fullscreenchange",function(){o.isFullScreen=!o.isFullScreen,o.isFullScreen?o.media.removeEventListener("click",o.clickToPlayPauseCallback):o.media.addEventListener("click",o.clickToPlayPauseCallback),c()}),o.globalBind("mousemove",function(e){if(l){var t=r.offset();(e.pageY<t.top||e.pageY>t.top+r.outerHeight(!0)||e.pageX<t.left||e.pageX>t.left+r.outerWidth(!0))&&(r.css("pointer-events",""),o.controls.css("pointer-events",""),l=!1)}})}else r.on("mouseover",function(){null!==s&&(clearTimeout(s),delete s);var e=r.offset(),i=t.container.offset();a.positionFullscreenButton(e.left-i.left,e.top-i.top,!0)}).on("mouseout",function(){null!==s&&(clearTimeout(s),delete s),s=setTimeout(function(){a.hideFullscreenButton()},1500)})}t.fullscreenBtn=r,o.globalBind("keydown",function(e){(mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen()||o.isFullScreen)&&27==e.keyCode&&t.exitFullScreen()})}},cleanfullscreen:function(e){e.exitFullScreen()},containerSizeTimeout:null,enterFullScreen:function(){var t=this;if("native"===t.media.pluginType||!mejs.MediaFeatures.isFirefox&&!t.options.usePluginFullScreen){if(e(document.documentElement).addClass("mejs-fullscreen"),normalHeight=t.container.height(),normalWidth=t.container.width(),"native"===t.media.pluginType)if(mejs.MediaFeatures.hasTrueNativeFullScreen)mejs.MediaFeatures.requestFullScreen(t.container[0]),t.isInIframe&&setTimeout(function n(){t.isNativeFullScreen&&(e(window).width()!==screen.width?t.exitFullScreen():setTimeout(n,500))},500);else if(mejs.MediaFeatures.hasSemiNativeFullScreen)return void t.media.webkitEnterFullscreen();if(t.isInIframe){var i=t.options.newWindowCallback(this);if(""!==i){if(!mejs.MediaFeatures.hasTrueNativeFullScreen)return t.pause(),void window.open(i,t.id,"top=0,left=0,width="+screen.availWidth+",height="+screen.availHeight+",resizable=yes,scrollbars=no,status=no,toolbar=no");setTimeout(function(){t.isNativeFullScreen||(t.pause(),window.open(i,t.id,"top=0,left=0,width="+screen.availWidth+",height="+screen.availHeight+",resizable=yes,scrollbars=no,status=no,toolbar=no"))},250)}}t.container.addClass("mejs-container-fullscreen").width("100%").height("100%"),t.containerSizeTimeout=setTimeout(function(){t.container.css({width:"100%",height:"100%"}),t.setControlsSize()},500),"native"===t.media.pluginType?t.$media.width("100%").height("100%"):(t.container.find(".mejs-shim").width("100%").height("100%"),t.media.setVideoSize(e(window).width(),e(window).height())),t.layers.children("div").width("100%").height("100%"),t.fullscreenBtn&&t.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen"),t.setControlsSize(),t.isFullScreen=!0}},exitFullScreen:function(){clearTimeout(this.containerSizeTimeout),"native"!==this.media.pluginType&&mejs.MediaFeatures.isFirefox?this.media.setFullscreen(!1):(mejs.MediaFeatures.hasTrueNativeFullScreen&&(mejs.MediaFeatures.isFullScreen()||this.isFullScreen)&&mejs.MediaFeatures.cancelFullScreen(),e(document.documentElement).removeClass("mejs-fullscreen"),this.container.removeClass("mejs-container-fullscreen").width(normalWidth).height(normalHeight),"native"===this.media.pluginType?this.$media.width(normalWidth).height(normalHeight):(this.container.find(".mejs-shim").width(normalWidth).height(normalHeight),this.media.setVideoSize(normalWidth,normalHeight)),this.layers.children("div").width(normalWidth).height(normalHeight),this.fullscreenBtn.removeClass("mejs-unfullscreen").addClass("mejs-fullscreen"),this.setControlsSize(),this.isFullScreen=!1)}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{startLanguage:"",tracksText:mejs.i18n.t("Captions/Subtitles"),hideCaptionsButtonWhenEmpty:!0,toggleCaptionsButtonWhenOnlyOne:!1,slidesSelector:""}),e.extend(MediaElementPlayer.prototype,{hasChapters:!1,buildtracks:function(t,i,n,a){if(0!=t.tracks.length){var o;if(this.domNode.textTracks)for(o=this.domNode.textTracks.length-1;o>=0;o--)this.domNode.textTracks[o].mode="hidden";for(t.chapters=e('<div class="mejs-chapters mejs-layer"></div>').prependTo(n).hide(),t.captions=e('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover"><span class="mejs-captions-text"></span></div></div>').prependTo(n).hide(),t.captionsText=t.captions.find(".mejs-captions-text"),t.captionsButton=e('<div class="mejs-button mejs-captions-button"><button type="button" aria-controls="'+this.id+'" title="'+this.options.tracksText+'" aria-label="'+this.options.tracksText+'"></button><div class="mejs-captions-selector"><ul><li><input type="radio" name="'+t.id+'_captions" id="'+t.id+'_captions_none" value="none" checked="checked" /><label for="'+t.id+'_captions_none">'+mejs.i18n.t("None")+"</label></li></ul></div></div>").appendTo(i),o=i=0;o<t.tracks.length;o++)"subtitles"==t.tracks[o].kind&&i++;for(this.options.toggleCaptionsButtonWhenOnlyOne&&1==i?t.captionsButton.on("click",function(){t.setTrack(null==t.selectedTrack?t.tracks[0].srclang:"none")}):t.captionsButton.hover(function(){e(this).find(".mejs-captions-selector").css("visibility","visible")},function(){e(this).find(".mejs-captions-selector").css("visibility","hidden")}).on("click","input[type=radio]",function(){lang=this.value,t.setTrack(lang)}),t.options.alwaysShowControls?t.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover"):t.container.bind("controlsshown",function(){t.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover")}).bind("controlshidden",function(){a.paused||t.container.find(".mejs-captions-position").removeClass("mejs-captions-position-hover")}),t.trackToLoad=-1,t.selectedTrack=null,t.isLoadingTrack=!1,o=0;o<t.tracks.length;o++)"subtitles"==t.tracks[o].kind&&t.addTrackButton(t.tracks[o].srclang,t.tracks[o].label);t.loadNextTrack(),a.addEventListener("timeupdate",function(){t.displayCaptions()},!1),""!=t.options.slidesSelector&&(t.slidesContainer=e(t.options.slidesSelector),a.addEventListener("timeupdate",function(){t.displaySlides()},!1)),a.addEventListener("loadedmetadata",function(){t.displayChapters()},!1),t.container.hover(function(){t.hasChapters&&(t.chapters.css("visibility","visible"),t.chapters.fadeIn(200).height(t.chapters.find(".mejs-chapter").outerHeight()))},function(){t.hasChapters&&!a.paused&&t.chapters.fadeOut(200,function(){e(this).css("visibility","hidden"),e(this).css("display","block")})}),null!==t.node.getAttribute("autoplay")&&t.chapters.css("visibility","hidden")}},setTrack:function(e){var t;if("none"==e)this.selectedTrack=null,this.captionsButton.removeClass("mejs-captions-enabled");else for(t=0;t<this.tracks.length;t++)if(this.tracks[t].srclang==e){null==this.selectedTrack&&this.captionsButton.addClass("mejs-captions-enabled"),this.selectedTrack=this.tracks[t],this.captions.attr("lang",this.selectedTrack.srclang),this.displayCaptions();break}},loadNextTrack:function(){this.trackToLoad++,this.trackToLoad<this.tracks.length?(this.isLoadingTrack=!0,this.loadTrack(this.trackToLoad)):(this.isLoadingTrack=!1,this.checkForTracks())},loadTrack:function(t){var i=this,n=i.tracks[t];e.ajax({url:n.src,dataType:"text",success:function(e){n.entries="string"==typeof e&&/<tt\s+xml/gi.exec(e)?mejs.TrackFormatParser.dfxp.parse(e):mejs.TrackFormatParser.webvvt.parse(e),n.isLoaded=!0,i.enableTrackButton(n.srclang,n.label),i.loadNextTrack(),"chapters"==n.kind&&i.media.addEventListener("play",function(){i.media.duration>0&&i.displayChapters(n)},!1),"slides"==n.kind&&i.setupSlides(n)},error:function(){i.loadNextTrack()}})},enableTrackButton:function(t,i){""===i&&(i=mejs.language.codes[t]||t),this.captionsButton.find("input[value="+t+"]").prop("disabled",!1).siblings("label").html(i),this.options.startLanguage==t&&e("#"+this.id+"_captions_"+t).click(),this.adjustLanguageBox()},addTrackButton:function(t,i){""===i&&(i=mejs.language.codes[t]||t),this.captionsButton.find("ul").append(e('<li><input type="radio" name="'+this.id+'_captions" id="'+this.id+"_captions_"+t+'" value="'+t+'" disabled="disabled" /><label for="'+this.id+"_captions_"+t+'">'+i+" (loading)</label></li>")),this.adjustLanguageBox(),this.container.find(".mejs-captions-translations option[value="+t+"]").remove()},adjustLanguageBox:function(){this.captionsButton.find(".mejs-captions-selector").height(this.captionsButton.find(".mejs-captions-selector ul").outerHeight(!0)+this.captionsButton.find(".mejs-captions-translations").outerHeight(!0))},checkForTracks:function(){var e=!1;if(this.options.hideCaptionsButtonWhenEmpty){for(i=0;i<this.tracks.length;i++)if("subtitles"==this.tracks[i].kind){e=!0;
break}e||(this.captionsButton.hide(),this.setControlsSize())}},displayCaptions:function(){if("undefined"!=typeof this.tracks){var e,t=this.selectedTrack;if(null!=t&&t.isLoaded)for(e=0;e<t.entries.times.length;e++)if(this.media.currentTime>=t.entries.times[e].start&&this.media.currentTime<=t.entries.times[e].stop)return this.captionsText.html(t.entries.text[e]),void this.captions.show().height(0);this.captions.hide()}},setupSlides:function(e){this.slides=e,this.slides.entries.imgs=[this.slides.entries.text.length],this.showSlide(0)},showSlide:function(t){if("undefined"!=typeof this.tracks&&"undefined"!=typeof this.slidesContainer){var i=this,n=i.slides.entries.text[t],a=i.slides.entries.imgs[t];"undefined"==typeof a||"undefined"==typeof a.fadeIn?i.slides.entries.imgs[t]=a=e('<img src="'+n+'">').on("load",function(){a.appendTo(i.slidesContainer).hide().fadeIn().siblings(":visible").fadeOut()}):!a.is(":visible")&&!a.is(":animated")&&a.fadeIn().siblings(":visible").fadeOut()}},displaySlides:function(){if("undefined"!=typeof this.slides){var e,t=this.slides;for(e=0;e<t.entries.times.length;e++)if(this.media.currentTime>=t.entries.times[e].start&&this.media.currentTime<=t.entries.times[e].stop){this.showSlide(e);break}}},displayChapters:function(){var e;for(e=0;e<this.tracks.length;e++)if("chapters"==this.tracks[e].kind&&this.tracks[e].isLoaded){this.drawChapters(this.tracks[e]),this.hasChapters=!0;break}},drawChapters:function(t){var i,n,a=this,o=n=0;for(a.chapters.empty(),i=0;i<t.entries.times.length;i++)n=t.entries.times[i].stop-t.entries.times[i].start,n=Math.floor(n/a.media.duration*100),(n+o>100||i==t.entries.times.length-1&&100>n+o)&&(n=100-o),a.chapters.append(e('<div class="mejs-chapter" rel="'+t.entries.times[i].start+'" style="left: '+o.toString()+"%;width: "+n.toString()+'%;"><div class="mejs-chapter-block'+(i==t.entries.times.length-1?" mejs-chapter-block-last":"")+'"><span class="ch-title">'+t.entries.text[i]+'</span><span class="ch-time">'+mejs.Utility.secondsToTimeCode(t.entries.times[i].start)+"&ndash;"+mejs.Utility.secondsToTimeCode(t.entries.times[i].stop)+"</span></div></div>")),o+=n;a.chapters.find("div.mejs-chapter").click(function(){a.media.setCurrentTime(parseFloat(e(this).attr("rel"))),a.media.paused&&a.media.play()}),a.chapters.show()}}),mejs.language={codes:{af:"Afrikaans",sq:"Albanian",ar:"Arabic",be:"Belarusian",bg:"Bulgarian",ca:"Catalan",zh:"Chinese","zh-cn":"Chinese Simplified","zh-tw":"Chinese Traditional",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",et:"Estonian",tl:"Filipino",fi:"Finnish",fr:"French",gl:"Galician",de:"German",el:"Greek",ht:"Haitian Creole",iw:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",ko:"Korean",lv:"Latvian",lt:"Lithuanian",mk:"Macedonian",ms:"Malay",mt:"Maltese",no:"Norwegian",fa:"Persian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian",sr:"Serbian",sk:"Slovak",sl:"Slovenian",es:"Spanish",sw:"Swahili",sv:"Swedish",tl:"Tagalog",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",cy:"Welsh",yi:"Yiddish"}},mejs.TrackFormatParser={webvvt:{pattern_identifier:/^([a-zA-z]+-)?[0-9]+$/,pattern_timecode:/^([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,parse:function(t){var i=0;t=mejs.TrackFormatParser.split2(t,/\r?\n/);for(var n,a,o={text:[],times:[]};i<t.length;i++)if(this.pattern_identifier.exec(t[i])&&(i++,(n=this.pattern_timecode.exec(t[i]))&&i<t.length)){for(i++,a=t[i],i++;""!==t[i]&&i<t.length;)a=a+"\n"+t[i],i++;a=e.trim(a).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),o.text.push(a),o.times.push({start:0==mejs.Utility.convertSMPTEtoSeconds(n[1])?.2:mejs.Utility.convertSMPTEtoSeconds(n[1]),stop:mejs.Utility.convertSMPTEtoSeconds(n[3]),settings:n[5]})}return o}},dfxp:{parse:function(t){t=e(t).filter("tt");var i=0;i=t.children("div").eq(0);var n=i.find("p");i=t.find("#"+i.attr("style"));var a,o;if(t={text:[],times:[]},i.length&&(o=i.removeAttr("id").get(0).attributes,o.length))for(a={},i=0;i<o.length;i++)a[o[i].name.split(":")[1]]=o[i].value;for(i=0;i<n.length;i++){var r;if(o={start:null,stop:null,style:null},n.eq(i).attr("begin")&&(o.start=mejs.Utility.convertSMPTEtoSeconds(n.eq(i).attr("begin"))),!o.start&&n.eq(i-1).attr("end")&&(o.start=mejs.Utility.convertSMPTEtoSeconds(n.eq(i-1).attr("end"))),n.eq(i).attr("end")&&(o.stop=mejs.Utility.convertSMPTEtoSeconds(n.eq(i).attr("end"))),!o.stop&&n.eq(i+1).attr("begin")&&(o.stop=mejs.Utility.convertSMPTEtoSeconds(n.eq(i+1).attr("begin"))),a){r="";for(var s in a)r+=s+":"+a[s]+";"}r&&(o.style=r),0==o.start&&(o.start=.2),t.times.push(o),o=e.trim(n.eq(i).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),t.text.push(o),0==t.times.start&&(t.times.start=2)}return t}},split2:function(e,t){return e.split(t)}},3!="x\n\ny".split(/\n/gi).length&&(mejs.TrackFormatParser.split2=function(e,t){var i,n=[],a="";for(i=0;i<e.length;i++)a+=e.substring(i,i+1),t.test(a)&&(n.push(a.replace(t,"")),a="");return n.push(a),n})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{contextMenuItems:[{render:function(e){return"undefined"==typeof e.enterFullScreen?null:mejs.i18n.t(e.isFullScreen?"Turn off Fullscreen":"Go Fullscreen")},click:function(e){e.isFullScreen?e.exitFullScreen():e.enterFullScreen()}},{render:function(e){return mejs.i18n.t(e.media.muted?"Unmute":"Mute")},click:function(e){e.setMuted(e.media.muted?!1:!0)}},{isSeparator:!0},{render:function(){return mejs.i18n.t("Download Video")},click:function(e){window.location.href=e.media.currentSrc}}]}),e.extend(MediaElementPlayer.prototype,{buildcontextmenu:function(t){t.contextMenu=e('<div class="mejs-contextmenu"></div>').appendTo(e("body")).hide(),t.container.bind("contextmenu",function(e){return t.isContextMenuEnabled?(e.preventDefault(),t.renderContextMenu(e.clientX-1,e.clientY-1),!1):void 0}),t.container.bind("click",function(){t.contextMenu.hide()}),t.contextMenu.bind("mouseleave",function(){t.startContextMenuTimer()})},cleancontextmenu:function(e){e.contextMenu.remove()},isContextMenuEnabled:!0,enableContextMenu:function(){this.isContextMenuEnabled=!0},disableContextMenu:function(){this.isContextMenuEnabled=!1},contextMenuTimeout:null,startContextMenuTimer:function(){var e=this;e.killContextMenuTimer(),e.contextMenuTimer=setTimeout(function(){e.hideContextMenu(),e.killContextMenuTimer()},750)},killContextMenuTimer:function(){var e=this.contextMenuTimer;null!=e&&(clearTimeout(e),delete e)},hideContextMenu:function(){this.contextMenu.hide()},renderContextMenu:function(t,i){for(var n=this,a="",o=n.options.contextMenuItems,r=0,s=o.length;s>r;r++)if(o[r].isSeparator)a+='<div class="mejs-contextmenu-separator"></div>';else{var l=o[r].render(n);null!=l&&(a+='<div class="mejs-contextmenu-item" data-itemindex="'+r+'" id="element-'+1e6*Math.random()+'">'+l+"</div>")}n.contextMenu.empty().append(e(a)).css({top:i,left:t}).show(),n.contextMenu.find(".mejs-contextmenu-item").each(function(){var t=e(this),i=parseInt(t.data("itemindex"),10),a=n.options.contextMenuItems[i];"undefined"!=typeof a.show&&a.show(t,n),t.click(function(){"undefined"!=typeof a.click&&a.click(n),n.contextMenu.hide()})}),setTimeout(function(){n.killControlsTimer("rev3")},100)}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{postrollCloseText:mejs.i18n.t("Close")}),e.extend(MediaElementPlayer.prototype,{buildpostroll:function(t,i,n){var a=this.container.find('link[rel="postroll"]').attr("href");"undefined"!=typeof a&&(t.postroll=e('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">'+this.options.postrollCloseText+'</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(n).hide(),this.media.addEventListener("ended",function(){e.ajax({dataType:"html",url:a,success:function(e){n.find(".mejs-postroll-layer-content").html(e)}}),t.postroll.show()},!1))}})}(mejs.$),define("mediaelementjs",["jquery"],function(){}),"undefined"==typeof jwplayer&&(jwplayer=function(e){return jwplayer.api?jwplayer.api.selectPlayer(e):void 0},jwplayer.version="6.8.4616",jwplayer.vid=document.createElement("video"),jwplayer.audio=document.createElement("audio"),jwplayer.source=document.createElement("source"),function(e){function t(e){return function(){return l(e)}}function i(e,t,i,n,a){return function(){var o,s;if(a)i(e);else{try{if((o=e.responseXML)&&(s=o.firstChild,o.lastChild&&"parsererror"===o.lastChild.nodeName))return void(n&&n("Invalid XML"))}catch(l){}if(o&&s)return i(e);(o=r.parseXML(e.responseText))&&o.firstChild?(e=r.extend({},e,{responseXML:o}),i(e)):n&&n(e.responseText?"Invalid XML":t)}}}var n=document,a=window,o=navigator,r=e.utils=function(){};r.exists=function(e){switch(typeof e){case"string":return 0<e.length;case"object":return null!==e;case"undefined":return!1}return!0},r.styleDimension=function(e){return e+(0<e.toString().indexOf("%")?"":"px")},r.getAbsolutePath=function(e,t){if(r.exists(t)||(t=n.location.href),r.exists(e)){var i;if(r.exists(e)){i=e.indexOf("://");var a=e.indexOf("?");i=i>0&&(0>a||a>i)}else i=void 0;if(i)return e;i=t.substring(0,t.indexOf("://")+3);var o,a=t.substring(i.length,t.indexOf("/",i.length+1));0===e.indexOf("/")?o=e.split("/"):(o=t.split("?")[0],o=o.substring(i.length+a.length+1,o.lastIndexOf("/")),o=o.split("/").concat(e.split("/")));for(var s=[],l=0;l<o.length;l++)o[l]&&r.exists(o[l])&&"."!=o[l]&&(".."==o[l]?s.pop():s.push(o[l]));return i+a+"/"+s.join("/")}},r.extend=function(){var e=r.extend.arguments;if(1<e.length){for(var t=1;t<e.length;t++)r.foreach(e[t],function(t,i){try{r.exists(i)&&(e[0][t]=i)}catch(n){}});return e[0]}return null};var s=window.console=window.console||{log:function(){}};r.log=function(){var e=Array.prototype.slice.call(arguments,0);"object"==typeof s.log?s.log(e):s.log.apply(s,e)};var l=r.userAgentMatch=function(e){return null!==o.userAgent.toLowerCase().match(e)};r.isIE=r.isMSIE=t(/msie/i),r.isFF=t(/firefox/i),r.isChrome=t(/chrome/i),r.isIPod=t(/iP(hone|od)/i),r.isIPad=t(/iPad/i),r.isSafari602=t(/Macintosh.*Mac OS X 10_8.*6\.0\.\d* Safari/i),r.isIETrident=function(e){return e?(e=parseFloat(e).toFixed(1),l(RegExp("msie\\s*"+e+"|trident/.+rv:\\s*"+e,"i"))):l(/msie|trident/i)},r.isSafari=function(){return l(/safari/i)&&!l(/chrome/i)&&!l(/chromium/i)&&!l(/android/i)},r.isIOS=function(e){return l(e?RegExp("iP(hone|ad|od).+\\sOS\\s"+e,"i"):/iP(hone|ad|od)/i)},r.isAndroid=function(e,t){var i=t?!l(/chrome\/[23456789]/i):!0;return e?i&&l(RegExp("android.*"+e,"i")):i&&l(/android/i)},r.isMobile=function(){return r.isIOS()||r.isAndroid()},r.saveCookie=function(e,t){n.cookie="jwplayer."+e+"="+t+"; path=/"},r.getCookies=function(){for(var e={},t=n.cookie.split("; "),i=0;i<t.length;i++){var a=t[i].split("=");0===a[0].indexOf("jwplayer.")&&(e[a[0].substring(9,a[0].length)]=a[1])}return e},r.typeOf=function(e){var t=typeof e;return"object"===t?e?e instanceof Array?"array":t:"null":t},r.translateEventResponse=function(t,i){var n=r.extend({},i);if(t!=e.events.JWPLAYER_FULLSCREEN||n.fullscreen)if("object"==typeof n.data){var a=n.data;delete n.data,n=r.extend(n,a)}else"object"==typeof n.metadata&&r.deepReplaceKeyName(n.metadata,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]);else n.fullscreen="true"==n.message?!0:!1,delete n.message;return r.foreach(["position","duration","offset"],function(e,t){n[t]&&(n[t]=Math.round(1e3*n[t])/1e3)}),n},r.flashVersion=function(){if(r.isAndroid())return 0;var e,t=o.plugins;try{if("undefined"!==t&&(e=t["Shockwave Flash"]))return parseInt(e.description.replace(/\D+(\d+)\..*/,"$1"),10)}catch(i){}if("undefined"!=typeof a.ActiveXObject)try{if(e=new a.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return parseInt(e.GetVariable("$version").split(" ")[1].split(",")[0],10)}catch(n){}return 0},r.getScriptPath=function(e){for(var t=n.getElementsByTagName("script"),i=0;i<t.length;i++){var a=t[i].src;if(a&&0<=a.indexOf(e))return a.substr(0,a.indexOf(e))}return""},r.deepReplaceKeyName=function(t,i,n){switch(e.utils.typeOf(t)){case"array":for(var a=0;a<t.length;a++)t[a]=e.utils.deepReplaceKeyName(t[a],i,n);break;case"object":r.foreach(t,function(a,o){var r;if(i instanceof Array&&n instanceof Array){if(i.length!=n.length)return;r=i}else r=[i];for(var s=a,l=0;l<r.length;l++)s=s.replace(RegExp(i[l],"g"),n[l]);t[s]=e.utils.deepReplaceKeyName(o,i,n),a!=s&&delete t[a]})}return t};var c=r.pluginPathType={ABSOLUTE:0,RELATIVE:1,CDN:2};r.getPluginPathType=function(e){if("string"==typeof e){e=e.split("?")[0];var t=e.indexOf("://");if(t>0)return c.ABSOLUTE;var i=e.indexOf("/");return e=r.extension(e),!(0>t&&0>i)||e&&isNaN(e)?c.RELATIVE:c.CDN}},r.getPluginName=function(e){return e.replace(/^(.*\/)?([^-]*)-?.*\.(swf|js)$/,"$2")},r.getPluginVersion=function(e){return e.replace(/[^-]*-?([^\.]*).*$/,"$1")},r.isYouTube=function(e){return/^(http|\/\/).*(youtube\.com|youtu\.be)\/.+/.test(e)},r.youTubeID=function(e){try{return/v[=\/]([^?&]*)|youtu\.be\/([^?]*)|^([\w-]*)$/i.exec(e).slice(1).join("").replace("?","")}catch(t){return""}},r.isRtmp=function(e,t){return 0===e.indexOf("rtmp")||"rtmp"==t},r.foreach=function(e,t){var i,n;for(i in e)"function"==r.typeOf(e.hasOwnProperty)?e.hasOwnProperty(i)&&(n=e[i],t(i,n)):(n=e[i],t(i,n))},r.isHTTPS=function(){return 0===a.location.href.indexOf("https")},r.repo=function(){var t=web_url+e.version.split(/\W/).splice(0,2).join("/")+"/";try{r.isHTTPS()&&(t=t.replace("http://","https://ssl."))}catch(i){}return t},r.ajax=function(e,t,n,o){var s;if(0<e.indexOf("#")&&(e=e.replace(/#.*$/,"")),e&&0<=e.indexOf("://")&&e.split("/")[2]!=a.location.href.split("/")[2]&&r.exists(a.XDomainRequest))s=new a.XDomainRequest,s.onload=i(s,e,t,n,o),s.ontimeout=s.onprogress=function(){},s.timeout=5e3;else{if(!r.exists(a.XMLHttpRequest))return n&&n(),s;var l=s=new a.XMLHttpRequest,c=e;s.onreadystatechange=function(){if(4===l.readyState)switch(l.status){case 200:i(l,c,t,n,o)();break;case 404:n("File not found")}}}return s.overrideMimeType&&s.overrideMimeType("text/xml"),s.onerror=function(){n("Error loading file")},setTimeout(function(){try{s.open("GET",e,!0),s.send()}catch(t){n&&n(e)}},0),s},r.parseXML=function(e){var t;try{if(a.DOMParser){if(t=(new a.DOMParser).parseFromString(e,"text/xml"),t.childNodes&&t.childNodes.length&&"parsererror"==t.childNodes[0].firstChild.nodeName)return}else t=new a.ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)}catch(i){return}return t},r.filterPlaylist=function(e,t){var i,n,a,o,s=[];for(i=0;i<e.length;i++)if(n=r.extend({},e[i]),n.sources=r.filterSources(n.sources),0<n.sources.length){for(a=0;a<n.sources.length;a++)o=n.sources[a],o.label||(o.label=a.toString());s.push(n)}if(t&&0===s.length)for(i=0;i<e.length;i++)if(n=r.extend({},e[i]),n.sources=r.filterSources(n.sources,!0),0<n.sources.length){for(a=0;a<n.sources.length;a++)o=n.sources[a],o.label||(o.label=a.toString());s.push(n)}return s},r.filterSources=function(t,i){var n,a,o=r.extensionmap;if(t){a=[];for(var s=0;s<t.length;s++){var l=t[s].type,c=t[s].file;c&&(c=r.trim(c)),l||(l=o.extType(r.extension(c)),t[s].type=l),i?e.embed.flashCanPlay(c,l)&&(n||(n=l),l==n&&a.push(r.extend({},t[s]))):r.canPlayHTML5(l)&&(n||(n=l),l==n&&a.push(r.extend({},t[s])))}}return a},r.canPlayHTML5=function(t){return!r.isAndroid()||"hls"!=t&&"m3u"!=t&&"m3u8"!=t?(t=r.extensionmap.types[t],!!t&&!!e.vid.canPlayType&&e.vid.canPlayType(t)):!1},r.seconds=function(e){e=e.replace(",",".");var t=e.split(":"),i=0;return"s"==e.slice(-1)?i=parseFloat(e):"m"==e.slice(-1)?i=60*parseFloat(e):"h"==e.slice(-1)?i=3600*parseFloat(e):1<t.length?(i=parseFloat(t[t.length-1]),i+=60*parseFloat(t[t.length-2]),3==t.length&&(i+=3600*parseFloat(t[t.length-3]))):i=parseFloat(e),i},r.serialize=function(e){return null==e?null:"true"==e.toString().toLowerCase()?!0:"false"==e.toString().toLowerCase()?!1:isNaN(Number(e))||5<e.length||0===e.length?e:Number(e)}}(jwplayer),function(e){var t="video/",i=e.foreach,n={mp4:t+"mp4",vorbis:"audio/ogg",ogg:t+"ogg",webm:t+"webm",aac:"audio/mp4",mp3:"audio/mpeg",hls:"application/vnd.apple.mpegurl"},a={mp4:n.mp4,f4v:n.mp4,m4v:n.mp4,mov:n.mp4,m4a:n.aac,f4a:n.aac,aac:n.aac,mp3:n.mp3,ogv:n.ogg,ogg:n.vorbis,oga:n.vorbis,webm:n.webm,m3u8:n.hls,hls:n.hls},t="video",t={flv:t,f4v:t,mov:t,m4a:t,m4v:t,mp4:t,aac:t,f4a:t,mp3:"sound",smil:"rtmp",m3u8:"hls",hls:"hls"},o=e.extensionmap={};i(a,function(e,t){o[e]={html5:t}}),i(t,function(e,t){o[e]||(o[e]={}),o[e].flash=t}),o.types=n,o.mimeType=function(e){var t;return i(n,function(i,n){!t&&n==e&&(t=i)}),t},o.extType=function(e){return o.mimeType(a[e])}}(jwplayer.utils),function(e){var t=e.loaderstatus={NEW:0,LOADING:1,ERROR:2,COMPLETE:3},i=document;e.scriptloader=function(n){function a(){r=t.ERROR,l.sendEvent(s.ERROR)}function o(){r=t.COMPLETE,l.sendEvent(s.COMPLETE)}var r=t.NEW,s=jwplayer.events,l=new s.eventdispatcher;e.extend(this,l),this.load=function(){var l=e.scriptloader.loaders[n];if(!l||l.getStatus()!=t.NEW&&l.getStatus()!=t.LOADING){if(e.scriptloader.loaders[n]=this,r==t.NEW){r=t.LOADING;var c=i.createElement("script");c.addEventListener?(c.onload=o,c.onerror=a):c.readyState&&(c.onreadystatechange=function(){("loaded"==c.readyState||"complete"==c.readyState)&&o()}),i.getElementsByTagName("head")[0].appendChild(c),c.src=n}}else l.addEventListener(s.ERROR,a),l.addEventListener(s.COMPLETE,o)},this.getStatus=function(){return r}},e.scriptloader.loaders={}}(jwplayer.utils),function(e){e.trim=function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},e.pad=function(e,t,i){for(i||(i="0");e.length<t;)e=i+e;return e},e.xmlAttribute=function(e,t){for(var i=0;i<e.attributes.length;i++)if(e.attributes[i].name&&e.attributes[i].name.toLowerCase()==t.toLowerCase())return e.attributes[i].value.toString();return""},e.extension=function(e){return e&&"rtmp"!=e.substr(0,4)?(e=e.substring(e.lastIndexOf("/")+1,e.length).split("?")[0].split("#")[0],-1<e.lastIndexOf(".")?e.substr(e.lastIndexOf(".")+1,e.length).toLowerCase():void 0):""},e.stringToColor=function(e){return e=e.replace(/(#|0x)?([0-9A-F]{3,6})$/gi,"$2"),3==e.length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)}}(jwplayer.utils),function(e){var t="touchmove",i="touchstart";e.touch=function(n){function a(e){e.type==i?(l=!0,d=r(u.DRAG_START,e)):e.type==t?l&&(h||(o(u.DRAG_START,e,d),h=!0),o(u.DRAG,e)):(l&&(h?o(u.DRAG_END,e):(e.cancelBubble=!0,o(u.TAP,e))),l=h=!1,d=null)}function o(e,t,i){c[e]&&(t.preventManipulation&&t.preventManipulation(),t.preventDefault&&t.preventDefault(),t=i?i:r(e,t))&&c[e](t)}function r(e,t){var i=null;if(t.touches&&t.touches.length?i=t.touches[0]:t.changedTouches&&t.changedTouches.length&&(i=t.changedTouches[0]),!i)return null;var n=s.getBoundingClientRect(),i={type:e,target:s,x:i.pageX-window.pageXOffset-n.left,y:i.pageY,deltaX:0,deltaY:0};return e!=u.TAP&&d&&(i.deltaX=i.x-d.x,i.deltaY=i.y-d.y),i}var s=n,l=!1,c={},d=null,h=!1,u=e.touchEvents;return document.addEventListener(t,a),document.addEventListener("touchend",function(e){l&&h&&o(u.DRAG_END,e),l=h=!1,d=null}),document.addEventListener("touchcancel",a),n.addEventListener(i,a),n.addEventListener("touchend",a),this.addEventListener=function(e,t){c[e]=t},this.removeEventListener=function(e){delete c[e]},this}}(jwplayer.utils),function(e){e.touchEvents={DRAG:"jwplayerDrag",DRAG_START:"jwplayerDragStart",DRAG_END:"jwplayerDragEnd",TAP:"jwplayerTap"}}(jwplayer.utils),function(e){e.key=function(t){var i,n,a;this.edition=function(){return a&&a.getTime()<(new Date).getTime()?"invalid":i},this.token=function(){return n},e.exists(t)||(t="");try{t=e.tea.decrypt(t,"36QXq4W@GSBV^teR");var o=t.split("/");(i=o[0])?/^(free|pro|premium|ads)$/i.test(i)?(n=o[1],o[2]&&0<parseInt(o[2])&&(a=new Date,a.setTime(String(o[2])))):i="invalid":i="free"}catch(r){i="invalid"}}}(jwplayer.utils),function(e){var t=e.tea={};t.encrypt=function(e,a){if(0==e.length)return"";var o=t.strToLongs(n.encode(e));1>=o.length&&(o[1]=0);for(var r,s=t.strToLongs(n.encode(a).slice(0,16)),l=o.length,c=o[l-1],d=o[0],h=Math.floor(6+52/l),u=0;0<h--;){u+=2654435769,r=u>>>2&3;for(var p=0;l>p;p++)d=o[(p+1)%l],c=(c>>>5^d<<2)+(d>>>3^c<<4)^(u^d)+(s[3&p^r]^c),c=o[p]+=c}return o=t.longsToStr(o),i.encode(o)},t.decrypt=function(e,a){if(0==e.length)return"";for(var o,r=t.strToLongs(i.decode(e)),s=t.strToLongs(n.encode(a).slice(0,16)),l=r.length,c=r[l-1],d=r[0],h=2654435769*Math.floor(6+52/l);0!=h;){o=h>>>2&3;for(var u=l-1;u>=0;u--)c=r[u>0?u-1:l-1],c=(c>>>5^d<<2)+(d>>>3^c<<4)^(h^d)+(s[3&u^o]^c),d=r[u]-=c;h-=2654435769}return r=t.longsToStr(r),r=r.replace(/\0+$/,""),n.decode(r)},t.strToLongs=function(e){for(var t=Array(Math.ceil(e.length/4)),i=0;i<t.length;i++)t[i]=e.charCodeAt(4*i)+(e.charCodeAt(4*i+1)<<8)+(e.charCodeAt(4*i+2)<<16)+(e.charCodeAt(4*i+3)<<24);return t},t.longsToStr=function(e){for(var t=Array(e.length),i=0;i<e.length;i++)t[i]=String.fromCharCode(255&e[i],e[i]>>>8&255,e[i]>>>16&255,e[i]>>>24&255);return t.join("")};var i={code:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e,t){var a,o,r,s,l,c,d=[],h="",u=i.code;if(c=("undefined"==typeof t?0:t)?n.encode(e):e,l=c.length%3,l>0)for(;3>l++;)h+="=",c+="\x00";for(l=0;l<c.length;l+=3)a=c.charCodeAt(l),o=c.charCodeAt(l+1),r=c.charCodeAt(l+2),s=a<<16|o<<8|r,a=s>>18&63,o=s>>12&63,r=s>>6&63,s&=63,d[l/3]=u.charAt(a)+u.charAt(o)+u.charAt(r)+u.charAt(s);return d=d.join(""),d=d.slice(0,d.length-h.length)+h},decode:function(e,t){t="undefined"==typeof t?!1:t;var a,o,r,s,l,c,d=[],h=i.code;c=t?n.decode(e):e;for(var u=0;u<c.length;u+=4)a=h.indexOf(c.charAt(u)),o=h.indexOf(c.charAt(u+1)),s=h.indexOf(c.charAt(u+2)),l=h.indexOf(c.charAt(u+3)),r=a<<18|o<<12|s<<6|l,a=r>>>16&255,o=r>>>8&255,r&=255,d[u/4]=String.fromCharCode(a,o,r),64==l&&(d[u/4]=String.fromCharCode(a,o)),64==s&&(d[u/4]=String.fromCharCode(a));return s=d.join(""),t?n.decode(s):s}},n={encode:function(e){return e=e.replace(/[\u0080-\u07ff]/g,function(e){return e=e.charCodeAt(0),String.fromCharCode(192|e>>6,128|63&e)}),e=e.replace(/[\u0800-\uffff]/g,function(e){return e=e.charCodeAt(0),String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)})},decode:function(e){return e=e.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){return e=(15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2),String.fromCharCode(e)}),e=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){return e=(31&e.charCodeAt(0))<<6|63&e.charCodeAt(1),String.fromCharCode(e)})}}}(jwplayer.utils),function(e){e.events={COMPLETE:"COMPLETE",ERROR:"ERROR",API_READY:"jwplayerAPIReady",JWPLAYER_READY:"jwplayerReady",JWPLAYER_FULLSCREEN:"jwplayerFullscreen",JWPLAYER_RESIZE:"jwplayerResize",JWPLAYER_ERROR:"jwplayerError",JWPLAYER_SETUP_ERROR:"jwplayerSetupError",JWPLAYER_MEDIA_BEFOREPLAY:"jwplayerMediaBeforePlay",JWPLAYER_MEDIA_BEFORECOMPLETE:"jwplayerMediaBeforeComplete",JWPLAYER_COMPONENT_SHOW:"jwplayerComponentShow",JWPLAYER_COMPONENT_HIDE:"jwplayerComponentHide",JWPLAYER_MEDIA_BUFFER:"jwplayerMediaBuffer",JWPLAYER_MEDIA_BUFFER_FULL:"jwplayerMediaBufferFull",JWPLAYER_MEDIA_ERROR:"jwplayerMediaError",JWPLAYER_MEDIA_LOADED:"jwplayerMediaLoaded",JWPLAYER_MEDIA_COMPLETE:"jwplayerMediaComplete",JWPLAYER_MEDIA_SEEK:"jwplayerMediaSeek",JWPLAYER_MEDIA_TIME:"jwplayerMediaTime",JWPLAYER_MEDIA_VOLUME:"jwplayerMediaVolume",JWPLAYER_MEDIA_META:"jwplayerMediaMeta",JWPLAYER_MEDIA_MUTE:"jwplayerMediaMute",JWPLAYER_MEDIA_LEVELS:"jwplayerMediaLevels",JWPLAYER_MEDIA_LEVEL_CHANGED:"jwplayerMediaLevelChanged",JWPLAYER_CAPTIONS_CHANGED:"jwplayerCaptionsChanged",JWPLAYER_CAPTIONS_LIST:"jwplayerCaptionsList",JWPLAYER_CAPTIONS_LOADED:"jwplayerCaptionsLoaded",JWPLAYER_PLAYER_STATE:"jwplayerPlayerState",state:{BUFFERING:"BUFFERING",IDLE:"IDLE",PAUSED:"PAUSED",PLAYING:"PLAYING"},JWPLAYER_PLAYLIST_LOADED:"jwplayerPlaylistLoaded",JWPLAYER_PLAYLIST_ITEM:"jwplayerPlaylistItem",JWPLAYER_PLAYLIST_COMPLETE:"jwplayerPlaylistComplete",JWPLAYER_DISPLAY_CLICK:"jwplayerViewClick",JWPLAYER_CONTROLS:"jwplayerViewControls",JWPLAYER_USER_ACTION:"jwplayerUserAction",JWPLAYER_INSTREAM_CLICK:"jwplayerInstreamClicked",JWPLAYER_INSTREAM_DESTROYED:"jwplayerInstreamDestroyed",JWPLAYER_AD_TIME:"jwplayerAdTime",JWPLAYER_AD_ERROR:"jwplayerAdError",JWPLAYER_AD_CLICK:"jwplayerAdClicked",JWPLAYER_AD_COMPLETE:"jwplayerAdComplete",JWPLAYER_AD_IMPRESSION:"jwplayerAdImpression",JWPLAYER_AD_COMPANIONS:"jwplayerAdCompanions",JWPLAYER_AD_SKIPPED:"jwplayerAdSkipped"}}(jwplayer),function(e){var t=e.utils;e.events.eventdispatcher=function(i,n){function a(e,i,n){if(e)for(var a=0;a<e.length;a++){var o=e[a];if(o){null!==o.count&&0===--o.count&&delete e[a];try{o.listener(i)}catch(r){t.log('Error handling "'+n+'" event listener ['+a+"]: "+r.toString(),o.listener,i)}}}}var o,r;this.resetEventListeners=function(){o={},r=[]},this.resetEventListeners(),this.addEventListener=function(e,i,n){try{t.exists(o[e])||(o[e]=[]),"string"==t.typeOf(i)&&(i=new Function("return "+i)()),o[e].push({listener:i,count:n||null})}catch(a){t.log("error",a)}return!1},this.removeEventListener=function(e,i){if(o[e]){try{for(var n=0;n<o[e].length;n++)if(o[e][n].listener.toString()==i.toString()){o[e].splice(n,1);break}}catch(a){t.log("error",a)}return!1}},this.addGlobalListener=function(e,i){try{"string"==t.typeOf(e)&&(e=new Function("return "+e)()),r.push({listener:e,count:i||null})}catch(n){t.log("error",n)}return!1},this.removeGlobalListener=function(e){if(e){try{for(var i=r.length;i--;)r[i].listener.toString()==e.toString()&&r.splice(i,1)}catch(n){t.log("error",n)}return!1}},this.sendEvent=function(s,l){t.exists(l)||(l={}),t.extend(l,{id:i,version:e.version,type:s}),n&&t.log(s,l),a(o[s],l,s),a(r,l,s)}}}(window.jwplayer),function(e){var t={},i={};e.plugins=function(){},e.plugins.loadPlugins=function(n,a){return i[n]=new e.plugins.pluginloader(new e.plugins.model(t),a),i[n]},e.plugins.registerPlugin=function(i,n,a,o){var r=e.utils.getPluginName(i);t[r]||(t[r]=new e.plugins.plugin(i)),t[r].registerPlugin(i,n,a,o)}}(jwplayer),function(e){e.plugins.model=function(t){this.addPlugin=function(i){var n=e.utils.getPluginName(i);return t[n]||(t[n]=new e.plugins.plugin(i)),t[n]},this.getPlugins=function(){return t}}}(jwplayer),function(e){var t=jwplayer.utils,i=jwplayer.events;e.pluginmodes={FLASH:0,JAVASCRIPT:1,HYBRID:2},e.plugin=function(n){function a(){switch(t.getPluginPathType(n)){case t.pluginPathType.ABSOLUTE:return n;case t.pluginPathType.RELATIVE:return t.getAbsolutePath(n,window.location.href)}}function o(){d=setTimeout(function(){h=t.loaderstatus.COMPLETE,u.sendEvent(i.COMPLETE)},1e3)}function r(){h=t.loaderstatus.ERROR,u.sendEvent(i.ERROR)}var s,l,c,d,h=t.loaderstatus.NEW,u=new i.eventdispatcher;t.extend(this,u),this.load=function(){if(h==t.loaderstatus.NEW)if(0<n.lastIndexOf(".swf"))s=n,h=t.loaderstatus.COMPLETE,u.sendEvent(i.COMPLETE);else if(t.getPluginPathType(n)==t.pluginPathType.CDN)h=t.loaderstatus.COMPLETE,u.sendEvent(i.COMPLETE);else{h=t.loaderstatus.LOADING;var e=new t.scriptloader(a());e.addEventListener(i.COMPLETE,o),e.addEventListener(i.ERROR,r),e.load()}},this.registerPlugin=function(e,n,a,o){d&&(clearTimeout(d),d=void 0),c=n,a&&o?(s=o,l=a):"string"==typeof a?s=a:"function"==typeof a?l=a:!a&&!o&&(s=e),h=t.loaderstatus.COMPLETE,u.sendEvent(i.COMPLETE)},this.getStatus=function(){return h},this.getPluginName=function(){return t.getPluginName(n)},this.getFlashPath=function(){if(s)switch(t.getPluginPathType(s)){case t.pluginPathType.ABSOLUTE:return s;case t.pluginPathType.RELATIVE:return 0<n.lastIndexOf(".swf")?t.getAbsolutePath(s,window.location.href):t.getAbsolutePath(s,a())}return null},this.getJS=function(){return l},this.getTarget=function(){return c},this.getPluginmode=function(){return"undefined"!=typeof s&&"undefined"!=typeof l?e.pluginmodes.HYBRID:"undefined"!=typeof s?e.pluginmodes.FLASH:"undefined"!=typeof l?e.pluginmodes.JAVASCRIPT:void 0},this.getNewInstance=function(e,t,i){return new l(e,t,i)},this.getURL=function(){return n}}}(jwplayer.plugins),function(e){var t=e.utils,i=e.events,n=t.foreach;e.plugins.pluginloader=function(a,o){function r(){h?p.sendEvent(i.ERROR,{message:l}):d||(d=!0,c=t.loaderstatus.COMPLETE,p.sendEvent(i.COMPLETE))}function s(){if(u||r(),!d&&!h){var i=0,n=a.getPlugins();t.foreach(u,function(a){a=t.getPluginName(a);var o=n[a];a=o.getJS();var s=o.getTarget(),o=o.getStatus();o==t.loaderstatus.LOADING||o==t.loaderstatus.NEW?i++:a&&(!s||parseFloat(s)>parseFloat(e.version))&&(h=!0,l="Incompatible player version",r())}),0==i&&r()}}var l,c=t.loaderstatus.NEW,d=!1,h=!1,u=o,p=new i.eventdispatcher;t.extend(this,p),this.setupPlugins=function(e,i,o){var r={length:0,plugins:{}},s=0,l={},c=a.getPlugins();return n(i.plugins,function(n,a){var d=t.getPluginName(n),h=c[d],u=h.getFlashPath(),p=h.getJS(),m=h.getURL();u&&(r.plugins[u]=t.extend({},a),r.plugins[u].pluginmode=h.getPluginmode(),r.length++);try{if(p&&i.plugins&&i.plugins[m]){var f=document.createElement("div");f.id=e.id+"_"+d,f.style.position="absolute",f.style.top=0,f.style.zIndex=s+10,l[d]=h.getNewInstance(e,t.extend({},i.plugins[m]),f),s++,e.onReady(o(l[d],f,!0)),e.onResize(o(l[d],f))}}catch(v){t.log("ERROR: Failed to load "+d+".")}}),e.plugins=l,r},this.load=function(){if(!t.exists(o)||"object"==t.typeOf(o)){c=t.loaderstatus.LOADING,n(o,function(e){t.exists(e)&&(e=a.addPlugin(e),e.addEventListener(i.COMPLETE,s),e.addEventListener(i.ERROR,m))});var e=a.getPlugins();n(e,function(e,t){t.load()})}s()};var m=this.pluginFailed=function(){h||(h=!0,l="File not found",r())};this.getStatus=function(){return c}}}(jwplayer),function(){jwplayer.parsers={localName:function(e){return e?e.localName?e.localName:e.baseName?e.baseName:"":""},textContent:function(e){return e?e.textContent?jwplayer.utils.trim(e.textContent):e.text?jwplayer.utils.trim(e.text):"":""},getChildNode:function(e,t){return e.childNodes[t]},numChildren:function(e){return e.childNodes?e.childNodes.length:0}}}(jwplayer),function(e){var t=e.parsers;(t.jwparser=function(){}).parseEntry=function(i,n){for(var a=[],o=[],r=e.utils.xmlAttribute,s=0;s<i.childNodes.length;s++){var l=i.childNodes[s];if("jwplayer"==l.prefix){var c=t.localName(l);"source"==c?(delete n.sources,a.push({file:r(l,"file"),"default":r(l,"default"),label:r(l,"label"),type:r(l,"type")})):"track"==c?(delete n.tracks,o.push({file:r(l,"file"),"default":r(l,"default"),kind:r(l,"kind"),label:r(l,"label")})):(n[c]=e.utils.serialize(t.textContent(l)),"file"==c&&n.sources&&delete n.sources)}n.file||(n.file=n.link)}if(a.length)for(n.sources=[],s=0;s<a.length;s++)0<a[s].file.length&&(a[s]["default"]="true"==a[s]["default"]?!0:!1,a[s].label.length||delete a[s].label,n.sources.push(a[s]));if(o.length)for(n.tracks=[],s=0;s<o.length;s++)0<o[s].file.length&&(o[s]["default"]="true"==o[s]["default"]?!0:!1,o[s].kind=o[s].kind.length?o[s].kind:"captions",o[s].label.length||delete o[s].label,n.tracks.push(o[s]));return n}}(jwplayer),function(e){var t=jwplayer.utils,i=t.xmlAttribute,n=e.localName,a=e.textContent,o=e.numChildren,r=e.mediaparser=function(){};r.parseGroup=function(e,s){var l,c,d=[];for(c=0;c<o(e);c++)if(l=e.childNodes[c],"media"==l.prefix&&n(l))switch(n(l).toLowerCase()){case"content":i(l,"duration")&&(s.duration=t.seconds(i(l,"duration"))),0<o(l)&&(s=r.parseGroup(l,s)),i(l,"url")&&(s.sources||(s.sources=[]),s.sources.push({file:i(l,"url"),type:i(l,"type"),width:i(l,"width"),label:i(l,"label")}));break;case"title":s.title=a(l);break;case"description":s.description=a(l);break;case"guid":s.mediaid=a(l);break;case"thumbnail":s.image||(s.image=i(l,"url"));break;case"group":r.parseGroup(l,s);break;case"subtitle":var h={};if(h.file=i(l,"url"),h.kind="captions",0<i(l,"lang").length){var u=h;l=i(l,"lang");var p={zh:"Chinese",nl:"Dutch",en:"English",fr:"French",de:"German",it:"Italian",ja:"Japanese",pt:"Portuguese",ru:"Russian",es:"Spanish"};l=p[l]?p[l]:l,u.label=l}d.push(h)}for(s.hasOwnProperty("tracks")||(s.tracks=[]),c=0;c<d.length;c++)s.tracks.push(d[c]);
return s}}(jwplayer.parsers),function(e){function t(t){for(var a={},o=0;o<t.childNodes.length;o++){var s=t.childNodes[o],l=r(s);if(l)switch(l.toLowerCase()){case"enclosure":a.file=i.xmlAttribute(s,"url");break;case"title":a.title=n(s);break;case"guid":a.mediaid=n(s);break;case"pubdate":a.date=n(s);break;case"description":a.description=n(s);break;case"link":a.link=n(s);break;case"category":a.tags=a.tags?a.tags+n(s):n(s)}}return a=e.mediaparser.parseGroup(t,a),a=e.jwparser.parseEntry(t,a),new jwplayer.playlist.item(a)}var i=jwplayer.utils,n=e.textContent,a=e.getChildNode,o=e.numChildren,r=e.localName;e.rssparser={},e.rssparser.parse=function(e){for(var i=[],n=0;n<o(e);n++){var s=a(e,n);if("channel"==r(s).toLowerCase())for(var l=0;l<o(s);l++){var c=a(s,l);"item"==r(c).toLowerCase()&&i.push(t(c))}}return i}}(jwplayer.parsers),function(e){e.playlist=function(t){var i=[];if("array"==e.utils.typeOf(t))for(var n=0;n<t.length;n++)i.push(new e.playlist.item(t[n]));else i.push(new e.playlist.item(t));return i}}(jwplayer),function(e){var t=e.item=function(i){var n=jwplayer.utils,a=n.extend({},t.defaults,i);a.tracks=i&&n.exists(i.tracks)?i.tracks:[],0==a.sources.length&&(a.sources=[new e.source(a)]);for(var o=0;o<a.sources.length;o++){var r=a.sources[o]["default"];a.sources[o]["default"]=r?"true"==r.toString():!1,a.sources[o]=new e.source(a.sources[o])}if(a.captions&&!n.exists(i.tracks)){for(i=0;i<a.captions.length;i++)a.tracks.push(a.captions[i]);delete a.captions}for(o=0;o<a.tracks.length;o++)a.tracks[o]=new e.track(a.tracks[o]);return a};t.defaults={description:"",image:"",mediaid:"",title:"",sources:[],tracks:[]}}(jwplayer.playlist),function(e){var t=jwplayer,i=t.utils,n=t.events,a=t.parsers;e.loader=function(){function t(t){try{var i=t.responseXML.childNodes;t="";for(var o=0;o<i.length&&(t=i[o],!(8!=t.nodeType));o++);if("xml"==a.localName(t)&&(t=t.nextSibling),"rss"!=a.localName(t))r("Not a valid RSS feed");else{var l=new e(a.rssparser.parse(t));s.sendEvent(n.JWPLAYER_PLAYLIST_LOADED,{playlist:l})}}catch(c){r()}}function o(e){r(e.match(/invalid/i)?"Not a valid RSS feed":"")}function r(e){s.sendEvent(n.JWPLAYER_ERROR,{message:e?e:"Error loading file"})}var s=new n.eventdispatcher;i.extend(this,s),this.load=function(e){i.ajax(e,t,o)}}}(jwplayer.playlist),function(e){var t=jwplayer.utils,i={file:void 0,label:void 0,type:void 0,"default":void 0};e.source=function(e){var n=t.extend({},i);return t.foreach(i,function(i){t.exists(e[i])&&(n[i]=e[i],delete e[i])}),n.type&&0<n.type.indexOf("/")&&(n.type=t.extensionmap.mimeType(n.type)),"m3u8"==n.type&&(n.type="hls"),"smil"==n.type&&(n.type="rtmp"),n}}(jwplayer.playlist),function(e){var t=jwplayer.utils,i={file:void 0,label:void 0,kind:"captions","default":!1};e.track=function(e){var n=t.extend({},i);return e||(e={}),t.foreach(i,function(i){t.exists(e[i])&&(n[i]=e[i],delete e[i])}),n}}(jwplayer.playlist),function(e){function t(e,t,n){var a=e.style;a.backgroundColor="#000",a.color="#FFF",a.width=i.styleDimension(n.width),a.height=i.styleDimension(n.height),a.display="table",a.opacity=1,n=document.createElement("p"),a=n.style,a.verticalAlign="middle",a.textAlign="center",a.display="table-cell",a.font="15px/20px Arial, Helvetica, sans-serif",n.innerHTML=t.replace(":",":<br>"),e.innerHTML="",e.appendChild(n)}var i=e.utils,n=e.events,a=!0,o=!1,r=document,s=e.embed=function(l){function c(e,t){i.foreach(t,function(t,i){"function"==typeof e[t]&&e[t].call(e,i)})}function d(){if(!C)if("array"==i.typeOf(_.playlist)&&2>_.playlist.length&&(0==_.playlist.length||!_.playlist[0].sources||0==_.playlist[0].sources.length))p();else if(!T)if("string"==i.typeOf(_.playlist)){var t=new e.playlist.loader;t.addEventListener(n.JWPLAYER_PLAYLIST_LOADED,function(e){_.playlist=e.playlist,T=o,d()}),t.addEventListener(n.JWPLAYER_ERROR,function(e){T=o,p(e)}),T=a,t.load(_.playlist)}else if(S.getStatus()==i.loaderstatus.COMPLETE){for(t=0;t<_.modes.length;t++)if(_.modes[t].type&&s[_.modes[t].type]){var r=i.extend({},_),u=new s[_.modes[t].type](v,_.modes[t],r,S,l);if(u.supportsConfig())return u.addEventListener(n.ERROR,h),u.embed(),c(l,r.events),l}var f;_.fallback?(f="No suitable players found and fallback enabled",k=setTimeout(function(){m(f,a)},10),i.log(f),new s.download(v,_,p)):(f="No suitable players found and fallback disabled",m(f,o),i.log(f),v.parentNode.replaceChild(w,v))}}function h(e){f(x+e.message)}function u(e){f("Could not load plugins: "+e.message)}function p(e){f(e&&e.message?"Error loading playlist: "+e.message:x+"No playable sources found")}function m(e,t){k&&(clearTimeout(k),k=null),k=setTimeout(function(){k=null,l.dispatchEvent(n.JWPLAYER_SETUP_ERROR,{message:e,fallback:t})},0)}function f(e){C||(_.fallback?(C=a,t(v,e,_),m(e,a)):m(e,o))}var v,g,w,_=new s.config(l.config),y=_.width,b=_.height,x="Error loading player: ",S=e.plugins.loadPlugins(l.id,_.plugins),T=o,C=o,k=null;return _.fallbackDiv&&(w=_.fallbackDiv,delete _.fallbackDiv),_.id=l.id,g=r.getElementById(l.id),_.aspectratio?l.config.aspectratio=_.aspectratio:delete l.config.aspectratio,v=r.createElement("div"),v.id=g.id,v.style.width=0<y.toString().indexOf("%")?y:y+"px",v.style.height=0<b.toString().indexOf("%")?b:b+"px",g.parentNode.replaceChild(v,g),this.embed=function(){C||(S.addEventListener(n.COMPLETE,d),S.addEventListener(n.ERROR,u),S.load())},this.errorScreen=f,this};e.embed.errorScreen=t}(jwplayer),function(e){function t(e){if(e.playlist)for(var t=0;t<e.playlist.length;t++)e.playlist[t]=new a(e.playlist[t]);else{var o={};n.foreach(a.defaults,function(t){i(e,o,t)}),o.sources||(e.levels?(o.sources=e.levels,delete e.levels):(t={},i(e,t,"file"),i(e,t,"type"),o.sources=t.file?[t]:[])),e.playlist=[new a(o)]}}function i(e,t,i){n.exists(e[i])&&(t[i]=e[i],delete e[i])}var n=e.utils,a=e.playlist.item;(e.embed.config=function(i){var a={fallback:!0,height:270,primary:"html5",width:480,base:i.base?i.base:n.getScriptPath("jwplayer.js"),aspectratio:""};i=n.extend(a,e.defaults,i);var a={type:"html5",src:i.base+"jwplayer.html5.js"},o={type:"flash",src:i.base+"jwplayer.flash.swf"};if(i.modes="flash"==i.primary?[o,a]:[a,o],i.listbar&&(i.playlistsize=i.listbar.size,i.playlistposition=i.listbar.position,i.playlistlayout=i.listbar.layout),i.flashplayer&&(o.src=i.flashplayer),i.html5player&&(a.src=i.html5player),t(i),o=i.aspectratio,"string"==typeof o&&n.exists(o)){var r=o.indexOf(":");-1==r?a=0:(a=parseFloat(o.substr(0,r)),o=parseFloat(o.substr(r+1)),a=0>=a||0>=o?0:100*(o/a)+"%")}else a=0;return-1==i.width.toString().indexOf("%")?delete i.aspectratio:a?i.aspectratio=a:delete i.aspectratio,i}).addConfig=function(e,i){return t(i),n.extend(e,i)}}(jwplayer),function(e){var t=e.utils,i=document;e.embed.download=function(e,n,a){function o(e,n){for(var a=i.querySelectorAll(e),o=0;o<a.length;o++)t.foreach(n,function(e,t){a[o].style[e]=t})}function r(e,t,n){return e=i.createElement(e),t&&(e.className="jwdownload"+t),n&&n.appendChild(e),e}var s,l=t.extend({},n),c=l.width?l.width:480,d=l.height?l.height:320;n=n.logo?n.logo:{prefix:t.repo(),file:"logo.png",margin:10};var h,u,p,m,l=l.playlist,f=["mp4","aac","mp3"];if(l&&l.length){for(m=l[0],s=m.sources,l=0;l<s.length;l++){var v=s[l],g=v.type?v.type:t.extensionmap.extType(t.extension(v.file));v.file&&t.foreach(f,function(e){g==f[e]?(h=v.file,u=m.image):t.isYouTube(v.file)&&(p=v.file)})}h?(s=h,a=u,e&&(l=r("a","display",e),r("div","icon",l),r("div","logo",l),s&&l.setAttribute("href",t.getAbsolutePath(s))),l="#"+e.id+" .jwdownload",e.style.width="",e.style.height="",o(l+"display",{width:t.styleDimension(Math.max(320,c)),height:t.styleDimension(Math.max(180,d)),background:"black center no-repeat "+(a?"url("+a+")":""),backgroundSize:"contain",position:"relative",border:"none",display:"block"}),o(l+"display div",{position:"absolute",width:"100%",height:"100%"}),o(l+"logo",{top:n.margin+"px",right:n.margin+"px",background:"top right no-repeat url("+n.prefix+n.file+")"}),o(l+"icon",{background:"center no-repeat url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAgNJREFUeNrs28lqwkAYB/CZqNVDDj2r6FN41QeIy8Fe+gj6BL275Q08u9FbT8ZdwVfotSBYEPUkxFOoks4EKiJdaDuTjMn3wWBO0V/+sySR8SNSqVRKIR8qaXHkzlqS9jCfzzWcTCYp9hF5o+59sVjsiRzcegSckFzcjT+ruN80TeSlAjCAAXzdJSGPFXRpAAMYwACGZQkSdhG4WCzehMNhqV6vG6vVSrirKVEw66YoSqDb7cqlUilE8JjHd/y1MQefVzqdDmiaJpfLZWHgXMHn8F6vJ1cqlVAkEsGuAn83J4gAd2RZymQygX6/L1erVQt+9ZPWb+CDwcCC2zXGJaewl/DhcHhK3DVj+KfKZrMWvFarcYNLomAv4aPRSFZVlTlcSPA5fDweW/BoNIqFnKV53JvncjkLns/n/cLdS+92O7RYLLgsKfv9/t8XlDn4eDyiw+HA9Jyz2eyt0+kY2+3WFC5hluej0Ha7zQQq9PPwdDq1Et1sNsx/nFBgCqWJ8oAK1aUptNVqcYWewE4nahfU0YQnk4ntUEfGMIU2m01HoLaCKbTRaDgKtaVLk9tBYaBcE/6Artdr4RZ5TB6/dC+9iIe/WgAMYADDpAUJAxjAAAYwgGFZgoS/AtNNTF7Z2bL0BYPBV3Jw5xFwwWcYxgtBP5OkE8i9G7aWGOOCruvauwADALMLMEbKf4SdAAAAAElFTkSuQmCC)"})):p?(n=p,e=r("iframe","",e),e.src="http://www.youtube.com/embed/"+t.youTubeID(n),e.width=c,e.height=d,e.style.border="none"):a()}}}(jwplayer),function(e){var t=e.utils,i=e.events,n={};(e.embed.flash=function(o,r,s,l,c){function d(e,t,i){var n=document.createElement("param");n.setAttribute("name",t),n.setAttribute("value",i),e.appendChild(n)}function h(e,t,i){return function(){try{i&&document.getElementById(c.id+"_wrapper").appendChild(t);var n=document.getElementById(c.id).getPluginConfig("display");"function"==typeof e.resize&&e.resize(n.width,n.height),t.style.left=n.x,t.style.top=n.h}catch(a){}}}function u(e){if(!e)return{};var i={},n=[];return t.foreach(e,function(e,a){var o=t.getPluginName(e);n.push(e),t.foreach(a,function(e,t){i[o+"."+e]=t})}),i.plugins=n.join(","),i}var p=new e.events.eventdispatcher,m=t.flashVersion();t.extend(this,p),this.embed=function(){if(s.id=c.id,10>m)return p.sendEvent(i.ERROR,{message:"Flash version must be 10.0 or greater"}),!1;var e,a,f=c.config.listbar,v=t.extend({},s);if(o.id+"_wrapper"==o.parentNode.id)e=document.getElementById(o.id+"_wrapper");else{if(e=document.createElement("div"),a=document.createElement("div"),a.style.display="none",a.id=o.id+"_aspect",e.id=o.id+"_wrapper",e.style.position="relative",e.style.display="block",e.style.width=t.styleDimension(v.width),e.style.height=t.styleDimension(v.height),c.config.aspectratio){var g=parseFloat(c.config.aspectratio);a.style.display="block",a.style.marginTop=c.config.aspectratio,e.style.height="auto",e.style.display="inline-block",f&&("bottom"==f.position?a.style.paddingBottom=f.size+"px":"right"==f.position&&(a.style.marginBottom=-1*f.size*(g/100)+"px"))}o.parentNode.replaceChild(e,o),e.appendChild(o),e.appendChild(a)}for(e=l.setupPlugins(c,v,h),0<e.length?t.extend(v,u(e.plugins)):delete v.plugins,"undefined"!=typeof v["dock.position"]&&"false"==v["dock.position"].toString().toLowerCase()&&(v.dock=v["dock.position"],delete v["dock.position"]),e=v.wmode?v.wmode:v.height&&40>=v.height?"transparent":"opaque",a="height width modes events primary base fallback volume".split(" "),f=0;f<a.length;f++)delete v[a[f]];a=t.getCookies(),t.foreach(a,function(e,t){"undefined"==typeof v[e]&&(v[e]=t)}),a=window.location.href.split("/"),a.splice(a.length-1,1),a=a.join("/"),v.base=a+"/",n[o.id]=v,t.isIE()?(a='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" " width="100%" height="100%"id="'+o.id+'" name="'+o.id+'" tabindex=0"">',a+='<param name="movie" value="'+r.src+'">',a+='<param name="allowfullscreen" value="true"><param name="allowscriptaccess" value="always">',a+='<param name="seamlesstabbing" value="true">',a+='<param name="wmode" value="'+e+'">',a+='<param name="bgcolor" value="#000000">',a+="</object>",o.outerHTML=a,e=document.getElementById(o.id)):(a=document.createElement("object"),a.setAttribute("type","application/x-shockwave-flash"),a.setAttribute("data",r.src),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("bgcolor","#000000"),a.setAttribute("id",o.id),a.setAttribute("name",o.id),a.setAttribute("tabindex",0),d(a,"allowfullscreen","true"),d(a,"allowscriptaccess","always"),d(a,"seamlesstabbing","true"),d(a,"wmode",e),o.parentNode.replaceChild(a,o),e=a),c.config.aspectratio&&(e.style.position="absolute"),c.container=e,c.setPlayer(e,"flash")},this.supportsConfig=function(){if(m){if(!s)return!0;if("string"==t.typeOf(s.playlist))return!0;try{var e=s.playlist[0].sources;if("undefined"==typeof e)return!0;for(var i=0;i<e.length;i++)if(e[i].file&&a(e[i].file,e[i].type))return!0}catch(n){}}return!1}}).getVars=function(e){return n[e]};var a=e.embed.flashCanPlay=function(e,i){if(t.isYouTube(e)||t.isRtmp(e,i)||"hls"==i)return!0;var n=t.extensionmap[i?i:t.extension(e)];return n?!!n.flash:!1}}(jwplayer),function(e){var t=e.utils,i=t.extensionmap,n=e.events;e.embed.html5=function(a,o,r,s,l){function c(e,t,i){return function(){try{var n=document.querySelector("#"+a.id+" .jwmain");i&&n.appendChild(t),"function"==typeof e.resize&&(e.resize(n.clientWidth,n.clientHeight),setTimeout(function(){e.resize(n.clientWidth,n.clientHeight)},400)),t.left=n.style.left,t.top=n.style.top}catch(o){}}}function d(e){h.sendEvent(e.type,{message:"HTML5 player not found"})}var h=this,u=new n.eventdispatcher;t.extend(h,u),h.embed=function(){if(e.html5){s.setupPlugins(l,r,c),a.innerHTML="";var i=e.utils.extend({},r);delete i.volume,i=new e.html5.player(i),l.container=document.getElementById(l.id),l.setPlayer(i,"html5")}else i=new t.scriptloader(o.src),i.addEventListener(n.ERROR,d),i.addEventListener(n.COMPLETE,h.embed),i.load()},h.supportsConfig=function(){if(e.vid.canPlayType)try{if("string"==t.typeOf(r.playlist))return!0;for(var n=r.playlist[0].sources,a=0;a<n.length;a++){var o,s=n[a].file,l=n[a].type;if(null!==navigator.userAgent.match(/BlackBerry/i)||t.isAndroid()&&("m3u"==t.extension(s)||"m3u8"==t.extension(s))||t.isRtmp(s,l))o=!1;else{var c,d=i[l?l:t.extension(s)];if(!d||d.flash&&!d.html5)c=!1;else{var h=d.html5,u=e.vid;if(h)try{c=u.canPlayType(h)?!0:!1}catch(p){c=!1}else c=!0}o=c}if(o)return!0}}catch(m){}return!1}}}(jwplayer),function(e){var t=e.embed,i=e.utils,n=/\.(js|swf)$/;e.embed=i.extend(function(a){function o(){r="Adobe SiteCatalyst Error: Could not find Media Module"}var r,s=i.repo(),l=i.extend({},e.defaults),c=i.extend({},l,a.config),d=a.config,h=c.plugins,u=c.analytics,p=s+"jwpsrv.js",m=s+"sharing.js",f=s+"related.js",v=s+"gapro.js",l=e.key?e.key:l.key,g=new e.utils.key(l).edition(),h=h?h:{};switch("ads"==g&&c.advertising&&(n.test(c.advertising.client)?h[c.advertising.client]=c.advertising:h[s+c.advertising.client+".js"]=c.advertising),delete d.advertising,d.key=l,c.analytics&&n.test(c.analytics.client)&&(p=c.analytics.client),delete d.analytics,u&&"ads"!==g&&delete u.enabled,"free"!=g&&u&&!1===u.enabled||(h[p]=u?u:{}),delete h.sharing,delete h.related,g){case"ads":if(d.sitecatalyst)try{window.s&&window.s.hasOwnProperty("Media")?new e.embed.sitecatalyst(a):o()}catch(w){o()}case"premium":c.related&&(n.test(c.related.client)&&(f=c.related.client),h[f]=c.related),c.ga&&(n.test(c.ga.client)&&(v=c.ga.client),h[v]=c.ga);case"pro":c.sharing&&(n.test(c.sharing.client)&&(m=c.sharing.client),h[m]=c.sharing),c.skin&&(d.skin=c.skin.replace(/^(beelden|bekle|five|glow|modieus|roundster|stormtrooper|vapor)$/i,i.repo()+"skins/$1.xml"))}return d.plugins=h,a.config=d,a=new t(a),r&&a.errorScreen(r),a},e.embed)}(jwplayer),function(e){var t=jwplayer.utils;e.sitecatalyst=function(e){function i(e){u.debug&&t.log(e)}function n(e){return e=e.split("/"),e=e[e.length-1],e=e.split("?"),e[0]}function a(){if(!m){m=!0;var e=h.getPosition();i("stop: "+r+" : "+e),s.Media.stop(r,e)}}function o(){f||(a(),f=!0,i("close: "+r),s.Media.close(r),d=!0,c=0)}var r,l,c,d,h=e,u=t.extend({},h.config.sitecatalyst),p={onPlay:function(){if(!d){var e=h.getPosition();m=!1,i("play: "+r+" : "+e),s.Media.play(r,e)}},onPause:a,onBuffer:a,onIdle:o,onPlaylistItem:function(e){try{d=!0,o(),c=0;var i;if(u.mediaName)i=u.mediaName;else{var a=h.getPlaylistItem(e.index);i=a.title?a.title:a.file?n(a.file):a.sources&&a.sources.length?n(a.sources[0].file):""}r=i,l=u.playerName?u.playerName:h.id}catch(s){t.log(s)}},onTime:function(){if(d){var e=h.getDuration();if(-1==e)return;f=m=d=!1,i("open: "+r+" : "+e+" : "+l),s.Media.open(r,e,l),i("play: "+r+" : 0"),s.Media.play(r,0)}if(e=h.getPosition(),3<=Math.abs(e-c)){var t=c;i("seek: "+t+" to "+e),i("stop: "+r+" : "+t),s.Media.stop(r,t),i("play: "+r+" : "+e),s.Media.play(r,e)}c=e},onComplete:o},m=!0,f=!0;t.foreach(p,function(e){h[e](p[e])})}}(jwplayer.embed),function(e,t){var i=[],n=e.utils,a=e.events,o=a.state,r=document,s=e.api=function(i){function l(e,t){return function(i){return t(e,i)}}function c(e,t){return g[e]||(g[e]=[],h(a.JWPLAYER_PLAYER_STATE,function(t){var i=t.newstate;if(t=t.oldstate,i==e){var n=g[i];if(n)for(var a=0;a<n.length;a++){var o=n[a];"function"==typeof o&&o.call(this,{oldstate:t,newstate:i})}}})),g[e].push(t),f}function d(e,t){try{e.jwAddEventListener(t,'function(dat) { jwplayer("'+f.id+'").dispatchEvent("'+t+'", dat); }')}catch(i){n.log("Could not add internal listener")}}function h(e,t){return v[e]||(v[e]=[],p&&w&&d(p,e)),v[e].push(t),f}function u(){if(w){if(p){var e=Array.prototype.slice.call(arguments,0),t=e.shift();if("function"==typeof p[t]){switch(e.length){case 6:return p[t](e[0],e[1],e[2],e[3],e[4],e[5]);case 5:return p[t](e[0],e[1],e[2],e[3],e[4]);case 4:return p[t](e[0],e[1],e[2],e[3]);case 3:return p[t](e[0],e[1],e[2]);case 2:return p[t](e[0],e[1]);case 1:return p[t](e[0])}return p[t]()}}return null}_.push(arguments)}var p,m,f=this,v={},g={},w=!1,_=[],y={},b={};f.container=i,f.id=i.id,f.getBuffer=function(){return u("jwGetBuffer")},f.getContainer=function(){return f.container},f.addButton=function(e,t,i,a){try{b[a]=i,u("jwDockAddButton",e,t,"jwplayer('"+f.id+"').callback('"+a+"')",a)}catch(o){n.log("Could not add dock button"+o.message)}},f.removeButton=function(e){u("jwDockRemoveButton",e)},f.callback=function(e){b[e]&&b[e]()},f.forceState=function(e){return u("jwForceState",e),f},f.releaseState=function(){return u("jwReleaseState")},f.getDuration=function(){return u("jwGetDuration")},f.getFullscreen=function(){return u("jwGetFullscreen")},f.getHeight=function(){return u("jwGetHeight")},f.getLockState=function(){return u("jwGetLockState")},f.getMeta=function(){return f.getItemMeta()},f.getMute=function(){return u("jwGetMute")},f.getPlaylist=function(){var e=u("jwGetPlaylist");return"flash"==f.renderingMode&&n.deepReplaceKeyName(e,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]),e},f.getPlaylistItem=function(e){return n.exists(e)||(e=f.getPlaylistIndex()),f.getPlaylist()[e]},f.getPlaylistIndex=function(){return u("jwGetPlaylistIndex")},f.getPosition=function(){return u("jwGetPosition")},f.getRenderingMode=function(){return f.renderingMode},f.getState=function(){return u("jwGetState")},f.getVolume=function(){return u("jwGetVolume")},f.getWidth=function(){return u("jwGetWidth")},f.setFullscreen=function(e){return n.exists(e)?u("jwSetFullscreen",e):u("jwSetFullscreen",!u("jwGetFullscreen")),f},f.setMute=function(e){return n.exists(e)?u("jwSetMute",e):u("jwSetMute",!u("jwGetMute")),f},f.lock=function(){return f},f.unlock=function(){return f},f.load=function(e){return u("jwLoad",e),f},f.playlistItem=function(e){return u("jwPlaylistItem",parseInt(e,10)),f},f.playlistPrev=function(){return u("jwPlaylistPrev"),f},f.playlistNext=function(){return u("jwPlaylistNext"),f},f.resize=function(e,t){if("flash"!==f.renderingMode)u("jwResize",e,t);else{var i=r.getElementById(f.id+"_wrapper"),a=r.getElementById(f.id+"_aspect");a&&(a.style.display="none"),i&&(i.style.display="block",i.style.width=n.styleDimension(e),i.style.height=n.styleDimension(t))}return f},f.play=function(e){return e===t?(e=f.getState(),u(e==o.PLAYING||e==o.BUFFERING?"jwPause":"jwPlay")):u("jwPlay",e),f},f.pause=function(e){return e===t?(e=f.getState(),u(e==o.PLAYING||e==o.BUFFERING?"jwPause":"jwPlay")):u("jwPause",e),f},f.stop=function(){return u("jwStop"),f},f.seek=function(e){return u("jwSeek",e),f},f.setVolume=function(e){return u("jwSetVolume",e),f},f.createInstream=function(){return new s.instream(this,p)},f.setInstream=function(e){return m=e},f.loadInstream=function(e,t){return m=f.setInstream(f.createInstream()).init(t),m.loadItem(e),m},f.getQualityLevels=function(){return u("jwGetQualityLevels")},f.getCurrentQuality=function(){return u("jwGetCurrentQuality")},f.setCurrentQuality=function(e){u("jwSetCurrentQuality",e)},f.getCaptionsList=function(){return u("jwGetCaptionsList")},f.getCurrentCaptions=function(){return u("jwGetCurrentCaptions")},f.setCurrentCaptions=function(e){u("jwSetCurrentCaptions",e)},f.getControls=function(){return u("jwGetControls")},f.getSafeRegion=function(){return u("jwGetSafeRegion")},f.setControls=function(e){u("jwSetControls",e)},f.destroyPlayer=function(){u("jwPlayerDestroy")},f.playAd=function(t){var i=e(f.id).plugins;i.vast&&i.vast.jwPlayAd(t)},f.pauseAd=function(){var t=e(f.id).plugins;t.vast?t.vast.jwPauseAd():u("jwPauseAd")};var x={onBufferChange:a.JWPLAYER_MEDIA_BUFFER,onBufferFull:a.JWPLAYER_MEDIA_BUFFER_FULL,onError:a.JWPLAYER_ERROR,onSetupError:a.JWPLAYER_SETUP_ERROR,onFullscreen:a.JWPLAYER_FULLSCREEN,onMeta:a.JWPLAYER_MEDIA_META,onMute:a.JWPLAYER_MEDIA_MUTE,onPlaylist:a.JWPLAYER_PLAYLIST_LOADED,onPlaylistItem:a.JWPLAYER_PLAYLIST_ITEM,onPlaylistComplete:a.JWPLAYER_PLAYLIST_COMPLETE,onReady:a.API_READY,onResize:a.JWPLAYER_RESIZE,onComplete:a.JWPLAYER_MEDIA_COMPLETE,onSeek:a.JWPLAYER_MEDIA_SEEK,onTime:a.JWPLAYER_MEDIA_TIME,onVolume:a.JWPLAYER_MEDIA_VOLUME,onBeforePlay:a.JWPLAYER_MEDIA_BEFOREPLAY,onBeforeComplete:a.JWPLAYER_MEDIA_BEFORECOMPLETE,onDisplayClick:a.JWPLAYER_DISPLAY_CLICK,onControls:a.JWPLAYER_CONTROLS,onQualityLevels:a.JWPLAYER_MEDIA_LEVELS,onQualityChange:a.JWPLAYER_MEDIA_LEVEL_CHANGED,onCaptionsList:a.JWPLAYER_CAPTIONS_LIST,onCaptionsChange:a.JWPLAYER_CAPTIONS_CHANGED,onAdError:a.JWPLAYER_AD_ERROR,onAdClick:a.JWPLAYER_AD_CLICK,onAdImpression:a.JWPLAYER_AD_IMPRESSION,onAdTime:a.JWPLAYER_AD_TIME,onAdComplete:a.JWPLAYER_AD_COMPLETE,onAdCompanions:a.JWPLAYER_AD_COMPANIONS,onAdSkipped:a.JWPLAYER_AD_SKIPPED};n.foreach(x,function(e){f[e]=l(x[e],h)});var S={onBuffer:o.BUFFERING,onPause:o.PAUSED,onPlay:o.PLAYING,onIdle:o.IDLE};return n.foreach(S,function(e){f[e]=l(S[e],c)}),f.remove=function(){if(!w)throw"Cannot call remove() before player is ready";_=[],s.destroyPlayer(this.id)},f.setup=function(t){if(e.embed){var i=r.getElementById(f.id);return i&&(t.fallbackDiv=i),i=f,_=[],s.destroyPlayer(i.id),i=e(f.id),i.config=t,new e.embed(i).embed(),i}return f},f.registerPlugin=function(t,i,n,a){e.plugins.registerPlugin(t,i,n,a)},f.setPlayer=function(e,t){p=e,f.renderingMode=t},f.detachMedia=function(){return"html5"==f.renderingMode?u("jwDetachMedia"):void 0},f.attachMedia=function(e){return"html5"==f.renderingMode?u("jwAttachMedia",e):void 0},f.removeEventListener=function(e,t){var i=v[e];if(i)for(var n=i.length;n--;)i[n]===t&&i.splice(n,1)},f.dispatchEvent=function(e,t){var i=v[e];if(i)for(var i=i.slice(0),o=n.translateEventResponse(e,t),r=0;r<i.length;r++){var s=i[r];if("function"==typeof s)try{e===a.JWPLAYER_PLAYLIST_LOADED&&n.deepReplaceKeyName(o.playlist,["__dot__","__spc__","__dsh__","__default__"],["."," ","-","default"]),s.call(this,o)}catch(l){n.log("There was an error calling back an event handler")}}},f.dispatchInstreamEvent=function(e){m&&m.dispatchEvent(e,arguments)},f.callInternal=u,f.playerReady=function(e){for(w=!0,p||f.setPlayer(r.getElementById(e.id)),f.container=r.getElementById(f.id),n.foreach(v,function(e){d(p,e)}),h(a.JWPLAYER_PLAYLIST_ITEM,function(){y={}}),h(a.JWPLAYER_MEDIA_META,function(e){n.extend(y,e.metadata)}),f.dispatchEvent(a.API_READY);0<_.length;)u.apply(this,_.shift())},f.getItemMeta=function(){return y},f.isBeforePlay=function(){return u("jwIsBeforePlay")},f.isBeforeComplete=function(){return u("jwIsBeforeComplete")},f};s.selectPlayer=function(e){var t;return n.exists(e)||(e=0),e.nodeType?t=e:"string"==typeof e&&(t=r.getElementById(e)),t?(e=s.playerById(t.id))?e:s.addPlayer(new s(t)):"number"==typeof e?i[e]:null},s.playerById=function(e){for(var t=0;t<i.length;t++)if(i[t].id==e)return i[t];return null},s.addPlayer=function(e){for(var t=0;t<i.length;t++)if(i[t]==e)return e;return i.push(e),e},s.destroyPlayer=function(e){for(var t,a=-1,o=0;o<i.length;o++)i[o].id==e&&(a=o,t=i[o]);return a>=0&&(e=t.id,o=r.getElementById(e+("flash"==t.renderingMode?"_wrapper":"")),n.clearCss&&n.clearCss("#"+e),o&&("html5"==t.renderingMode&&t.destroyPlayer(),t=r.createElement("div"),t.id=e,o.parentNode.replaceChild(t,o)),i.splice(a,1)),null},e.playerReady=function(t){var i=e.api.playerById(t.id);i?i.playerReady(t):e.api.selectPlayer(t.id).playerReady(t)}}(window.jwplayer),function(e){var t=e.events,i=e.utils,n=t.state;e.api.instream=function(e,a){function o(t,i){return c[t]||(c[t]=[],a.jwInstreamAddEventListener(t,'function(dat) { jwplayer("'+e.id+'").dispatchInstreamEvent("'+t+'", dat); }')),c[t].push(i),this}function r(e,i){return d[e]||(d[e]=[],o(t.JWPLAYER_PLAYER_STATE,function(t){var i=t.newstate,n=t.oldstate;if(i==e){var a=d[i];if(a)for(var o=0;o<a.length;o++){var r=a[o];"function"==typeof r&&r.call(this,{oldstate:n,newstate:i,type:t.type})}}})),d[e].push(i),this}var s,l,c={},d={},h=this;h.type="instream",h.init=function(){return e.callInternal("jwInitInstream"),h},h.loadItem=function(t,n){s=t,l=n||{},"array"==i.typeOf(t)?e.callInternal("jwLoadArrayInstream",s,l):e.callInternal("jwLoadItemInstream",s,l)},h.removeEvents=function(){c=d={}},h.removeEventListener=function(e,t){var i=c[e];if(i)for(var n=i.length;n--;)i[n]===t&&i.splice(n,1)},h.dispatchEvent=function(e,t){var n=c[e];if(n)for(var n=n.slice(0),a=i.translateEventResponse(e,t[1]),o=0;o<n.length;o++){var r=n[o];"function"==typeof r&&r.call(this,a)}},h.onError=function(e){return o(t.JWPLAYER_ERROR,e)},h.onMediaError=function(e){return o(t.JWPLAYER_MEDIA_ERROR,e)},h.onFullscreen=function(e){return o(t.JWPLAYER_FULLSCREEN,e)},h.onMeta=function(e){return o(t.JWPLAYER_MEDIA_META,e)},h.onMute=function(e){return o(t.JWPLAYER_MEDIA_MUTE,e)},h.onComplete=function(e){return o(t.JWPLAYER_MEDIA_COMPLETE,e)},h.onPlaylistComplete=function(e){return o(t.JWPLAYER_PLAYLIST_COMPLETE,e)},h.onPlaylistItem=function(e){return o(t.JWPLAYER_PLAYLIST_ITEM,e)},h.onTime=function(e){return o(t.JWPLAYER_MEDIA_TIME,e)},h.onBuffer=function(e){return r(n.BUFFERING,e)},h.onPause=function(e){return r(n.PAUSED,e)},h.onPlay=function(e){return r(n.PLAYING,e)},h.onIdle=function(e){return r(n.IDLE,e)},h.onClick=function(e){return o(t.JWPLAYER_INSTREAM_CLICK,e)},h.onInstreamDestroyed=function(e){return o(t.JWPLAYER_INSTREAM_DESTROYED,e)},h.onAdSkipped=function(e){return o(t.JWPLAYER_AD_SKIPPED,e)},h.play=function(e){a.jwInstreamPlay(e)},h.pause=function(e){a.jwInstreamPause(e)},h.hide=function(){e.callInternal("jwInstreamHide")},h.destroy=function(){h.removeEvents(),e.callInternal("jwInstreamDestroy")},h.setText=function(e){a.jwInstreamSetText(e?e:"")},h.getState=function(){return a.jwInstreamState()},h.setClick=function(e){a.jwInstreamClick&&a.jwInstreamClick(e)}}}(window.jwplayer),function(e){var t=e.api,i=t.selectPlayer;t.selectPlayer=function(t){return(t=i(t))?t:{registerPlugin:function(t,i,n){e.plugins.registerPlugin(t,i,n)}}}}(jwplayer)),define("jwplayer/jwplayer",function(){}),define("interaction_view/ui/media",["mediaelementjs","jwplayer/jwplayer"],function(){jwplayer.key="pi2CAQ+8YcxsOQV3Qj6nu+xcVJPULv/CrOegByy/3hg=";var e={statusclear:function(e){e.loaded=!1,e.played=!1,e.reseted=!1,e.completed=!1},play:function(t){("Video"==t.get("iType")||"QQVideo"==t.get("iType"))&&e.video.play(t),"Audio"==t.get("iType")&&e.audio.play(t)},pause:function(e){if(!e.media)return!1;e.isPaused=!0;try{e.media.pause(!0)}catch(t){}"Audio"==e.get("iType")&&interaction_view.ismobile&&(e.preloadformobile||(e.preloadformobile=null))},seek:function(t,i,n){if(n&&(i=e.getTimeByPercent(t,n)),t.hls){console.log(i);try{t.media.seek(i),t.iview.sliderplay()}catch(a){}}else try{t.media.setCurrentTime(i)}catch(a){}},changeSrc:function(e,t){if(e.hls)try{e.media.load([{file:t+"_audio.m3u8"}])}catch(i){}else try{e.media.setSrc(t)}catch(i){}},video:{render:function(t,i,n){return".m3u8"==_g.string.getUrlExt(n)||".M3U8"==_g.string.getUrlExt(n)?void e.video.renderH(t,i,n):void 0},init:function(t,i,n){var a=n;if(".m3u8"==_g.string.getUrlExt(a)||".M3U8"==_g.string.getUrlExt(a))return void e.video.initH(t,i,n);var o=i.iview.getdetail(),r=o.iRepeat||!1,s=o.iControl||!1,l=i.iview.getcommon(),c=i.autoplay=o.iAutoplay||!1,d=_g.device.mobile()?"webkit-playsinline":"",h=['<video style="position:absolute;" src="'+a+'" poster="'+o.iFile[0].picture+'" width="'+l.iWidth+'" height="'+l.iHeight+'" '+d+'">',"</video>"].join("");i.iview.$el.children(".Element").append(h),i.videoloaded=!1;var u=o.iAutohide;null==u&&(u=!0),options={enablePluginDebug:!1,type:"",pluginPath:web_url+"thirdparty/mediaelementjs/",flashName:"flashmediaelement.swf",silverlightName:"silverlightmediaelement.xap",videoWidth:l.iWidth,videoHeight:l.iHeight,pluginWidth:-1,pluginHeight:-1,timerRate:100,pauseOtherPlayers:!1,features:s?["playpause","progress","current","duration","volume","fullscreen"]:[],loop:r,success:function(e){i.media=e,s||i.iview.$el.find(".mejs-controls").addClass("hide");var n=!1;interaction_view.ismobile?(n=!0,c||i.iview.$el.addClass("hide"),i.iview.$el.css("opacity",""),i.videoloaded=!0,console.info("video loaded"),i.iview.$el.children(".iVideo").removeClass("unloaded"),i.loaded=!0,t.set("loaded",!0),t.page.ipreloadlist.preloadcheck(t.toJSON().file,!0,i)):(i.media.play(),i.media.addEventListener("loadedmetadata",function(){if(!n){n=!0;try{model.media.pause()}catch(e){}try{i.media.setCurrentTime(0)}catch(e){}c||i.iview.$el.addClass("hide"),i.iview.$el.css("opacity",""),i.videoloaded=!0,console.info("video loaded"),i.iview.$el.children(".iVideo").removeClass("unloaded"),i.loaded=!0,t.set("loaded",!0),t.page.ipreloadlist.preloadcheck(t.toJSON().file,!0,i)}},!1)),s||(i.iview.$el.find(".mejs-controls").addClass("hide"),i.iview.$el.find(".mejs-overlay-button").addClass("hide")),e.addEventListener("ended",function(){if(!r){try{e.setCurrentTime(0)}catch(t){}try{e.pause()}catch(t){}u&&(i.iview.$el.addClass("hide"),i.hided=!0),i.onAnimationStart&&(interaction_view.events.onAnimationEnd(i.onAnimationStart),i.onAnimationStart=null)}},!1),e.addEventListener("timeupdate",function(){console.log("time update")},!1)},error:function(){i.loaded=!1,t.set("loaded",!0),t.page.ipreloadlist.preloadcheck(t.toJSON().file,!1,i)}},options.plugins=["flash","silverlight"],i.iview.$el.removeClass("hide").css("opacity",0),i.iview.$el.children(".Element").children("Video").mediaelementplayer(options)},preload:function(){},play:function(t){return"Video"==t.get("iType")&&(t.isPaused=!1,t.iview.$el.removeClass("hide"),t.hided=!1),t.loaded&&t.media?(t.hls?e.video.playH(t):("Audio"==t.get("iType")?(interaction_view.ismobile&&(t.preloadformobile||(t.preloadformobile=!1)),t.media.play()):setTimeout(function(){t.media.play()},100),t.reseted=!1,t.completed=!1),void(t.iview.slider&&t.iview.sliderplay())):!1},pause:function(){},stop:function(){},reset:function(e){if(!e.media)return!1;if(!e.reseted){try{e.media.setCurrentTime(0)}catch(t){}try{e.media.pause()}catch(t){}"Audio"==e.get("iType")&&interaction_view.ismobile&&(e.preloadformobile||(e.preloadformobile=null)),e.reseted=!0}},getDuration:function(e){return e.duration},renderH:function(){},initH:function(e,t,i){iview=t.iview,t.hls=!0,t.isPaused=!0;var n=t.get("iDetail"),a=n.iRepeat||!1,o=n.iControl||!1,r=iview.getcommon(),s=(t.autoplay=n.iAutoplay||!1,i);console.log("videosrc="+s),t.videoloaded=!1;var l=n.iAutohide;null==l&&(l=!0),iview.$el.removeClass("hide"),iview.$el.children(".Element").append('<div class="hls_video"></div>'),iview.$el.children(".Element").children("div").attr("id","Video_"+t.id+e.id),jwplayer("Video_"+t.id+e.id).setup({playlist:[{image:n.iFile[0].picture,file:i,type:"hls"}],flashplayer:web_url+"thirdparty/jwplayer/jwplayer.flash.swf",html5player:web_url+"thirdparty/jwplayer/jwplayer.html5.js",primary:$.browser.safari?"html5":interaction_view.ismobile?"html5":"flash",height:r.iHeight,width:r.iWidth,controls:o,repeat:a,displaytitle:!1,logo:{hide:!0},stretching:"exactfit",startparam:"starttime",stagevideo:!1});
var c=!1;jwplayer("Video_"+t.id+e.id).onSetupError(function(){t.loaded=!1}),jwplayer("Video_"+t.id+e.id).onReady(function(){jwplayer("Video_"+t.id+e.id).onMeta(function(){c||(c=!0,t.reseted=!1)})}),jwplayer("Video_"+t.id+e.id).onError(function(){t.loaded=!1}),jwplayer("Video_"+t.id+e.id).onComplete(function(){a?$.browser.safari&&(t.iview.$el.css("opacity",0),setTimeout(function(){t.iview.$el.css("opacity",1)},800)):(t.completed=!0,l&&(t.iview.$el.addClass("hide"),t.hided=!0),t.onAnimationStart&&(interaction_view.events.onAnimationEnd(t.onAnimationStart),t.onAnimationStart=null))}),jwplayer("Video_"+t.id+e.id).onPlay(function(e){console.log("The Video is start to play from "+e.oldstate)}),jwplayer("Video_"+t.id+e.id).onTime(function(){0==t.iview.$el.css("opacity")&&setTimeout(function(){t.iview.$el.css("opacity",1)},800)}),t.loaded=!0,t.videoloaded=!0,t.media=jwplayer("Video_"+t.id+e.id),e.get("loaded")||(t.reseted=!0,t.completed=!0,e.set("loaded",!0),e.page.ipreloadlist.preloadcheck(e.toJSON().file,!0,t))},preloadH:function(){},playH:function(e){e.notallowed=!1,e.isPaused=!1;try{e.iview.$el.css("opacity",1),e.completed||e.reseted?e.media&&e.media.seek(0):e.media&&e.media.play(!0)}catch(t){}e.completed=!1,e.reseted=!1},pauseH:function(){},stopH:function(){},resetH:function(e,t){if(!e.reseted){try{e.media.pause(!0)}catch(i){}e.media.completed=!0,e.reseted=!0,e.disabled=!0}},getDurationH:function(e){return e.getDuration()}},audio:{init:function(t,i){var n=t.toJSON().file;if(".m3u8"==_g.string.getUrlExt(n)||".M3U8"==_g.string.getUrlExt(n))return void e.audio.initH(t,i);var a=i.iview.getdetail(),o=a.iRepeat||!1,r=(i.autoplay=a.iAutoplay||!1,"Audio_"+t.id+i.id);i.loaded=!1,$("div#preloader").append('<audio id="'+r+'" src="'+n+'" controls="controls"></audio>'),options={enablePluginDebug:!1,type:"",pluginPath:web_url+"thirdparty/mediaelementjs/",flashName:"flashmediaelement.swf",silverlightName:"silverlightmediaelement.xap",timerRate:100,pauseOtherPlayers:!1,loop:o,success:function(e){i.media=e;var n=!1;interaction_view.ismobile?(n=!0,i.preloadformobile=null,i.loaded=!0,console.info("audio loaded"),t.set("loaded",!0),t.page.ipreloadlist.preloadcheck(t.toJSON().file,!0,i),e.addEventListener("loadeddata",function(){i.preloadformobile||(null==i.preloadformobile?i.media.pause():0==i.preloadformobile&&i.media.play(),i.preloadformobile=!0)},!1)):(e.play(),i.loaded=!0,console.info("audio loaded"),t.set("loaded",!0),t.page.ipreloadlist.preloadcheck(t.toJSON().file,!0,i),n=!0,e.addEventListener("loadeddata",function(){e.pause()},!1)),e.addEventListener("ended",function(){if(!o){if(i.iview.slider&&i.iview.sliderstop(),interaction_view.ismobile&&0==i.media.seekable.length)return;try{i.media.setCurrentTime(0)}catch(e){}try{i.media.pause()}catch(e){}i.onAnimationStart&&(interaction_view.events.onAnimationEnd(i.onAnimationStart),i.onAnimationStart=null)}},!1),e.addEventListener("timeupdate",function(){if(i.iview.slider){var e=i.media.currentTime,t=i.media.duration,n=100*_g.number.decimal(e/t,2);i.iview.onSliderChange(n)}},!1)},error:function(){i.loaded=!1,t.set("loaded",!0),t.page.ipreloadlist.preloadcheck(t.toJSON().file,!1,i)}},(".m4a"==_g.string.getUrlExt(n)||".M4A"==_g.string.getUrlExt(n))&&(options.pluginVars="isvideo=true"),options.plugins=["flash","silverlight"],$("#Audio_"+t.id+i.id).mediaelementplayer(options)},play:function(t){e.video.play(t)},pause:function(){},stop:function(){},getDuration:function(e){return e.duration},reset:function(t){e.video.reset(t)},initH:function(e,t){t.hls=!0;{var i=t.iview.getdetail(),n=t.iview.getcommon(),a=i.iRepeat||!1,o=(t.autoplay=i.iAutoplay||!1,"Audio_"+e.id+t.id);t.src=e.toJSON().file}t.loaded=!1,$("div#preloader").append('<audio id="'+o+'" controls></audio>'),console.log("audio file added"),jwplayer(o).setup({playlist:[{file:e.toJSON().file,type:"hls"}],flashplayer:web_url+"thirdparty/jwplayer/jwplayer.flash.swf",html5player:web_url+"thirdparty/jwplayer/jwplayer.html5.js",primary:$.browser.safari?"html5":"flash",repeat:a,width:n.iWidth,height:30});var r=!1;jwplayer(o).onSetupError(function(){t.loaded=!1,e.set("loaded",!0),e.page.ipreloadlist.preloadcheck(e.toJSON().file,!1,t)}),jwplayer(o).onReady(function(){t.media=jwplayer(o),interaction_view.ismobile?r||(r=!0,t.loaded=!0,t.reseted=!0,t.completed=!0,console.info("audio loaded"),e.set("loaded",!0),e.page.ipreloadlist.preloadcheck(e.toJSON().file,!0,t)):(t.media.play(!0),jwplayer(o).onMeta(function(){r||(t.media.pause(!0),t.reseted=!0,t.completed=!0,r=!0,t.loaded=!0,console.info("audio loaded"),e.set("loaded",!0),e.page.ipreloadlist.preloadcheck(e.toJSON().file,!0,t))}))}),jwplayer(o).onError(function(){t.loaded=!1,e.get("loaded")||(e.set("loaded",!0),e.page.ipreloadlist.preloadcheck(e.toJSON().file,!1,t))}),jwplayer(o).onComplete(function(){a||(t.completed=!0,t.iview.slider&&t.iview.sliderstop(),t.onAnimationStart&&(interaction_view.events.onAnimationEnd(t.onAnimationStart),t.onAnimationStart=null))}),jwplayer(o).onTime(function(e){if(t.iview.slider){var i=100*_g.number.decimal(e.position/e.duration,2);t.iview.onSliderChange(i)}}),jwplayer(o).onBuffer(function(){interaction_view.ismobile&&(t.preloadformobile||(null==t.preloadformobile?t.media.pause():0==t.preloadformobile&&t.media.play(),t.preloadformobile=!0))})},playH:function(t){e.video.playH(t)},pauseH:function(){},stopH:function(){},resetH:function(t){e.video.resetH(t)},getDurationH:function(e){return e.getDuration()}},canPlayVideo:function(){var e,t,i,n,a=document.createElement("video");return a.canPlayType?(e=""!==a.canPlayType('video/mp4; codecs="mp4v.20.8"'),t=""!==(a.canPlayType('video/mp4; codecs="avc1.42E01E"')||a.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),i=""!==a.canPlayType('video/ogg; codecs="theora"'),n=""!==a.canPlayType('video/webm; codecs="vp8, vorbis"'),e||t?!0:!1):!1},getTimeByPercent:function(e,t){if(!e.media)return null;if(e.hls)var i=e.media.getDuration();else var i=e.media.duration;return t/100*i}};return e}),define("interaction_view/ui/adapt",[],function(){var e={elements:[],size:{x:0,y:0},adjustSize:function(){},adjustPosition:function(){},adjustElement:function(e){{var t=e.view.getcommon();Reveal._getScreenScale()}if(e.view.x=t.iStartx+t.iWidth/2,e.view.y=t.iStarty+t.iHeight/2,e.view.staticX=t.iStartx,e.view.staticY=t.iStarty,e.adapt&&5!=e.adapt){switch(console.log(e.adapt),e.adapt){case 1:e.view.sizeLeft=!0,e.view.sizeTop=!0;break;case 2:var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i;break;case 3:e.view.sizeTop=!0,e.view.sizeRight=!0;var i=t.iStartx+t.iWidth/2,n=interaction_view.size.x-i;e.view.x=Reveal.slideScreenWidth-n,e.view.staticX=e.view.x-t.iWidth/2;break;case 4:e.view.sizeLeft=!0;var a=t.iStarty+t.iHeight/2;e.view.y=Reveal.slideScreenHeight>Reveal.slideHeight?a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:a,e.view.staticY=e.view.y-t.iHeight/2;break;case 5:break;case 6:e.view.sizeRight=!0;var i=t.iStartx+t.iWidth/2,n=interaction_view.size.x-i;e.view.x=Reveal.slideScreenWidth-n;var a=t.iStarty+t.iHeight/2;e.view.y=Reveal.slideScreenHeight>Reveal.slideHeight?a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:a,e.view.staticX=e.view.x-t.iWidth/2,e.view.staticY=e.view.y-t.iHeight/2;break;case 7:e.view.sizeLeft=!0,e.view.sizeBottom=!0;var a=t.iStarty+t.iHeight/2,o=interaction_view.size.y-a;e.view.y=Reveal.slideScreenHeight-o,e.view.staticY=e.view.y-t.iHeight/2;break;case 8:e.view.sizeBottom=!0;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.x=e.view.x):e.view.x=i;var a=t.iStarty+t.iHeight/2,o=interaction_view.size.y-a;e.view.y=Reveal.slideScreenHeight-o,e.view.staticX=e.view.x-t.iWidth/2,e.view.staticY=e.view.y-t.iHeight/2;break;case 9:e.view.sizeBottom=!0,e.view.sizeRight=!0;var i=t.iStartx+t.iWidth/2,n=interaction_view.size.x-i;e.view.x=Reveal.slideScreenWidth-n;var a=t.iStarty+t.iHeight/2,o=interaction_view.size.y-a;e.view.y=Reveal.slideScreenHeight-o,e.view.staticX=e.view.x-t.iWidth/2,e.view.staticY=e.view.y-t.iHeight/2;break;case 10:e.view.sizeLeft=!0,e.view.sizeRight=!0;var r=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=r-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s;var a=t.iStarty+t.iHeight/2;e.view.y=Reveal.slideScreenHeight>Reveal.slideHeight?a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:a,e.view.x=e.view.staticX+e.view.width/2,e.view.staticY=e.view.y-e.view.originHeight/2;break;case 11:e.view.sizeTop=!0,e.view.sizeBottom=!0;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-e.view.originWidth/2):e.view.x=i;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view.y=e.view.staticY+e.view.height/2;break;case 12:e.view.sizeLeft=!0,e.view.sizeRight=!0,e.view.sizeTop=!0,e.view.sizeBottom=!0;var r=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=r-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view.staticX=t.iStartx,e.view.staticY=t.iStarty,e.view.x=t.iStartx+e.view.width/2,e.view.y=t.iStarty+e.view.height/2;break;case 13:e.view.sizeLeft=!0,e.view.sizeRight=!0,e.view.sizeTop=!0;var r=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=r-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s,e.view.x=e.view.staticX+e.view.width/2;var a=t.iStarty+t.iHeight/2;if(Reveal.slideScreenHeight>Reveal.slideHeight)var d=Reveal.slideScreenHeight-Reveal.slideHeight;else var d=0;e.view.staticY=e.view.y-t.iHeight/2;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight)-d;e.view.height=c;break;case 14:e.view.sizeLeft=!0,e.view.sizeRight=!0,e.view.sizeBottom=!0;var r=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=r-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s,e.view.x=e.view.staticX+e.view.width/2;var a=t.iStarty+t.iHeight/2;e.view.y=Reveal.slideScreenHeight>Reveal.slideHeight?a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:a,e.view.staticY=e.view.y-t.iHeight/2;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c;break;case 15:if(e.view.sizeLeft=!0,e.view.sizeTop=!0,e.view.sizeBottom=!0,Reveal.slideScreenWidth>Reveal.slideWidth)var d=Reveal.slideScreenWidth-Reveal.slideWidth;else var d=0;var r=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=r-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth)-d;e.view.width=s;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view.x=e.view.staticX+e.view.width/2,e.view.y=e.view.staticY+e.view.height/2;break;case 16:e.view.sizeRight=!0,e.view.sizeTop=!0,e.view.sizeBottom=!0;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i;var r=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=r-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c,e.view.y=e.view.staticY+e.view.height/2;break;case 17:e.view.sizeTop=!0;var i=t.iStartx+t.iWidth/2;if(Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i,Reveal.slideScreenHeight>Reveal.slideHeight)var d=Reveal.slideScreenHeight-Reveal.slideHeight;else var d=0;e.view.staticY=e.view.y-t.iHeight/2;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight)-d;e.view.height=c,e.view.width=t.iWdith;break;case 18:e.view.sizeRight=!0;var a=t.iStarty+t.iHeight/2;e.view.y=Reveal.slideScreenHeight>Reveal.slideHeight?a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:a,e.view.staticY=e.view.y-t.iHeight/2;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i;var r=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=r-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth);e.view.width=s;break;case 19:e.view.sizeBottom=!0;var i=t.iStartx+t.iWidth/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i;var a=t.iStarty+t.iHeight/2;e.view.y=Reveal.slideScreenHeight>Reveal.slideHeight?a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:a,e.view.staticY=e.view.y-t.iHeight/2;var l=interaction_view.currentScreenSize?interaction_view.currentScreenSize.y:Reveal.slideScreenHeight,c=l-t.iStarty-(interaction_view.size.y-t.iStarty-t.iHeight);e.view.height=c;break;case 20:e.view.sizeLeft=!0;var a=t.iStarty+t.iHeight/2;if(e.view.y=Reveal.slideScreenHeight>Reveal.slideHeight?a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2:a,e.view.staticY=e.view.y-t.iHeight/2,Reveal.slideScreenWidth>Reveal.slideWidth)var d=Reveal.slideScreenWidth-Reveal.slideWidth;else var d=0;var r=interaction_view.currentScreenSize?interaction_view.currentScreenSize.x:Reveal.slideScreenWidth,s=r-t.iStartx-(interaction_view.size.x-t.iStartx-t.iWidth)-d;e.view.width=s}if(e.view.width&&(e.view.width=$.zoom&&1!=$.zoom?e.view.width/$.zoom:e.view.width),e.view.height&&(e.view.height=$.zoom&&1!=$.zoom?e.view.height/$.zoom:e.view.height),_g.device.ios()){if(e.view.model.isMasterOverlay||e.view.model.isBackgroundOverlay)var h=$(Reveal.options.containment).offset();else var h=e.view.$el.closest(".interaction-area").offset();h&&("LayerRef"==e.view.model.get("iType")||"ComponentRef"==e.view.model.get("iType"))&&(e.view.width&&(e.view.width=e.view.width+Math.abs(h.left)),e.view.height&&(e.view.height=e.view.height+Math.abs(h.top)))}}else{var i=t.iStartx+t.iWidth/2,a=t.iStarty+t.iHeight/2;Reveal.slideScreenWidth>Reveal.slideWidth?(e.view.x=i+(Reveal.slideScreenWidth-Reveal.slideWidth)/2,e.view.staticX=e.view.x-t.iWidth/2):e.view.x=i,Reveal.slideScreenHeight>Reveal.slideHeight?(e.view.y=a+(Reveal.slideScreenHeight-Reveal.slideHeight)/2,e.view.staticY=e.view.y-t.iHeight/2):e.view.y=a}},change:function(){_.each(interaction_view.adapt.elements,function(e){interaction_view.adapt.excute(e)})},excute:function(e){interaction_view.adapt.adjustElement(e);var t=!1;e.view.model.get("isStatic")?(e.view.width&&(t=!0,e.view.originWidth=e.view.width,e.view.$el.width(e.view.width),e.view.$el.children(".Element").width(e.view.width)),e.view.height&&(t=!0,e.view.originHeight=e.view.height,e.view.$el.height(e.view.height),e.view.$el.children(".Element").height(e.view.height)),e.view.$el.css({left:e.view.staticX,top:e.view.staticY})):(interaction_view.setPos(e.view.$el[0],{x:e.view.x,y:e.view.y}),e.view.width&&(t=!0,e.view.originWidth=e.view.width,e.view.$el.children(".Element").width(e.view.width)),e.view.height&&(t=!0,e.view.originHeight=e.view.height,e.view.$el.children(".Element").height(e.view.height))),t&&e.view.onSizeAdaptChange&&e.view.onSizeAdaptChange()}};return e}),define("text!interaction_view/template/analytics.js",[],function(){return'<iframe src="<%=data.src%>" style="border:none;width:0;height:0;" class="analytics_frame"></iframe>'}),define("interaction_view/ui/analytics",["text!interaction_view/template/analytics.js"],function(){var e=require("text!interaction_view/template/analytics.js"),t={set:function(t){var i="./analytics/"+t+".html";$("body").find(".analytics_frame").length?$("body").find(".analytics_frame").attr("src",i):$("body").append(_.template(e,{data:{src:i}}))}};return t}),define("interaction_view/ui/application",["text!interaction_view/template/alertbox.js"],function(){var e=require("text!interaction_view/template/alertbox.js"),t={buttons:[],buttonGroups:[],initForm:function(e){_.each(e.data,function(t){if(t.binding)if(_.include(["radio","checkboxes","dropdown"],t.field_type)){var i=[];_.each(t.binding,function(n,a){n&&(interaction_view.events.formEvents.push({overlay:n,func:function(i){interaction_view.application.setValue(e.id,t.cid,a,i),"checkboxes"!=t.field_type&&interaction_view.application.execBindingButton(n)},i:t,cid:t.cid,key:a,id:e.id,bindSwitch:"checkboxes"!=t.field_type}),i.push(n))}),"checkboxes"!=t.field_type&&i.length>1&&interaction_view.application.buttonGroups.push({overlays:i})}else interaction_view.events.formEvents.push({overlay:t.binding,func:function(i){if(i&&"number"==t.field_type){i=Number(i);var n=interaction_view.application.validateNumber(i,t.field_options.min,t.field_options.max);n&&interaction_view.application.errorAlert(n)}interaction_view.application.setValue(e.id,t.cid,null,i)},i:t,cid:t.cid,id:e.id})})},getValue:function(e,t,i){var n=_.find(interaction_view.applications,function(t){return t.id==e}),a=_.find(n.data,function(e){return e.cid==t});return _.include(["radio","dropdown"],a.field_type)?i?i==a.value?1:0:a.value:_.include(["checkboxes"],a.field_type)?i&&a.value&&a.value.length?_.include(a.value,i):!1:a.value},setValue:function(e,t,i,n){var a=_.find(interaction_view.applications,function(t){return t.id==e});return"submit"==t?(interaction_view.application.submitForm(e),!1):void(a.data=_.map(a.data,function(e){return e.cid==t&&(_.include(["radio","dropdown"],e.field_type)?e.value=i:_.include(["checkboxes"],e.field_type)?(e.value||(e.value=[]),e.value=n?_.union(e.value,[i]):_.without(e.value,i)):e.value=n),e}))},sendOverlayToButtonGroup:function(e){var t=e.createPath(),i=interaction_view.hashPath(t);_.include(_.pluck(interaction_view.application.buttons,"hash"),i)?interaction_view.application.buttons=_.map(interaction_view.application.buttons,function(t){return t.hash==i&&(t.overlay=e),t}):interaction_view.application.buttons.push({hash:i,overlay:e})},getHashs:function(e){var t=[];return _.each(e,function(e){t.push(interaction_view.hashPath(e.path)+e.id)}),t},execBindingButton:function(e){{var t=interaction_view.hashPath(e.path)+e.id,i=[];_.find(interaction_view.application.buttonGroups,function(e){_.include(interaction_view.application.getHashs(e.overlays),t)&&_.each(e.overlays,function(e){interaction_view.hashPath(e.path)+e.id==t||i.push(e)})})}i.length&&_.each(i,function(e){var t=interaction_view.hashPath(e.path)+e.id,i=_.find(interaction_view.application.buttons,function(e){return e.hash==t});i&&i.overlay.iview.resetButtonStatus()})},isBindingButton:function(e){var t=!1;return _.each(interaction_view.application.buttonGroups,function(i){_.include(interaction_view.application.getHashs(i.overlays),interaction_view.hashPath(e.createPath()))&&(t=!0)}),t},errorMsg:function(e,t,i,n){var a=_.find(interaction_view.applications,function(t){return t.id==e}),o=_.find(a.data,function(e){return e.cid==t});return i?o.label+(n||"ä¸­å¡«åçæ°å¼ä¸æ­£ç¡®"):_.include(["radio","dropdown","checkboxes"],o.field_type)?"è¯·éæ©"+o.label:o.label+(n||"ä¸è½ä¸ºç©º")},errorAlert:function(t){if(!interaction_view.containment.children(".alert_mask").length){interaction_view.containment.append('<div class="alert_mask"></div>');var i=_.template(e,{text:t});interaction_view.containment.append(i),interaction_view.containment.find(".alert-confirm").on("click",function(){interaction_view.containment.find(".alert_mask").remove(),interaction_view.containment.find(".alert-box").remove()})}},submitForm:function(e){var t=_.find(interaction_view.applications,function(t){return t.id==e});if(!t)return!1;var i,n={},a=!0,o="";if(_.each(t.data,function(t){if(n[t.cid]=t.value,"number"==t.field_type){var r=!1;if((n[t.cid]||_.isNumber(n[t.cid]))&&(r=!0),t.field_options.integer_only&&_.isNumber(n[t.cid])&&(n[t.cid]=Math.round(n[t.cid])),!_.isNumber(n[t.cid])||_.isNaN(n[t.cid]))(t.required||r)&&(i||(i=interaction_view.application.errorMsg(e,t.cid,r?!0:!1)),a=!1);else{var s=interaction_view.application.validateNumber(n[t.cid],t.field_options.min,t.field_options.max);s&&(i=interaction_view.application.errorMsg(e,t.cid,!0,s),a=!1)}}else if("mobile"==t.field_type){var l=$.trim(n[t.cid]);if(t.required&&!l)a=!1,i=interaction_view.application.errorMsg(e,t.cid);else if(l){var c=/^0?1[3|4|5|7|8][0-9]\d{8}$/;c.test(l)||(a=!1,i="è¯·è¾å¥æ­£ç¡®ææºå·ç ï¼")}o=l}else t.required&&!n[t.cid]&&(i||(i=interaction_view.application.errorMsg(e,t.cid)),a=!1)}),!a)return void(i&&interaction_view.application.errorAlert(i));if(_.each(interaction_view.environment.otherFormValue,function(e,t){n[t]=e.value,(""==e.value||void 0==e.value)&&(interaction_view.application.errorAlert(e.errMsg),a=!1)}),a){o&&(epub360_userinfo=epub360_userinfo||{},epub360_userinfo.mobile=o),"undefined"!=typeof epub360_sourceinfo&&epub360_sourceinfo.openid&&(n.source_openid=epub360_sourceinfo.openid);var r="/form/"+t.app_id+"/?format=json";_g.ajax.post({traditional:!0,url:r,data:n,callback:function(i){var n=null;if(200==i.code)interaction_view.events.onFormSubmitEvent(70,t.id),"function"==typeof epub360FromSubmited&&epub360FromSubmited();else{var a=i.msg;if(_.keys(a).length){var o=_.keys(a)[0];n=interaction_view.application.errorMsg(e,o),interaction_view.application.errorAlert(n)}}}})}},setFormData:function(e,t,i,n){var a=_.find(interaction_view.applications,function(t){return t.id==e});if(!a)return!1;3==i&&(n=null);_.each(a.data,function(e){if(e.cid==t){if(1==i||2==i){if(n=Number(n),e.value=Number(e.value),_.isNaN(n)||!_.isNumber(n))return!1;(_.isNaN(e.value)||!_.isNumber(e.value))&&(e.value=0)}1==i?e.value+=n:2==i?e.value-=n:e.value="number"==e.field_type?Number(n):n}})},validateNumber:function(e,t,i){if(_.isNaN(e)||!_.isNumber(e))return"è¯·è¾å¥æ°å­";var n=!1,a="åå¼èå´:";return void 0!=t&&(a=a+"å¤§äº"+t,t>=e&&(n=!0)),void 0!=i&&(a=a+"å°äº"+i,e>=i&&(n=!0)),n?a:void 0},getFormFieldValue:function(e){if(2!=e.split("_").length)return null;var t=e.split("_")[0],i=e.split("_")[1],n=_.find(interaction_view.applications,function(e){return e.app_id==t});if(!n)return null;for(var a=null,o=0;o<n.data.length;o++)if(n.data[o].cid==i){"undefined"!=typeof n.data[o].value&&(a=n.data[o].value);break}return a}};return t}),define("interaction_view/ui/weixin",[],function(){var e={chooseimage:function(e){return interaction_view.foredit?void global.message("warning","è¯·å¨å¾®ä¿¡æ¨¡å¼é¢è§è¯¥åè½"):void("undefined"!=typeof wx_permissions&&wx_permissions.chooseImage?wx.chooseImage({success:function(t){t.localIds&&t.localIds.length?e&&e(t.localIds):e&&e(null)}}):interaction_view.weixin.error())},voiceauth:function(){if(interaction_view.foredit)return void global.message("warning","è¯·å¨å¾®ä¿¡æ¨¡å¼é¢è§è¯¥åè½");if("undefined"!=typeof wx_permissions&&wx_permissions.startRecord){if(interaction_view.weixinvoiceauth)return;wx.startRecord({success:function(){wx.stopRecord({})},cancel:function(){interaction_view.errorAlert("å¼å¯å¾®ä¿¡åè½å¤±è´¥")}}),interaction_view.weixinvoiceauth=!0}},shareable:function(){return"undefined"!=typeof wx_permissions&&wx_permissions.onMenuShareTimeline?!0:!1},eventStatistic:function(e){var t="system",i=e,n="weixin",a="www.epub360.com";current_host=window.location.host,-1!=current_host.indexOf("tu960")&&(a=current_host);var o="http://"+a+"/manage/book/"+interaction_view.book_id+"/event.gif?opt_category="+t+"&opt_action="+n+"&opt_label="+i+"&t="+_g.uuid(),r=document.createElement("img");r.src=o,r.onload=function(){}},share:function(){if("undefined"!=typeof wx_permissions&&wx_permissions.onMenuShareTimeline){var e=message_link;"current"==interaction_view.share_page_id?(e=_g.changeURLPar(e,"disableHistoryStart","0"),e=_g.changeURLPar(e,"pageid",interaction_view.currentPage)):"first"!=interaction_view.share_page_id?(e=_g.changeURLPar(e,"disableHistoryStart","0"),e=_g.changeURLPar(e,"pageid",interaction_view.share_page_id)):"first"==interaction_view.share_page_id&&message_link.indexOf("pageid")>0&&(e=_g.changeURLPar(e,"disableHistoryStart","1"),e=_g.changeURLPar(e,"pageid","")),wx.onMenuShareAppMessage({title:msgTitle,desc:msgContent,link:e,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","appmessage","click"])},success:function(){shareSuccess(),interaction_view.weixin.eventStatistic("åéç»æå"),_gaq.push(["_trackSocial","Wechat","appmessage",ga_opt_target,ga_opt_pagePath]),_paq.push(["trackEvent","weixin","share","appmessage"])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","appmessage","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","appmessage",JSON.stringify(e)])}}),wx.onMenuShareTimeline({title:shareTitle,link:e,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","timeline","click"])},success:function(){shareSuccess(),interaction_view.weixin.eventStatistic("åäº«å°æåå"),_gaq.push(["_trackSocial","Wechat","timeline",ga_opt_target,ga_opt_pagePath]),_paq.push(["trackEvent","weixin","share","timeline"])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","timeline","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","timeline",JSON.stringify(e)])}}),wx.onMenuShareQQ({title:msgTitle,desc:msgContent,link:e,imgUrl:imgUrl,trigger:function(){_gaq.push(["_trackEvent","weixin","share","QQ","click"])},complete:function(){_gaq.push(["_trackEvent","weixin","share","QQ","complete"])},success:function(){shareSuccess(),interaction_view.weixin.eventStatistic("åäº«å°QQ"),_gaq.push(["_trackSocial","Wechat","QQ",ga_opt_target,ga_opt_pagePath]),_paq.push(["trackEvent","weixin","share","QQ"])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","QQ","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","QQ",JSON.stringify(e)])}}),wx.onMenuShareWeibo({title:msgTitle,desc:msgContent,link:message_link,imgUrl:imgUrl,trigger:function(){_paq.push(["trackEvent","weixin","share","Weibo","click"])},complete:function(){_paq.push(["trackEvent","weixin","share","Weibo","complete"])},success:function(){shareSuccess(),interaction_view.weixin.eventStatistic("åäº«å°å¾®å"),_gaq.push(["_trackSocial","Wechat","Weibo",ga_opt_target,ga_opt_pagePath]),_paq.push(["trackEvent","weixin","share","Weibo"])},cancel:function(){_gaq.push(["_trackEvent","weixin","share","Weibo","cancel"])},fail:function(e){_gaq.push(["_trackEvent","error","weixinjsapi","Weibo",JSON.stringify(e)])}})}},error:function(){interaction_view.errorAlert("å¼å¯å¾®ä¿¡åè½å¤±è´¥")}};return e}),function(e,t){function i(){n.READY||(n.event.determineEventTypes(),n.utils.each(n.gestures,function(e){n.detection.register(e)}),n.event.onTouch(n.DOCUMENT,n.EVENT_MOVE,n.detection.detect),n.event.onTouch(n.DOCUMENT,n.EVENT_END,n.detection.detect),n.READY=!0)}var n=function(e,t){return new n.Instance(e,t||{})};n.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.HAS_POINTEREVENTS=e.navigator.pointerEnabled||e.navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in e,n.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,n.NO_MOUSEEVENTS=n.HAS_TOUCHEVENTS&&e.navigator.userAgent.match(n.MOBILE_REGEX),n.EVENT_TYPES={},n.DIRECTION_DOWN="down",n.DIRECTION_LEFT="left",n.DIRECTION_UP="up",n.DIRECTION_RIGHT="right",n.POINTER_MOUSE="mouse",n.POINTER_TOUCH="touch",n.POINTER_PEN="pen",n.EVENT_START="start",n.EVENT_MOVE="move",n.EVENT_END="end",n.DOCUMENT=e.document,n.plugins=n.plugins||{},n.gestures=n.gestures||{},n.READY=!1,n.utils={extend:function(e,i,n){for(var a in i)e[a]!==t&&n||(e[a]=i[a]);return e},each:function(e,i,n){var a,o;if("forEach"in e)e.forEach(i,n);else if(e.length!==t){for(a=0,o=e.length;o>a;a++)if(i.call(n,e[a],a,e)===!1)return}else for(a in e)if(e.hasOwnProperty(a)&&i.call(n,e[a],a,e)===!1)return},hasParent:function(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(e){var t=[],i=[];return n.utils.each(e,function(e){t.push("undefined"!=typeof e.clientX?e.clientX:e.pageX),i.push("undefined"!=typeof e.clientY?e.clientY:e.pageY)}),{pageX:(Math.min.apply(Math,t)+Math.max.apply(Math,t))/2,pageY:(Math.min.apply(Math,i)+Math.max.apply(Math,i))/2}},getVelocity:function(e,t,i){return{x:Math.abs(t/e)||0,y:Math.abs(i/e)||0}},getAngle:function(e,t){var i=t.pageY-e.pageY,n=t.pageX-e.pageX;return 180*Math.atan2(i,n)/Math.PI},getDirection:function(e,t){var i=Math.abs(e.pageX-t.pageX),a=Math.abs(e.pageY-t.pageY);return i>=a?e.pageX-t.pageX>0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT:e.pageY-t.pageY>0?n.DIRECTION_UP:n.DIRECTION_DOWN},getDistance:function(e,t){var i=t.pageX-e.pageX,n=t.pageY-e.pageY;return Math.sqrt(i*i+n*n)},getScale:function(e,t){return e.length>=2&&t.length>=2?this.getDistance(t[0],t[1])/this.getDistance(e[0],e[1]):1},getRotation:function(e,t){return e.length>=2&&t.length>=2?this.getAngle(t[1],t[0])-this.getAngle(e[1],e[0]):0},isVertical:function(e){return e==n.DIRECTION_UP||e==n.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(e,t){t&&e&&e.style&&(n.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(i){n.utils.each(t,function(t,n){i&&(n=i+n.substring(0,1).toUpperCase()+n.substring(1)),n in e.style&&(e.style[n]=t)})}),"none"==t.userSelect&&(e.onselectstart=function(){return!1}),"none"==t.userDrag&&(e.ondragstart=function(){return!1}))}},n.Instance=function(e,t){var a=this;return i(),this.element=e,this.enabled=!0,this.options=n.utils.extend(n.utils.extend({},n.defaults),t||{}),this.options.stop_browser_behavior&&n.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),n.event.onTouch(e,n.EVENT_START,function(e){a.enabled&&n.detection.startDetect(a,e)}),this},n.Instance.prototype={on:function(e,t){var i=e.split(" ");return n.utils.each(i,function(e){this.element.addEventListener(e,t,!1)},this),this},off:function(e,t){var i=e.split(" ");return n.utils.each(i,function(e){this.element.removeEventListener(e,t,!1)},this),this},trigger:function(e,t){t||(t={});var i=n.DOCUMENT.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t;var a=this.element;return n.utils.hasParent(t.target,a)&&(a=t.target),a.dispatchEvent(i),this},enable:function(e){return this.enabled=e,this},reset:function(){a=null,o=!1,r=!1,n.PointerEvent.reset()}};var a=null,o=!1,r=!1;n.event={bindDom:function(e,t,i){var a=t.split(" ");n.utils.each(a,function(t){e.addEventListener(t,i,!1)})},onTouch:function(e,t,i){var s=this;this.bindDom(e,n.EVENT_TYPES[t],function(l){var c=l.type.toLowerCase();if(!c.match(/mouse/)||!r){c.match(/touch/)||c.match(/pointerdown/)||c.match(/mouse/)&&1===l.which?o=!0:c.match(/mouse/)&&!l.which&&(o=!1),c.match(/touch|pointer/)&&(r=!0);var d=0;o&&(n.HAS_POINTEREVENTS&&t!=n.EVENT_END?d=n.PointerEvent.updatePointer(t,l):c.match(/touch/)?d=l.touches.length:r||(d=c.match(/up/)?0:1),d>0&&t==n.EVENT_END?t=n.EVENT_MOVE:d||(t=n.EVENT_END),(d||null===a)&&(a=l),i.call(n.detection,s.collectEventData(e,t,s.getTouchList(a,t),l)),n.HAS_POINTEREVENTS&&t==n.EVENT_END&&(d=n.PointerEvent.updatePointer(t,l))),d||(a=null,o=!1,r=!1,n.PointerEvent.reset())}})},determineEventTypes:function(){var e;e=n.HAS_POINTEREVENTS?n.PointerEvent.getEvents():n.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],n.EVENT_TYPES[n.EVENT_START]=e[0],n.EVENT_TYPES[n.EVENT_MOVE]=e[1],n.EVENT_TYPES[n.EVENT_END]=e[2]
},getTouchList:function(e){return n.HAS_POINTEREVENTS?n.PointerEvent.getTouchList():e.touches?e.touches:(e.identifier=1,[e])},collectEventData:function(e,t,i,a){var o=n.POINTER_TOUCH;return(a.type.match(/mouse/)||n.PointerEvent.matchType(n.POINTER_MOUSE,a))&&(o=n.POINTER_MOUSE),{center:n.utils.getCenter(i),timeStamp:(new Date).getTime(),target:a.target,touches:i,eventType:t,pointerType:o,srcEvent:a,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return n.detection.stopDetect()}}}},n.PointerEvent={pointers:{},getTouchList:function(){var e=this,t=[];return n.utils.each(e.pointers,function(e){t.push(e)}),t},updatePointer:function(e,t){return e==n.EVENT_END?this.pointers={}:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t),Object.keys(this.pointers).length},matchType:function(e,t){if(!t.pointerType)return!1;var i=t.pointerType,a={};return a[n.POINTER_MOUSE]=i===t.MSPOINTER_TYPE_MOUSE||i===n.POINTER_MOUSE,a[n.POINTER_TOUCH]=i===t.MSPOINTER_TYPE_TOUCH||i===n.POINTER_TOUCH,a[n.POINTER_PEN]=i===t.MSPOINTER_TYPE_PEN||i===n.POINTER_PEN,a[e]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},n.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(e,t){this.current||(this.stopped=!1,this.current={inst:e,startEvent:n.utils.extend({},t),lastEvent:!1,name:""},this.detect(t))},detect:function(e){if(this.current&&!this.stopped){e=this.extendEventData(e);var t=this.current.inst.options;return n.utils.each(this.gestures,function(i){return this.stopped||t[i.name]===!1||i.handler.call(i,e,this.current.inst)!==!1?void 0:(this.stopDetect(),!1)},this),this.current&&(this.current.lastEvent=e),e.eventType==n.EVENT_END&&!e.touches.length-1&&this.stopDetect(),e}},stopDetect:function(){this.previous=n.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(e){var t=this.current.startEvent;!t||e.touches.length==t.touches.length&&e.touches!==t.touches||(t.touches=[],n.utils.each(e.touches,function(e){t.touches.push(n.utils.extend({},e))}));var i,a,o=e.timeStamp-t.timeStamp,r=e.center.pageX-t.center.pageX,s=e.center.pageY-t.center.pageY,l=n.utils.getVelocity(o,r,s);return"end"===e.eventType?(i=this.current.lastEvent&&this.current.lastEvent.interimAngle,a=this.current.lastEvent&&this.current.lastEvent.interimDirection):(i=this.current.lastEvent&&n.utils.getAngle(this.current.lastEvent.center,e.center),a=this.current.lastEvent&&n.utils.getDirection(this.current.lastEvent.center,e.center)),n.utils.extend(e,{deltaTime:o,deltaX:r,deltaY:s,velocityX:l.x,velocityY:l.y,distance:n.utils.getDistance(t.center,e.center),angle:n.utils.getAngle(t.center,e.center),interimAngle:i,direction:n.utils.getDirection(t.center,e.center),interimDirection:a,scale:n.utils.getScale(t.touches,e.touches),rotation:n.utils.getRotation(t.touches,e.touches),startEvent:t}),e},register:function(e){var i=e.defaults||{};return i[e.name]===t&&(i[e.name]=!0),n.utils.extend(n.defaults,i,!0),e.index=e.index||1e3,this.gestures.push(e),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}},n.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:-1!==e.navigator.userAgent.toLowerCase().indexOf("android")?5:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(e,t){if(n.detection.current&&n.detection.current.name!=this.name&&this.triggered)return t.trigger(this.name+"end",e),void(this.triggered=!1);if(!(t.options.drag_max_touches>0&&e.touches.length>t.options.drag_max_touches))switch(e.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:if(e.distance<t.options.drag_min_distance&&n.detection.current.name!=this.name)return;if(n.detection.current.name!=this.name&&(n.detection.current.name=this.name,t.options.correct_for_drag_min_distance&&e.distance>0)){var i=Math.abs(t.options.drag_min_distance/e.distance);n.detection.current.startEvent.center.pageX+=e.deltaX*i,n.detection.current.startEvent.center.pageY+=e.deltaY*i,e=n.detection.extendEventData(e)}(n.detection.current.lastEvent.drag_locked_to_axis||t.options.drag_lock_to_axis&&t.options.drag_lock_min_distance<=e.distance)&&(e.drag_locked_to_axis=!0);var a=n.detection.current.lastEvent.direction;e.drag_locked_to_axis&&a!==e.direction&&(e.direction=n.utils.isVertical(a)?e.deltaY<0?n.DIRECTION_UP:n.DIRECTION_DOWN:e.deltaX<0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT),this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),t.trigger(this.name+e.direction,e),(t.options.drag_block_vertical&&n.utils.isVertical(e.direction)||t.options.drag_block_horizontal&&!n.utils.isVertical(e.direction))&&e.preventDefault();break;case n.EVENT_END:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}},n.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:800,hold_threshold:1},timer:null,handler:function(e,t){switch(e.eventType){case n.EVENT_START:clearTimeout(this.timer),n.detection.current.name=this.name,this.timer=setTimeout(function(){n.detection.current&&"hold"==n.detection.current.name&&t.trigger("hold",e)},t.options.hold_timeout);break;case n.EVENT_MOVE:e.distance>t.options.hold_threshold&&clearTimeout(this.timer);break;case n.EVENT_END:clearTimeout(this.timer)}}},n.gestures.Release={name:"release",index:1/0,handler:function(e,t){e.eventType==n.EVENT_END&&t.trigger(this.name,e)}},n.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(e,t){if(e.eventType==n.EVENT_END){if(t.options.swipe_max_touches>0&&e.touches.length<t.options.swipe_min_touches&&e.touches.length>t.options.swipe_max_touches)return;(e.velocityX>t.options.swipe_velocity||e.velocityY>t.options.swipe_velocity)&&(t.trigger(this.name,e),t.trigger(this.name+e.direction,e))}}},n.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(e,t){if(e.eventType==n.EVENT_END&&"touchcancel"!=e.srcEvent.type){var i=n.detection.previous,a=!1;if(e.deltaTime>t.options.tap_max_touchtime||e.distance>t.options.tap_max_distance)return;i&&"tap"==i.name&&e.timeStamp-i.lastEvent.timeStamp<t.options.doubletap_interval&&e.distance<t.options.doubletap_distance&&(t.trigger("doubletap",e),a=!0),(!a||t.options.tap_always)&&(n.detection.current.name="tap",t.trigger(n.detection.current.name,e))}}},n.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,t){return t.options.prevent_mouseevents&&e.pointerType==n.POINTER_MOUSE?void e.stopDetect():(t.options.prevent_default&&e.preventDefault(),void(e.eventType==n.EVENT_START&&t.trigger(this.name,e)))}},n.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(e,t){if(n.detection.current.name!=this.name&&this.triggered)return t.trigger(this.name+"end",e),void(this.triggered=!1);if(!(e.touches.length<2))switch(t.options.transform_always_block&&e.preventDefault(),e.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:var i=Math.abs(1-e.scale),a=Math.abs(e.rotation);if(i<t.options.transform_min_scale&&a<t.options.transform_min_rotation)return;n.detection.current.name=this.name,this.triggered||(t.trigger(this.name+"start",e),this.triggered=!0),t.trigger(this.name,e),a>t.options.transform_min_rotation&&t.trigger("rotate",e),i>t.options.transform_min_scale&&(t.trigger("pinch",e),t.trigger("pinch"+(e.scale<1?"in":"out"),e));break;case n.EVENT_END:this.triggered&&t.trigger(this.name+"end",e),this.triggered=!1}}},"function"==typeof define&&define.amd?define("hammerjs",[],function(){return n}):"object"==typeof module&&module.exports?module.exports=n:e.Hammer=n}(window),function(e,t){function i(e,i){e.event.bindDom=function(e,n,a){i(e).on(n,function(e){var i=e.originalEvent||e;i.pageX===t&&(i.pageX=e.pageX,i.pageY=e.pageY),i.target||(i.target=e.target),i.which===t&&(i.which=i.button),i.preventDefault||(i.preventDefault=e.preventDefault),i.stopPropagation||(i.stopPropagation=e.stopPropagation),a.call(this,i)})},e.Instance.prototype.on=function(e,t){return i(this.element).on(e,t)},e.Instance.prototype.off=function(e,t){return i(this.element).off(e,t)},e.Instance.prototype.trigger=function(e,t){var n=i(this.element);return n.has(t.target).length&&(n=i(t.target)),n.trigger({type:e,gesture:t})},i.fn.hammer=function(t){return this.each(function(){var n=i(this),a=n.data("hammer");a?"reset"==t?e.detection.current=null:a&&t&&e.utils.extend(a.options,t):n.data("hammer",new e(this,t||{}))})}}"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("jquery.hammer",["hammerjs","jquery"],i):i(e.Hammer,e.jQuery||e.Zepto)}(this),function(){var e={support:function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}(),bind:function(){}};"undefined"==typeof require?(window._g||(window._g={}),window._g.touch=e):define("_g/touch",["_g/base","jquery.hammer"],function(){return window._g.touch=e,window._g.touch})}(window),function(e){function t(e){if(e in h.style)return e;var t=["Moz","Webkit","O","ms"],i=e.charAt(0).toUpperCase()+e.substr(1);if(e in h.style)return e;for(var n=0;n<t.length;++n){var a=t[n]+i;if(a in h.style)return a}}function i(){return h.style[u.transform]="",h.style[u.transform]="rotateY(90deg)",""!==h.style[u.transform]}function n(e){return"string"==typeof e&&this.parse(e),this}function a(e,t,i){t===!0?e.queue(i):t?e.queue(t,i):i()}function o(t){var i=[];return e.each(t,function(t){t=e.camelCase(t),t=e.transit.propertyMap[t]||e.cssProps[t]||t,t=l(t),-1===e.inArray(t,i)&&i.push(t)}),i}function r(t,i,n,a){var r=o(t);e.cssEase[n]&&(n=e.cssEase[n]);var s=""+d(i)+" "+n;parseInt(a,10)>0&&(s+=" "+d(a));var l=[];return e.each(r,function(e,t){l.push(t+" "+s)}),l.join(", ")}function s(t,i){i||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=u.transform,e.cssHooks[t]={get:function(i){var n=e(i).css("transit:transform");return n.get(t)},set:function(i,n){var a=e(i).css("transit:transform");a.setFromString(t,n),e(i).css({"transit:transform":a})}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function c(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function d(t){var i=t;return e.fx.speeds[i]&&(i=e.fx.speeds[i]),c(i,"ms")}e.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var h=document.createElement("div"),u={},p=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;u.transition=t("transition"),u.transitionDelay=t("transitionDelay"),u.transform=t("transform"),u.transformOrigin=t("transformOrigin"),u.transform3d=i();var m={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},f=u.transitionEnd=m[u.transition]||null;for(var v in u)u.hasOwnProperty(v)&&"undefined"==typeof e.support[v]&&(e.support[v]=u[v]);h=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)",epubOut:"cubic-bezier(.3,1,.0,1)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new n},set:function(t,i){var a=i;a instanceof n||(a=new n(a)),t.style[u.transform]="WebkitTransform"!==u.transform||p?a.toString():a.toString(!0),e(t).data("transform",a)}},e.cssHooks.transform={set:e.cssHooks["transit:transform"].set},e.fn.jquery<"1.8"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[u.transformOrigin]},set:function(e,t){e.style[u.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[u.transition]},set:function(e,t){e.style[u.transition]=t}}),s("scale"),s("translate"),s("translateZ"),s("rotate"),s("rotateX"),s("rotateY"),s("rotate3d"),s("perspective"),s("skewX"),s("skewY"),s("x",!0),s("y",!0),n.prototype={setFromString:function(e,t){var i="string"==typeof t?t.split(","):t.constructor===Array?t:[t];i.unshift(e),n.prototype.set.apply(this,i)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=c(e,"deg")},rotateX:function(e){this.rotateX=c(e,"deg")},rotateY:function(e){this.rotateY=c(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=c(e,"deg")},skewY:function(e){this.skewY=c(e,"deg")},perspective:function(e){this.perspective=c(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&void 0!==e&&(this._translateX=c(e,"px")),null!==t&&void 0!==t&&(this._translateY=c(t,"px")),this.translate=this._translateX+","+this._translateY},translateZ:function(e){this.translateZ=c(e,"px")}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},translateZ:function(){return this.translateZ||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;3>=t;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=c(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,i,n){t.setFromString(i,n)})},toString:function(e){var t=[];for(var i in this)if(this.hasOwnProperty(i)){if(!u.transform3d&&("rotateX"===i||"rotateY"===i||"translateZ"===i||"perspective"===i||"transformOrigin"===i))continue;"_"!==i[0]&&t.push(e&&"scale"===i?i+"3d("+this[i]+",1)":e&&"translate"===i?i+"3d("+this[i]+",0)":i+"("+this[i]+")")}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,i,n,o){var s=this,l=0,c=!0;"function"==typeof i&&(o=i,i=void 0),"function"==typeof n&&(o=n,n=void 0),"undefined"!=typeof t.easing&&(n=t.easing,delete t.easing),"undefined"!=typeof t.duration&&(i=t.duration,delete t.duration),"undefined"!=typeof t.complete&&(o=t.complete,delete t.complete),"undefined"!=typeof t.queue&&(c=t.queue,delete t.queue),"undefined"!=typeof t.delay&&(l=t.delay,delete t.delay),"undefined"==typeof i&&(i=e.fx.speeds._default),"undefined"==typeof n&&(n=e.cssEase._default),e.fx.off&&(i=0),i=d(i);var h=r(t,i,n,l),p=e.transit.enabled&&u.transition,m=p?parseInt(i,10)+parseInt(l,10):0;if(0===m){var v=function(e){s.css(t),o&&o.apply(s),e&&e()};return a(s,c,v),s}var g={},w=function(i){var n=!1,a=function(){n&&s.unbind(f,a),m>0&&s.each(function(){this.style[u.transition]=g[this]||null}),"function"==typeof o&&o.apply(s),"function"==typeof i&&i()};m>0&&f&&e.transit.useTransitionEnd?(n=!0,s.bind(f,a)):window.setTimeout(a,m),s.each(function(){m>0&&(this.style[u.transition]=h),e(this).css(t)})},_=function(e){this.offsetWidth,w(e)};return a(s,c,_),this},e.transit.getTransitionValue=r}("undefined"!=typeof jQuery?jQuery:Zepto),define("jquery.transit",["jquery"],function(){}),function(){var e={support:function(){},init:function(){$(document).on("keydown",function(e){console.log("keydown"+e)}),$(document).on("keyup",function(e){console.log("keyup"+e)}),$(document).on("keypress",function(e){console.log("keypress"+e)})}};"undefined"==typeof require?(window._g||(window._g={}),window._g.keyboard=e):define("_g/keyboard",["_g/base","_g/event"],function(){return window._g.keyboard=e,window._g.keyboard})}(window),function(){var e={0:{x:{activeItem:{x:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{x:function(e,t){return e*t*100+"%"}}},y:{activeItem:{y:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{y:function(e,t){return e*t*100+"%"}}},perspective:!1,currentEasing:"snap",activeEasing:"snap"},1:{x:{activeItem:{x:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{x:0}},y:{activeItem:{y:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{y:0}},activeTop:!0,perspective:!1,currentEasing:"snap",activeEasing:"snap"},2:{x:{activeItem:{},currentItem:{opacity:function(e,t){return 1-t}}},y:{activeItem:{},currentItem:{opacity:function(e,t){return 1-t}}},currentTop:!0,perspective:!1,currentEasing:"snap",activeEasing:"snap"},3:{perspective:!0,currentEasing:"out",activeEasing:"in",currentTop:!0,percentcontrol:[.5,1],.5:{x:{activeItem:{rotateY:function(e){return 90*-e+"deg"},opacity:.2},currentItem:{rotateY:function(e,t){return 90*e*t*2+"deg"},opacity:function(e,t){return.2+.8*(1-2*t)}}},y:{activeItem:{rotateX:function(e){return 90*e+"deg"},opacity:.2},currentItem:{rotateX:function(e,t){return 90*-e*t*2+"deg"},opacity:function(e,t){return.2+.8*(1-2*t)}}}},1:{x:{activeItem:{rotateY:function(e,t){return 90*-e*(1-2*(t-.5))+"deg"},opacity:function(e,t){return.2+.8*(t-.5)*2}},currentItem:{rotateY:function(e){return 90*e+"deg"},opacity:.2}},y:{activeItem:{rotateX:function(e,t){return 90*e*(1-2*(t-.5))+"deg"},opacity:function(e,t){return.2+.8*(t-.5)*2}},currentItem:{rotateX:function(e){return 90*-e+"deg"},opacity:.2}}}},4:{x:{css:{currentItem:{transformOrigin:function(e){return 0>e?"100% 50%":"0% 50%"}},activeItem:{transformOrigin:function(e){return e>0?"100% 50%":"0% 50%"}}},activeItem:{x:function(e,t){return-e*(1-t)*100+"%"},opacity:function(e,t){return t},rotateY:function(e,t){return-e*(1-t)*90+"deg"}},currentItem:{x:function(e,t){return e*t*100+"%"},rotateY:function(e,t){return e*t*90+"deg"},opacity:function(e,t){return 1-t}}},y:{css:{currentItem:{transformOrigin:function(e){return 0>e?"50% 100%":"50% 0%"}},activeItem:{transformOrigin:function(e){return e>0?"50% 100%":"50% 0%"}}},activeItem:{y:function(e,t){return-e*(1-t)*100+"%"},opacity:function(e,t){return t},rotateX:function(e,t){return e*(1-t)*90+"deg"}},currentItem:{y:function(e,t){return e*t*100+"%"},rotateX:function(e,t){return-e*t*90+"deg"},opacity:function(e,t){return 1-t}}},currentTop:!0,perspective:!0,currentEasing:"easeOutCubic",activeEasing:"easeOutCubic"},5:{x:{css:{currentItem:{transformOrigin:function(e){return e>0?"100% 50%":"0% 50%"}}},activeItem:{x:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{x:0,scale:function(e,t){return.5+.5*(1-t)}}},y:{css:{currentItem:{transformOrigin:function(e){return e>0?"50% 100%":"50% 0%"}}},activeItem:{y:function(e,t){return-e*(1-t)*100+"%"}},currentItem:{y:0,scale:function(e,t){return.5+.5*(1-t)}}},activeTop:!0,perspective:!1,currentEasing:"epubOut",activeEasing:"epubOut"}};"undefined"==typeof require?(window._g||(window._g={}),window._g.transitionargs=e):define("_g/transitionargs",["_g/base"],function(){return window._g.transitionargs=e,window._g.transitionargs})}(window),function(){function e(e,t){var i=1200;return"x"===e?"perspective("+i+"px) rotateY("+t+"rad)":"perspective("+i+"px) rotateX("+-t+"rad)"}var t=document.createElement("div"),n=function(e,i){return null==i&&(i=t),void 0!==i.style[e]?e:void 0},a=n("webkitTransform"),o=(n("webkitTransitionProperty"),n("webkitTransitionDuration")),r=(n("webkitTransitionTimingFunction"),n("webkitTransition")),s=function(e){this.init(e)};s.prototype={isDraged:!1,init:function(e){var t={containment:null,containmentClass:"c-transition-containment",perspectiveClass:"c-perspective",itemClass:"c-transition-item",currentClass:"c-transition-current",leftClass:"c-transition-left",rightClass:"c-transition-right",upClass:"c-transition-up",downClass:"c-transition-down",activeClass:"c-transition-active",topClass:"c-transition-top",repeat:!1,direction:0,type:1,duration:1e3,onStart:null,onEnd:function(){},onCancel:function(){},control:!0,autoplay:!1,width:null,height:null,disableControlled:!1,autoplayDirection:-1,autoplayAxis:null};if(this.opts=e?$.extend(!0,{},t,e):t,!this.opts.containment)return!1;if($(this.opts.containment).addClass(this.opts.containmentClass),_.bindAll(this),7==this.opts.type){var i="flipboardStyle";if(!document.getElementById(i)){var n=document.createElement("style");n.setAttribute("id",i),n.innerHTML='[data-flap]{-webkit-backface-visibility:hidden;backface-visibility:hidden}[data-flap].backface-visible{-webkit-backface-visibility:visible;backface-visibility:visible}[data-flap="left"],[data-flap="right"]{z-index:1}[data-flap="front"],[data-flap="back"]{z-index:2}.flap-shadow{position:absolute;top:0;width:50%;height:100%;background:#000;z-index:99999}.flap-shadowY{position:absolute;left:0;width:100%;height:50%;background:#000;z-index:99999}.flap-shadow.left,.flap-shadow.back{left:0}.flap-shadow.right,.flap-shadow.front{right:0}.flap-shadowY.up,.flap-shadowY.bottom{top:0}.flap-shadowY.down,.flap-shadowY.top{bottom:0}.flap-shadow.flap-gradient{background:linear-gradient(to right,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%)}.flap-shadow.back.flap-gradient{background:linear-gradient(to left,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%)}.flap-shadowY.flap-gradient{background:linear-gradient(to top,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%);background:-webkit-linear-gradient(to top,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%)}.flap-shadowY.top.flap-gradient{background:linear-gradient(to bottom,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%);background:-webkit-linear-gradient(to bottom,rgba(0,0,0,0.5) 0,rgba(0,0,0,0) 100%)}',(document.getElementsByTagName("head")[0]||document.body).appendChild(n)}var a=$(this.opts.containment);this.container=a[0],this.$container=a;var o=this.opts.width||this.$container.width(),r=this.opts.height||this.$container.height();this.width=o%2?o+1:o,this.height=r%2?r+1:r,this.hack=this.width>o||this.height>r,a.attr("data-hack",this.hack);var s=a.offset(),l=this.opts.boundary||0;interaction_view.ismobile?(this.boundaryStart=l+s.left,this.boundaryEnd=o-l-s.left,this.boundaryStartY=l+s.top,this.boundaryEndY=r-l-s.top):(this.boundaryStart=l,this.boundaryEnd=o-l,this.boundaryStartY=l,this.boundaryEndY=r-l),this.PI=Math.PI,this.dur=this.opts.duration||"1000",this.rad=this.opts.rad||.5,this.isTransiting=!1,this.shadowOpacity=this.opts.shadowOpacity||.1;var c=this;$(window).resize(function(){c.resize()}),$(this.opts.containment).on("touchend",function(){setTimeout(function(){c.key&&!c.isTransiting&&(console.log("transition is touchended"),c.clearNode(!0))},50)})}return this.opts.control&&(this.control(),this.opts.disableControlled&&this.disableControl()),this.opts.autostart?(this.timerDisabled=!1,this.timerstart({})):this.timerDisabled=!0,this},resize:function(){var e=this.opts.width||this.$container.width(),t=this.opts.height||this.$container.height();this.width=e%2?e+1:e,this.height=t%2?t+1:t,this.hack=this.width>e||this.height>t,this.$container.attr("data-hack",this.hack);var i=this.$container.offset(),n=this.opts.boundary||20;this.boundaryStart=n+i.left,this.boundaryEnd=e-n-i.left,this.boundaryStartY=n+i.top,this.boundaryEndY=t-n-i.top},disableControlled:!1,disableControl:function(){this.disableControlled=!0},enableControl:function(){this.disableControlled=!1},control:function(){var e=this;_g.dragcontrol.bind({el:this.opts.containment,dragstart:function(t){e.disableControlled||e.start(t)},dragleft:function(t){e.disableControlled||e.dragX(t)},dragright:function(t){e.disableControlled||e.dragX(t)},dragup:function(t){e.disableControlled||e.dragY(t)},dragdown:function(t){e.disableControled||e.dragY(t)},dragend:function(t){if(!e.disableControlled){if(e.direction&&!e.timerDisabled){var i="x"==e.direction?t.gesture.deltaX:t.gesture.deltaY;e.TimerDirection=i>0?1:-1}e.dragEnd(t)}},canDragX:function(){return e.opts.autoplayAxis&&"x"!=e.opts.autoplayAxis?!1:!0},canDragY:function(){return e.opts.autoplayAxis&&"y"!=e.opts.autoplayAxis?!1:!0}})},stashitemClass:function(){$(this.opts.containment).find("."+this.opts.itemClass).css({transform:"","-moz-transform":"","-webkit-transform":"","-o-transform":"","-ms-transform":"",opacity:""}),this.stashClass={current:$(this.opts.containment).find("."+this.opts.currentClass).attr("style"),left:$(this.opts.containment).find("."+this.opts.leftClass).attr("style"),right:$(this.opts.containment).find("."+this.opts.rightClass).attr("style"),up:$(this.opts.containment).find("."+this.opts.upClass).attr("style"),down:$(this.opts.containment).find("."+this.opts.downClass).attr("style")},this.stashed=!0},recoveritemClass:function(){if(this.stashed)try{this.currentItem.attr("style",this.stashClass.current||""),this.activeItem.hasClass(this.opts.leftClass)?this.activeItem.attr("style",this.stashClass.left||""):this.activeItem.hasClass(this.opts.rightClass)?this.activeItem.attr("style",this.stashClass.right||""):this.activeItem.hasClass(this.opts.upClass)?this.activeItem.attr("style",this.stashClass.up||""):this.activeItem.hasClass(this.opts.downClass)&&this.activeItem.attr("style",this.stashClass.down||"")}catch(e){console.log(e)}$(this.opts.containment).find("."+this.opts.itemClass).css({transform:"","-moz-transform":"","-webkit-transform":"","-o-transform":"","-ms-transform":"",opacity:""}),this.stashed=!1},start:function(e,t){this.isTransiting||(this.key=1*new Date,void 0==t&&(t=this.opts.type),this.args=_g.transitionargs[t]||{},this.args.perspective?$(this.opts.containment).addClass(this.opts.perspectiveClass):$(this.opts.containment).removeClass(this.opts.perspectiveClass),this.currentItem=$(this.opts.containment).find(">."+this.opts.currentClass),this.currentItem.addClass(this.opts.topClass),this.stashitemClass())},startInit:function(e,t,i){this.dur=this.opts.duration,this.lastsubpi=0,this.startObj={x:0,y:0},this.end={x:0,y:0};var n=this.getPos(e,i);this.startObj.x=this.end.x=n.x,this.startObj.y=this.end.y=n.y,this.touchStartDirection=!1,this.realslide=!1},clearNode:function(e){var t=this;$(t.fromNodeCloneNode).remove(),$(t.toNodeCloneNode).remove(),$(t.fromNodeFlapShadow).remove(),$(t.toNodeFlapShadow).remove(),$(t.fromNodeCloneNodeFlapShadow).remove(),$(t.toNodeCloneNodeFlapShadow).remove(),e&&(t.currentItem&&t.currentItem.length&&(t.currentItem[0].style.removeProperty("visibility"),t.currentItem[0].style.removeProperty("clip"),t.currentItem[0].style.removeProperty("opacity")),t.activeItem&&t.activeItem.length&&(t.activeItem[0].style.removeProperty("visibility"),t.activeItem[0].style.removeProperty("clip"),t.activeItem[0].style.removeProperty("opacity")),t.isTransiting=!1,t.key=null)},initNode:function(){this.fromNode=this.currentItem[0],this.toNode=this.activeItem[0],this.fromNodeCloneNode=this.fromNode.cloneNode(!0),this.toNodeCloneNode=this.toNode.cloneNode(!0),this.r=this.boundaryEnd-this.startObj.x,this.l=this.startObj.x-this.boundaryStart,this.u=this.startObj.y-this.boundaryStartY,this.d=this.boundaryEndY-this.startObj.y,$(this.toNode).css({visibility:"visible"}),$(this.fromNode).css({visibility:"visible"}),$(this.fromNodeCloneNode).css({visibility:"visible"}),$(this.toNodeCloneNode).css({visibility:"visible"})},dragX:function(e,t,i){if(!this.isTransiting&&this.key&&(e.gesture.deltaX<=0?(this.plus=-1,this.activeItem=$(this.opts.containment).find(">."+this.opts.rightClass)):(this.plus=1,this.activeItem=$(this.opts.containment).find(">."+this.opts.leftClass)),this.activeItem.length)){var n=e.gesture.deltaX;if(this.direction="x",void 0==t&&(t=this.opts.type),7!=t)this.dragHandle(n,t);else{if(this.isOverstepBoundary("x",e,i))return;this.touchStartDirection!=e.type&&(console.log("------------------------------",this.isOverstepBoundary("x",e)),this.startInit(e,t,i),this.flipSide=this.startObj.x<this.width/2?"l2r":"r2l",this.touchStartDirection=e.type,this.clearNode(),this.initNode(e),"dragleft"==e.type?this.leftFlap():this.rightFlap());var a=this.getPos(e,i);this.end.x=a.x,this.end.y=a.y,this.dragHandle(this.end.x-this.startObj.x,t)}}},dragY:function(e,t,i){if(!this.isTransiting&&this.key&&(e.gesture.deltaY<=0?(this.plus=-1,this.activeItem=$(this.opts.containment).find("."+this.opts.downClass)):(this.plus=1,this.activeItem=$(this.opts.containment).find("."+this.opts.upClass)),this.activeItem.length)){var n=e.gesture.deltaY;if(this.direction="y",void 0==t&&(t=this.opts.type),7!=t)this.dragHandle(n,t);else{if(this.isOverstepBoundary("y",e,i))return;this.touchStartDirection!=e.type&&(this.startInit(e,t,i),this.direction="y",this.touchStartDirection=e.type,this.flipSide=this.startObj.y<this.height/2?"u2d":"d2u",this.clearNode(),this.initNode(e),this.r=this.d,this.l=this.u,"dragup"==e.type?this.upFlap():this.downFlap());var a=this.getPos(e,i);this.end.x=a.x,this.end.y=a.y,this.dragHandle(this.end.y-this.startObj.y,t)}}},getIsPassMiddlePosition:function(){var e,t,i=this.end.x,n=this.end.y,a=this.startObj.x,o=this.startObj.y,r=this.l,s=this.r,l=this.rad,c=0;return"l2r"==this.flipSide?"dragleft"==this.touchStartDirection?a-r*l>i?(e=this.endRotate,c=1,t=(r-(a-i))/r):(e=0,c=0,t=(a-i)/r):"dragright"==this.touchStartDirection&&(i>a+s*l?(e=this.endRotate,c=1,t=(s-(i-a))/s):(e=0,c=0,t=(i-a)/s)):"r2l"==this.flipSide?"dragleft"==this.touchStartDirection?a-r*l>i?(e=this.endRotate,c=1,t=(r-(a-i))/r):(e=0,c=0,t=(a-i)/r):"dragright"==this.touchStartDirection&&(i>a+s*l?(e=this.endRotate,c=1,t=(s-(i-a))/s):(e=0,c=0,t=(i-a)/s)):"u2d"==this.flipSide?"dragup"==this.touchStartDirection?o-r*l>n?(e=this.endRotate,c=1,t=(r-(o-n))/r):(e=0,c=0,t=(o-n)/r):"dragdown"==this.touchStartDirection&&(n>o+s*l?(e=this.endRotate,c=1,t=(s-(n-o))/s):(e=0,c=0,t=(n-o)/s)):"d2u"==this.flipSide&&("dragup"==this.touchStartDirection?o-r*l>n?(e=this.endRotate,c=1,t=(r-(o-n))/r):(e=0,c=0,t=(o-n)/r):"dragdown"==this.touchStartDirection&&(n>o+s*l?(e=this.endRotate,c=1,t=(s-(n-o))/s):(e=0,c=0,t=(n-o)/s))),{subpi:e,isPassMiddlePosition:c,dur:t}},dragHandle:function(t,n){if(isDraged=!0,this.opts.onStopPlay&&this.opts.onStopPlay(),$(this.opts.containment).find("."+this.opts.itemClass).removeClass(this.opts.activeClass),this.activeItem.addClass(this.opts.activeClass),this.currentItem=$(this.opts.containment).find("."+this.opts.currentClass),void 0==n&&(n=this.opts.type),7!=n){var o=Math.abs(t)/$(this.opts.containment).width();if(_g.browserSupport({msie:9}))if(this.args.percentcontrol){for(i=0;i<this.args.percentcontrol.length;i++)if(o<=this.args.percentcontrol[i]){if(this.args[this.args.percentcontrol[i]][this.direction].css){var r=this.args[this.args.percentcontrol[i]][this.direction].css;r.currentItem&&this.currentItem.css(this.getArgs(r.currentItem,this.plus,o)),r.activeItem&&this.activeItem.css(this.getArgs(r.activeItem,this.plus,o))}this.activeItem.css(this.getArgs(this.args[this.args.percentcontrol[i]][this.direction].activeItem,this.plus,o)),this.currentItem.css(this.getArgs(this.args[this.args.percentcontrol[i]][this.direction].currentItem,this.plus,o));
break}}else{if(this.args[this.direction].css){var r=this.args[this.direction].css;r.currentItem&&this.currentItem.css(this.getArgs(r.currentItem,this.plus,o)),r.activeItem&&this.activeItem.css(this.getArgs(r.activeItem,this.plus,o))}this.activeItem.css(this.getArgs(this.args[this.direction].activeItem,this.plus,o)),this.currentItem.css(this.getArgs(this.args[this.direction].currentItem,this.plus,o))}else this.currentItem.css("x"==this.direction?"margin-left":"margin-top",this.plus*o*100+"%"),this.activeItem.css("x"==this.direction?"margin-left":"margin-top",-this.plus*(1-o)*100+"%");this.args.currentTop?this.currentItem.addClass(this.opts.topClass):this.currentItem.removeClass(this.opts.topClass),this.args.activeTop&&this.activeItem.addClass(this.opts.topClass),this.opts.onTransition&&this.opts.onTransition(event,o)}else{var t=Math.round(Math.abs(t)),s=t,l=this.startObj.x,c=this.end.x,d=this.startObj.y,h=this.end.y;if("x"==this.direction){c<this.boundaryStart&&(c=this.boundaryStart,s=l-this.boundaryStart),c>this.boundaryEnd&&(c=this.boundaryEnd,s=this.boundaryEnd-l);{1*(this.width/2)}}else{h<this.boundaryStartY&&(h=this.boundaryStartY,s=d-this.boundaryStartY),h>this.boundaryEndY&&(h=this.boundaryEndY,s=this.boundaryEndY-d);{1*(this.height/2)}}var u="";if("l2r"==this.flipSide?"dragleft"==this.touchStartDirection?(c>=l&&(c=l,s=0),u=-this.PI*(s/this.l)):"dragright"==this.touchStartDirection&&(l>=c&&(c=l,s=0),u=this.PI*(s/this.r)):"r2l"==this.flipSide?"dragleft"==this.touchStartDirection?(c>=l&&(c=l,s=0),u=-this.PI*(s/this.l)):"dragright"==this.touchStartDirection&&(l>=c&&(c=l,s=0),u=this.PI*(s/this.r)):"u2d"==this.flipSide?"dragup"==this.touchStartDirection?(h>=d&&(h=d,s=0),u=-this.PI*(s/this.l)):"dragdown"==this.touchStartDirection&&(d>=h&&(h=d,s=0),u=this.PI*(s/this.r)):"d2u"==this.flipSide&&("dragup"==this.touchStartDirection?(h>=d&&(h=d,s=0),u=-this.PI*(s/this.l)):"dragdown"==this.touchStartDirection&&(d>=h&&(h=d,s=0),u=this.PI*(s/this.r))),this.lastsubpi==u)return;this.lastsubpi=u,console.log("[this.lastsubpi:",this.lastsubpi,"]"),this.fromNodeCloneNode.style[a]=e(this.direction,u),this.toNodeCloneNode.style[a]=e(this.direction,this.PI+u),this.toNodeFlapShadow.style.opacity=Math.abs(u)>this.PI/2?0:.7-2*Math.abs(u)/this.PI*.7,this.fromNodeFlapShadow.style.opacity=Math.abs(u)>this.PI/2?.7-2*(this.PI-Math.abs(u))/this.PI*.7:0,this.fromNodeCloneNodeFlapShadow.style.opacity=Math.abs(u)>this.PI/2?this.shadowOpacity:2*Math.abs(u)/this.PI*this.shadowOpacity,this.toNodeCloneNodeFlapShadow.style.opacity=Math.abs(u)>this.PI/2?2*(this.PI-Math.abs(u))/this.PI*this.shadowOpacity:this.shadowOpacity,this.args.currentTop?this.currentItem.addClass(this.opts.topClass):this.currentItem.removeClass(this.opts.topClass),this.args.activeTop&&this.activeItem.addClass(this.opts.topClass),this.opts.onTransition&&this.opts.onTransition(event,o)}},dragEnd:function(t,n,s){function l(){3==v&&(f.lastsubpi=_,f.realslide=!1,$(f.toNodeCloneNode).remove(),$(f.toNodeFlapShadow).remove(),$(f.fromNodeCloneNode).remove(),$(f.fromNodeFlapShadow).remove(),f.touchStartDirection=!1,f.isTransiting=!1,f.key=null,f.currentItem[0].style.removeProperty("visibility"),f.currentItem[0].style.removeProperty("clip"),f.currentItem[0].style.removeProperty("opacity"),f.activeItem[0].style.removeProperty("visibility"),f.activeItem[0].style.removeProperty("clip"),f.activeItem[0].style.removeProperty("opacity"),w?f.opts.onEnd&&f.opts.onEnd(w):f.opts.onCancel&&f.opts.onCancel(w))}if(!this.isTransiting)if(void 0==n&&(n=this.opts.type),7!=n){if(!this.currentItem.length||!this.activeItem.length)return;this.currentItem.addClass("c-transition-noevents");var c=this;this.isTransiting=!0;var d="x"==this.direction?t.gesture.deltaX:t.gesture.deltaY,h=Math.abs(d)/$(this.opts.containment).width();if(_g.browserSupport({msie:9}))if(this.args.percentcontrol){for(c.currentItem.removeClass("c-transition-noevents"),this.percent=h,i=0;i<this.args.percentcontrol.length;i++)if(h<=this.args.percentcontrol[i]){this.transitPercent(i);break}}else{var u=1100,p=this.getArgs(this.args[this.direction].currentItem,this.plus,1);p.duration=u,p.easing=this.args.currentEasing;var m=this.getArgs(this.args[this.direction].activeItem,this.plus,1);m.duration=u,m.easing=this.args.activeEasing,m.complete=function(){c.currentItem.removeClass("c-transition-noevents"),c.isTransiting=!1,_g.device.android()?setTimeout(function(){c.onTransitionEnd()},100):c.onTransitionEnd()},this.currentItem.transit(p),this.activeItem.transit(m)}else this.activeItem.css("x"==this.direction?"margin-left":"margin-top","0%"),this.currentItem.css("x"==this.direction?"margin-left":"margin-top",100*-this.plus+"%")}else{var f=this,v=1;f.isTransiting=!0;var g=f.getIsPassMiddlePosition(),w=g.isPassMiddlePosition;if(f.dur=f.dur*g.dur,!(this.currentItem.length&&this.activeItem.length&&f.fromNodeCloneNode&&this.key&&this.touchStartDirection))return w=0,void l();var _=g.subpi;if(s){f.dur=500;var _="x"==f.direction?t.gesture.deltaX<0?-3.141592653589793:3.141592653589793:t.gesture.deltaY<0?-3.141592653589793:3.141592653589793}else if(f.l<=0||f.r<=0||f.lastsubpi==_)return $(f.fromNodeCloneNode).remove(),f.fromNode.style.clip="rect(0px "+f.width+"px "+f.height+"px 0px)",w&&$(f.fromNode).css({visibility:"hidden"}),w||$(f.toNode).css({visibility:"hidden"}),$(f.toNodeCloneNode).remove(),f.toNode.style.clip="rect(0px "+f.width+"px "+f.height+"px 0px)",$(f.fromNodeFlapShadow).remove(),$(f.toNodeFlapShadow).remove(),v=3,void l();$(f.fromNodeCloneNode).on("webkitTransitionEnd",function(){$(f.fromNodeCloneNode).off("webkitTransitionEnd"),$(f.fromNodeCloneNode).remove(),f.fromNode.style.clip="rect(0px "+(f.width+1)+"px "+f.height+"px 0px)",w&&$(f.fromNode).css({visibility:"hidden"}),$(f.fromNodeFlapShadow).remove(),v++,l(),setTimeout(function(){3>v&&(v++,l())},f.dur/2)}),$(f.toNodeCloneNode).on("webkitTransitionEnd",function(){$(f.toNodeCloneNode).off("webkitTransitionEnd"),w||$(f.toNode).css({visibility:"hidden"}),$(f.toNodeCloneNode).remove(),$(f.toNodeFlapShadow).remove(),f.toNode.style.clip="rect(0px "+f.width+"px "+f.height+"px 0px)",v++,l()}),w||s?(f.toNodeFlapShadow.style[r]="opacity "+f.dur/2+"ms ease-in",f.fromNodeFlapShadow.style[r]="opacity "+f.dur/2+"ms ease-in",f.fromNodeFlapShadow.style.opacity=.7,f.toNodeFlapShadow.style.opacity=0,f.fromNodeCloneNodeFlapShadow.style.opacity=0,f.toNodeCloneNodeFlapShadow.style.opacity=0,f.fromNodeCloneNode.style[a]=e(f.direction,_),f.fromNodeCloneNode.style[o]=f.dur+"ms",f.toNodeCloneNode.style[a]=e(f.direction,f.PI+_),f.toNodeCloneNode.style[o]=1.5*f.dur+"ms"):(f.toNodeFlapShadow.style[r]="opacity "+f.dur/2+"ms ease-in",f.fromNodeFlapShadow.style[r]="opacity "+f.dur/2+"ms ease-in",f.toNodeFlapShadow.style.opacity=.7,f.fromNodeFlapShadow.style.opacity=0,f.fromNodeCloneNodeFlapShadow.style.opacity=0,f.toNodeCloneNodeFlapShadow.style.opacity=0,f.fromNodeCloneNode.style[a]=e(f.direction,_),f.fromNodeCloneNode.style[o]=1.5*f.dur+"ms",f.toNodeCloneNode.style[a]=e(f.direction,f.PI+_),f.toNodeCloneNode.style[o]=f.dur+"ms"),console.log("[isPassMiddlePosition:",w,"]"),console.log("[touchStartDirection:",this.touchStartDirection,"]"),console.log("[that.fromNodeCloneNode:",f.fromNodeCloneNode,"]"),console.log("[that.toNodeCloneNode:",f.toNodeCloneNode,"]"),console.log("[that.direction:",f.direction,"]"),console.log("[subpi:",_,"]"),console.log("[lastsubpi:",f.lastsubpi,"]"),console.log("[that.dur:",f.dur,"]")}},onTransitionEnd:function(){var e=this;this.recoveritemClass(),this.currentItem.removeClass(this.opts.currentClass),this.activeItem.addClass(this.opts.currentClass).removeClass(this.opts.activeClass).removeClass(this.opts.upClass).removeClass(this.opts.rightClass).removeClass(this.opts.leftClass).removeClass(this.opts.downClass),$(this.opts.containment).find("."+this.opts.itemClass).removeClass(this.opts.topClass);var t=this.currentItem.index(),i=this.activeItem.index();$(this.opts.containment).removeClass(this.opts.perspectiveClass),e.opts.onEnd&&e.opts.onEnd(t,i),this.timerStart()},transitPercent:function(e){var t=this;if(e<this.args.percentcontrol.length){var t=this,i=this.opts.duration*(this.args.percentcontrol[e]-this.percent),n=this.getArgs(this.args[this.args.percentcontrol[e]][this.direction].currentItem,this.plus,this.args.percentcontrol[e]);n.duration=i,n.easing=this.args.currentEasing;var a=this.getArgs(this.args[this.args.percentcontrol[e]][this.direction].activeItem,this.plus,this.args.percentcontrol[e]);a.duration=i,a.easing=this.args.activeEasing,a.complete=function(){t.transitPercent(e+1)},this.percent=this.args.percentcontrol[e],this.currentItem.transit(n),this.activeItem.transit(a)}else t.isTransiting=!1,this.onTransitionEnd()},getArgs:function(e,t,i){var n={};for(var a in e)n[a]="function"==typeof e[a]?e[a](t,i):e[a];return n},autostart:function(e,t,i){if(!this.isTransiting&&(this.args=_g.transitionargs[e]||{},this.currentItem=$(this.opts.containment).find("."+this.opts.currentClass),this.stashitemClass(),this.key=1*new Date,"x"==t&&(this.activeItem=$(this.opts.containment).find(0>i?"."+this.opts.rightClass:"."+this.opts.leftClass)),"y"==t&&(this.activeItem=$(this.opts.containment).find(0>i?"."+this.opts.downClass:"."+this.opts.upClass)),this.activeItem.length))if(7!=e){this.args.currentTop&&this.currentItem.addClass(this.opts.topClass),this.plus=i,this.direction=t,this.args.perspective?$(this.opts.containment).addClass(this.opts.perspectiveClass):$(this.opts.containment).removeClass(this.opts.perspectiveClass);var n={gesture:{}};"x"==t?n.gesture.deltaX=0:n.gesture.deltaY=0,this.dragHandle(0,e),this.dragEnd(n,e)}else{if("x"==t){if(0>i)var n={gesture:{deltaX:-.01},type:"dragleft"};else var n={gesture:{deltaX:.01},type:"dragright"};this.dragX(n,e,!0)}if("y"==t){if(0>i)var n={gesture:{deltaY:-.01},type:"dragup"};else var n={gesture:{deltaY:.01},type:"dragbottom"};this.dragY(n,e,!0)}this.dragEnd(n,e,!0)}},enableTimer:function(){this.timerDisabled=!1},disableTimer:function(){this.timerDisabled=!0},setCurrent:function(e,t){var i,n=this;$(this.opts.containment).children("."+this.opts.itemClass).removeClass(this.opts.topClass).removeClass(this.opts.activeClass).removeClass(this.opts.upClass).removeClass(this.opts.rightClass).removeClass(this.opts.leftClass).removeClass(this.opts.downClass);var a=$(this.opts.containment).children().length;if(e>=a){if(!this.opts.repeat)return void this.timerStop();this.current=0,e=0}else if(0>e){if(!this.opts.repeat)return void this.timerStop();this.current=a-1,e=a-1}if($(this.opts.containment).children().each(function(){$(this).index()==e?(i=$(this),$(this).addClass(n.opts.currentClass)):$(this).removeClass(n.opts.currentClass)}),t&&i){if("x"==t)var o=this.opts.leftClass,r=this.opts.rightClass;else var o=this.opts.upClass,r=this.opts.downClass;i.prev().length?i.prev().addClass(o):this.opts.repeat&&$(this.opts.containment).children().last().addClass(o),i.next().length?i.next().addClass(r):this.opts.repeat&&$(this.opts.containment).children().first().addClass(r)}},timerStart:function(e){if(!this.timerDisabled){var t=this;if(e)e.type||(e.type=t.opts.type),e.axis||(e.axis="x"),e.diretion||(e.direction=-1),e.startAt||(e.startAt=0),this.setCurrent(e.startAt,e.axis),this.current=e.startAt,this.TimerArgs=e;else{if(!this.TimerArgs)return;e=this.TimerArgs,this.TimerDirection=this.TimerDirection||t.opts.autoplayDirection,this.current=null!=this.tempCurrent?this.tempCurrent:-1==this.TimerDirection?this.current+1:this.current-1,this.tempCurrent=null,this.TimerDirection=null,this.setCurrent(this.current,e.axis)}this.Timer&&window.clearTimeout(this.Timer),this.Timer=window.setTimeout(function(){t.autostart(e.type,e.axis,e.direction)},this.opts.interval)}},timerStop:function(){this.Timer&&(window.clearTimeout(this.Timer),this.Timer=null),this.TimerArgs=null,this.disableTimer()},isOverstepBoundary:function(e,t,i){if(i)return!1;var n=this.getPos(t,i),a=n.x,o=n.y;if(console.log(a,"[",this.boundaryStart,this.boundaryEnd,"]"),console.log("this.key[",this.key,"]"),console.log("direction[",e,"]"),"x"==e){if(a<=this.boundaryStart||a>=this.boundaryEnd)return!0}else if("y"==e&&(o<=this.boundaryStartY||o>=this.boundaryEndY))return!0;return!1},getPos:function(e,t){var i=e.gesture.touches?e.gesture.touches[0]:{};return interaction_view.ismobile?t?{x:interaction_view.size.x,y:interaction_view.size.y}:{x:i.pageX,y:i.pageY}:t?{x:this.$container.offset().left+interaction_view.size.x,y:this.$container.offset().top+interaction_view.size.y}:{x:i.pageX-this.$container.offset().left,y:i.pageY-this.$container.offset().top}},addCloneAttr:function(){$(this.fromNodeFlapShadow).attr("data-clone","fromNodeFlapShadow"),$(this.toNodeFlapShadow).attr("data-clone","toNodeFlapShadow"),$(this.fromNodeCloneNodeFlapShadow).attr("data-clone","fromNodeCloneNodeFlapShadow"),$(this.toNodeCloneNodeFlapShadow).attr("data-clone","toNodeCloneNodeFlapShadow"),$(this.fromNodeCloneNode).attr("data-clone","fromNodeCloneNode"),$(this.toNodeCloneNode).attr("data-clone","toNodeCloneNode")},leftFlap:function(){this.endRotate=-this.PI,this.middlePosition=this.startObj.x-this.l/2,this.fromNodeFlapShadow=$('<div class="flap-shadow flat left" style="opacity: 0;"></div>')[0],this.toNodeFlapShadow=$('<div class="flap-shadow flat right" style="opacity: 0.7;"></div>')[0],this.fromNodeCloneNodeFlapShadow=$('<div class="flap-shadow flap-gradient front" style="opacity: 0;width:'+this.width/2+"px;height:"+this.height+'px;"></div>')[0],this.toNodeCloneNodeFlapShadow=$('<div class="flap-shadow flap-gradient back" style="opacity: '+this.shadowOpacity+";width:"+this.width/2+"px;height:"+this.height+'px;"></div>')[0],this.container.appendChild(this.fromNodeCloneNode),this.container.appendChild(this.toNodeCloneNode),this.fromNode.appendChild(this.fromNodeFlapShadow),this.toNode.appendChild(this.toNodeFlapShadow),this.fromNodeCloneNode.appendChild(this.fromNodeCloneNodeFlapShadow),this.toNodeCloneNode.appendChild(this.toNodeCloneNodeFlapShadow),this.addCloneAttr(),this.hack?(this.fromNode.style.clip="rect(0px "+(this.width/2+1)+"px "+this.height+"px 0px)",this.toNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+(this.width/2-1)+"px)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+(this.width/2-1)+"px)",this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(0rad)",this.toNodeCloneNode.style.clip="rect(0px "+(this.width/2+1)+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY("+this.PI+"rad)"):(this.fromNode.style.clip="rect(0px "+this.width/2+"px "+this.height+"px 0px)",this.toNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(0rad)",this.toNodeCloneNode.style.clip="rect(0px "+this.width/2+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY("+this.PI+"rad)")},rightFlap:function(){this.endRotate=this.PI,this.middlePosition=this.startObj.x+this.r/2,this.hack?(this.toNode.style.clip="rect(0px "+(this.width/2+1)+"px "+this.height+"px 0px)",this.fromNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.toNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+(this.width/2-1)+"px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(3.141592653589793rad)",this.fromNodeCloneNode.style.clip="rect(0px "+(this.width/2+1)+"px "+this.height+"px 0px)"):(this.toNode.style.clip="rect(0px "+this.width/2+"px "+this.height+"px 0px)",this.fromNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.toNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height+"px "+this.width/2+"px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(3.141592653589793rad)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width/2+"px "+this.height+"px 0px)"),this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateY(0rad)",this.container.appendChild(this.toNodeCloneNode),this.container.appendChild(this.fromNodeCloneNode),this.fromNodeFlapShadow=$('<div class="flap-shadow flat right" style="opacity: 0;">A</div>')[0],this.toNodeFlapShadow=$('<div class="flap-shadow flat left" style="opacity: 0.7;">B</div>')[0],this.fromNodeCloneNodeFlapShadow=$('<div class="flap-shadow flap-gradient back" style="opacity: 0;width:'+this.width/2+"px;height:"+this.height+'px;">C</div>')[0],this.toNodeCloneNodeFlapShadow=$('<div class="flap-shadow flap-gradient front" style="opacity: '+this.shadowOpacity+";width:"+this.width/2+"px;height:"+this.height+'px;">D</div>')[0],this.fromNode.appendChild(this.fromNodeFlapShadow),this.toNode.appendChild(this.toNodeFlapShadow),this.fromNodeCloneNode.appendChild(this.fromNodeCloneNodeFlapShadow),this.toNodeCloneNode.appendChild(this.toNodeCloneNodeFlapShadow),this.addCloneAttr()},upFlap:function(){this.endRotate=-this.PI,this.middlePosition=this.startObj.y-this.l/2,this.fromNodeFlapShadow=$('<div class="flap-shadowY flat up" style="opacity: 0;"></div>')[0],this.toNodeFlapShadow=$('<div class="flap-shadowY flat down" style="opacity: 0.7;"></div>')[0],this.fromNodeCloneNodeFlapShadow=$('<div class="flap-shadowY flap-gradient top" style="opacity: 0;width:'+this.width+"px;height:"+this.height/2+'px;"></div>')[0],this.toNodeCloneNodeFlapShadow=$('<div class="flap-shadowY flap-gradient bottom" style="opacity: '+this.shadowOpacity+";width:"+this.width+"px;height:"+this.height/2+'px;"></div>')[0],this.fromNodeCloneNode=this.fromNode.cloneNode(!0),this.toNodeCloneNode=this.toNode.cloneNode(!0),this.container.appendChild(this.fromNodeCloneNode),this.container.appendChild(this.toNodeCloneNode),this.fromNode.appendChild(this.fromNodeFlapShadow),this.toNode.appendChild(this.toNodeFlapShadow),this.fromNodeCloneNode.appendChild(this.fromNodeCloneNodeFlapShadow),this.toNodeCloneNode.appendChild(this.toNodeCloneNodeFlapShadow),this.hack?(this.fromNode.style.clip="rect(0px "+this.width+"px "+(this.height/2+1)+"px 0px)",this.toNode.style.clip="rect("+(this.height/2-1)+"px "+this.width+"px "+this.height+"px 0px)",this.fromNodeCloneNode.style.clip="rect("+(this.height/2-1)+"px "+this.width+"px "+this.height+"px 0px)",this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(0rad)",this.toNodeCloneNode.style.clip="rect(0px "+this.width+"px "+(this.height/2+1)+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX("+this.PI+"rad)"):(this.fromNode.style.clip="rect(0px "+this.width+"px "+this.height/2+"px 0px)",this.toNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.fromNodeCloneNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(0rad)",this.toNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height/2+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX("+this.PI+"rad)"),this.addCloneAttr()},downFlap:function(){this.endRotate=this.PI,this.middlePosition=this.startObj.y+this.r/2,this.hack?(this.toNode.style.clip="rect(0px "+this.width+"px "+(this.height/2+1)+"px 0px)",this.fromNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.clip="rect("+(this.height/2-1)+"px "+this.width+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(3.141592653589793rad)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width+"px "+(this.height/2+1)+"px 0px)"):(this.toNode.style.clip="rect(0px "+this.width+"px "+this.height/2+"px 0px)",this.fromNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.clip="rect("+this.height/2+"px "+this.width+"px "+this.height+"px 0px)",this.toNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(3.141592653589793rad)",this.fromNodeCloneNode.style.clip="rect(0px "+this.width+"px "+this.height/2+"px 0px)"),this.fromNodeCloneNode.style.webkitTransform="perspective(1200px) rotateX(0rad)",this.container.appendChild(this.toNodeCloneNode),this.container.appendChild(this.fromNodeCloneNode),this.fromNodeFlapShadow=$('<div class="flap-shadowY flat down" style="opacity: 0;"></div>')[0],this.toNodeFlapShadow=$('<div class="flap-shadowY flat up" style="opacity: 0.7;"></div>')[0],this.fromNodeCloneNodeFlapShadow=$('<div class="flap-shadowY flap-gradient bottom" style="opacity: 0;width:'+this.width+"px;height:"+this.height/2+'px;"></div>')[0],this.toNodeCloneNodeFlapShadow=$('<div class="flap-shadowY flap-gradient top" style="opacity: '+this.shadowOpacity+";width:"+this.width+"px;height:"+this.height/2+'px;"></div>')[0],this.fromNode.appendChild(this.fromNodeFlapShadow),this.toNode.appendChild(this.toNodeFlapShadow),this.fromNodeCloneNode.appendChild(this.fromNodeCloneNodeFlapShadow),this.toNodeCloneNode.appendChild(this.toNodeCloneNodeFlapShadow),this.addCloneAttr()}},"undefined"==typeof require?(window._g||(window._g={}),window._g.transition=s):define("_g/transition2",["_g/base","jquery.transit","_g/transitionargs"],function(){return window._g.transition=s,window._g.transition})}(window),function(){var e=function(e){this.init(e)};e.prototype={init:function(e){var t={body:"window",containment:".touchslide",slidesclass:".slides",groupclass:".group",itemclass:".Presentation",width:1024,height:768,overview:!0,controls:!0,progress:!0,slideNumber:!1,history:!1,disableHistoryStart:!1,keyboard:!0,overview:!0,center:!0,touch:!0,loop:!1,rtl:!1,fragments:!0,mouseWheel:!1,hideAddressBar:!0,previewLinks:!1,transition:0,transitionSpeed:"default",onReady:null,onSlideChange:null,canDragX:null,canDragY:null,canDragEnd:null,adapt:!1,screen_mode:1,show_excontent:!1,continuous:!1};if(this.options=e?$.extend(!0,{},t,e):t,_g.browserSupport({msie:9})||(this.options.canDragX=this.options.canDragY=function(){return!1}),_.bindAll(this),this._initVaribles(),this._initControls(),this._initScreenSet(),this._initSlideItems(),this.transition=new _g.transition({type:this.options.transition,containment:this.slideContent,control:!1,onEnd:this._complete,onStopPlay:this._onStopPlay,onCancel:this._cancel,duration:700,shadowOpacity:.3,rad:.1}),this._initSlideStyle(),this.options.onReady){var i=3==this.slideType?this.indexes[0][0]:this.indexes[0];this.options.onReady(this,i)}return this.options.controls&&(this._bindControllers(),this.setControllers()),this.options.progress&&this.setProgressBar(),this.options.keyboard&&this._bindKeyboard(),this.options.mouseWheel&&this._bindMouseWheel(),this.options.history&&this._bindRoute(),this},_bindRoute:function(){var e=this,t=Backbone.Router.extend({routes:{"page/:query":"page"}});this.Router=new t,this.Router.on("route:page",function(t){var i=e.getSlidePositionById(t);i&&e.slide(i.h,i.v)});var i=!1;e.options.disableHistoryStart&&(i=!0),e.options.disableHistoryStart||(Backbone.history.start({silent:i}),this.Router.navigate("page/"+this.getCurrentSlideId()))},_initVaribles:function(){this.indexv=0,this.indexh=0,this.currentSlideDirection=null,this.dragstart=!1,this.dragging=!1,this.sliding=!1},_initControls:function(){var e=this,t=0,i=0;this.hammertime=$(this.options.containment).hammer().on("dragstart",function(t){return interaction_view.stopDragging?void 0:e.sliding?(t.gesture.preventDefault(),!1):void((!e.options.canDrag||e.options.canDrag(t))&&(e.dragstart=!0,e._doStartEvent(t)))}),$(this.options.containment).hammer().on("drag",function(t){return e.sliding?(t.gesture.preventDefault(),!1):void 0}),$(this.options.containment).hammer().on("dragleft",function(i){if(console.log("------dragleft"),e.sliding)return i.gesture.preventDefault(),!1;if(!interaction_view.stopDragging){if(null==e.currentSlideDirection&&(e.currentSlideDirection=1),e.dragLock||interaction_view.events.onPageSwipeEvent(38,interaction_view.currentPage))return e.dragLock=!0,i.gesture.preventDefault(),e.dragstart=!1,!1;if(e.dragLock||e.options.continuous&&e.continuous("left"))return e.dragLock=!0,i.gesture.preventDefault(),!1;if(!e.options.canDragX||e.options.canDragX(i))return e._testSlideDragEventAccess(i)?(e.dragstart=!0,$.zoom&&1!=$.zoom&&(i.gesture.deltaX=i.gesture.deltaX/$.zoom),t=i.gesture.deltaX,e.options.smooth||e._doDragingEvent(i),i.gesture.preventDefault(),!1):void i.gesture.preventDefault()}}),$(this.options.containment).hammer().on("dragright",function(i){if(console.log("------dragright"),e.sliding)return i.gesture.preventDefault(),!1;if(!interaction_view.stopDragging){if(null==e.currentSlideDirection&&(e.currentSlideDirection=1),e.dragLock||interaction_view.events.onPageSwipeEvent(39,interaction_view.currentPage))return e.dragLock=!0,e.dragstart=!1,i.gesture.preventDefault(),!1;if(e.dragLock||e.options.continuous&&e.continuous("right"))return e.dragLock=!0,i.gesture.preventDefault(),!1;if(!e.options.canDragX||e.options.canDragX(i))return e._testSlideDragEventAccess(i)?(e.dragstart=!0,$.zoom&&1!=$.zoom&&(i.gesture.deltaX=i.gesture.deltaX/$.zoom),t=i.gesture.deltaX,e.options.smooth||e._doDragingEvent(i),i.gesture.preventDefault(),!1):(i.gesture.preventDefault(),!1)}}),$(this.options.containment).hammer({drag_lock_to_axis:!0}).on("dragup",function(t){if(e.sliding)return t.gesture.preventDefault(),!1;if(console.log("------dragup"),!interaction_view.stopDragging){if(console.log("dragup"),null==e.currentSlideDirection&&(e.currentSlideDirection=2),e.dragLock||interaction_view.events.onPageSwipeEvent(36,interaction_view.currentPage))return e.dragLock=!0,e.dragstart=!1,t.gesture.preventDefault(),!1;if(e.dragLock||e.options.continuous&&e.continuous("up"))return e.dragLock=!0,t.gesture.preventDefault(),!1;if(!e.options.canDragY||e.options.canDragY(t))return e._testSlideDragEventAccess(t)?(e.dragstart=!0,$.zoom&&1!=$.zoom&&(t.gesture.deltaY=t.gesture.deltaY/$.zoom),i=t.gesture.deltaY,e.options.smooth||e._doDragingEvent(t),t.gesture.preventDefault(),!1):(t.gesture.preventDefault(),!1)}}),$(this.options.containment).hammer({drag_lock_to_axis:!0}).on("dragdown",function(t){if(e.sliding)return t.gesture.preventDefault(),!1;if(console.log("------dragdown"),!interaction_view.stopDragging){if(console.log("dragdown"),null==e.currentSlideDirection&&(e.currentSlideDirection=2),e.dragLock||interaction_view.events.onPageSwipeEvent(37,interaction_view.currentPage))return e.dragLock=!0,e.dragstart=!1,t.gesture.preventDefault(),!1;if(e.dragLock||e.options.continuous&&e.continuous("down"))return e.dragLock=!0,t.gesture.preventDefault(),!1;if(!e.options.canDragY||e.options.canDragY(t))return e._testSlideDragEventAccess(t)?(e.dragstart=!0,$.zoom&&1!=$.zoom&&(t.gesture.deltaY=t.gesture.deltaY/$.zoom),i=t.gesture.deltaY,e.options.smooth||e._doDragingEvent(t),t.gesture.preventDefault(),!1):(t.gesture.preventDefault(),!1)}}),$(this.options.containment).hammer().on("dragend",function(n){if(!interaction_view.stopDragging&&(console.log("slide is dragended"),e.dragstart||(e.currentSlideDirection=null),e.dragLock=!1,(!e.options.canDrag||e.options.canDrag(n))&&(e.options.canDragEnd&&e.options.canDragEnd(n),e._testSlideDragEventAccess(n)))){if(1==e.currentSlideDirection&&t||2==e.currentSlideDirection&&i)if(e.options.smooth){var a=e.getSlideDirections(),o=1==e.currentSlideDirection?"x":"y";e.originh=e.indexh,e.originv=e.indexv;var r=!0;if(1==e.currentSlideDirection){var s=t/Math.abs(t);0>s&&!a.right?r=!1:s>0&&!a.left?r=!1:(e._onStopPlay(),e.indexh=0>s?e.indexh+1:e.indexh-1,e.indexv=0)}else{var s=i/Math.abs(i);0>s&&!a.down?r=!1:s>0&&!a.up?r=!1:(e._onStopPlay(),e.indexv=0>s?e.indexv+1:e.indexv-1)}r&&e.transition.autostart(e.options.transition,o,s)}else $.zoom&&1!=$.zoom&&(2==e.currentSlideDirection&&i&&(n.gesture.deltaY=n.gesture.deltaY/$.zoom),1==e.currentSlideDirection&&t&&(n.gesture.deltaX=n.gesture.deltaX/$.zoom)),e._doDragEndEvent(n);return e.dragstart=!1,e.currentSlideDirection=null,t=0,i=0,n.gesture.preventDefault(),!1}}),$(this.options.containment).on("touchend",function(){console.log("slide is touchended")})},_initSlideItems:function(){var e=0,t=0,i=this,n=[];if(this.slideItems=[],this.slideIds={},this.slideIdsArray=[],0==this.slideContent.children(".slideTempContainer").length&&this.slideContent.append('<div class="slideTempContainer" style="position:absolute;left:-99999px;top:-99999px;"></div>'),this.slideContent.hasClass("c-transition-containment")||this.slideContent.addClass("c-transition-containment"),this.slideTempContainer=this.slideContent.children(".slideTempContainer"),this.slideContent.children(this.options.groupclass).length>0){this.slideType=3,this.slideContent.children(this.options.groupclass).each(function(){n[t]=[],i.slideItems[t]=[],$(this).children(i.options.itemclass).each(function(){var a=$(this).attr("id");n[t][e]=a||1,i.slideItems[t][e]=this,a&&(i.slideIds[a]={h:t,v:e},i.slideIdsArray.push(a)),e+=1}),t+=1,e=0});var a=this.slideContent.children(this.options.groupclass).detach();this.slideTempContainer.append(a)}else{this.slideType=1,this.slideContent.children(this.options.itemclass).each(function(){var e=$(this).attr("id");n[t]=$(this).attr("id")||1,i.slideItems[t]=this,e&&(i.slideIds[e]={h:t,v:null},i.slideIdsArray.push(e)),t+=1});var a=this.slideContent.children(this.options.itemclass).detach();this.slideTempContainer.append(a)}this.indexes=n,this.options.continuous&&(this.options.continuous=1==this.slideType?1:this.indexes[this.indexes.length-1]&&this.indexes[this.indexes.length-2]&&1==this.indexes[this.indexes.length-1].length&&1==this.indexes[this.indexes.length-2].length?1:2),this.options.show_overview&&this._drawOverview()},_initSlideStyle:function(){var e=this;this.slideContent.find(this.options.itemclass).each(function(){$(this).css({width:"100%",height:"100%"}),$(this).children(".interaction-area").css({width:"100%",height:"100%"}),$(this).addClass("c-transition-item")}),this.setSlideItems(),e.setAdaptSlideItems()},_initScreenSet:function(){this.slideScreenWidth=this.options.width,this.slideScreenHeight=this.options.height,this.slideWidth=this.options.width,this.slideHeight=this.options.height,this.slideContainment=$(this.options.containment),this.slideContent=$(this.options.containment).find(this.options.slidesclass).first(),0==this.slideContainment.children(".slides-wrap").length&&this.slideContent.wrap('<div class="slides-wrap" style="position:absolute;width:100%;height:100%;left:0;top:0;z-index:1000;"></div>'),this.slideWrap=this.slideContainment.children(".slides-wrap"),this.slideContainment.css({width:this.slideScreenWidth,height:this.slideScreenHeight}),this.slideContent.css({width:this.slideScreenWidth,height:this.slideScreenHeight}),this.slideGroup=this.slideContent.children(),this.options.adapt&&(this.adapt=!0),this.setAdaptScreen()},sendSlide2Content:function(e){var t=$(e).detach();this.slideContent.append(t)},sendSlide2Temp:function(e){var t=$(e).detach();this.slideTempContainer.append(t)},setSingleSlideItem:function(e,t,i){this.slideContent.find(this.options.itemclass).removeClass("c-transition-"+i),this.slideItem=this.getSlideItem(e,t),$(this.slideItem).addClass("c-transition-"+i),$(this.slideItem).parent().is(this.slideContent)||this.sendSlide2Content(this.slideItem)},setSlideItems:function(){var e=this;this.currentItem=this.getCurrentSlide(),this.leftItem=null,this.rightItem=null,this.upItem=null,this.downItem=null;var t=[];t.push(this.getCurrentSlideId()),$(this.currentItem).parent().is(this.slideContent)||this.sendSlide2Content(this.currentItem);var i=this.getSlideDirections();i.left&&(t.push(this.getLeft()),this.leftItem=this.getSlideItemById(this.getLeft()),$(this.leftItem).parent().is(this.slideContent)||this.sendSlide2Content(this.leftItem),$(this.currentItem).attr("data-left","1")),i.right&&(t.push(this.getRight()),this.rightItem=this.getSlideItemById(this.getRight()),$(this.rightItem).parent().is(this.slideContent)||this.sendSlide2Content(this.rightItem),$(this.currentItem).attr("data-right","1")),3==this.slideType&&(i.up&&(t.push(this.getUp()),this.upItem=this.getSlideItemById(this.getUp()),$(this.upItem).parent().is(this.slideContent)||this.sendSlide2Content(this.upItem),$(this.currentItem).attr("data-up","1")),i.down&&(t.push(this.getDown()),this.downItem=this.getSlideItemById(this.getDown()),$(this.downItem).parent().is(this.slideContent)||this.sendSlide2Content(this.downItem),$(this.currentItem).attr("data-down","1"))),this.slideContent.children(this.options.itemclass).each(function(){var i=$(this).attr("id");
_.include(t,i)||e.sendSlide2Temp(this)}),this.slideContent.find(".c-transition-item").each(function(){this.id!=e.currentItem.id&&$(this).removeClass("c-transition-current"),$(this).removeClass("c-transition-left").removeClass("c-transition-right").removeClass("c-transition-up").removeClass("c-transition-down")}),$(this.currentItem).addClass("c-transition-current"),this.rightItem&&$(this.rightItem).addClass("c-transition-right"),this.leftItem&&$(this.leftItem).addClass("c-transition-left"),this.upItem&&$(this.upItem).addClass("c-transition-up"),this.downItem&&$(this.downItem).addClass("c-transition-down")},setAdaptScreen:function(){if(this.options.adapt){var e=this._getScreenSize(),t=this._getScreenScale();0==this.options.screen_mode?(this.slideScreenWidth=e.x,this.slideScreenHeight=e.y):1==this.options.screen_mode?(t.x&&(e.x=parseInt(e.x/t.x,10)),t.y&&(e.y=parseInt(e.y/t.y,10)),t.x&&(this.slideScreenWidth=e.x>this.options.width?e.x:this.options.width,this.slideScreenHeight=this.options.height),t.y&&(this.slideScreenHeight=e.y>this.options.height?e.y:this.options.height,this.slideScreenWidth=this.options.width)):(t.y&&(e.x=parseInt(e.x/t.y,10)),t.x&&(e.y=parseInt(e.y/t.x,10)),t.y&&(this.slideScreenWidth=e.x<this.options.width?e.x:this.options.width,this.slideScreenHeight=this.options.height),t.x&&(this.slideScreenHeight=e.y<this.options.height?e.y:this.options.height,this.slideScreenWidth=this.options.width)),this.slideContainment.css({width:this.slideScreenWidth+2,height:this.slideScreenHeight}),this.slideContent.css({width:this.slideScreenWidth+2,height:this.slideScreenHeight}),this.slideContent.find(".Presentation").css({overflow:"hidden"}),this.options.show_excontent&&this.slideContent.find(".interaction-view").css({overflow:"visible"}),this.slideWrap.css({overflow:"hidden"}),this.slideContainment.css({overflow:"visible"})}else if(2==this.options.screen_mode){var e=this._getScreenSize(),t=this._getScreenScale();t.y&&(e.x=parseInt(e.x/t.y,10)),t.x&&(e.y=parseInt(e.y/t.x,10)),t.y&&(this.slideScreenWidth=e.x<this.options.width?e.x:this.options.width,this.slideScreenHeight=this.options.height),t.x&&(this.slideScreenHeight=e.y<this.options.height?e.y:this.options.height,this.slideScreenWidth=this.options.width),this.slideContainment.css({width:this.slideScreenWidth,height:this.slideScreenHeight}),this.slideContent.css({width:this.slideScreenWidth,height:this.slideScreenHeight}),this.slideContent.find(".Presentation").css({overflow:"hidden"}),this.slideWrap.css({overflow:"hidden"}),this.slideContainment.css({overflow:"visible"})}},setAdaptSlideItems:function(){var e=(this._getScreenScale(),(this.slideScreenWidth-this.slideWidth)/2),t=(this.slideScreenHeight-this.slideHeight)/2;this.slideContent.find(".interaction-area").css({"margin-left":e}),this.slideContent.find(".interaction-area").css({"margin-top":t})},_getScreenSize:function(){var e,t;if(interaction_view.isWeixin&&_g.device.ios())return{x:$(window).width(),y:$(window).height()};if("window"==this.options.body){var i=window,n=document,a=n.documentElement,o=n.getElementsByTagName("body")[0];e=i.innerWidth||a.clientWidth||o.clientWidth,t=i.innerHeight||a.clientHeight||o.clientHeight}else e=parseInt($(this.options.body).css("width"),10),t=parseInt($(this.options.body).css("height"),10);return{x:e,y:t}},_getScreenScale:function(){var e=this._getScreenSize(),t=e.x,i=e.y,n=this.options.width,a=this.options.height,o=null;o=n>=a?t/i>=n/a?i/a:t/n:i/t>a/n?t/n:i/a,$.zoom&&(o=$.zoom);var r;return r=t/i>=n/a?{x:o,y:null}:{x:null,y:o}},_bindControllers:function(){var e=this;$(".action-control").children("button").on("click",function(){$(this).hasClass("enabled")&&($(this).hasClass("navigate-right")&&e.next(),$(this).hasClass("navigate-left")&&e.prev(),$(this).hasClass("navigate-up")&&e.up(),$(this).hasClass("navigate-down")&&e.down())})},_bindKeyboard:function(){var e=this;$(document).on("keydown",function(t){var i=!1,n=e.getSlideDirections();37==t.keyCode&&n.left&&(e.options.onKeyboard&&e.options.onKeyboard(),e.prev(),i=!0),38==t.keyCode&&n.up&&(e.options.onKeyboard&&e.options.onKeyboard(),e.up(),i=!0),39==t.keyCode&&n.right&&(e.options.onKeyboard&&e.options.onKeyboard(),e.next(),i=!0),40==t.keyCode&&n.down&&(e.options.onKeyboard&&e.options.onKeyboard(),e.down(),i=!0),27==t.keyCode&&e.options.overview&&e.options.show_controlbar&&e.toggleOverview(e.show_overview?!1:!0),i&&t.preventDefault()})},_bindMouseWheel:function(){var e=this,t=0,i=0;e.wheelLock=!1,e.wheelEventLock=!1,$(this.options.containment).addClass("iMouseWheel enableMouseWheel"),$(this.options.containment).on("wheelstart",function(t){console.log("wstart"),$(t.target).is(this)&&(e.sliding||e.wheelLock||(e.wheelstart=!0))}),$(this.options.containment).on("wheelleft",function(i,n){if($(i.target).is(this)){var a=_g.mousewheel.getMouseWheel(n),o=a.x,r=Math.max(-1,Math.min(1,o||0));null==e.currentSlideDirection&&(e.currentSlideDirection=1);var s=parseInt(e.slideScreenWidth/25,10);if(t+=r/Math.abs(r)*s,i.gesture={deltaX:-1},-100>t&&(e.wheelEventLock||interaction_view.events.onPageSwipeEvent(38,interaction_view.currentPage)))return e.wheelEventLock=!0,void(t=0);if(-100>t&&(e.wheelEventLock||e.options.continuous&&e.continuous("left")))return e.wheelEventLock=!0,t=0,!1;if(e._testSlideDragEventAccess(i)&&(e.wheelstart=!0,_g.mousewheel.currentTarget=$(e.options.containment),-100>t&&!e.wheelLock)){var l=e.getSlideDirections();if(!l.right)return;e.options.onWheel&&e.options.onWheel(),e.wheelLock=!0,e.originh=e.indexh,e.originv=e.indexv,e.indexh=e.indexh+1,e.indexv=0,e.transition.autostart(e.options.transition,"x",i.gesture.deltaX)}}}),$(this.options.containment).on("wheelright",function(i,n){if($(i.target).is(this)){var a=_g.mousewheel.getMouseWheel(n),o=a.x,r=Math.max(-1,Math.min(1,o||0));null==e.currentSlideDirection&&(e.currentSlideDirection=1);var s=parseInt(e.slideScreenWidth/25,10);if(t+=r/Math.abs(r)*s,i.gesture={deltaX:1},t>100&&(e.wheelEventLock||interaction_view.events.onPageSwipeEvent(39,interaction_view.currentPage)))return e.wheelEventLock=!0,void(t=0);if(t>100&&(e.wheelEventLock||e.options.continuous&&e.continuous("right")))return e.wheelEventLock=!0,t=0,!1;if(e._testSlideDragEventAccess(i)&&(e.wheelstart=!0,_g.mousewheel.currentTarget=$(e.options.containment),t>100&&!e.wheelLock)){var l=e.getSlideDirections();if(!l.left)return;e.options.onWheel&&e.options.onWheel(),e.wheelLock=!0,e.originh=e.indexh,e.originv=e.indexv,e.indexh=e.indexh-1,e.indexv=0,e.transition.autostart(e.options.transition,"x",i.gesture.deltaX)}}}),$(this.options.containment).on("wheelup",function(t,n){if(console.log(t.currentTarget),$(t.target).is(this)){var a=_g.mousewheel.getMouseWheel(n),o=a.y,r=Math.max(-1,Math.min(1,o));null==e.currentSlideDirection&&(e.currentSlideDirection=2);var s=parseInt(e.slideScreenHeight/25,10);if(i+=r/Math.abs(r)*s,t.gesture={deltaY:-1},-50>i&&(e.wheelEventLock||interaction_view.events.onPageSwipeEvent(36,interaction_view.currentPage)))return e.wheelEventLock=!0,void(i=0);if(-50>i&&(e.wheelEventLock||e.options.continuous&&e.continuous("up")))return e.wheelEventLock=!0,i=0,!1;if(e._testSlideDragEventAccess(t)&&(e.dragstart=!0,_g.mousewheel.currentTarget=$(e.options.containment),-50>i&&!e.wheelLock)){var l=e.getSlideDirections();if(!l.down)return;e.options.onWheel&&e.options.onWheel(),e.wheelLock=!0,e.originh=e.indexh,e.originv=e.indexv,e.indexv+=1,e.transition.autostart(e.options.transition,"y",t.gesture.deltaY)}}}),$(this.options.containment).on("wheeldown",function(t,n){if($(t.target).is(this)){var a=_g.mousewheel.getMouseWheel(n),o=(a.y,Math.max(-1,Math.min(1,n.wheelDeltaY)));null==e.currentSlideDirection&&(e.currentSlideDirection=2);var r=parseInt(e.slideScreenHeight/25,10);if(i+=o/Math.abs(o)*r,t.gesture={deltaY:1},i>50&&(e.wheelEventLock||interaction_view.events.onPageSwipeEvent(38,interaction_view.currentPage)))return e.wheelEventLock=!0,void(i=0);if(i>50&&(e.wheelEventLock||e.options.continuous&&e.continuous("down")))return e.wheelEventLock=!0,i=0,!1;if(e._testSlideDragEventAccess(t)&&(e.wheelstart=!0,_g.mousewheel.currentTarget=$(e.options.containment),i>50&&!e.wheelLock)){var s=e.getSlideDirections();if(!s.up)return;e.options.onWheel&&e.options.onWheel(),e.wheelLock=!0,e.originh=e.indexh,e.originv=e.indexv,e.indexv-=1,e.transition.autostart(e.options.transition,"y",t.gesture.deltaY)}}}),$(this.options.containment).on("wheelend",function(n){console.log("wend"),$(n.target).is(this)&&(e.wheelstart||(e.currentSlideDirection=null),e.wheelEventLock=!1,e.wheelstart=!1,e.wheelLock=!1,e.currentSlideDirection=null,t=0,i=0)})},_bindOverviewEvents:function(){var e=this;this.touchoverviewelement.hammer().on("tap",function(t){if(console.log(t.target),$(t.target).is(".touchslide_overview_item")){var i=$(t.target).attr("data-indexh"),n=$(t.target).attr("data-indexv");i&&n&&e.slide(Number(i),Number(n))}return e.toggleOverview(!1),!1})},_drawOverview:function(){var e=this,t=this._getScreenSize(),n=this.slideScreenWidth/this.slideScreenHeight,a=parseInt(t.x/4<250?t.x/4:250,10),o=parseInt(a/n,10);if(this.overview_width=a,this.overview_height=o,$("body").append('<div class="touchslide_overview disableMouseWheel iMouseWheel" style="width:100%;height:100%;position:absolute;left:0;z-index:10000;overflow:auto;top:0;display:none;"></div>'),this.touchoverviewelement=$("body").children(".touchslide_overview"),this.touchoverviewelement.append('<div class="touchslide_overview_container"></div>'),this.touchoverviewcontainerel=this.touchoverviewelement.children(".touchslide_overview_container"),this.touchoverviewcontainerel.append('<div class="touchslide_overview_wrap disableMouseWheel iMouseWheel"></div>'),this.touchoverviewel=this.touchoverviewcontainerel.children(".touchslide_overview_wrap"),this.touchoverviewel.css("top",0),this.touchoverviewcontainerel.css({width:a+"px",height:o+"px","margin-left":"-"+a/2+"px","margin-top":"-"+o/2+"px"}),3==this.slideType){for(i=0;i<this.indexes.length;i++){var r=i*a+10*i;for(e.touchoverviewel.append('<div class="touchslide_overview_group" data-index="'+i+'" style="position:absolute;left:'+r+'px;top:0;"></div>'),j=0;j<this.indexes[i].length;j++){var s=j*o+10*j,l=this.options.getOverview?this.options.getOverview(this.indexes[i][j]):null;$(e.touchoverviewel.children()[i]).append('<div class="touchslide_overview_item" data-indexh="'+i+'" data-indexv="'+j+'" style="position:absolute;top:'+s+"px;left:0;width:"+a+"px;height:"+o+'px;"></div>'),$(e.touchoverviewel.children()[i]).children('[data-indexv="'+j+'"]').css({"background-color":"#FFF",outline:"1px solid #ccc"}),l&&$(e.touchoverviewel.children()[i]).children('[data-indexv="'+j+'"]').css({"background-image":"url("+l+")","background-size":"contain","background-position":"center center","background-repeat":"no-repeat"})}}$($(e.touchoverviewel.children()[0]).children()[0]).css("outline","2px solid red")}else{for(i=0;i<this.indexes.length;i++){var r=i*a+10*i,l=this.options.getOverview?this.options.getOverview(this.indexes[i]):null;e.touchoverviewel.append('<div class="touchslide_overview_item" data-indexh="'+i+'" data-indexv="0" style="position:absolute;left:'+r+"px;bottom:0;width:"+a+"px;height:"+o+'px;top:0;"></div>'),$(e.touchoverviewel.children()[i]).css({"background-color":"#FFF",outline:"1px solid #ccc"}),l&&$(e.touchoverviewel.children()[i]).css({"background-image":"url("+l+")","background-size":"contain","background-position":"center center","background-repeat":"no-repeat"})}$(e.touchoverviewel.children()[0]).css("outline","2px solid red")}this._bindOverviewEvents()},continuous:function(e){if(!this.isLast()||"up"!=e&&"left"!=e){if(this.Ended&&this.isFirst()&&("down"==e||"right"==e)){var t=0;if("down"==e&&2==this.options.continuous)switch(this.options.transition){case 0:t=0;break;case 1:t=4;break;case 2:t=8;break;case 3:t=10;break;case 4:t=14;break;case 5:t=18}else{if("right"!=e||1!=this.options.continuous)return!1;switch(this.options.transition){case 0:t=3;break;case 1:t=7;break;case 2:t=8;break;case 3:t=13;break;case 4:t=17;break;case 5:t=21}}var i=this.getLast();return presentation.gotopage(i,t),!0}return!1}var t=0;if("up"==e&&2==this.options.continuous)switch(this.options.transition){case 0:t=2;break;case 1:t=6;break;case 2:t=8;break;case 3:t=12;break;case 4:t=16;break;case 5:t=20}else{if("left"!=e||1!=this.options.continuous)return!1;switch(this.options.transition){case 0:t=1;break;case 1:t=5;break;case 2:t=8;break;case 3:t=11;break;case 4:t=15;break;case 5:t=19}}var n=this.getFirst();return presentation.gotopage(n,t),this.Ended=!0,!0},isLast:function(){return 3==this.slideType?this.indexh==this.slideItems.length-1&&this.indexv==this.slideItems[this.indexh].length-1:this.indexh==this.slideItems.length-1},isFirst:function(){return 3==this.slideType?0==this.indexh&&0==this.indexv:0==this.indexh},toggleOverview:function(e){if(this.options.show_overview)if(e){$(".reveal").css("opacity",.1);var t=this.indexh*this.overview_width+10*this.indexh;this.touchoverviewelement.show(),this.touchoverviewelement.scrollLeft(t),this.touchoverviewelement.scrollTop(0),this.show_overview=!0}else $(".reveal").css("opacity",""),this.touchoverviewelement.hide(),this.show_overview=!1},getSlideDirections:function(){var e={left:!1,right:!1,up:!1,down:!1};return 1==this.slideType?(this.indexh>0&&(e.left=!0),this.indexh<this.indexes.length-1&&(e.right=!0)):(this.indexh>0&&(this.options.checkSlidePermission?this.options.checkSlidePermission(this,this.slideType,"left",this.indexh,this.indexv)&&(e.left=!0):e.left=!0),this.indexh<this.indexes.length-1&&(this.options.checkSlidePermission?this.options.checkSlidePermission(this,this.slideType,"right",this.indexh,this.indexv)&&(e.right=!0):e.right=!0),this.indexv>0&&(e.up=!0),this.indexv<this.indexes[this.indexh].length-1&&(e.down=!0)),e},_testSlideDragEventAccess:function(e){var t=!0;return this.dragstart||this.wheelstart?(1==this.currentSlideDirection&&("dragup"==e.type||"dragdown"==e.type||"wheelup"==e.type||"wheeldown"==e.type)&&(t=!1),2==this.currentSlideDirection&&("dragleft"==e.type||"dragright"==e.type||"wheelleft"==e.type||"wheelright"==e.type)&&(t=!1),1==this.slideType&&("dragup"==e.type||"dragdown"==e.type||"wheelup"==e.type||"wheeldown"==e.type)&&(t=!1),2==this.slideType&&("dragleft"==e.type||"dragright"==e.type||"wheelleft"==e.type||"wheelright"==e.type)&&(t=!1),("dragend"==e.type||"wheelend"==e.type)&&(this.currentSlideDirection||(t=!1))):t=!1,t},_doStartEvent:function(e){this.transition.start(e)},_doDragingEvent:function(e){{var t=this._getDragDistance(e),i=this.getSlideDirections();this.transition.opts.type}if("dragleft"==e.type||"dragright"==e.type||"wheelleft"==e.type||"wheelright"==e.type){var n=e.gesture.deltaX;if(-1!=e.type.indexOf("right")&&!i.left)return void(this.dragstart=!1);if(-1!=e.type.indexOf("left")&&!i.right)return void(this.dragstart=!1);interaction_view.transitionPagePreLoad=null,n<t.min&&(e.gesture.deltaX=t.min),n>t.max&&(e.gesture.deltaX=t.max),this.transition.dragX(e)}if("dragup"==e.type||"dragdown"==e.type||"wheelup"==e.type||"wheeldown"==e.type){if(-1!=e.type.indexOf("down")&&!i.up)return void(this.dragstart=!1);if(-1!=e.type.indexOf("up")&&!i.down)return void(this.dragstart=!1);interaction_view.transitionPagePreLoad=null;var a=e.gesture.deltaY;a<t.min&&(e.gesture.deltaY=t.min),a>t.max&&(e.gesture.deltaY=t.max),this.transition.dragY(e)}},_doDragEndEvent:function(e){var t=(this.transition.opts.type,this._getDragDistance({type:1==this.currentSlideDirection?"dragleft":"dragup"})),i=[0,0],n=!1,a=this.getSlideDirections();if(e&&e.gesture){if(1==this.currentSlideDirection){var o=e.gesture.deltaX;if(o<t.min&&(e.gesture.deltaX=t.min),o>t.max&&(e.gesture.deltaX=t.max),0!=o&&(this.originh=this.indexh,this.originv=this.indexv,0>o&&a.right&&(n=!0,this.indexh+=1),o>0&&a.left&&(n=!0,this.indexh-=1),this.indexv=0),n){var r=this.getCurrentSlideId();this.options.onSlideChangeStart&&this.options.onSlideChangeStart(r),(o>0&&a.left||0>o&&a.right)&&(this.sliding=!0,this.transition.dragEnd(e))}}if(2==this.currentSlideDirection){var s=e.gesture.deltaY;if(s<t.min&&(e.gesture.deltaY=t.min),s>t.max&&(e.gesture.deltaY=t.max),0!=s&&(this.originh=this.indexh,this.originv=this.indexv,0>s&&a.down&&(n=!0,i=[0,t.min],this.indexv+=1),s>0&&a.up&&(n=!0,i=[0,t.max],this.indexv-=1)),n){var r=this.getCurrentSlideId();this.options.onSlideChangeStart&&this.options.onSlideChangeStart(r),(s>0&&a.up||0>s&&a.down)&&(this.sliding=!0,this.transition.dragEnd(e))}}n||this.transition.recoveritemClass()}},_complete:function(){var e=this;this.slideContent.find(".c-transition-item").removeClass("c-transition-left").removeClass("c-transition-right").removeClass("c-transition-up").removeClass("c-transition-down").removeClass("c-transition-active"),console.log(e.indexh,e.originh);var t=3==e.slideType?e.indexes[e.indexh][e.indexv]:e.indexes[e.indexh],i=3==e.slideType?e.indexes[e.originh][e.originv]:e.indexes[e.originh];e.preStoped=!1,e.sliding=!1,e.onSlideChange(t,i)},_cancel:function(){var e=this;this.indexh=this.originh,this.indexv=this.originv,7==e.transition.opts.type&&this.slideContent.find(".c-transition-item").removeClass("c-transition-active"),this.slideContent.find(".c-transition-item").removeClass("c-transition-left").removeClass("c-transition-right").removeClass("c-transition-up").removeClass("c-transition-down"),this.setSlideItems(),e.sliding=!1;var t=3==e.slideType?e.indexes[e.indexh][e.indexv]:e.indexes[e.indexh];this.options.onContinuePlay&&this.options.onContinuePlay(t)},_getDragDistance:function(e){var t={min:0,max:0},i=this.getSlideDirections();return("dragleft"==e.type||"dragright"==e.type||"wheelleft"==e.type||"wheelright"==e.type)&&(i.right&&(t.min=-this.slideScreenWidth),i.left&&(t.max=this.slideScreenWidth)),("dragup"==e.type||"dragdown"==e.type||"wheelup"==e.type||"wheeldown"==e.type)&&(i.down&&(t.min=-this.slideScreenHeight),i.up&&(t.max=this.slideScreenHeight)),t},_getCurrentPosition:function(){var e=-this.indexh*this.slideScreenWidth,t=-this.indexv*this.slideScreenHeight;return{x:e,y:t}},isOverview:function(){return!1},getSlideItem:function(e,t){return 3==this.slideType?this.slideItems[e][t]:this.slideItems[e]},getSlideItemById:function(e){var t=this.getSlidePositionById(e);return t?3==this.slideType?this.slideItems[t.h][t.v]:this.slideItems[t.h]:null},getCurrentSlide:function(){return 3==this.slideType?this.slideItems[this.indexh][this.indexv]:this.slideItems[this.indexh]},getCurrentSlideId:function(){return 3==this.slideType?this.indexes[this.indexh][this.indexv]:this.indexes[this.indexh]},getIndices:function(){return{h:this.indexh,v:this.indexv}},getAllSlideIds:function(){return this.slideIdsArray},getFirst:function(){var e=this.getAllSlideIds();return e?e[0]:null},getLast:function(){var e=this.getAllSlideIds();return e?e[e.length-1]:null},getRight:function(){return this.getSlideDirections().right?3==this.slideType?this.indexes[this.indexh+1][0]:this.indexes[this.indexh+1]:null},getLeft:function(){return this.getSlideDirections().left?3==this.slideType?this.indexes[this.indexh-1][0]:this.indexes[this.indexh-1]:null},getUp:function(){return this.getSlideDirections().up&&3==this.slideType?this.indexes[this.indexh][this.indexv-1]:null},getDown:function(){return this.getSlideDirections().down&&3==this.slideType?this.indexes[this.indexh][this.indexv+1]:null},getPrev:function(){return this.getSlideDirections().up?this.getUp():"object"==typeof this.indexes[this.indexh-1]&&this.indexes[this.indexh-1][0]?_.last(this.indexes[this.indexh-1]):this.indexes[this.indexh-1]},getNext:function(){var e;return e=this.getSlideDirections().down?this.getDown():this.getRight(),!e&&Reveal.indexes.length>this.indexh+1&&(e=this.indexes[this.indexh+1][0]),e},getSlidePositionById:function(e){var t=this.slideIds[e];return t},getVerticalLength:function(){return 3==this.slideType?this.indexes[this.indexh].length:1},getHorizontalLength:function(){return this.indexes.length},slide:function(e,t){if(void 0!=e&&(e!=this.indexh||t!=this.indexv)){var i=this.getCurrentSlideId();this.indexh=e,this.indexv=t?t:0;var n=(e*this.slideScreenWidth,t?t*this.slideScreenHeight:0,this.getCurrentSlideId());this.onSlideChange(n,i)}},setControllers:function(){var e=this.getSlideDirections();$(".action-control").children("button").removeClass("enabled"),e.right&&$(".action-control").children(".navigate-right").addClass("enabled"),e.left&&$(".action-control").children(".navigate-left").addClass("enabled"),e.up&&$(".action-control").children(".navigate-up").addClass("enabled"),e.down&&$(".action-control").children(".navigate-down").addClass("enabled")},setProgressBar:function(){var e=parseInt((this.indexh+1)/this.indexes.length*100,10);$(".controlbar").children(".progress").children("span").css({width:e+"%"})},onSlideChange:function(e,t){var i=this;this.setSlideItems(),this.previousSlide=t,this.currentSlide=e,this.options.history&&this.Router.navigate("page/"+e),i.options.onSlideChange&&i.options.onSlideChange(i.currentSlide,i.previousSlide),i.options.controls&&i.setControllers(),i.options.progress&&i.setProgressBar()},_onStopPlay:function(){if(!this.preStoped){var e=this,t=3==e.slideType?e.indexes[e.indexh][e.indexv]:e.indexes[e.indexh];this.options.onStopPlay&&this.options.onStopPlay(t),this.preStoped=!0}},prev:function(){0==this.indexh||this.indexes.length<2||this.slide(this.indexh-1)},next:function(){this.indexh==this.indexes.length-1||this.indexes.length<2||this.slide(this.indexh+1)},up:function(){3==this.slideType&&this.indexes[this.indexh][this.indexv-1]&&this.slide(this.indexh,this.indexv-1)},down:function(){3==this.slideType&&this.indexes[this.indexh][this.indexv+1]&&this.slide(this.indexh,this.indexv+1)},changeOverview:function(e,t){if(this.options.show_overview){var i=t?t*this.overview_height+10*t:0;$(this.touchoverviewel).find(".touchslide_overview_item").css("outline","1px solid #ccc"),3==this.slideType?($($(this.touchoverviewel.children()[this.indexh]).children()[this.indexv]).css("outline","2px solid red"),this.touchoverviewel.children().css("top",0),this.touchoverviewel.children().eq(e).css({top:-i})):$(this.touchoverviewel.children()[this.indexh]).css("outline","2px solid red")}}},"undefined"==typeof require?(window._g||(window._g={}),window._g.touchslide=e):define("_g/touchslide2",["_g/base","_g/touch","jquery.hammer","underscore","jquery.transit","backbone","_g/keyboard","_g/transition2"],function(){return window._g.touchslide=e,window._g.touchslide})}(window),function(){var e,t,i,n,a,o,r,s,l,c={};t=window.document.documentElement,l=window.navigator.userAgent.toLowerCase(),c.ios=function(){return c.iphone()||c.ipod()||c.ipad()},c.iphone=function(){return i("iphone")},c.ipod=function(){return i("ipod")},c.ipad=function(){return i("ipad")},c.android=function(){return i("android")},c.androidPhone=function(){return c.android()&&i("mobile")},c.androidTablet=function(){return c.android()&&!i("mobile")},c.blackberry=function(){return i("blackberry")||i("bb10")||i("rim")},c.blackberryPhone=function(){return c.blackberry()&&!i("tablet")},c.blackberryTablet=function(){return c.blackberry()&&i("tablet")},c.windows=function(){return i("windows")},c.mac=function(){return i("mac")},c.linux=function(){return i("linux")},c.windowsPhone=function(){return c.windows()&&i("phone")},c.windowsTablet=function(){return c.windows()&&i("touch")},c.fxos=function(){return(i("(mobile;")||i("(tablet;"))&&i("; rv:")},c.fxosPhone=function(){return c.fxos()&&i("mobile")},c.fxosTablet=function(){return c.fxos()&&i("tablet")},c.meego=function(){return i("meego")},c.mobile=function(){return c.androidPhone()||c.iphone()||c.ipod()||c.windowsPhone()||c.blackberryPhone()||c.fxosPhone()||c.meego()},c.tablet=function(){return c.ipad()||c.androidTablet()||c.blackberryTablet()||c.windowsTablet()||c.fxosTablet()},c.msie=function(){return $.browser.msie||!!navigator.userAgent.match(/Trident\/7\./)},c.portrait=function(){return 90!==Math.abs(window.orientation)},c.landscape=function(){return 90===Math.abs(window.orientation)},c.noConflict=function(){return this},c.svg=function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")},c.online=function(e,t,i){var n=new Image;n.onload=function(){console.log("online"),t&&t.constructor==Function&&t()},n.onerror=function(){console.log("offline"),i&&i.constructor==Function&&i()},n.src=e+"?t="+_g.uuid()},c.screenSize=function(){var e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0],a=e.innerWidth||i.clientWidth||n.clientWidth,o=e.innerHeight||i.clientHeight||n.clientHeight;return{x:a,y:o}},c.isWeixin=function(){var e=navigator.userAgent.toLowerCase();return/micromessenger/.test(e)?!0:!1},i=function(e){return-1!==l.indexOf(e)},a=function(e){var i;return i=new RegExp(e,"i"),t.className.match(i)},e=function(e){return a(e)?void 0:t.className+=" "+e},r=function(e){return a(e)?t.className=t.className.replace(e,""):void 0};var d=function(){c.ios()?c.ipad()?e("ios ipad tablet"):c.iphone()?e("ios iphone mobile"):c.ipod()&&e("ios ipod mobile"):e(c.android()?c.androidTablet()?"android tablet":"android mobile":c.blackberry()?c.blackberryTablet()?"blackberry tablet":"blackberry mobile":c.windows()?c.windowsTablet()?"windows tablet":c.windowsPhone()?"windows mobile":"desktop":c.fxos()?c.fxosTablet()?"fxos tablet":"fxos mobile":c.meego()?"meego mobile":"desktop")};n=function(){return c.landscape()?(r("portrait"),e("landscape")):(r("landscape"),e("portrait"))},s="onorientationchange"in window,o=s?"orientationchange":"resize",window.addEventListener?window.addEventListener(o,n,!1):window.attachEvent?window.attachEvent(o,n):window[o]=n,n(),c.initDom=d,window._g_device=c,"undefined"==typeof require?(window._g||(window._g={}),window._g.device=_g_device):define("_g/device",["_g/base"],function(){return window._g.device=_g_device,window._g.device})}(window),function(){var e={support:function(){},init:function(){_g.mousewheel.wheelstart=!1,_g.mousewheel.wheeltimer=null,_g.mousewheel.checkflag=!1,_g.mousewheel.preventDefault=!0,_g.mousewheel.direction=null,_g.mousewheel.direction_lock=!0,_g.mousewheel.currentTarget=null,_g.mousewheel.mouseWheelSpeed=20;var e=function(e){if(!_g.mousewheel.disabled){_g.mousewheel.e=e;var t=_g.mousewheel.getMouseWheel(e),i=t.x,n=t.y;if(void 0!=i||void 0!=n)return _g.mousewheel.direction_lock?null==_g.mousewheel.direction&&(0!=n&&(_g.mousewheel.direction=1),0!=i&&(_g.mousewheel.direction=0)):(0!=n&&(_g.mousewheel.direction=1),0!=i&&(_g.mousewheel.direction=0)),_g.mousewheel.wheelstart?(_g.mousewheel.checkflag=!1,_g.mousewheel.onWheel(e),_g.mousewheel.direction?0>n?_g.mousewheel.onWheelUp(e):_g.mousewheel.onWheelDown(e):0>i?_g.mousewheel.onWheelLeft(e):_g.mousewheel.onWheelRight(e)):(_g.mousewheel.wheelstart=!0,_g.mousewheel.onStart(e),_g.mousewheel.checkflag=!0,_g.mousewheel.wheeltimer=window.setInterval(function(){_g.mousewheel.checkflag?(_g.mousewheel.checkflag=!1,_g.mousewheel.wheelstart=!1,window.clearInterval(_g.mousewheel.wheeltimer),_g.mousewheel.onEnd(_g.mousewheel.e),_g.mousewheel.direction=null):_g.mousewheel.checkflag=!0},100)),_g.mousewheel.preventDefault?(_g.mousewheel.preventDefault=!1,e.preventDefault(),!1):void 0}};_g.event.addEvent(window,"wheel",e),_g.event.addEvent(window,"mousewheel",e),_g.event.addEvent(window,"DOMMouseScroll",e)},getMouseWheel:function(e){_g.mousewheel.mouseWheelSpeed=20;var t,i;return"deltaX"in e?(t=-e.deltaX,i=-e.deltaY):"wheelDeltaX"in e?(t=e.wheelDeltaX/120*_g.mousewheel.mouseWheelSpeed,i=e.wheelDeltaY/120*_g.mousewheel.mouseWheelSpeed):t=i="wheelDelta"in e?e.wheelDelta/120*_g.mousewheel.mouseWheelSpeed:"detail"in e?-e.detail/3*_g.mousewheel.mouseWheelSpeed:void 0,{x:t,y:i}},getElement:function(e,t,i){var n,a=t?".iMouseWheel.enableMouseWheelX,.iMouseWheel.enableMouseWheel":i?".iMouseWheel.enableMouseWheelY,iMouseWheel.enableMouseWheel":".iMouseWheel";return _g.mousewheel.currentTarget?n=_g.mousewheel.currentTarget:t||i?t?n=$(e.target).is(a)?$(e.target):$(e.target).closest($(e.target).closest(".iMouseWheel.enableMouseWheelX").length?".iMouseWheel.enableMouseWheelX":".iMouseWheel.enableMouseWheel"):i&&(n=$(e.target).is(a)?$(e.target):$(e.target).closest($(e.target).closest(".iMouseWheel.enableMouseWheelY").length?".iMouseWheel.enableMouseWheelY":".iMouseWheel.enableMouseWheel")):n=$(e.target).is(".iMouseWheel")?$(e.target):$(e.target).closest(".iMouseWheel"),n},available:function(e){var t=_g.mousewheel.getElement(e);return t.length?t.hasClass("disableMouseWheel")?!1:t.hasClass("disableMouseWheelX")&&0==_g.mousewheel.direction?!1:t.hasClass("disableMouseWheelY")&&1==_g.mousewheel.direction?!1:t.hasClass("enableMouseWheel")?(e.preventDefault(),t):t.hasClass("enableMouseWheelX")&&0==_g.mousewheel.direction?(e.preventDefault(),t):t.hasClass("enableMouseWheelY")&&1==_g.mousewheel.direction?(e.preventDefault(),t):(t=_g.mousewheel.getElement(e,!_g.mousewheel.direction,_g.mousewheel.direction),t.length?(e.preventDefault(),t):null):(_g.mousewheel.preventDefault&&e.preventDefault(),null)},onStart:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelstart",e)},onWheel:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelmove",e)},onEnd:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelend",e),_g.mousewheel.currentTarget=null},onWheelLeft:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelleft",e)},onWheelRight:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelright",e)},onWheelUp:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheelup",e)},onWheelDown:function(e){var t=_g.mousewheel.available(e);t&&t.trigger("wheeldown",e)}};"undefined"==typeof require?(window._g||(window._g={}),window._g.mousewheel=e):define("_g/mousewheel",["_g/base","_g/event"],function(){return window._g.mousewheel=e,window._g.mousewheel})}(window),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one(e.support.transition.end,function(){i=!0});var a=function(){if(!i)try{e(n).trigger(e.support.transition.end)}catch(t){}};return setTimeout(a,t),this},e(function(){e.support.transition=t()})}(jQuery),+function(e){function t(t){return this.each(function(){var i=e(this),a=i.data("bs.alert");a||i.data("bs.alert",a=new n(this)),"string"==typeof t&&a[t].call(i)})}var i='[data-dismiss="alert"]',n=function(t){e(t).on("click",i,this.close)};n.VERSION="3.1.1",n.prototype.close=function(t){function i(){o.detach().trigger("closed.bs.alert").remove()}var n=e(this),a=n.attr("data-target");a||(a=n.attr("href"),a=a&&a.replace(/.*(?=#[^\s]*$)/,""));var o=e(a);t&&t.preventDefault(),o.length||(o=n.hasClass("alert")?n:n.parent()),o.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),e.support.transition&&o.hasClass("fade")?o.one(e.support.transition.end,i).emulateTransitionEnd(150):i())};var a=e.fn.alert;e.fn.alert=t,e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=a,this},e(document).on("click.bs.alert.data-api",i,n.prototype.close)}(jQuery),+function(e){function t(t){return this.each(function(){var n=e(this),a=n.data("bs.button"),o="object"==typeof t&&t;a||n.data("bs.button",a=new i(this,o)),"toggle"==t?a.toggle():t&&a.setState(t)})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.isLoading=!1};i.VERSION="3.1.1",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(t){var i="disabled",n=this.$element,a=n.is("input")?"val":"html",o=n.data();t+="Text",null==o.resetText&&n.data("resetText",n[a]()),n[a](null==o[t]?this.options[t]:o[t]),setTimeout(e.proxy(function(){"loadingText"==t?(this.isLoading=!0,n.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i))
},this),0)},i.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}e&&this.$element.toggleClass("active")};var n=e.fn.button;e.fn.button=t,e.fn.button.Constructor=i,e.fn.button.noConflict=function(){return e.fn.button=n,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var n=e(i.target);n.hasClass("btn")||(n=n.closest(".btn")),t.call(n,"toggle"),i.preventDefault()})}(jQuery),+function(e){function t(t){return this.each(function(){var n=e(this),a=n.data("bs.carousel"),o=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t),r="string"==typeof t?t:o.slide;a||n.data("bs.carousel",a=new i(this,o)),"number"==typeof t?a.to(t):r?a[r]():o.interval&&a.pause().cycle()})}var i=function(t,i){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};i.VERSION="3.1.1",i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},i.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},i.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(".item"),this.$items.index(this.$active)},i.prototype.to=function(t){var i=this,n=this.getActiveIndex();return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},i.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){return this.sliding?void 0:this.slide("next")},i.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},i.prototype.slide=function(t,i){var n=this.$element.find(".item.active"),a=i||n[t](),o=this.interval,r="next"==t?"left":"right",s="next"==t?"first":"last",l=this;if(!a.length){if(!this.options.wrap)return;a=this.$element.find(".item")[s]()}if(a.hasClass("active"))return this.sliding=!1;var c=a[0],d=e.Event("slide.bs.carousel",{relatedTarget:c,direction:r});if(this.$element.trigger(d),!d.isDefaultPrevented()){this.sliding=!0,o&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var t=e(l.$indicators.children()[l.getActiveIndex()]);t&&t.addClass("active")}));var h=e.Event("slid.bs.carousel",{relatedTarget:c,direction:r});return e.support.transition&&this.$element.hasClass("slide")?(a.addClass(t),a[0].offsetWidth,n.addClass(r),a.addClass(r),n.one(e.support.transition.end,function(){a.removeClass([t,r].join(" ")).addClass("active"),n.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(h)},0)}).emulateTransitionEnd(1e3*n.css("transition-duration").slice(0,-1))):(n.removeClass("active"),a.addClass("active"),this.sliding=!1,this.$element.trigger(h)),o&&this.cycle(),this}};var n=e.fn.carousel;e.fn.carousel=t,e.fn.carousel.Constructor=i,e.fn.carousel.noConflict=function(){return e.fn.carousel=n,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(i){var n,a=e(this),o=e(a.attr("data-target")||(n=a.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),r=e.extend({},o.data(),a.data()),s=a.attr("data-slide-to");s&&(r.interval=!1),t.call(o,r),(s=a.attr("data-slide-to"))&&o.data("bs.carousel").to(s),i.preventDefault()}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var i=e(this);t.call(i,i.data())})})}(jQuery),+function(e){function t(t){return this.each(function(){var n=e(this),a=n.data("bs.collapse"),o=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t);!a&&o.toggle&&"show"==t&&(t=!t),a||n.data("bs.collapse",a=new i(this,o)),"string"==typeof t&&a[t]()})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};i.VERSION="3.1.1",i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var i=e.Event("show.bs.collapse");if(this.$element.trigger(i),!i.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var a=n.data("bs.collapse");if(a&&a.transitioning)return;t.call(n,"hide"),a||n.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var r=function(t){return t&&t.target!=this.$element[0]?void this.$element.one(e.support.transition.end,e.proxy(r,this)):(this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,void this.$element.off(e.support.transition.end+".bs.collapse").trigger("shown.bs.collapse"))};if(!e.support.transition)return r.call(this);var s=e.camelCase(["scroll",o].join("-"));this.$element.on(e.support.transition.end+".bs.collapse",e.proxy(r,this)).emulateTransitionEnd(350)[o](this.$element[0][s])}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(t){return t&&t.target!=this.$element[0]?void this.$element.one(e.support.transition.end,e.proxy(n,this)):(this.transitioning=0,void this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse"))};return e.support.transition?void this.$element[i](0).one(e.support.transition.end,e.proxy(n,this)).emulateTransitionEnd(350):n.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=e.fn.collapse;e.fn.collapse=t,e.fn.collapse.Constructor=i,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var n,a=e(this),o=a.attr("data-target")||i.preventDefault()||(n=a.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),r=e(o),s=r.data("bs.collapse"),l=s?"toggle":a.data(),c=a.attr("data-parent"),d=c&&e(c);s&&s.transitioning||(d&&d.find('[data-toggle="collapse"][data-parent="'+c+'"]').not(a).addClass("collapsed"),a[r.hasClass("in")?"addClass":"removeClass"]("collapsed")),t.call(r,l)})}(jQuery),+function(e){function t(t){t&&3===t.which||(e(a).remove(),e(o).each(function(){var n=i(e(this)),a={relatedTarget:this};n.hasClass("open")&&(n.trigger(t=e.Event("hide.bs.dropdown",a)),t.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown",a))}))}function i(t){var i=t.attr("data-target");i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&e(i);return n&&n.length?n:t.parent()}function n(t){return this.each(function(){var i=e(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new r(this)),"string"==typeof t&&n[t].call(i)})}var a=".dropdown-backdrop",o='[data-toggle="dropdown"]',r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.VERSION="3.1.1",r.prototype.toggle=function(n){var a=e(this);if(!a.is(".disabled, :disabled")){var o=i(a),r=o.hasClass("open");if(t(),!r){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var s={relatedTarget:this};if(o.trigger(n=e.Event("show.bs.dropdown",s)),n.isDefaultPrevented())return;a.trigger("focus"),o.toggleClass("open").trigger("shown.bs.dropdown",s)}return!1}},r.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var n=e(this);if(t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")){var a=i(n),r=a.hasClass("open");if(!r||r&&27==t.keyCode)return 27==t.which&&a.find(o).trigger("focus"),n.trigger("click");var s=" li:not(.divider):visible a",l=a.find('[role="menu"]'+s+', [role="listbox"]'+s);if(l.length){var c=l.index(l.filter(":focus"));38==t.keyCode&&c>0&&c--,40==t.keyCode&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var s=e.fn.dropdown;e.fn.dropdown=n,e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",o,r.prototype.toggle).on("keydown.bs.dropdown.data-api",o+', [role="menu"], [role="listbox"]',r.prototype.keydown)}(jQuery),+function(e){function t(t,n){return this.each(function(){var a=e(this),o=a.data("bs.modal"),r=e.extend({},i.DEFAULTS,a.data(),"object"==typeof t&&t);o||a.data("bs.modal",o=new i(this,r)),"string"==typeof t?o[t](n):r.show&&o.show(n)})}var i=function(t,i){this.options=i,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.1.1",i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},i.prototype.show=function(t){var i=this,n=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var n=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var a=e.Event("shown.bs.modal",{relatedTarget:t});n?i.$element.find(".modal-dialog").one(e.support.transition.end,function(){i.$element.trigger("focus").trigger(a)}).emulateTransitionEnd(300):i.$element.trigger("focus").trigger(a)}))},i.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},i.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},i.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(t){var i=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var a=e.support.transition&&n;if(this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),a&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;a?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){i.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,o).emulateTransitionEnd(150):o()}else t&&t()},i.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},i.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0);this.scrollbarWidth&&this.$body.css("padding-right",e+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},i.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var n=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=i,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var n=e(this),a=n.attr("href"),o=e(n.attr("data-target")||a&&a.replace(/.*(?=#[^\s]+$)/,"")),r=o.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(a)&&a},o.data(),n.data());n.is("a")&&i.preventDefault(),t.call(o,r,this),o.one("hide.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})})}(jQuery),+function(e){function t(t){return this.each(function(){var n=e(this),a=n.data("bs.tooltip"),o="object"==typeof t&&t;(a||"destroy"!=t)&&(a||n.data("bs.tooltip",a=new i(this,o)),"string"==typeof t&&a[t]())})}var i=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};i.VERSION="3.1.1",i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(t,i,n){this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var a=this.options.trigger.split(" "),o=a.length;o--;){var r=a[o];if("click"==r)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=r){var s="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},i.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},i.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show()},i.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},i.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;var i=this,n=this.tip();this.setContent(),this.options.animation&&n.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,o=/\s?auto?\s?/i,r=o.test(a);r&&(a=a.replace(o,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(a),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var s=this.getPosition(),l=n[0].offsetWidth,c=n[0].offsetHeight;if(r){var d=a,h=this.$element.parent(),u=this.getPosition(h);a="bottom"==a&&s.top+s.height+c-u.scroll>u.height?"top":"top"==a&&s.top-u.scroll-c<0?"bottom":"right"==a&&s.right+l>u.width?"left":"left"==a&&s.left-l<u.left?"right":a,n.removeClass(d).addClass(a)}var p=this.getCalculatedOffset(a,s,l,c);this.applyPlacement(p,a),this.hoverState=null;var m=function(){i.$element.trigger("shown.bs."+i.type)};e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,m).emulateTransitionEnd(150):m()}},i.prototype.applyPlacement=function(t,i){var n=this.tip(),a=n[0].offsetWidth,o=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),s=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(s)&&(s=0),t.top=t.top+r,t.left=t.left+s,e.offset.setOffset(n[0],e.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),n.addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;"top"==i&&c!=o&&(t.top=t.top+o-c);var d=this.getViewportAdjustedDelta(i,t,l,c);d.left?t.left+=d.left:t.top+=d.top;var h=d.left?2*d.left-a+l:2*d.top-o+c,u=d.left?"left":"top",p=d.left?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(h,n[0][p],u)},i.prototype.replaceArrow=function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},i.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},i.prototype.hide=function(){function t(){"in"!=i.hoverState&&n.detach(),i.$element.trigger("hidden.bs."+i.type)}var i=this,n=this.tip(),a=e.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},i.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(t){t=t||this.$element;var i=t[0],n="BODY"==i.tagName;return e.extend({},"function"==typeof i.getBoundingClientRect?i.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:n?e(window).width():t.outerWidth(),height:n?e(window).height():t.outerHeight()},n?{top:0,left:0}:t.offset())},i.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},i.prototype.getViewportAdjustedDelta=function(e,t,i,n){var a={top:0,left:0};if(!this.$viewport)return a;var o=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-o-r.scroll,l=t.top+o-r.scroll+n;s<r.top?a.top=r.top-s:l>r.top+r.height&&(a.top=r.top+r.height-l)}else{var c=t.left-o,d=t.left+o+i;c<r.left?a.left=r.left-c:d>r.width&&(a.left=r.left+r.width-d)}return a},i.prototype.getTitle=function(){var e,t=this.$element,i=this.options;return e=t.attr("data-original-title")||("function"==typeof i.title?i.title.call(t[0]):i.title)},i.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(t){var i=this;t&&(i=e(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=i,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),+function(e){function t(t){return this.each(function(){var n=e(this),a=n.data("bs.popover"),o="object"==typeof t&&t;(a||"destroy"!=t)&&(a||n.data("bs.popover",a=new i(this,o)),"string"==typeof t&&a[t]())})}var i=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");i.VERSION="3.1.1",i.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},i.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var n=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=i,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),+function(e){function t(i,n){var a,o=e.proxy(this.process,this);this.$element=e(e(i).is("body")?window:i),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scrollspy",o),this.options=e.extend({},t.DEFAULTS,n),this.selector=(this.options.target||(a=e(i).attr("href"))&&a.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}function i(i){return this.each(function(){var n=e(this),a=n.data("bs.scrollspy"),o="object"==typeof i&&i;a||n.data("bs.scrollspy",a=new t(this,o)),"string"==typeof i&&a[i]()})}t.VERSION="3.1.1",t.DEFAULTS={offset:10},t.prototype.refresh=function(){var t=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var i=this;this.$body.find(this.selector).filter(":visible").map(function(){var n=e(this),a=n.data("target")||n.attr("href"),o=/^#./.test(a)&&e(a);return o&&o.length&&o.is(":visible")&&[[o[t]().top+(!e.isWindow(i.$scrollElement.get(0))&&i.$scrollElement.scrollTop()),a]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight),n=i-this.$scrollElement.height(),a=this.offsets,o=this.targets,r=this.activeTarget;if(t>=n)return r!=(e=o.last()[0])&&this.activate(e);if(r&&t<=a[0])return r!=(e=o[0])&&this.activate(e);for(e=a.length;e--;)r!=o[e]&&t>=a[e]&&(!a[e+1]||t<=a[e+1])&&this.activate(o[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")};var n=e.fn.scrollspy;e.fn.scrollspy=i,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=n,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);i.call(t,t.data())})})}(jQuery),+function(e){function t(t){return this.each(function(){var n=e(this),a=n.data("bs.tab");a||n.data("bs.tab",a=new i(this)),"string"==typeof t&&a[t]()})}var i=function(t){this.element=e(t)};i.VERSION="3.1.1",i.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=t.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var a=i.find(".active:last a")[0],o=e.Event("show.bs.tab",{relatedTarget:a});if(t.trigger(o),!o.isDefaultPrevented()){var r=e(n);this.activate(t.closest("li"),i),this.activate(r,r.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:a})})}}},i.prototype.activate=function(t,i,n){function a(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),n&&n()}var o=i.find("> .active"),r=n&&e.support.transition&&o.hasClass("fade");r?o.one(e.support.transition.end,a).emulateTransitionEnd(150):a(),o.removeClass("in")};var n=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=i,e.fn.tab.noConflict=function(){return e.fn.tab=n,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(i){i.preventDefault(),t.call(e(this),"show")})}(jQuery),+function(e){function t(t){return this.each(function(){var n=e(this),a=n.data("bs.affix"),o="object"==typeof t&&t;a||n.data("bs.affix",a=new i(this,o)),"string"==typeof t&&a[t]()})}var i=function(t,n){this.options=e.extend({},i.DEFAULTS,n),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(t),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.1.1",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},i.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=e(document).height(),n=this.$target.scrollTop(),a=this.$element.offset(),o=this.options.offset,r=o.top,s=o.bottom;"object"!=typeof o&&(s=r=o),"function"==typeof r&&(r=o.top(this.$element)),"function"==typeof s&&(s=o.bottom(this.$element));var l=null!=this.unpin&&n+this.unpin<=a.top?!1:null!=s&&a.top+this.$element.height()>=t-s?"bottom":null!=r&&r>=n?"top":!1;if(this.affixed!==l){null!=this.unpin&&this.$element.css("top","");var c="affix"+(l?"-"+l:""),d=e.Event(c+".bs.affix");this.$element.trigger(d),d.isDefaultPrevented()||(this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(c).trigger(e.Event(c.replace("affix","affixed"))),"bottom"==l&&this.$element.offset({top:t-this.$element.height()-s}))}}};var n=e.fn.affix;e.fn.affix=t,e.fn.affix.Constructor=i,e.fn.affix.noConflict=function(){return e.fn.affix=n,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var i=e(this),n=i.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.call(i,n)})})}(jQuery),!function(e){var t=function(t,i){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,i),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"==typeof this.options.autoSelect?this.options.autoSelect:!0,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.delay="number"==typeof this.options.delay?this.options.delay:250,this.$menu=e(this.options.menu),this.shown=!1,this.listen(),this.showHintOnFocus="boolean"==typeof this.options.showHintOnFocus?this.options.showHintOnFocus:!1};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").data("value");return(this.autoSelect||e)&&this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},setSource:function(e){this.source=e},show:function(){var t,i=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return t="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight,this.$menu.insertAfter(this.$element).css({top:i.top+i.height+t,left:i.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var i;if(this.query="undefined"!=typeof t&&null!==t?t:this.$element.val()||"",this.query.length<this.options.minLength)return this.shown?this.hide():this;var n=e.proxy(function(){i=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,i&&this.process(i)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(n,this.delay)},process:function(t){var i=this;return t=e.grep(t,function(e){return i.matcher(e)}),t=this.sorter(t),t.length?"all"==this.options.items?this.render(t).show():this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){for(var t,i=[],n=[],a=[];t=e.shift();)t.toLowerCase().indexOf(this.query.toLowerCase())?~t.indexOf(this.query)?n.push(t):a.push(t):i.push(t);return i.concat(n,a)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var i=this;return t=e(t).map(function(t,n){return t=e(i.options.item).data("value",n),t.find("a").html(i.highlighter(n)),t[0]}),this.autoSelect&&t.first().addClass("active"),this.$menu.html(t),this},next:function(){var t=this.$menu.find(".active").removeClass("active"),i=t.next();i.length||(i=e(this.$menu.find("li")[0])),i.addClass("active")},prev:function(){var e=this.$menu.find(".active").removeClass("active"),t=e.prev();t.length||(t=this.$menu.find("li").last()),t.addClass("active")},listen:function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))
},destroy:function(){this.$element.data("typeahead",null),this.$element.off("focus").off("blur").off("keypress").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove()},eventSupported:function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t="function"==typeof this.$element[e]),t},move:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]),this.shown||40!=t.keyCode?this.move(t):this.lookup("")},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(){this.focused||(this.focused=!0,(0===this.options.minLength&&!this.$element.val()||this.options.showHintOnFocus)&&this.lookup())},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")},mouseleave:function(){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var i=e.fn.typeahead;e.fn.typeahead=function(i){var n=arguments;return this.each(function(){var a=e(this),o=a.data("typeahead"),r="object"==typeof i&&i;o||a.data("typeahead",o=new t(this,r)),"string"==typeof i&&(n.length>1?o[i].apply(o,Array.prototype.slice.call(n,1)):o[i]())})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0},e.fn.typeahead.Constructor=t,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=i,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(){var t=e(this);t.data("typeahead")||t.typeahead(t.data())})}(window.jQuery),+function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one(e.support.transition.end,function(){i=!0});var a=function(){i||e(n).trigger(e.support.transition.end)};return setTimeout(a,t),this},e(function(){e.support.transition=t()})}(jQuery),define("bootstrap",["jquery"],function(){}),window.bootbox=window.bootbox||function e(t,i){function n(e){var t=w[v.locale];return t?t[e]:w.en[e]}function a(e,i,n){e.preventDefault();var a=t.isFunction(n)&&n(e)===!1;a||i.modal("hide")}function o(e){var t,i=0;for(t in e)i++;return i}function r(e,i){var n=0;t.each(e,function(e,t){i(e,t,n++)})}function s(e){var i,n;if("object"!=typeof e)throw new Error("Please supply an object of options");if(!e.message)throw new Error("Please specify a message");return e=t.extend({},v,e),e.buttons||(e.buttons={}),e.backdrop=e.backdrop?"static":!1,i=e.buttons,n=o(i),r(i,function(e,a,o){if(t.isFunction(a)&&(a=i[e]={callback:a}),"object"!==t.type(a))throw new Error("button with key "+e+" must be an object");a.label||(a.label=e),a.className||(a.className=2>=n&&o===n-1?"btn-primary":"btn-default")}),e}function l(e,t){var i=e.length,n={};if(1>i||i>2)throw new Error("Invalid argument length");return 2===i||"string"==typeof e[0]?(n[t[0]]=e[0],n[t[1]]=e[1]):n=e[0],n}function c(e,i,n){return t.extend(!0,{},e,l(i,n))}function d(e,t,i){return p(c(u.apply(null,e),t,i),e)}function h(){for(var e={},t=0,i=arguments.length;i>t;t++){var a=arguments[t],o=a.toLowerCase(),r=a.toUpperCase();e[o]={label:n(r)}}return e}function u(){return{buttons:h.apply(null,arguments)}}function p(e,t){var n={};return r(t,function(e,t){n[t]=!0}),r(e.buttons,function(e){if(n[e]===i)throw new Error("button key "+e+" is not allowed (options are "+t.join("\n")+")")}),e}var m={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input form-control' autocomplete=off type=text />"}},f=t("body"),v={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0},g={};g.alert=function(){var e;if(e=d(["ok"],arguments,["message","callback"]),e.callback&&!t.isFunction(e.callback))throw new Error("alert requires callback property to be a function when provided");return e.buttons.ok.callback=e.onEscape=function(){return t.isFunction(e.callback)?e.callback():!0},g.dialog(e)},g.confirm=function(){var e;if(e=d(["cancel","confirm"],arguments,["message","callback"]),e.buttons.cancel.callback=e.onEscape=function(){return e.callback(!1)},e.buttons.confirm.callback=function(){return e.callback(!0)},!t.isFunction(e.callback))throw new Error("confirm requires a callback");return g.dialog(e)},g.prompt=function(){var e,n,a,o,r,s;if(o=t(m.form),n={buttons:h("cancel","confirm"),value:""},e=p(c(n,arguments,["title","callback"]),["cancel","confirm"]),s=e.show===i?!0:e.show,e.message=o,e.buttons.cancel.callback=e.onEscape=function(){return e.callback(null)},e.buttons.confirm.callback=function(){return e.callback(r.val())},e.show=!1,!e.title)throw new Error("prompt requires a title");if(!t.isFunction(e.callback))throw new Error("prompt requires a callback");return r=t(m.inputs.text),r.val(e.value),o.append(r),o.on("submit",function(e){e.preventDefault(),a.find(".btn-primary").click()}),a=g.dialog(e),a.off("shown.bs.modal"),a.on("shown.bs.modal",function(){r.focus()}),s===!0&&a.modal("show"),a},g.dialog=function(e){e=s(e);var i=t(m.dialog),n=i.find(".modal-body"),o=e.buttons,l="",c={onEscape:e.onEscape};if(r(o,function(e,t){l+="<button data-bb-handler='"+e+"' type='button' class='btn "+t.className+"'>"+t.label+"</button>",c[e]=t.callback}),n.find(".bootbox-body").html(e.message),e.animate===!0&&i.addClass("fade"),e.className&&i.addClass(e.className),e.title&&n.before(m.header),e.closeButton){var d=t(m.closeButton);e.title?i.find(".modal-header").prepend(d):d.css("margin-top","-10px").prependTo(n)}return e.title&&i.find(".modal-title").html(e.title),l.length&&(n.after(m.footer),i.find(".modal-footer").html(l)),e.width&&e.height&&(i.width(e.width),i.height(e.height),i.css({left:"50%",top:"50%","margin-top":function(){return-(t(this).height()/2)},"margin-left":function(){return-(t(this).width()/2)}}),i.children(".modal-dialog").width(e.width).height(e.height)),i.on("hidden.bs.modal",function(e){e.target===this&&i.remove()}),i.on("shown.bs.modal",function(){i.find(".btn-primary:first").focus()}),i.on("escape.close.bb",function(e){c.onEscape&&a(e,i,c.onEscape)}),i.on("click",".modal-footer button",function(e){var n=t(this).data("bb-handler");a(e,i,c[n])}),i.on("click",".bootbox-close-button",function(e){a(e,i,c.onEscape)}),i.on("keyup",function(e){27===e.which&&i.trigger("escape.close.bb")}),f.append(i),i.modal({backdrop:e.backdrop,keyboard:!1,show:!1}),e.draggable&&i.draggable(),e.show&&i.modal("show"),i},g.setDefaults=function(e){t.extend(v,e)},g.hideAll=function(){t(".bootbox").modal("hide")};var w={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"PotwierdÅº"},ru:{OK:"OK",CANCEL:"ÐÑÐ¼ÐµÐ½Ð°",CONFIRM:"ÐÑÐ¸Ð¼ÐµÐ½Ð¸ÑÑ"},zh_CN:{OK:"OK",CANCEL:"åæ¶",CONFIRM:"ç¡®è®¤"},zh_TW:{OK:"OK",CANCEL:"åæ¶",CONFIRM:"ç¢ºèª"}};return g.init=function(i){window.bootbox=e(i||t)},g}(window.jQuery),define("bootboxjs",["bootstrap"],function(){}),define("text!rightpanel/share.js",[],function(){return'<form class="form-horizontal">\n  <h5 style="color:#f80; margin:0 0 20px;">åäº«ç»ç«å¤å¥½åï¼</h5>\n  <div class="control-group">\n    <label for="inc_http" class="control-label">å°åï¼</label>\n    <div class="controls">\n      <input type="text" value="<%-url%>" id="inc_http" style="width:450px; line-height:18px;">\n    </div>\n  </div>\n  <h5 style="color:#f80; margin:0 0 20px;">æåå®¹è´´å°BlogæBBSï¼</h5>\n  <div class="control-group">\n    <label class="control-label" for="inputWidth">èªå®ä¹å°ºå¯¸ï¼</label>\n    <div class="controls">\n      <div style="width:180px; float:left;">\n        <label class="control-label" for="inputWidth" style="width:60px;">å®½åº¦</label>\n        <input type="text" id="inputWidth" class="input-small" placeholder="èªå®ä¹é«åº¦" value="650" style="width:40px; margin:0 10px;">\n        px </div>\n      <div style="width:180px; float:left;">\n        <label class="control-label" for="inputHeight" style="width:60px;">é«åº¦</label>\n        <input type="text" id="inputHeight" class="input-small" placeholder="èªå®ä¹å®½åº¦" value="540" style="width:40px; margin:0 10px;">\n        px </div>\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label">æ¯å¦æ¾ç¤ºæ­æ¾æ¡ï¼</label>\n    <div class="controls">\n      <label class="radio inline" style="margin-left:30px;">\n        <input type="radio" name="controlbar" id="controlbar1" value="1" checked="">\n        æ¯ </label>\n      <label class="radio inline" style="margin-left:30px;">\n        <input type="radio" name="controlbar" id="controlbar0" value="0" >\n        å¦ </label>\n    </div>\n  </div>\n  <div class="control-group">\n    <label for="inc_http" class="control-label">å¤å¶iframeä»£ç ï¼</label>\n    <div class="controls">\n      <input type="text" id="embedIframe" value="<%-iframecode%>" id="inc_http" style="width:450px; line-height:18px;">\n    </div>\n  </div>  \n  <div class="control-group">\n    <label class="control-label" for="embedHtml">å¤å¶Htmlä»£ç ï¼</label>\n    <div class="controls">\n      <textarea rows="4" style="width: 450px; margin: 0px; height: 160px; resize: none;" id="embedHtml"><%-code%></textarea>\n    </div>\n  </div>\n</form>'}),require(["bootboxjs","_g/ui","text!rightpanel/share.js"],function(){window.share=function(e,t){function i(e){var i=parseInt(e.find("#inputWidth").val())||650,n=parseInt(e.find("#inputHeight").val())||540,s=parseInt(e.find('input[name="controlbar"]:checked').val());e.find("textarea#embedHtml").val(_.template(o,{origin:a,url:t,w:i,h:n,controlbar:s})),e.find("input#embedIframe").val(_.template(r,{origin:a,url:t,w:i,h:n,controlbar:s}))}var n="epub360player"+_g.uuid(),a="http://"+location.host;t=a+t;var o="<div id="+n+'>\n   <script type="text/javascript" src="<%=origin%>/staticfs/thirdparty/play/player.js?v='+n+'"></script>\n   <script>\n       epub360PlayerInit("'+n+'",<%=w%>,<%=h%>,"<%=url%>?autoplay=false<% if (controlbar==0){ %>&controlbar=false<% } %>","<%=origin%>");\n   </script></div>',r='<iframe style="width: <%=w%>px; height: <%=h%>px; border: none;" src="<%=url%>?autoplay=false<% if (controlbar==0){ %>&controlbar=false<% } %>"></iframe>',s=require("text!rightpanel/share.js"),l=bootbox.dialog({title:"<h3>åäº«: "+e+"<h3>",message:_.template(s,{url:t,code:_.template(o,{origin:a,url:t,w:650,h:540,controlbar:1}),iframecode:_.template(r,{origin:a,url:t,w:650,h:540,controlbar:1})})});$(l).css({width:"700px",height:"490px"}).find(".modal-body").css("max-height","600px"),_g.ui.center({Item:l}),setTimeout('$(".bootbox").find(".modal-dialog").css("margin-top", $(".bootbox").offset().top-$(".bootbox").find(".modal-dialog").offset().top+"px");',200),$(l).find("input[type='text'], textarea").mouseenter(function(){$(this).select()}),$(l).find("#inputWidth, #inputHeight").keyup(function(){i($(l))}),$(l).find("input[name='controlbar']").click(function(){i($(l))})}}),define("share/main",function(){}),function(e){e.fn.addBack=e.fn.addBack||e.fn.andSelf,e.fn.extend({actual:function(t,i){if(!this[t])throw'$.actual => The jQuery method "'+t+'" you called does not exist';var n,a,o={absolute:!1,clone:!1,includeMargin:!1},r=e.extend(o,i),s=this.eq(0);if(r.clone===!0)n=function(){var e="position: absolute !important; top: -1000 !important; ";s=s.clone().attr("style",e).appendTo("body")},a=function(){s.remove()};else{var l,c=[],d="";n=function(){l=s.parents().addBack().filter(":hidden"),d+="visibility: hidden !important; display: block !important; ",r.absolute===!0&&(d+="position: absolute !important; "),l.each(function(){var t=e(this),i=t.attr("style");c.push(i),t.attr("style",i?i+";"+d:d)})},a=function(){l.each(function(t){var i=e(this),n=c[t];void 0===n?i.removeAttr("style"):i.attr("style",n)})}}n();var h=/(outer)/.test(t)?s[t](r.includeMargin):s[t]();return a(),h}})}(jQuery),define("jquery.actual",["jquery"],function(){}),define("text!interaction_view/template/controlbar.js",[],function(){return'<div class=\'presentation-area\'>\n    <div class="controlbar">\n            <div class="logo"><% if (typeof cbt_data=="undefined"){ %><% if(typeof has_logo != \'undefined\' &&  has_logo){ %><a href="http://www.epub360.com" target="_blank"><img alt="logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAAAaCAYAAAAkJwuaAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABhFJREFUeNrsmVlwlEUQx7+sSTwikSAqiAciJCJQQVFBA4WAZwyXoiioUUAi+CBe4IMFXg8ioIKlgoIHhhKltDzAg0IpopJQbjQYTVKh1NKICUSUwygJC7Gb+k3ZTu2GXcyDD9tV/5qd6S/zfdPT3fPvSUo4HA48WSqYLNggKBasFPwRJCWqDBgw4GAbiqKrFuwUDBW8IKgXPJA0WdsSzZALBFmCHMFCwbGCRwRvJ82VmCHPFpwrqBXMEJwj+FkwWrA8abL4DTlfUC74UjBOUCE4X/Cn4CYMmpQ4DPkEB4164irBLYIGwXj0zyXN1rYhjxF0F6wTXCwoYPwlQaZgtaBG0FWQmzRddEPqYfKT4AfBbsGDgjWCSeifpH2FdnAC79D08Ficz6Ycpu5/YcgboDfHM9ZBMEcwAW90xlD5irZ3Au/QlDBLMK+NZ9T7PxE0CpbwDfbwUz67XfAWB6GTIwT3C+pMTo8lRwumC+YKrouiV6d5XHAz81qZiO5GQSfBCJyjqLy8PPPgLgshV8/LJ3R1wTMFhXhkAWG8X/ANXtFPsAfvjUfWCi5lUyZF0Q8RlHhjYQ64boIfoyysj6DKzG2lMAq70MVvEvQ0Yx8LLuH3OozjROceSCGyzPtu5dgdTf8XQV7IDH7ABB/Rz8djN2NElVbB1wkY0Ybk5hj622kX4W27BOcxNhIjKhUbJHiT8f6CdIzYRE5/CN3MKO+4GyNWkcZ2YLjObNYIouFhwRaioD/rVyO2oCvDXvvplwpOVg8PMahyFO0WysSnbSVEaH4mWCy4wOiW8IG30R+G4T80O+hCNNfzCpXTad8gdTjvzGahKp/jUcX0tVjowe8KWMbr9HVhGd47utLqt88WrKDfzxycK0lp8807XArbgO4++uvpz6I/MBUvU/nNhFXYW6jt52luwEM20fZm4e6j+2C4gN1UmQoCPGuc8fIAZhDAV1WOE+zldyptlnnWD3eX4zPw1iaja/Lmce/qTuoIjEO5CDrRbMhew2zsmly/S6p5WT5/0IG4X8P4nbQN5J5rBGcyrgfSNvS7PENsbYOr6hz3svtFLLzCeK5bUITfEUPFqmAYvb35Q2aRB2KkkTTaF0lR64ggq0unbRbs83Rp3oa4/l92kdcKXhM8j5s7ca6/DFeeY0IoMC87VI5cgHe/S3+GSexDCNsywm07edjl7ysJ3dlEQT0ee7jyKZSuzoT9fxLrkTvwOnXnL6Lsogv9PbS9PA88lDTgSeqFo7w8tsh79juSfycXOoayTGZDtrYTBWxu78pGeVFfwRkez3JhcqR3KEUSJMoZXl45ALdTOQvjTsNAF3Lr1IC+hG/S8D9NMKYdDZne3oZsMZyr0FxO+DvW2k5RECEtaJ69WvA+p2op+h7m3dXU/XPpD4pyMiciY2EbPYmSdgntNG/sCsHLGCwU/HM7HjEpIDCnZqpncP+EjKUPMed0mEA1d54pJqWke1HQbObM8MZazHeFYhwy7tlRXMZs5IrQ6ixTSEnEI5sN3bA0Yov3Ee5Dx3intAt9dzCc6n1YxKMup3jz1XsG7mzmjZiy1dKWfeRQ+3yLSTXNMQ48f0N2Gl2ml4Ja4zhI/+WRpVQG00jiY9GVmhpV5R68J9vkLVd/699MEZxENRJAL5xe6+1b2aQCQ6QDDjbllAvxkKHG81dT446EslyGrtZ4Ul9O/Bz6NRyAWjFdZAh4EUwhm3tVlUpzWE7AqKNNERC3IbXW7saEWWZ8N7VmDTXpcO/vyvDMbRBXrWROMPq9UJow45UY2ebjwRixI/PlGP1TgrtM5TTVoy5XwR50Y58xul/hqCV4up72dwie5VJkmHl2OWdBwEZM9O4HLocSasX1LRs2HmpYDd+9HspYm8rpl0vO6ALNWWoYv3P990CdKf8COF8uNalyy9+5bnOpoRH9ZOpaDadX2SQXXn3x2F6Q5LVm/iKKgzw2ZpXROQMVMs9ik3IexSMr6Q/nHTncJ6w38+itzjvU+Bv5HbDWYv5j4A69FV5f9RUpUf4d64vbySmQ8qTYS4g2/h3rS0dTlyYlDh4ZS74nXBqT5ootfwswAIGagOhx/Kc1AAAAAElFTkSuQmCC"></a><% } %><% } %></div>\n            <div class="progress"><span></span></div>\n            <% if(controlbar_settings.arrow){%>\n              <% if(play_mode==0){ %>\n                <div class="btn-group action-control" style="margin-left: -40px;">\n                   <button class="btn navigate-left" href="#" ><i class="icon-chevron-left icon-2x"></i></button>\n                   <button class="btn navigate-right" href="#" ><i class="icon-chevron-right icon-2x"></i></button>                  \n              <% } else {%>\n                <div class="btn-group action-control" style="margin-left: -90px;">\n                    <button class="btn navigate-left" href="#" ><i class="icon-chevron-left icon-2x"></i></button>\n                    <button class="btn navigate-right" href="#" ><i class="icon-chevron-right icon-2x"></i></button>\n                    <button class="btn navigate-up" href="#" ><i class="icon-chevron-up icon-2x"></i></button>\n                    <button class="btn navigate-down" href="#" ><i class="icon-chevron-down icon-2x"></i></button>\n               <% } %>\n            </div>\n            <% } %>\n    </div>\n</div>'}),define("interaction_view/ui/screenset",["text!interaction_view/template/controlbar.js","_g/device"],function(){var e=require("text!interaction_view/template/controlbar.js"),t={init:function(){if(window.screenLock=!1,window.screenScale=null,window.bar_height=0,window.useTranform=!1,window.get_window_size=function(){var e,t;if(interaction_view.isWeixin&&_g.device.ios())return{x:$(window).width(),y:$(window).height()};if(interaction_view.forpreview)e=parseInt($(".interaction-preview").css("width"),10),t=parseInt($(".interaction-preview").css("height"),10);else{var i=window,n=document,a=n.documentElement,o=n.getElementsByTagName("body")[0];e=i.innerWidth||a.clientWidth||o.clientWidth,t=i.innerHeight||a.clientHeight||o.clientHeight}return{x:e,y:t}},window.recover_screen=function(){window.useTransform?(document.querySelectorAll(".reveal")[0].style.transform="scale(1)",document.querySelectorAll(".reveal")[0].style.WebkitTransform="scale(1)",document.querySelectorAll(".reveal")[0].style.MozTransform="scale(1)",document.querySelectorAll(".reveal")[0].style["-o-transform"]="scale(1)"):(document.querySelectorAll(".reveal")[0].style.zoom=1,document.querySelectorAll(".reveal")[0].style.MozTransform="scale(1)"),$.zoom=1},window.adjust_screen=function(){if(window.screenLock)return void interaction_view.screenset.patchForFixedSize();var e=1,t=get_window_size();if(interaction_view.ismobile&&interaction_view.currentScreenSize&&interaction_view.currentScreenSize.x==t.x&&interaction_view.currentScreenSize.y==t.y)return void interaction_view.screenset.patchForIframe();var i=t.x,n=t.y,a=interaction_view?interaction_view.size.x:parseInt($(".slides")[0].style.width,10),o=interaction_view?interaction_view.size.y:parseInt($(".slides")[0].style.height,10);$("body").height($("html").height()-0),e=a>=o?2==interaction_view.screen_mode?window.screenScale?window.screenScale:i/n>=a/o?i/a:n/o:window.screenScale?window.screenScale:i/n>=a/o?n/o:i/a:2==interaction_view.screen_mode?window.screenScale?window.screenScale:n/i>=o/a?n/o:i/a:window.screenScale?window.screenScale:n/i>=o/a?i/a:n/o,window.useTranform?(document.querySelectorAll(".reveal")[0].style.transform="scale("+e+")",document.querySelectorAll(".reveal")[0].style.WebkitTransform="scale("+e+")",document.querySelectorAll(".reveal")[0].style.MozTransform="scale("+e+")",document.querySelectorAll(".reveal")[0].style["-o-transform"]="scale("+e+")"):(document.querySelectorAll(".reveal")[0].style.zoom=e,document.querySelectorAll(".reveal")[0].style.MozTransform="scale("+e+")"),$.zoom=e,interaction_view.currentScreenSize=t,!interaction_view.ismobile&&_g.device.msie()&&interaction_view.screenset.adjustPatchforIE(e),interaction_view.screenset.patchForIframe(),"undefined"!=typeof Reveal&&Reveal.adapt?(Reveal.setAdaptScreen(),Reveal._initSlideStyle(),interaction_view.adapt.change()):"undefined"!=typeof Reveal?(Reveal.setAdaptScreen(),Reveal._initSlideStyle()):interaction_view.currentScreenSize=null,interaction_view.touchview&&interaction_view.screenset.adjustRevealPosition(e)},interaction_view.ismobile){var e="onorientationchange"in window,t=e?"orientationchange":"resize";window.addEventListener?window.addEventListener(t,interaction_view.screenset.patchForMobileOrientation,!1):window.attachEvent?window.attachEvent(t,interaction_view.screenset.patchForMobileOrientation):window[t]=interaction_view.screenset.patchForMobileOrientation,interaction_view.screenset.patchForMobileOrientation()}else interaction_view.forpreview||(window.onresize=function(){console.log("window resize"),adjust_screen()},window.onload=adjust_screen);window.screenSizeLock=function(){recover_screen(),window.screenLock=!0,interaction_view.screenset.patchForFixedSize(),interaction_view.screenset.patchForScreenMode2()},window.screenSizeRelease=function(){window.screenLock=!1,adjust_screen()}},patchForScreenMode2:function(){2==interaction_view.screen_mode&&(Reveal.setAdaptScreen(),Reveal._initSlideStyle())},patchForFixedSize:function(){if("undefined"!=typeof Reveal&&Reveal.adapt)Reveal.setAdaptScreen(),Reveal._initSlideStyle(),interaction_view.adapt.change();else{var e="undefined"!=typeof Reveal?Reveal.slideWidth:interaction_view.size.x,t="undefined"!=typeof Reveal?Reveal.slideHeight:interaction_view.size.y,i=get_window_size();if(window.useTransform){var n=(i.y-t)/2;$(".reveal").css({"margin-top":n});var a=(i.x-e)/2;$(".reveal").css({"margin-left":a})}else{var n=(i.y-t)/2;$(".reveal").css({"margin-top":n});var a=(i.x-e)/2;$(".reveal").css({"margin-left":a})}}},bindControlbarAutoHideEvent:function(){interaction_view.controlbarStatus=1,interaction_view.ismobile||$("body").on("mouseover",function(){$(".loading").length>0&&$(".loading").show(),0==interaction_view.controlbarStatus&&interaction_view.screenset.controlbarel&&interaction_view.screenset.controlbarel.show(500),interaction_view.controlbarStatus=1,t.startControlbarHide()})},changeProgressBar:function(){var e=Reveal.getIndices();interaction_view.screenset.controlbarel&&(interaction_view.screenset.controlbarel.find(".progress").children("span")[0].style.width=(e.h+1)/interaction_view.ipagelist.models.length*100+"%")},startControlbarHide:function(){"number"==typeof interaction_view.controlbarTimeOut&&(window.clearTimeout(interaction_view.controlbarTimeOut),delete interaction_view.controlbarTimeOut),interaction_view.controlbarTimeOut=window.setTimeout(function(){interaction_view.screenset.controlbarel&&interaction_view.screenset.controlbarel.hide(),$(".loading").length>0&&$(".loading").hide(500),interaction_view.controlbarStatus=0},3e3)},render:function(){var e=interaction_view.doc.toJSON();interaction_view.screenset.values=t.values=t.queryparse(e),interaction_view.ismobile||interaction_view.forpreview||t.rendercontrolbar(),t.initScreen(),t.bindControlbarAutoHideEvent(),interaction_view.ismobile&&interaction_view.screenset.startControlbarHide()},initScreen:function(){workEnd("-------- 6. screenset  1 add style 1 --------"),t.values.bg_opacity?interaction_view.containment.css("background",t.values.bg_color):interaction_view.containment.css("background-color","transparent"),workEnd("-------- 6. screenset  1 add style 1 --------"),0==t.values.screen_mode&&(window.screenLock=!0,interaction_view.screenset.controlbarel&&(interaction_view.screenset.controlbarel.find("button.actualsize").addClass("active"),interaction_view.screenset.controlbarel.find("button.adaptive").removeClass("active")),recover_screen())},queryparse:function(e){return e.bg_color=_g.getUrlParameterByName("bg_color")?"#"+_g.getUrlParameterByName("bg_color"):e.bg_color,e.bg_opacity=_g.getUrlParameterByName("bg_opacity")?Number(_g.getUrlParameterByName("bg_opacity")):e.bg_opacity,e.screen_mode=_g.getUrlParameterByName("screen_mode")?Number(_g.getUrlParameterByName("screen_mode")):e.screen_mode,e.show_controlbar=_g.getUrlParameterByName("controlbar")?_g.string.string2boolean(_g.getUrlParameterByName("controlbar")):e.show_controlbar,e.controlbar_settings=_g.getUrlParameterByName("controlbar_settings")?JSON.parse(_g.getUrlParameterByName("controlbar_settings")):e.controlbar_settings,e},rendercontrolbar:function(){t.values.show_controlbar&&(interaction_view.containment.append(_.template(e,t.values)),interaction_view.screenset.controlbarel=$("div.presentation-area"),interaction_view.screenset.controlbarel.find("[rel=tooltip]").tooltip())},adjustPatchforIE:function(e){var t=get_window_size();if(t.x/t.y<interaction_view.size.x/interaction_view.size.y){var i=(t.y-interaction_view.size.y*e)/2;$(".reveal").css({"margin-top":i})}else{var n=(t.x-interaction_view.size.x*e)/2;$(".reveal").css({"margin-left":n})}},adjustRevealPosition:function(e){var t=get_window_size(),i="undefined"!=typeof Reveal?Reveal.slideScreenWidth:interaction_view.size.x,n="undefined"!=typeof Reveal?Reveal.slideScreenHeight:interaction_view.size.y;if(t.x/t.y<interaction_view.size.x/interaction_view.size.y){if(window.useTransform)var a=(t.y-n)/2,o=(t.x-i)/2;else{var a;a=!interaction_view.ismobile&&$.browser.mozilla?(t.y-n*e)/2:(t.y/e-n)/2;var o=0}$(".reveal").css({"margin-top":a}),$(".reveal").css({"margin-left":o})}else{if(window.useTransform)var o=(t.x-i)/2,a=(t.y-n)/2;else{var o;o=$.browser.mozilla?(t.x-i*e)/2:(t.x/e-i)/2;var a=0}$(".reveal").css({"margin-left":o}),$(".reveal").css({"margin-top":a})}},patchForIframe:function(){!$.zoom||1==$.zoom},patchForWeiXin:function(){"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)&&$(".reveal").css("transform","scale(1.005,1.005)")},adaptScreen:function(){},patchForMobileOrientation:function(){var e=interaction_view.doc.toJSON().vertical,t=interaction_view.doc.toJSON().horizontal,i=!1;return e||t?(t?e||_g.device.portrait()&&(i=!0,$("body").children(".book_mask").length||$("body").append('<div class="book_mask"><img src="/staticfs/diazo/img/screendirectionlock.png"><div>è¯·è°æ´å°éåå±å¹éè¯»çæ¹å</div></div>')):_g.device.landscape()&&(i=!0,$("body").children(".book_mask").length||$("body").append('<div class="book_mask"><img src="/staticfs/diazo/img/screendirectionlock.png"><div>è¯·è°æ´å°éåå±å¹éè¯»çæ¹å</div></div>')),i||$("body").children(".book_mask").remove(),adjust_screen(),void console.log(_g.device.portrait())):!1}};return t}),define("interaction_view/ui/touchinit",[],function(){var e={init:function(){interaction_view.queue=new Queue,interaction_view.PluginManage.init(),interaction_view.iImgs={},interaction_view.share_page_id="first",interaction_view.share_app_data={},window.shareSuccess=function(){$("#epub360-ad").addClass("show");var e=!1;if("function"==typeof epub360ShareEvent&&epub360ShareEvent(),["www.epub360.com","m.creatby.com"].indexOf(window.location.host)>=0&&(e=!0),(window.location.pathname.indexOf("uaqjq")>0||window.location.pathname.indexOf("glh1i4")>0)&&(e=!1),!e){var t=_.filter(interaction_view.events.pageWXShareSuccessEvents,function(e){return e.page_id==interaction_view.currentPage});_.each(t,function(e){e.func()})}},interaction_view.wait=function(){$("#jswait-loading").hide(),$("body").append('<div class="mejs-overlay-button player-control-button" style="cursor:pointer;margin-top: -35px;position: absolute;top: 50%;left: 50%;width: 100px;height: 100px;margin: -50px 0 0 -50px;z-index: 1000001;background: url(http://qn.static.epub360.com/thirdparty/mediaelementjs/bigplay.svg);"></div>'),$(".player-control-button").on("click",function(){$("#jswait-loading").show(),$("div#epub360player-cover").remove(),$(".player-control-button").remove(),loading_progress_timer=setInterval(function(){compute_loadding_progress(),set_loading_progress()},200),interaction_view.start()})},interaction_view.start=function(){if(!interaction_view.foredit)for(var e=0;e<interaction_view.events.epub360StartEvents.length;e++)interaction_view.events.epub360StartEvents[e]();workEnd("-------- 1. touchinit 3 interaction_view.start start --------");var t=!1;1==_g.getUrlParameterByName("disableHistoryStart")&&(t=!0),workEnd("-------- 1. touchinit 3 add style 1 --------"),interaction_view.ismobile&&$("body").addClass("ios"),workEnd("-------- 1. touchinit 3 add style 1 --------");var i=interaction_view.doc.get("play_mode");interaction_view.book_id=interaction_view.doc.get("id"),interaction_view.play_mode=i,interaction_view.screen_mode=interaction_view.doc.get("screen_mode"),interaction_view.events.init(),interaction_view.screenset.init(),interaction_view.screenset.render();var n=interaction_view.doc.toJSON();interaction_view.ismobile&&$("body").one("touchstart",function(){presentation.preloadpageAudio()}),interaction_view.continuous=n.continuous,interaction_view.hasArrow=n.arrow,workEnd("-------- 1. touchinit 3 interaction_view.start 1 --------"),new _g.touchslide({body:interaction_view.forpreview?".interaction-preview":"window",width:interaction_view.size.x,height:interaction_view.size.y,containment:".reveal",keyboard:!interaction_view.foredit&&!interaction_view.ismobile,controls:!interaction_view.ismobile,mouseWheel:!interaction_view.ismobile&&n.desktop_mousewheel,progress:!interaction_view.ismobile,adapt:n.adapt,history:interaction_view.forpreview?!1:!0,disableHistoryStart:t,show_excontent:n.show_excontent,screen_mode:n.screen_mode,transition:n.switch_mode,overview:interaction_view.forpreview?!1:n.controlbar_settings.overview,show_overview:interaction_view.ismobile?!1:interaction_view.forpreview?!1:!0,show_controlbar:n.show_controlbar,continuous:n.continuous,smooth:n.smooth,onReady:function(e,t){workEnd("-------- 1. touchinit 3 interaction_view.start  _g.touchslide.onReady  start ------------"),interaction_view.screenset.patchForWeiXin(),window.Reveal=e,interaction_view.forpreview||adjust_screen(),interaction_view.playstatus="wait",interaction_view.currentPage=t;var i=require("interaction_view/view/master");interaction_view.imasterlist.length&&interaction_view.imasterlist.at(0).addView("iview",i),workEnd("-------- 1. touchinit 3 interaction_view.start  masterview ------------");var n=require("interaction_view/view/background");interaction_view.ibackgroundlist.length&&interaction_view.ibackgroundlist.at(0).addView("iview",n),presentation.startLoad(),interaction_view.ismobile&&(presentation.isFirstPageLoading=interaction_view.currentPage),presentation.pageLoad(interaction_view.currentPage)},slidePlay:function(e){var t=e;interaction_view.currentPage=e;var i=interaction_view.ipagelist.getPage(interaction_view.currentPage);i.get("loaded")&&interaction_view.imasterlist.at(0).get("loaded")&&interaction_view.ibackgroundlist.at(0).get("loaded")?(interaction_view.playstatus="play",interaction_view.containment.find("#jswait-loading").remove(),interaction_view.android?window.setTimeout(function(){interaction_view.play(t)},50):interaction_view.play(t)):(!interaction_view.containment.has("#jswait-loading").length>0&&interaction_view.containment.jswait&&interaction_view.containment.jswait(),interaction_view.playstatus="wait",i.isStartLoad||interaction_view.ipagelist.getPage(i.id)&&presentation.pageLoad(i.id))},onSlideChangeStart:function(e){Reveal.options.slidePlay(e),Reveal.played=e,interaction_view.ismobile&&window.setTimeout(function(){presentation.preloadFourDirections()},0)},onStopPlay:function(e){interaction_view.pausePlay(e)},onContinuePlay:function(e){interaction_view.continuePlay(e)},onSlideChange:function(e,t){Reveal.lockAction=!1;var i=t;interaction_view.stopPlay(i),Reveal.played!=e&&(Reveal.options.slidePlay(e),interaction_view.ismobile&&window.setTimeout(function(){presentation.preloadFourDirections()},0)),Reveal.played=null,interaction_view.ismobile&&window.setTimeout(function(){presentation.clearPreloadPages()},0),interaction_view.hasArrow&&!interaction_view.continuous&&Reveal.isLast()?($(".master_arrow_icon").hide(),interaction_view.hideArrow=!0):interaction_view.hideArrow&&($(".master_arrow_icon").show(),interaction_view.hideArrow=!1)},onKeyboard:function(){interaction_view.transitionPagePreLoad=null},onWheel:function(){interaction_view.transitionPagePreLoad=null},canDrag:function(e){return 0!=$(e.target).closest(".disableDragX").length&&0!=$(e.target).closest(".disableDragY").length&&0==$(e.target).closest(".dragConnector").length?!1:!0
},canDragX:function(e){if(0!=$(e.target).closest(".disableDragX").length){if($(e.target).closest(".disableDragX").hasClass("is_exceededX"))return!0;var t=$(e.target).closest(".dragConnector.disableDragX").data("dragfuncs");return t&&t.length&&(connector.dragcontroller($(e.target).closest(".dragConnector.disableDragX"),e,t,0),e.gesture.preventDefault()),!1}return!0},canDragY:function(e){if(0!=$(e.target).closest(".disableDragY").length){if($(e.target).closest(".disableDragY").hasClass("is_exceededY"))return!0;var t=$(e.target).closest(".dragConnector.disableDragY").data("dragfuncs");return t&&t.length&&(connector.dragcontroller($(e.target).closest(".dragConnector.disableDragY"),e,t,1),e.gesture.preventDefault()),!1}return!0},canDragEnd:function(e){var t=$(e.target).closest(".dragConnector").data("dragfuncs");t&&t.length&&connector.dragcontroller($(e.target).closest(".dragConnector"),e,t)},checkSlidePermission:function(e,t,i){if("left"==i){var n=e.getCurrentSlideId();return interaction_view.control.getLeft(n)?!0:!1}if("right"==i){var n=e.getCurrentSlideId();return interaction_view.control.getRight(n)?!0:!1}return!0},getOverview:function(e){return interaction_view.ipagelist.getPage(e)&&interaction_view.ipagelist.getPage(e).toJSON().nav?interaction_view.ipagelist.getPage(e).toJSON().nav.thumbnail:null}}),interaction_view.ismobile||(interaction_view.presentate=new $.presentate(!0))},interaction_view.init=function(){interaction_view.containment=$(interaction_view.forpreview?".interaction-preview":"body"),presentation.forpreview(),presentation.screencontrol(),_e.preloadpage&&_e.preloadpage.init(),window.iPageDirection="landscape";var e=require("interaction_view/model/doc");if(interaction_view.doc=new e({id:"doc"}),"undefined"!=typeof cbt_data||"undefined"!=typeof epub360_book_data){interaction_view.forpreview||(interaction_view.isPack=!0);var t;workEnd("-------- 1. touchinit 1 page list start --------"),"undefined"!=typeof epub360_book_data?(t=interaction_view.doc.parse(epub360_book_data),workEnd("-------- 1.1 touchinit 1 page parse --------")):t=interaction_view.doc.parse(cbt_data),interaction_view.doc.set(t),workEnd("-------- 1. touchinit 2 page list ready --------"),"false"==_g.getUrlParameterByName("autoplay")?interaction_view.wait():interaction_view.start(),workEnd("-------- 1. touchinit 3 interaction_view.start end --------")}else interaction_view.doc.fetch({success:function(){"false"==_g.getUrlParameterByName("autoplay")?interaction_view.wait():interaction_view.start()}})}}};return e}),define("interaction_view/ui/timeline",["interaction_view/model/base"],function(){interaction_view.timeline={render:function(e){(epub360.isV2||epub360.variable.isV2)&&(e.timelines=[],e.iOverlaylist.each(function(t){var i=t.get("iAnis");if(i.length&&!t.iAnimationlist){t.iAnimationlist=new interaction_view.collection.Animation,t.iAnimationlist.pageid=e.id;for(var n=[],t=0;t<i.length;t++){var a=$.extend(!0,{},i[t]);a.id=_g.uuid(4),a.iKind||(a.iKind=0),a.pageid=e.id,n.push(a)}t.iAnimationlist.reset(n),e.timelines.push(t.iAnimationlist)}}))},setPlay:function(e){e.timelines&&e.timelines.length&&_.each(e.timelines,function(e){e.setParams(),e.setPlay()})},play:function(e){e.timelines&&e.timelines.length&&_.each(e.timelines,function(e){e.timeline.play(0,!1)})}}}),define("interaction_view/ui/expression",["interaction_view/model/base"],function(){interaction_view.expression={Reg:[/\@/g,/\$/g],Regs:[/\@[^\@]+\@/g,/\$[^\$]+\$/g],Spliter:".",isVar:function(e){e+="";var t=e.match(this.Regs[0])||e.match(this.Regs[1])||e.match(/[\+\-\*\/\>\=\<\!]/g);if(!t){var i=e.match(/\d+/g);return i&&1==i.length&&i[0]==e}return t},id2values_db:function(text){if(!this.isVar(text))return text;var view=this;text=""+text;var ids=text.match(view.Regs[1]);return _.each(ids,function(e){text=text.replace(e,view.id2value_db(e))}),eval(text)},id2value_db:function(e){return"undefined"==typeof e?"":(e=""+e,e=e.replace(this.Reg[1],""),void(e=this.id2values(e)))},id2values:function(text,no_compute){if(!this.isVar(text))return text;var view=this;text=""+text;var ids=text.match(view.Regs[0]);if(_.each(ids,function(e){text=text.replace(e,view.id2value(e))}),!no_compute)try{text=eval(text)}catch(err){}return _.isString(text)&&("'"==text[0]&&"'"==text[text.length-1]||'"'==text[0]&&'"'==text[text.length-1])&&(text=text.substr(1,text.length-2)),text},id2value:function(e){if("undefined"==typeof e)return"";e=""+e,e=e.replace(this.Reg[0],"");var t=e.indexOf("_"),i=e.substr(0,t),n=e.substr(t+1),a="";switch(i){case"s":a=this.getSystemVar(n);break;case"u":a=this.getUserInfo(n);break;case"g":a=this.getGlobal(n);break;case"m":a=this.getMasterEl(n);break;case"b":a=this.getBackgroundEl(n);break;case"p":a=this.getPageEl(n);break;case"l":a=this.getLayerEl(n);break;case"v":a=this.getVote(n);break;case"z":a=this.getZhuli(n);break;case"f":a=this.getForm(n);break;default:a=this.getOld(e)}if(!_.isNumber(a)){var o=$("<input type='text' />");o.val(a),a=""+o.val(),o.remove()}return a},getSystemVar:function(e){switch(e){case"time":return(new Date).toLocaleString();case"countnum":return interaction_view.forpreview?123:"undefined"!=typeof wx_config&&wx_config.countnum?wx_config.countnum:0}return""},getUserInfo:function(e){switch(e){case"uid":return"81234671";case"name":return"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname?epub360_userinfo.nickname:"user1";case"portrait":return""}return""},getGlobal:function(e){switch(e){case"global1":return"global1"}return""},getMasterEl:function(e){var t=e.split(this.Spliter),i=interaction_view.imasterlist.where({id:t[0]})[0];if(i){var n=i.iOverlaylist.where({id:t[1]})[0];if(n)return this.getOverlayValue(n)}return""},getBackgroundEl:function(e){var t=e.split(this.Spliter),i=interaction_view.ibackgroundlist.where({id:t[0]})[0];if(i){var n=i.iOverlaylist.where({id:t[1]})[0];if(n)return this.getOverlayValue(n)}return""},getPageEl:function(e){var t=e.split(this.Spliter),i=interaction_view.ipagelist.getPage(t[0]);if(i){var n=i.iOverlaylist.where({id:t[1]})[0];if(n)return this.getOverlayValue(n)}return""},getLayerEl:function(e){var t=e.split(this.Spliter),i=interaction_view.ipagelist.getPage(t[0]);if(i){var n=i.iOverlaylist.where({id:t[1]})[0];if(n){var a=interaction_view.ilayerlist.where({id:t[2]})[0];if(a){var o=a.overlays.filter(function(e){return e.id==t[3]})[0];if(o){var r=n.iview.$el.find("[data-id="+t[2]+"]").find("#"+t[3]);switch(o.iType){case"Variable":return 0==o.iDetail.iKind||2==o.iDetail.iKind?Number(r.text()):r.text();case"Paragraph":return r.find(".iText").text();case"Input":return r.find("input").val();case"Textarea":return r.find("textarea").val()}}}}}return""},getOverlayValue:function(e){switch(e.attributes.iType){case"Variable":return 0==e.attributes.iDetail.iKind||2==e.attributes.iDetail.iKind?Number(e.attributes.iDetail.initial):String(e.attributes.iDetail.initial);case"Paragraph":return e.iview.$el.find(".iText").text();case"Input":return e.iview.$el.find("input").val();case"Textarea":return e.iview.$el.find("textarea").val()}},getVote:function(e){var t=this.isVote(e);return t?this.getVoteVal(t):0},getVoteVal:function(e){var t=e.item[0],i=e.item[0].attributes.iDetail,n=parseInt(i.initial);return""==e.ext?n=t.get("value")||parseInt(i.initial):"position"==e.ext?n=t.get("position")||0:"voted"==e.ext&&(n=t.get("voted")||0),n},isVote:function(e){var t,i;return t=e.split("_"),i=t.length>1?t[1]:"",t.length>1&&["position","voted"].indexOf(i)>-1&&(e=t[0]),item=_.filter(interaction_view.environment.Votes.collection,function(t){return t.id==e}),item.length?{item:item,ext:i}:!1},getZhuli:function(e){switch(e){case"identity":if("undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname)return interaction_view.environment.Shareapp.usertype();case"count":if("undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname)return interaction_view.environment.Shareapp.total();case"initiater":"undefined"!=typeof epub360_userinfo&&epub360_userinfo.nickname&&(2==interaction_view.environment.Shareapp.status?1:0)}return""},getForm:function(e){var t=interaction_view.application.getFormFieldValue(e);return null!=t?t:""},getOld:function(e){switch(e){case"å©å_ç¨æ·èº«ä»½":return this.getZhuli("identity");case"å©å_å©åæ°":return this.getZhuli("count");case"å©å_æ¯å¦åèµ·":return this.getZhuli("initiater");case"å¾®ä¿¡_ç¨æ·æµç§°":return this.getUserInfo("name")}var t=this.isVote(e);if(t)return this.getVoteVal(t);var i=interaction_view.ibackgroundlist.at(0).iOverlaylist.where({id:e})[0];if(i)return this.getOverlayValue(i);if(i=interaction_view.imasterlist.at(0).iOverlaylist.where({id:e})[0])return this.getOverlayValue(i);var n=interaction_view.ipagelist.getPage(interaction_view.currentPage);return(i=n.iOverlaylist.where({id:e})[0])?this.getOverlayValue(i):""}}}),define("interaction_view/ui/pluginmanage",["interaction_view/model/base"],function(){interaction_view.PluginManage={Actions:{},ActionExecutes:{},init:function(){if(epub360.PlayerPlugins.length){for(var e=[],t=[],i=[],n=[],a=0;a<epub360.PlayerPlugins.length;a++){var o=epub360.PlayerPlugins[a];"actionexecute"==o.type?i.push(o):"action"==o.type?n.push(o):t.push(o)}for(var a=0;a<i.length;a++){var o=i[a];interaction_view.PluginManage.initActionExecute(o)}for(var a=0;a<n.length;a++){var o=n[a];interaction_view.PluginManage.initAction(o)}for(var r=0,a=0;a<t.length;a++)void 0==t[a].order&&(t[a].config.Model?_.find(t,function(e){return e.config.type==t[a].config.Model})?void 0===_.find(t,function(e){return e.config.type==t[a].config.Model}).order?(_.find(t,function(e){return e.config.type==t[a].config.Model}).order=r,r+=1,t[a].order=r,r+=1):t[a].order=r:(t[a].order=r,r+=1):void 0===t[a].order&&(t[a].order=r,r+=1));e=_.sortBy(t,function(e){return e.order});for(var a=0;a<e.length;a++){var s,o=e[a],l=o.config;if(interaction_view.model[l.type])return;var c=interaction_view.PluginManage.parsePluginConfig(l);l.template?(s=_eT[l.template]?_eT[l.template]:l.template,delete l.template):s=_eT.Container,window.funcT["_"+l.type]=_.template(s),interaction_view.PluginManage.initMVC(o,l,c)}}},initMVC:function(e,t,i){var n=t.Model||"Base";delete t.Model;var a=e.onInitialize;delete e.onInitialize;var o=e.onEpubReady;o&&interaction_view.events.epub360StartEvents.push(o),delete e.onEpubReady;var r=interaction_view.view[n].extend(_.omit(e,"config"));interaction_view.model[t.type]=interaction_view.model[n].extend({defaults:i,setcollection:function(){},setview:function(){this.iview=new r({model:this})},onInitialize:a})},parsePluginConfig:function(e){var t={iCommon:{},iDetail:{},iParentdiv:".interaction-view"};if(t.iType=e.type,e.actions&&e.actions.length)for(var i=0;i<e.actions.length;i++){var n=e.actions[i];interaction_view.PluginManage.Actions[n.type]||(interaction_view.PluginManage.Actions[n.type]=n.func)}return t},initAction:function(e){delete e.type;var t=e.config;interaction_view.PluginManage.Actions[t.type]=e.config.func},initActionExecute:function(e){delete e.type;var t=e.config;interaction_view.PluginManage.ActionExecutes[t.type]=e.config}}}),function(e){"function"==typeof define&&define.amd?define("coverFlow",["jquery"],e):e(jQuery)}(function(e){if(!e.ui||!e.Widget){e.ui=e.ui||{};var t=0,i=Array.prototype.slice;e.widget=function(t,i,n){var a,o,r,s,l={},c=t.split(".")[0];return t=t.split(".")[1],a=c+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][a.toLowerCase()]=function(t){return!!e.data(t,a)},e[c]=e[c]||{},o=e[c][t],r=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new r(e,t)},e.extend(r,o,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),s=new i,s.options=e.widget.extend({},s.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},a=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=a,t=n.apply(this,arguments),this._super=i,this._superApply=o,t}}()):void(l[t]=n)}),r.prototype=e.widget.extend(s,{widgetEventPrefix:o?s.widgetEventPrefix||t:t},l,{constructor:r,namespace:c,widgetName:t,widgetFullName:a}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete o._childConstructors):i._childConstructors.push(r),e.widget.bridge(t,r),r},e.widget.extend=function(t){for(var n,a,o=i.call(arguments,1),r=0,s=o.length;s>r;r++)for(n in o[r])a=o[r][n],o[r].hasOwnProperty(n)&&void 0!==a&&(t[n]=e.isPlainObject(a)?e.isPlainObject(t[n])?e.widget.extend({},t[n],a):e.widget.extend({},a):a);return t},e.widget.bridge=function(t,n){var a=n.prototype.widgetFullName||t;e.fn[t]=function(o){var r="string"==typeof o,s=i.call(arguments,1),l=this;return o=!r&&s.length?e.widget.extend.apply(null,[o].concat(s)):o,this.each(r?function(){var i,n=e.data(this,a);return"instance"===o?(l=n,!1):n?e.isFunction(n[o])&&"_"!==o.charAt(0)?(i=n[o].apply(n,s),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}:function(){var t=e.data(this,a);t?(t.option(o||{}),t._init&&t._init()):e.data(this,a,new n(o,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},_on:function(t,i,n){var a,o=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=a=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,a=this.widget()),e.each(n,function(n,r){function s(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof r?o[r]:r).apply(o,arguments):void 0}"string"!=typeof r&&(s.guid=r.guid=r.guid||s.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+o.eventNamespace,d=l[2];d?a.delegate(d,c,s):i.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_trigger:function(t,i,n){var a,o,r=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(a in o)a in i||(i[a]=o[a]);return this.element.trigger(i,n),!(e.isFunction(r)&&r.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}()}!function(e,t,i,n){function a(e,t,i,n){var a=this;a.widget=e,a.element=t,a.items=i,a.options=n}function o(e){return parseFloat((.017453*e).toFixed(6))}function r(){e.coverflow.renderer.Classic.apply(this,arguments)}function s(e,t){return typeof e===t}function l(e,t){return!!~(""+e).indexOf(t)}function c(e,t){var i,a;for(i in e)if(a=e[i],!l(a,"-")&&C[a]!==n)return"pfx"===t?a:!0;return!1}function d(t,i,a){var o,r;for(o in t)if(r=i[t[o]],r!==n)return a===!1?t[o]:s(r,"function")?e.proxy(r,a||i):r;return!1}function h(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+P.join(n+" ")+n).split(" ");return s(t,"string")||s(t,"undefined")?c(a,t):(a=(e+" "+E.join(n+" ")+n).split(" "),d(a,t,i))}e.coverflow={renderer:{},support:{}},a.prototype={cssClass:"classic",itemMargin:0,initialize:function(){var t=this,i=t.options,n={},a=t.items.eq(t.widget.currentIndex);t.itemSize=a.width(),t.outerWidth=t.element.parent().outerWidth(!1),t.itemMargin=-Math.floor(i.overlap/2*a.innerWidth()),t.items.css({marginLeft:t.itemMargin,marginRight:t.itemMargin}),n.width=t.items.width()*t.items.length,e.extend(n,t._getCenterPosition()),t.element.css(n)},_getCenterPosition:function(){var e,t=this,i=t.itemSize,n=t.widget.currentIndex;return e=(t.outerWidth-i)/2,e-=n*t.itemSize/2,e+=parseInt(t.element.css("paddingLeft"),10)||0,e-=n*t.itemMargin*2,e-=t.itemMargin,e=Math.round(e),{left:e}},select:function(){return this._getCenterPosition()},getElementTransitionStyles:function(t){var i=e.coverflow.transition[t.easing]||e.coverflow.transition.easeOutQuint;return e.extend(this._getCenterPosition(),{transition:"left "+t.duration+"ms "+i})},refresh:function(t,i,n){var a=this,o=a.options,r=a.items.length,s=a.itemSize,l=a.itemMargin;this.items.each(function(c){var d=c===n&&0>i-n||c-n>0?"left":"right",h=c===n?1-t:c===i?t:1,u={zIndex:r+("left"===d?n-c:c-n)+10},p=1-h*(1-o.scale),m=[p,h*("right"===d?-.15:.15),0,p,0,0];u.left=-c*(s/2)+("right"===d?-s/2+s/2*o.overlap:s/2-s/2*o.overlap)*h,e.coverflow.isOldie&&(c===n?(u.left+=l,u.top=0):u.top=Math.ceil(-l/2)),a._transform(this,u,m),e(this).css(u)})},_transform:function(){var t=this;return e.coverflow.support.transform?void t._matrixTransform.apply(t,arguments):void(e.coverflow.isOldie&&t._fallbackTransform.apply(t,arguments))},_matrixTransform:function(e,t,i){t.transform="matrix("+i.join(",")+")"},_fallbackTransform:function(e,t,i){e.filters["DXImageTransform.Microsoft.Matrix"]||(e.style.filter=(e.style.filter?"":" ")+'progid:DXImageTransform.Microsoft.Matrix(sizingMethod="auto expand")');var n=e.filters["DXImageTransform.Microsoft.Matrix"];n.M11=i[0],n.M12=i[2],n.M21=i[1],n.M22=i[3]}},e.extend(e.coverflow.renderer,{Classic:a}),r.prototype={cssClass:"3d",initialize:function(){var t=this,i={};t.itemSize=t.items.eq(t.widget.currentIndex).outerWidth(!0),t.outerWidth=t.element.parent().outerWidth(!1),i.width=t.itemSize*t.items.length,e.extend(i,t._getCenterPosition(),t._getPerspectiveOrigin()),t.element.css(i)},getItemRenderedWidth:function(){var e=this.options;return Math.cos(o(e.angle))*this.itemSize*e.scale},_getPerspectiveOrigin:function(){var e=this,t=e.options;return{perspectiveOrigin:Math.round(e.itemSize/2+e.widget.currentIndex*e.getItemRenderedWidth()*(1-t.overlap))+"px "+t.perspectiveY+"%"}},_getCenterPosition:function(){var e,t=this,i=t.getItemRenderedWidth(),n=t.widget.currentIndex;return e=(t.outerWidth-t.itemSize)/2,e-=n*i,e+=n*i*t.options.overlap,e-=parseInt(t.element.css("paddingLeft"),10)||0,e=Math.round(e),{left:e}},select:function(){return e.extend({},this._getCenterPosition(),this._getPerspectiveOrigin())},getElementTransitionStyles:function(t){var i=this,n=e.coverflow.transition[t.easing]||e.coverflow.transition.easeOutQuint,a={transitionProperty:"left",transitionDuration:t.duration+"ms",transitionTimingFunction:n,transitionDelay:"initial"};return e.extend(a,i._getCenterPosition(),i._getPerspectiveOrigin())},refresh:function(t,i,n){var a=this,r=a.options,s=a.items.length,l=a.itemSize,c=a.getItemRenderedWidth();this.items.each(function(a){var d,h=a===n&&0>i-n||a-n>0?"left":"right",u=a===n?1-t:a===i?t:1,p={zIndex:s+("left"===h?n-a:a-n)+10},m=1-u*(1-r.scale),f="right"===h?r.angle:-r.angle;f=o(u*f),p.left=Math.round(-a*l+u*a*c*(1-r.overlap)+(1-u)*a*c*(1-r.overlap)),d=[(m*Math.cos(f)).toFixed(6),0,Math.sin(-f).toFixed(6),0,0,m,0,0,Math.sin(f).toFixed(6),0,(m*Math.cos(f)).toFixed(6),0,0,0,0,1],p.transform="matrix3d("+d.join(", ")+")",p.transformOrigin="right"===h?"left center":"right center",e(this).css(p)})}},e.extend(e.coverflow.renderer,{ThreeD:r});for(var u=i.createElement("div"),p=u.style,m=0,f=["ms","moz","webkit","o"],v=f.length,g="",w=0,_=e.coverflow.support,y=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};v>w&&!t.requestAnimationFrame;w++)t.requestAnimationFrame=t[f[w]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[f[w]+"CancelAnimationFrame"]||t[f[w]+"CancelRequestAnimationFrame"];if(t.requestAnimationFrame||(t.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-m)),a=t.setTimeout(function(){e(i+n)},n);return m=i+n,a}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(e){clearTimeout(e)}),e.each(f,function(e,t){return"ms"!==t&&(t=y(t)),!_.transform&&t+"Transform"in p&&(_.transform=t+"Transform"),!_.transition&&t+"Transition"in p&&(_.transition=t+"Transition"),_.transform&&_.transition?(g=t,!1):!0}),_.transform&&_.transition||(_.transform="transform"in p?"transform":!1,_.transition="transition"in p?"transition":!1),null==e.support.transform&&(e.support.transform=_.transform),null==e.support.transition&&(e.support.transition=_.transition),null==e.cssProps)throw new Error("Your jQuery version is too old. Please upgrade.");g&&e.each(["transitionProperty","transitionDuration","transitionTimingFunction","transitionDelay","perspectiveOrigin"],function(t,i){null==e.cssProps[i]&&(e.cssProps[i]=g+y(i))}),u=null;var b,x=i.documentElement,S="coverflowjsfeaturedetection",T=i.createElement(S),C=T.style,k="Webkit Moz O ms",P=k.split(" "),E=k.toLowerCase().split(" "),D=function(e,t,n,a){var o,r,s,l,c=i.createElement("div"),d=i.body,h=d||i.createElement("body");if(parseInt(n,10))for(;n--;)s=i.createElement("div"),s.id=a?a[n]:S+(n+1),c.appendChild(s);return o=["&#173;","<style id='s",S,"'>",e,"</style>"].join(""),c.id=S,(d?c:h).innerHTML+=o,h.appendChild(c),d||(h.style.background="",h.style.overflow="hidden",l=x.style.overflow,x.style.overflow="hidden",x.appendChild(h)),r=t(c,e),d?c.parentNode.removeChild(c):(h.parentNode.removeChild(h),x.style.overflow=l),!!r},A={}.hasOwnProperty;b=s(A,"undefined")||s(A.call,"undefined")?function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")}:function(e,t){return A.call(e,t)},e.coverflow.support.transform3d=function(){var e=!!h("perspective");return e&&"webkitPerspective"in x.style&&D("@media (transform-3d),(-webkit-transform-3d){#coverflowjsfeaturedetection{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e}(),null==e.support.transform3d&&(e.support.transform3d=e.coverflow.support.transform3d);var $={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"transitionend"},I=navigator.userAgent.toLowerCase(),O=function(){var e=/(msie) ([\w.]+)/.exec(I);return null!==e&&e[1]&&~~e[2]<10}();e.coverflow=e.extend(!0,{},e.coverflow,{isAndroid:/android/.test(I),isOldie:O,transition:{easeInQuad:"cubic-bezier( .55,.085,.68,.53 )",easeInCubic:"cubic-bezier( .550, .055, .675, .190 )",easeInQuart:"cubic-bezier( .895, .03, .685, .22 )",easeInQuint:"cubic-bezier( .755, .05, .855, .06 )",easeInSine:"cubic-bezier( .47, 0, .745, .715 )",easeInExpo:"cubic-bezier( .95, .05, .795, .035 )",easeInCirc:"cubic-bezier( .6, .04, .98, .335 )",easeInBack:"cubic-bezier( .6, -.28, .735, .045 )",easeOutQuad:"cubic-bezier( .25,.46,.45,.94 )",easeOutCubic:"cubic-bezier( .215,.61,.355,1 )",easeOutQuart:"cubic-bezier( .165, .84, .44, 1 )",easeOutQuint:"cubic-bezier( .23, 1, .32, 1 )",easeOutSine:"cubic-bezier( .39, .575, .565, 1 )",easeOutExpo:"cubic-bezier( .19,1,.22,1 )",easeOutCirc:"cubic-bezier( .075, .82, .165, 1 )",easeOutBack:"cubic-bezier( .175, .885, .32, 1.275 )",easeInOutQuad:"cubic-bezier( .455, .03, .515, .955 )",easeInOutCubic:"cubic-bezier( .645, .045, .355, 1 )",easeInOutQuart:"cubic-bezier( .77, 0, .175, 1 )",easeInOutQuint:"cubic-bezier( .86, 0, .07, 1 )",easeInOutSine:"cubic-bezier( .445, .05, .55, .95 )",easeInOutExpo:"cubic-bezier( 1, 0, 0, 1 )",easeInOutCirc:"cubic-bezier( .785, .135, .15, .86 )",easeInOutBack:"cubic-bezier( .68, -.55, .265, 1.55 )"},renderer:{}}),e.widget("ui.coverflow",{options:{items:"> *",active:0,duration:400,easing:"easeOutQuint",angle:45,perspectiveY:45,scale:.7,overlap:.3,trigger:{itemfocus:!1,itemclick:!0,mousewheel:!0}},isTicking:!1,_create:function(){var i,n,a=this,o=this.options,r=e.coverflow.support||{};a.elementOrigStyle=a.element.attr("style"),a.items=a.element.find(o.items).each(function(){var t=e(this);t.data({coverflowOrigElemAttr:{style:t.attr("style"),"class":t.attr("class"),tabIndex:t.attr("tabIndex")}})}).addClass("ui-coverflow-item"),a._setDimensions(),a.support=r,i=r.transform&&!O&&null==t.opera&&r.transform3d?e.coverflow.renderer.ThreeD:e.coverflow.renderer.Classic,n={angle:o.angle,perspectiveY:o.perspectiveY,scale:o.scale,overlap:o.overlap,itemSize:a.itemSize,outerWidth:a.outerWidth},a.renderer=new i(a,a.element,a.items,n),a.element.addClass("ui-coverflow ui-coverflow-"+a.renderer.cssClass+"-render").parent().addClass("ui-coverflow-wrapper ui-clearfix"),o.trigger.itemfocus&&this._bindFocus(),o.trigger.itemclick&&a.element.data("CoverFlowDisableClick",!1)&&a._on(a.items,{click:function(e){a.element.data("CoverFlowDisableClick")||a._select(e)}}),o.trigger.mousewheel&&a._on({mousewheel:a._onMouseWheel,DOMMouseScroll:a._onMouseWheel}),a.useJqueryAnimate=!(r.transition&&e.isFunction(t.requestAnimationFrame)),a.coverflowrafid=0},_bindFocus:function(){var e=this;e.items.prop("tabIndex",0),e._on(e.items,{focus:e._select})},_init:function(){var e=this,t=e.options;t.duration=~~t.duration,t.duration<1&&(t.duration=1),e.currentIndex=e._isValidIndex(t.active,!0)?t.active:0,e.activeItem=e.items.removeClass("ui-state-active").eq(e.currentIndex).addClass("ui-state-active"),e._setDimensions(),e.renderer.initialize(),e._refresh(1,e._getFrom(),e.currentIndex),e._trigger("beforeselect",null,e._ui()),e._trigger("select",null,e._ui())},_setDimensions:function(){var e=this;e.itemWidth=e.items.width(),e.itemHeight=e.items.height(),e.itemSize=e.items.outerWidth(!0),e.outerWidth=e.element.parent().outerWidth(!1)},_isValidIndex:function(e,t){return t=!!t,e=~~e,(this.currentIndex!==e||t)&&e>-1&&!!this.items.get(e)},_select:function(e){this.select(e.currentTarget)},next:function(){return this.select(this.currentIndex+1)},prev:function(){return this.select(this.currentIndex-1)},_getFrom:function(){var e=this;return Math.abs(e.previous-e.currentIndex)<=1?e.previousIndex:e.currentIndex+(e.previousIndex<e.currentIndex?-1:1)},select:function(i){var n,a=this,o=a.options,r=isNaN(parseInt(i,10))?a.items.index(i):parseInt(i,10);return a._isValidIndex(r)?!1===a._trigger("beforeselect",null,this._ui(a.items.eq(r),r))?!1:(a.isTicking&&(a.useJqueryAnimate?a.element.stop(!0,!1):(a.coverflowrafid&&t.cancelAnimationFrame(a.coverflowrafid),a.element.unbind($[a.support.transition]))),a.isTicking=!0,a.previousIndex=a.currentIndex,o.active=a.currentIndex=r,n=e.extend({},a.renderer.select(),{coverflow:1}),a.useJqueryAnimate?a._animation(o,n):(o=e.extend({duration:o.duration,easing:o.easing},n),a._transition(o)),!0):!1},_animation:function(t,i){var n=this,a=this._getFrom();e.fx.step.coverflow=function(e){n._refresh(e.now,a,n.currentIndex)},n.element.animate(i,{duration:t.duration,easing:t.easing}).promise().done(function(){n._onAnimationEnd()})},_transition:function(i){var n=this,a=new Date,o=n._getFrom(),r=n.currentIndex,s={},l=function(){var e=((new Date).getTime()-a.getTime())/i.duration;e>1?n.isTicking=!1:n._refresh(e,o,r),n.isTicking&&(n.coverflowrafid=t.requestAnimationFrame(l))};e.isFunction(n.renderer.getElementTransitionStyles)&&(s=e.extend(s,n.renderer.getElementTransitionStyles(i))),n.element.one($[n.support.transition],function(){n._refresh(1,o,r),n._onAnimationEnd()}).css(s),n.coverflowrafid=t.requestAnimationFrame(l)},_onAnimationEnd:function(){var e=this;e.coverflowrafid&&cancelAnimationFrame(e.coverflowrafid),e.isTicking=!1,e.activeItem=e.items.removeClass("ui-state-active").eq(e.currentIndex).addClass("ui-state-active"),e._trigger("select",null,e._ui())},_refresh:function(e,t,i){this.element.parent().scrollTop(0),this.renderer.refresh(e,t,i)},_ui:function(e,t){return{active:e||this.activeItem,index:null!=t?t:this.currentIndex}},_onMouseWheel:function(e){var t=e.originalEvent;return e.preventDefault(),t.wheelDelta>0||t.detail<0?void this.prev():void this.next()},_destroy:function(){var t=this;t.elementOrigStyle!==n?t.element.attr("style",this.elementOrigStyle):t.element.removeAttr("style"),t.element.removeClass("ui-coverflow ui-helper-clearfix ui-coverflow-"+(t.renderer.cssClass||"classic")+"-render").parent().removeClass("ui-coverflow-wrapper ui-clearfix"),t.items.removeClass("ui-coverflow-item ui-state-active").each(function(){var t=e(this),i=t.data("coverflowOrigElemAttr");e.each(i,function(e,i){i!==n?t.attr(e,i):t.removeAttr(e)}),t.data("coverflowOrigElemAttr",null)}),t._super()}})}(e,this,this.document)}),function(){var e={init:function(){var e={init:function(t){return this.each(function(){var i=$(this),n=i.data("eraser");if(!n){var a=i.width(),o=i.height(),r=i.offset(),s=$("<canvas/>"),l=s.get(0),c=t.imageWidth,d=t.imageHeight,h=t&&t.size?t.size:40,u=t&&t.completeRatio?t.completeRatio:.7,p=t&&t.completeFunction?t.completeFunction:null,m=t&&t.completeRatioFunction?t.completeRatioFunction:null,f=[],v=Math.floor(a/h)||1,g=v*(Math.floor(o/h)||1),w=g,_=l.getContext("2d");if(i.after(s),l.id=this.id,l.className=this.className,l.width=a,l.height=o,!this.src)return;var y=new Image;y.onload=function(){for(c&&d?_.drawImage(y,0,0,c,d):_.drawImage(y,0,0),i.remove(),_.globalCompositeOperation="destination-out",_.strokeStyle="rgba(255,0,0,255)",_.lineWidth=h,_.lineCap="round",s.bind("mousedown.eraser",e.mouseDown),s.bind("touchstart.eraser",e.touchStart),s.bind("touchmove.eraser",e.touchMove),s.bind("touchend.eraser",e.touchEnd);w--;)f.push(1);$.zoom||($.zoom=1),n={posX:r.left,posY:r.top,touchDown:!1,touchID:-999,touchX:0,touchY:0,ptouchX:0,ptouchY:0,canvas:s,ctx:_,w:a,h:o,source:y,size:h,parts:f,colParts:v,numParts:g,ratio:0,complete:!1,completeRatio:u,completeFunction:p,completeRatioFunction:m,imageWidth:c,imageHeight:d},s.data("eraser",n),i.data("eraser",n),$(window).resize(function(){$.zoom||($.zoom=1);var e=s.offset();n.posX=e.left,n.posY=e.top,s.data("eraser",n)})},y.src=this.src}})},touchStart:function(t){var i=$(this),n=i.data("eraser"),a=i.offset();if(n.posX=a.left,n.posY=a.top,!n.touchDown){var o=t.originalEvent.changedTouches[0],r=o.pageX/$.zoom-n.posX,s=o.pageY/$.zoom-n.posY;e.evaluatePoint(n,r,s),n.touchDown=!0,n.touchID=o.identifier,n.touchX=r,n.touchY=s,t.preventDefault()}},touchMove:function(t){var i=$(this),n=i.data("eraser"),a=i.offset();if(n.posX=a.left,n.posY=a.top,n.touchDown)for(var o=t.originalEvent.changedTouches,r=o.length;r--;)if(o[r].identifier==n.touchID){var s=o[r].pageX/$.zoom-n.posX,l=o[r].pageY/$.zoom-n.posY;e.evaluatePoint(n,s,l),n.ctx.beginPath(),n.ctx.moveTo(n.touchX,n.touchY),n.touchX=s,n.touchY=l,n.ctx.lineTo(n.touchX,n.touchY),n.ctx.stroke(),t.preventDefault();break}},touchEnd:function(e){var t=$(this),i=t.data("eraser"),n=t.offset();if(i.posX=n.left,i.posY=n.top,i.touchDown)for(var a=e.originalEvent.changedTouches,o=a.length;o--;)if(a[o].identifier==i.touchID){i.touchDown=!1,e.preventDefault();break}},evaluatePoint:function(e,t,i){var n=Math.floor(t/e.size)+Math.floor(i/e.size)*e.colParts;n>=0&&n<e.numParts&&(e.ratio+=e.parts[n],e.parts[n]=0,e.complete||e.ratio/e.numParts>=e.completeRatio&&(e.complete=!0,null!=e.completeRatioFunction&&e.completeRatioFunction()))},mouseDown:function(t){var i=$(this),n=i.data("eraser"),a=i.offset();n.posX=a.left,n.posY=a.top;var o=t.pageX/$.zoom-n.posX,r=t.pageY/$.zoom-n.posY;console.log("mouse page "+t.pageX+" "+t.pageY),console.log("offset "+n.posX+" "+n.posY),e.evaluatePoint(n,o,r),n.touchDown=!0,n.touchX=o,n.touchY=r,n.ctx.beginPath(),n.ctx.moveTo(n.touchX-1,n.touchY),n.ctx.lineTo(n.touchX,n.touchY),n.ctx.stroke(),i.bind("mousemove.eraser",e.mouseMove),$(document).bind("mouseup.eraser",n,e.mouseUp),t.preventDefault()
},mouseMove:function(t){var i=$(this),n=i.data("eraser"),a=i.offset();n.posX=a.left,n.posY=a.top;var o=t.pageX/$.zoom-n.posX,r=t.pageY/$.zoom-n.posY;e.evaluatePoint(n,o,r),n.ctx.beginPath(),n.ctx.moveTo(n.touchX,n.touchY),n.touchX=o,n.touchY=r,n.ctx.lineTo(n.touchX,n.touchY),n.ctx.stroke(),t.preventDefault()},mouseUp:function(e){var t=e.data,i=t.canvas;t.touchDown=!1,i.unbind("mousemove.eraser"),$(document).unbind("mouseup.eraser"),e.preventDefault()},clear:function(){var e=$(this),t=e.data("eraser");if(t){h=0;var i=function(){t.ctx.clearRect(0,0,t.w,t.h);for(var e=t.numParts;e--;)t.parts[e]=0;t.ratio=t.numParts,t.complete=!0,null!=t.completeFunction&&t.completeFunction()};i()}},size:function(e){var t=$(this),i=t.data("eraser");i&&e&&(i.size=e,i.ctx.lineWidth=e)},reset:function(){var e=$(this),t=e.data("eraser");if(t){t.ctx.globalCompositeOperation="source-over",t.imageWidth&&t.imageHeight?t.ctx.drawImage(t.source,0,0,t.imageWidth,t.imageHeight):t.ctx.drawImage(t.source,0,0),t.ctx.globalCompositeOperation="destination-out";for(var i=t.numParts;i--;)t.parts[i]=1;t.ratio=0,t.complete=!1}}};$.fn.eraser=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void $.error("Method "+t+" does not yet exist on jQuery.eraser"):e.init.apply(this,arguments)}},set:function(e,t,i,n){$(e).eraser({size:40,imageWidth:t,imageHeight:i,completeRatio:.5,completeRatioFunction:function(){$(e).eraser("clear"),interaction_view.events.onEraserEvent(n)},completeFunction:function(){n.$el.addClass("invisible noevents")}})},reset:function(e){$(e).eraser("reset")}};"undefined"==typeof require?(window._e||(window._e={}),window._e.eraser=e):define("_e/eraser",["jquery"],function(){return window._e||(window._e={}),window._e.eraser=e,_e.eraser.init(),window._e.eraser})}(window),function(){function e(e){if(this.options={className:"child_Element",onStart:null,onEnd:null,autoClear:!1},"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.init()}var t={1:"bounce",2:"flash",3:"pulse",4:"rubberBand",5:"shake",6:"swing",7:"tada",8:"wobble",9:"jello",12:"rotate",20:"bounceIn",21:"bounceInDown",22:"bounceInLeft",23:"bounceInRight",24:"bounceInUp",61:"bounceOut",62:"bounceOutDown",63:"bounceOutLeft",64:"bounceOutRight",65:"bounceOutUp",25:"fadeIn",26:"fadeInDown",27:"fadeInDownBig",28:"fadeInLeft",29:"fadeInLeftBig",30:"fadeInRight",31:"fadeInRightBig",32:"fadeInUp",33:"fadeInUpBig",67:"fadeOut",68:"fadeOutDown",69:"fadeOutDownBig",70:"fadeOutLeft",71:"fadeOutLeftBig",72:"fadeOutRight",73:"fadeOutRightBig",74:"fadeOutUp",75:"fadeOutUpBig",11:"flip",34:"flipInX",35:"flipInY",76:"flipOutX",77:"flipOutY",36:"lightSpeedIn",78:"lightSpeedOut",37:"rotateIn",38:"rotateInDownLeft",39:"rotateInDownRight",40:"rotateInUpLeft",41:"rotateInUpRight",79:"rotateOut",80:"rotateOutDownLeft",81:"rotateOutDownRight",82:"rotateOutUpLeft",83:"rotateOutUpRight",10:"hinge",42:"rollIn",93:"rollOut",44:"zoomIn",45:"zoomInDown",46:"zoomInLeft",47:"zoomInRight",48:"zoomInUp",84:"zoomOut",85:"zoomOutDown",86:"zoomOutLeft",87:"zoomOutRight",88:"zoomOutUp",49:"slideInDown",50:"slideInLeft",51:"slideInRight",52:"slideInUp",89:"slideOutDown",90:"slideOutLeft",91:"slideOutRight",92:"slideOutUp"};e.prototype.init=function(){for(var e=0;e<this.options.items.length;e++){var t=this.options.items[e];this.options.items[e].origin_el=t.el,t.el.wrapInner('<div class="'+this.options.className+'" style="position:absolute;top:0;left:0;width:100%;height:100%;"></div>'),this.options.items[e].originClass=this.options.className,this.options.items[e].el=t.el.children("div"),this.options.items[e].child=!0}},e.prototype.play=function(){this.options.onStart&&this.options.onStart();for(var e=0;e<this.options.items.length;e++){var i=this.options.items[e],n=i.repeat;n=n?-1==n?"infinite":n:"1";var a=i.el;a.data("anitype",i.type),this.bindEnd(e,a);var o=t[i.type],r=i.originClass.replace("hide","")+" "+o+" animated";a[0].style.animationDuration=i.duration+"s",a[0].style.animationDelay=i.delay+"s",a[0].style.animationIterationCount=n,a[0].style.webkitAnimationDuration=i.duration+"s",a[0].style.webkitAnimationDelay=i.delay+"s",a[0].style.webkitAnimationIterationCount=n,i.type<20?a.attr("data-effect","1"):i.type>=20&&i.type<=60?(a.closest(".iView").hasClass("hide")&&(a[0].initHide=!0,a.closest(".iView").removeClass("hide")),i.onShow&&i.onShow(),a.attr("data-in","1"),this.options.autoClear&&a.closest(".iView").find("[data-out]").children().unwrap()):i.type>60&&(a.attr("data-out","1"),this.options.autoClear&&a.closest(".iView").find("[data-in]").children().unwrap()),a[0].className=r}},e.prototype.stop=function(){for(var e=0;e<this.options.items.length;e++){var t=this.options.items[e];t.el[0].className=this.options.className,t.el[0].style.animationDuration="",t.el[0].style.animationDelay="",t.el[0].style.animationIterationCount="",t.el[0].style.webkitAnimationDuration="",t.el[0].style.webkitAnimationDelay="",t.el[0].style.webkitAnimationIterationCount="",t.el[0].initHide&&t.el.closest(".iView").addClass("hide"),t.el.closest(".iView").find(".child_Action_Element").children().unwrap()}},e.prototype.bindEnd=function(e,t){var i=this;t.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).unbind("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend");var t=$(this).data("anitype");t>=20&&60>=t?$(this).closest(".iView").removeClass("noevents"):t>60&&100>t&&$(this).closest(".iView").addClass("noevents"),i.options.items[e].finished=!0,i.options.autoClear&&$(this).attr("data-effect")&&$(this).children().length&&$(this).children().unwrap(),i.end()})},e.prototype.end=function(){_.filter(this.options.items,function(e){return e.finished}).length==this.options.items.length&&(console.log("all animate end"),this.options.onEnd&&this.options.onEnd())},window.Animate=e,window.ANIMATE_TYPE_VALUE=t}(window),define("_e/cssanimate",function(){}),function(){window.animation=function(e){this.defaults={countTime:0,currentFrame:0,path:null,raster:null,animation:null},this.options=e,this.options=$.extend(!0,{},this.defaults,"object"==typeof e&&e),this.page=this.options.collection.page,this.options.old_animation=$.extend(!0,{},this.options.animation),this.init()},window.animation.prototype={init:function(){_.bindAll(this),this.handleVars(),0==this.options.animation.iKind&&this.setparam(),1==this.options.animation.iKind&&this.setgroupparam()},refresh:function(){this.options.animation=$.extend(!0,{},this.options.old_animation),this.init()},handleVars:function(){var e=this.options.animation,t=interaction_view.getVarsOp(this.page.id,[0,2]);_.each(this.options.animation.iTiming,function(i,n){"object"!=typeof i&&(e.iTiming[n]=Number(t.var2val(i)))}),_.each(this.options.animation.iDetail,function(i,n){var a=String(i);a.length&&"%"!=a[a.length-1]&&"object"!=typeof i&&(e.iDetail[n]=Number(t.var2val(i)))})},cssTovalue:function(e){var t=e;return t=Number(e.split("px")[0])},EaseTypes:{0:"Linear.easeNone",1:"Power0.easeIn",2:"Power0.easeInOut",3:"Power0.easeOut",4:"Power1.easeIn",5:"Power1.easeInOut",6:"Power1.easeOut",7:"Power2.easeIn",8:"Power2.easeInOut",9:"Power2.easeOut",10:"Power3.easeIn",11:"Power3.easeInOut",12:"Power3.easeOut",13:"Power4.easeIn",14:"Power4.easeInOut",15:"Power4.easeOut",16:"Quad.easeIn",17:"Quad.easeInOut",18:"Quad.easeOut",19:"Cubic.easeIn",20:"Cubic.easeInOut",21:"Cubic.easeOut",22:"Quart.easeIn",23:"Quart.easeInOut",24:"Quart.easeOut",25:"Quint.easeIn",26:"Quint.easeInOut",27:"Quint.easeOut",28:"Strong.easeIn",29:"Strong.easeInOut",30:"Strong.easeOut",31:"Back.easeIn",32:"Back.easeInOut",33:"Back.easeOut",34:"Bounce.easeIn",35:"Bounce.easeInOut",36:"Bounce.easeOut",37:"Circ.easeIn",38:"Circ.easeInOut",39:"Circ.easeOut",40:"Elastic.easeIn",41:"Elastic.easeInOut",42:"Elastic.easeOut",43:"Expo.easeIn",44:"Expo.easeInOut",45:"Expo.easeOut",46:"Sine.easeIn",47:"Sine.easeInOut",48:"Sine.easeOut",49:"SlowMo.ease"},getTypeName:function(e){switch(e){case 100:return"åºç°å¨ç»";case 101:return"é£å¥";case 102:return"æ¾å¤§";case 103:return"æ¸ç°";case 104:return"ç¼©å°åºç°";case 200:return"æ¶å¤±å¨ç»";case 201:return"é£åº";case 202:return"ç¼©å°";case 203:return"æ¸é";case 204:return"æ¾å¤§æ¶å¤±";case 300:return"è¿å¨è·¯å¾";case 301:return"ç´çº¿è¿å¨";case 302:return"æ²çº¿è¿å¨";case 400:return"å¼ºè°å¨ç»";case 401:return"æ¾å¤§ç¼©å°";case 402:return"éæ";case 403:return"æè½¬";case 500:return"åªä½å¨ç»";case 501:return"æ­æ¾";case 502:return"æå";case 503:return"ç»æ";case 601:return"éå­åºç°";case 701:return"SVGæç»å¨ç»";case 702:return"SVGåå½¢å¨ç»"}},setpathparam:function(e){var t;this.pathoriginalpoint={};var i=this.page.iOverlaylist.get(this.options.animation.overlay_id);this.obj=i.iview.$el[0];var n=i.get("_offset_x")||0,a=i.get("_offset_y")||0,o=this.options.animation.iDetail.autoRotate||!1;if(o){this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el[0]}var r=this.options.animation.iDetail.closed;if(302==e){if(this.options.animation.iDetail.path.length<2)return this.param=null,!1;t=[],_.each(this.options.animation.iDetail.path,function(e,i,o){if(0!=i&&e.handleIn){var s={};s.x=e.handleIn.x+e.point.x+n,s.y=e.handleIn.y+e.point.y+a,t.push(s)}if(t.push({x:e.point.x+n,y:e.point.y+a}),e.handleOut){var l={};l.x=e.handleOut.x+e.point.x+n,l.y=e.handleOut.y+e.point.y+a,t.push(l)}if(i==o.length-1&&r&&e.handleOut&&o[0].handleIn){var c=o[0].handleIn,d=o[0].point,s={};s.x=c.x+d.x+n,s.y=c.y+d.y+a,t.push(s),t.push(d)}}),this.param.bezier={values:t,type:"cubic",autoRotate:o}}if(301==e){if(this.options.animation.iDetail.path.length<2)return this.param=null,!1;t=[];var s;for(s=0;s<this.options.animation.iDetail.path.length;s++){if(0!=s){var l=this.options.animation.iDetail.path[s-1],c=this.options.animation.iDetail.path[s],d={x:(l.point.x+c.point.x)/2+n,y:(l.point.y+c.point.y)/2+a};t.push(d)}if(t.push({x:this.options.animation.iDetail.path[s].point.x+n,y:this.options.animation.iDetail.path[s].point.y+a}),s==this.options.animation.iDetail.path.length-1&&r){var l=this.options.animation.iDetail.path[s],c=this.options.animation.iDetail.path[0],d={x:(l.point.x+c.point.x)/2+n,y:(l.point.y+c.point.y)/2+a};t.push(d),t.push({x:this.options.animation.iDetail.path[0].point.x+n,y:this.options.animation.iDetail.path[0].point.y+a})}}this.param.bezier={values:t,type:"quadratic",autoRotate:o}}},setappearparam:function(e){this.startshow=!0,this.fromparam={},this.toparam={},this.toparam.onStart=this.onStart,this.toparam.immediateRender=!1,this.toparam.onComplete=this.param.onComplete,this.toparam.delay=this.param.delay,this.toparam.repeat=this.param.repeat,this.toparam.ease=this.param.ease;var t,i,n;if(101==e){this.stopshow=!0,t=this.options.animation.iDetail.direction||0;var a=this.options.animation.iDetail.pathlength||0,o=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.x,r=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.y,s=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.find(".Element").first().width(),l=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.find(".Element").first().height();switch(i={},t){case 0:i.y=a?this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.y-a:"-"+l,i.x=o;break;case 1:i.x=a?this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.x+a:interaction_view.size.x+s,i.y=r;break;case 2:i.y=a?this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.y+a:interaction_view.size.y+l,i.x=o;break;case 3:i.x=a?this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.x-a:"-"+s,i.y=r}this.param.css=i,this.fromparam.css={x:Number(i.x),y:Number(i.y)},this.toparam.css={x:Number(o),y:Number(r)},a&&(this.fromparam.css.opacity=0,this.toparam.css.opacity=1),this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el[0],this.toparam.css.force3D=interaction_view.force3D}if(102==e){this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.children(".Element")[0],t=this.options.animation.iDetail.direction||0,n={},i={};{this.page.iOverlaylist.get(this.options.animation.overlay_id)}n.scale=0,this.param.css=n,this.fromparam.css={scale:0},this.toparam.css={scale:1},this.toparam.css.force3D=interaction_view.force3D,interaction_view.force3D&&_g.device.android()&&TweenLite.set(this.obj,{transformPerspective:2e3})}if(103==e&&(t=this.options.animation.iDetail.direction||0,n={},this.param.css={opacity:0},this.fromparam.css={opacity:0},this.toparam.css={opacity:1},this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el[0],this.toparam.css.force3D=interaction_view.force3D),104==e){this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.children(".Element")[0];var c=Number(this.options.animation.iDetail.scale)||2,d=Number(this.options.animation.iDetail.opacity)||.5;n={},i={};{this.page.iOverlaylist.get(this.options.animation.overlay_id)}n.scale=0,this.param.css=n,this.fromparam.css={scale:c,opacity:d},this.toparam.css={scale:1,opacity:1},this.toparam.css.force3D=interaction_view.force3D,interaction_view.force3D&&_g.device.android()&&TweenLite.set(this.obj,{transformPerspective:2e3})}},setdisappearparam:function(e){var t={};if(201==e){var i=this.options.animation.iDetail.direction||0;this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el[0];var n=this.options.animation.iDetail.pathlength||0,a=2*this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.find(".Element").first().width(),o=2*this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.find(".Element").first().height();switch(i){case 0:t.y=n?this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.y-n:"-"+o;break;case 1:t.x=n?this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.x+n:interaction_view.size.x+a;break;case 2:t.y=n?this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.y+n:interaction_view.size.y+o;break;case 3:t.x=n?this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.x-n:"-"+a}this.param.css=t,n&&(this.param.css.opacity=0)}if(202==e){this.overlay_obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el,this.obj=this.overlay_obj.children(".Element")[0];{this.page.iOverlaylist.get(this.options.animation.overlay_id)}t.scale=0,this.param.css=t}if(203==e&&(this.param.css={opacity:0},this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el[0]),204==e){var r=Number(this.options.animation.iDetail.scale)||2,s=Number(this.options.animation.iDetail.opacity)||0;this.overlay_obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el,this.obj=this.overlay_obj.children(".Element")[0];{this.page.iOverlaylist.get(this.options.animation.overlay_id)}t.scale=r,t.opacity=s,this.param.css=t}this.stophide=!0},setstrongparam:function(e){if(this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el[0],401==e){this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.children(".Element")[0];var t=(this.page.iOverlaylist.get(this.options.animation.overlay_id),{});t.scale=_.isNumber(this.options.animation.iDetail.scale)?Number(this.options.animation.iDetail.scale):1,this.param.css=t}if(402==e){var i=this.options.animation.iDetail.opacity||0;this.obj=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el[0],this.param.css={opacity:i}}if(403==e){var n=this.page.iOverlaylist.get(this.options.animation.overlay_id);this.obj=n.iview.wrap_el?n.iview.wrap_el[0]:n.iview.$el.children(".Element")[0];var a=_.isNumber(this.options.animation.iDetail.rotation)?Number(this.options.animation.iDetail.rotation):0,o=this.options.animation.iDetail.axial||0,r=this.options.animation.iDetail.transformOrigin||0,s="_cw",l="+";0>a&&(s="_ccw"),0>a&&(l="-");var t={};switch(0==o&&(t.rotation=l+"="+Math.abs(a)+s),1==o&&(t.rotationX=l+"="+Math.abs(a)+s),2==o&&(t.rotationY=l+"="+Math.abs(a)+s),this.param.css=t,r){case 0:this.param.css.transformOrigin="50% 50%";break;case 1:this.param.css.transformOrigin=0==o?"0% 50%":"left";break;case 2:this.param.css.transformOrigin=0==o?"100% 50%":"right";break;case 3:this.param.css.transformOrigin=0==o?"50% 100%":"bottom center";break;case 4:this.param.css.transformOrigin=0==o?"50% 0%":"top center";break;case 5:this.param.css.transformOrigin="0% 0%";break;case 6:this.param.css.transformOrigin="100% 0%";break;case 7:this.param.css.transformOrigin="0% 100%";break;case 8:this.param.css.transformOrigin="100% 100%";break;default:this.param.css.transformOrigin="50% 50%"}_g.device.android()&&TweenLite.set(this.obj,{transformPerspective:2e3})}this.param.css.force3D=interaction_view.force3D},settextparam:function(e){if(this.startshow=!0,601==e){var t=this.page.iOverlaylist.get(this.options.animation.overlay_id);if("Paragraph"==t.get("iType")){var i=this.page.iOverlaylist.get(this.options.animation.overlay_id).iview.$el.children(".Element")[0];this.obj=$(i).find(".iText"),this.param.text=t.attributes.iDetail.iText,$(this.obj).html("")}}},setgroupparam:function(){this.param={},this.param.data=this.options.animation,this.param.onStartParams=["{self}"],this.param.onStart=this.onStart,this.param.onComplete=this.stop,this.param.onCompleteParams=["{self}"];var e=this.options.animation.iTiming.repeat||0;-1==e?this.param.repeat=-1:e&&-2!=e?this.param.repeat=e-1:-2==e&&(this.param.repeat=-1)},setsvgparam:function(e){var t=this;this.startshow=!0,this.fromparam={},this.toparam={},this.toparam.onStart=this.onStart,this.toparam.immediateRender=!1,this.toparam.onComplete=this.param.onComplete,this.toparam.delay=this.param.delay,this.toparam.repeat=this.param.repeat,this.toparam.ease=this.param.ease;var i=this.page.iOverlaylist.get(this.options.animation.overlay_id);if(701==e)this.obj=i.iview.$el.find("svg").find("rect, circle, ellipse, polyline, path, line, polygon").not("[data-attr=morphCloneElement]"),this.fromparam.drawSVG=this.param.data.iDetail.startx+" "+this.param.data.iDetail.starty,this.toparam.drawSVG=this.param.data.iDetail.endx+" "+this.param.data.iDetail.endy;else if(702==e){this.toparam.paths=[],this.toparam.otherPaths=[];var n=0;if(_.each(this.param.data.iDetail.pathIndex,function(e){null!=e.selected&&n++}),1>=n)return;this.toparam.obj=i.iview.$el.children(".Element").find("svg"),_.each(this.param.data.iDetail.pathIndex,function(e){null!=e.selected?t.toparam.paths.push({shapeIndex:e.selected,id:e.id}):t.toparam.otherPaths.push({id:e.id})})}},setparam:function(){this.param={},this.param.data=this.options.animation;var e=this.page.iOverlaylist.get(this.options.animation.overlay_id);this.overlaymodel=e,this.param.onStartParams=["{self}"],this.param.onStart=this.onStart,this.param.onUpdate=this.onUpdate,this.param.onComplete=this.stop,this.param.onCompleteParams=["{self}"],this.param.ease=this.EaseTypes[this.options.animation.iTiming.ease||0];var t=this.options.animation.iTiming.repeat||0;switch(-1==t?this.param.repeat=-1:t&&-2!=t?this.param.repeat=t-1:-2==t&&(this.param.repeat=-1),this.options.animation.iType){case 100:return"åºç°å¨ç»";case 101:this.setappearparam(101);break;case 102:this.setappearparam(102);break;case 103:this.setappearparam(103);break;case 104:this.setappearparam(104);break;case 200:return"æ¶å¤±å¨ç»";case 201:this.setdisappearparam(201);break;case 202:this.setdisappearparam(202);break;case 203:this.setdisappearparam(203);break;case 204:this.setdisappearparam(204);break;case 300:return"è¿å¨è·¯å¾";case 301:this.setpathparam(301);break;case 302:this.setpathparam(302);break;case 400:return"å¼ºè°å¨ç»";case 401:this.setstrongparam(401);break;case 402:this.setstrongparam(402);break;case 403:this.setstrongparam(403);break;case 500:return"åªä½å¨ç»";case 501:this.setmedia(501);break;case 502:this.setmedia(502);break;case 503:this.setmedia(503);break;case 700:return"SVGå¨ç»";case 701:this.setsvgparam(701);break;case 702:this.setsvgparam(702);break;case 600:return"æå­å¨ç»";case 601:this.settextparam(601)}this.param&&this.param.css&&(this.param.css.force3D=interaction_view.force3D,this.param.css.force3D&&this.obj&&_g.device.android())},setmedia:function(e){"Audio"==this.overlaymodel.get("iType")&&(this.isAudio=!0)},pathstop:function(e){var t=this.options.animation.iTiming.rewind||!1;t&&-1!=this.options.animation.iTiming.repeat&&-2!=this.options.animation.iTiming.repeat&&this.options.animation.iDetail.path&&this.options.animation.iDetail.path[0]&&e.pause(0)},animationstop:function(e){var t=this.options.animation.iTiming.rewind||!1;t&&e&&e.pause(0)},stop:function(e){this.stopshow&&this.showelement(),this.stophide&&this.hideelement(),this.animationstop(e),interaction_view.events.onAnimationEnd({overlay_id:this.options.animation.overlay_id,animation_id:this.options.animation.id,page_id:this.page.id,layer_id:this.options.collection.layerid})},forcestop:function(e){var t=this.options.animation.iTiming.rewind||!1;e.pause(t?0:this.options.animation.iTiming.duration),this.options.collection.onComplete(this.options.animation.id)},addclickcontrol:function(){this.options.collection.addclickstop(this.options.animation.id)},onStart:function(){this.startshow&&this.showelement(),interaction_view.events.onAnimationStart({overlay_id:this.options.animation.overlay_id,animation_id:this.options.animation.id,page_id:this.page.id,layer_id:this.options.collection.layerid})},onUpdate:function(){},showelement:function(){var e=this.page.iOverlaylist.get(this.options.animation.overlay_id);e.iview.onBeforeShow&&e.iview.onBeforeShow(),e.iview.$el.removeClass("hide"),e.iview.onShow&&e.iview.onShow()},hideelement:function(){var e=this.page.iOverlaylist.get(this.options.animation.overlay_id);e.iview.onBeforeHide&&e.iview.onBeforeHide(),e.iview.$el.addClass("hide"),e.iview.onHide&&e.iview.onHide()}},window.animateTimeline={generateTimeline:function(e){if("undefined"!=typeof TimelineMax){var t=interaction_view.getVarsOp(e.iPage_id,[0,2]),i={paused:e.paused,onStart:e.onStart,onComplete:e.onComplete,onStartParams:e.onStartParams,onCompleteParams:e.onComplateParams};e.repeat&&(i.repeat=e.repeat);var n=new TimelineMax(i);n.elements=[],n.addLabel("Start");var a=0;if(e.ids){e.ids=_.filter(e.ids,function(t){page=t.page||interaction_view.getAnimationPage(t.page_id,e.page);var i=page.iAnimationlist.get(t.id);if(!i)return!1;var t=i.toJSON();return 0!=t.iKind||page.iOverlaylist.get(t.overlay_id)?!0:!1}),e.animations=[];for(var o=0;o<e.ids.length;o++){page=e.ids[o].page||interaction_view.getAnimationPage(e.ids[o].page_id,e.page);var r=page.iAnimationlist.get(e.ids[o].id);r.page=page,e.animations.push(r)}}if(0==e.animations.length)return!1;var s=interaction_view.filterAnimations(e.animations,e.page,e.group,e.foraction);return s=_.filter(s,function(e){return e._animation}),_.each(s,function(i,o){function r(e){return j.obj.find("path#"+e.id)}function l(e){return j.obj.find("path#clone_"+e.id)}function c(){$(z).attr("d",$(z).attr("data-original")),$(z).css($(z).data("initStyle")),$(z).data("show",!1)}function d(e){var t=e.css("fill")||"white",i=parseFloat(e.css("fill-opacity"))>=0?parseFloat(e.css("fill-opacity")):1,n=e.css("stroke")||"black",a=parseFloat(e.css("stroke-opacity"))>=0?parseFloat(e.css("stroke-opacity")):1,o=parseFloat(e.css("stroke-width"))>=0?parseFloat(e.css("stroke-width")):1;return{fill:t,"fill-opacity":i,stroke:n,"stroke-opacity":a,"stroke-width":o}}function h(){$(z).show().css({"stroke-dasharray":"none","stroke-dashoffset":"none"}),$(z).data("show",!0);for(var e=1;e<j.paths.length;e++)r(j.paths[e]).hide();for(var e=0;e<j.otherPaths.length;e++){var t=r(j.otherPaths[e]);t.data("show")||t.hide()}}function u(){h(),j.onStart(),c()}function p(){j.onComplete(),i.attributes.iTiming.rewind?c():$(z).data("show",!1)}if(i){i._animation.refresh();var m=i.page?i.page.id:e.iPage_id,f=i.page?i.page:e.page,v=i.toJSON(),g=$.extend(!0,{},i._animation.param);if(v.iTiming){var w=t.var2val(v.iTiming.delay),y=t.var2val(v.iTiming.repeat),b=t.var2val(v.iTiming.duration);a+=w,b=b;var x=o;if(_.include([0,3,4,5,6,7],v.iTiming.start))switch(n.addLabel(i.id+"_start",a),v.iTiming.start){case 0:n.call(e.page.iAnimationlist.AddClickTween,[n,e.iPage_id,i,a],this,a-w);break;case 3:case 4:case 5:case 6:n.call(e.page.iAnimationlist.AddPageSwipeTween,[n,e.iPage_id,v.iTiming.start,i,a],this,a-w);break;case 7:n.call(e.page.iAnimationlist.AddPageShakeTween,[n,e.iPage_id,v.iTiming.start,i,a],this,a-w)}else if(2==v.iTiming.start)if(0!=x){var S=n.getLabelTime(s[x-1].id+"_start");n.addLabel(i.id+"_start",S+w),a=n.getLabelTime(i.id+"_start")}else n.addLabel(i.id+"_start",a);else n.addLabel(i.id+"_start",a)}if(1==v.iKind&&v.children){var T=[];_.each(v.children,function(e){T.push({id:e,page_id:m,page:f})});var C=animateTimeline.generateTimeline({page:f,ids:T,iPage_id:m,group:!0,paused:!1,repeat:g.repeat,onStart:g.onStart,onComplete:g.onComplete,onStartParams:g.onStartParams,onCompleteParams:g.onCompleteParams,foraction:!0});if(C){n.add(C,a);var k=C;b=C.duration(),C.elements&&C.elements.length&&(n.elements=n.elements.concat(C.elements))}else b=0}else{if(!_g.browserSupport({msie:9})&&!_.include([101,201,100,103,200,203,402,500,501,502,503],i.get("iType"))){var P,E=$(i._animation.obj);if(i._animation.toparam)P=i._animation.toparam.css;else if(i._animation.param)if(i._animation.param.css)P=i._animation.param.css;else if(i._animation.param.bezier){var D=i._animation.param.bezier.values;P=D[D.length-1]}return P&&P.x&&E.css("margin-left",P.x+"px"),P&&P.y&&E.css("margin-top",P.y+"px"),E.removeClass("hide").show(),E.parents(".iView:first").removeClass("hide").show(),!0}var A=i._animation.obj,I={onUpdate:interaction_view.events.onAnimationUpdate,onUpdateParams:[{animation_id:i.id,overlay_id:i.get("overlay_id"),page_id:i.get("page_id"),layer_id:i.get("layer_id")}]};if(i._animation.toparam?i._animation.toparam=$.extend({},i._animation.toparam,I):i._animation.param=$.extend({},i._animation.param,I),_.include([301,302],i.get("iType"))&&!g)return!1;if(_.include([501,502,503],i.get("iType"))){interaction_view.isIos&&i._animation.isAudio&&501==i.get("iType")&&interaction_view.media.play(i._animation.overlaymodel);var O=e.page.iAnimationlist.getMediaTime(i);b=502==i.get("iType")||503==i.get("iType")?0:O,n.call(e.page.iAnimationlist.AddMediaTween,[i],this,a)}else if(_.include([102,103],i.get("iType")))n.add(TweenMax.fromTo(A,b,i._animation.fromparam,i._animation.toparam),a);else if(104==i.get("iType"))n.add(TweenMax.fromTo(A,.01,{opacity:0},i._animation.fromparam),a),n.add(TweenMax.fromTo(A,b-.01,i._animation.fromparam,i._animation.toparam),a+.01);else if(101==i.get("iType"))_g.browserSupport({msie:9})?n.add(TweenMax.fromTo(A,b,i._animation.fromparam,i._animation.toparam),a):n.add(TweenMax.fromTo(A,b,{"margin-left":i._animation.fromparam.css.x,"margin-top":i._animation.fromparam.css.y},{"margin-left":i._animation.toparam.css.x,"margin-top":i._animation.toparam.css.y,immediateRender:!1}),a);else if(201!=i.get("iType")||_g.browserSupport({msie:9}))if(701==i.get("iType")){n.add(TweenMax.fromTo(A,.001,{drawSVG:"0%",display:"block"},{drawSVG:!0,onStart:i._animation.toparam.onStart}),a);var N=$.extend(!0,{},i._animation.toparam);N.onStart=null,n.add(TweenMax.fromTo(A,b-.001,i._animation.fromparam,N),a+.001)}else if(702==i.get("iType")){if(i._animation.toparam.paths.length>=2){var R,M=b/(i._animation.toparam.paths.length-1),j=$.extend(!0,{},i._animation.toparam),L=a,F={immediateRender:j.immediateRender,ease:j.ease,onUpdate:j.onUpdate,onUpdateParams:j.onUpdateParams},z=r(j.paths[0])[0];$(z).data("initStyle")||$(z).data("initStyle",d($(z)));var W=new TimelineMax({repeat:j.repeat,onStart:u,onComplete:p});L=0;for(var o=1;o<i._animation.toparam.paths.length;o++)R=$.extend(!0,{morphSVG:{shape:l(j.paths[o])[0],shapeIndex:j.paths[o-1].shapeIndex}},F),R=$.extend(!0,d(r(j.paths[o])),R),W.add(TweenMax.to(z,M,R),L),L+=M;n.add(W,a)}}else n.add(TweenMax.to(A,b,i._animation.param),a);else n.add(TweenMax.to(A,b,{"margin-left":i._animation.param.css.x,"margin-top":i._animation.param.css.y}),a);var k=n.getChildren()[n.getChildren().length-1]}i.get("iType")>200&&i.get("iType")<210&&n.elements.push(i._animation.overlay_obj||i._animation.obj),y&&y>0?b*=y:-2==y&&n.call(e.page.iAnimationlist.AddRepeatClickTween,[n,e.iPage_id,k,i],this,a),a+=b,n.addLabel(i.id+"_end",a)}}),n}}}}(window),define("_e/animate",function(){}),function(e,t){var i="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,n=function(){for(var e,i,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"]],a=0,o=n.length,r={};o>a;a++)if(e=n[a],e&&e[1]in t){for(a=0,i=e.length;i>a;a++)r[n[0][a]]=e[a];return r}return!1}(),a={request:function(e){var a=n.requestFullscreen;e=e||t.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?e[a]():e[a](i&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){t[n.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(){},onerror:function(){},raw:n};return n?(Object.defineProperties(a,{isFullscreen:{get:function(){return!!t[n.fullscreenElement]}},element:{enumerable:!0,get:function(){return t[n.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!t[n.fullscreenEnabled]}}}),t.addEventListener(n.fullscreenchange,function(e){a.onchange.call(a,e)}),t.addEventListener(n.fullscreenerror,function(e){a.onerror.call(a,e)}),void(e.screenfull=a)):e.screenfull=!1}(window,document),define("screenfull",function(){});var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,i){var n=function(e){var t,i=[],n=e.length;for(t=0;t!==n;i.push(e[t++]));return i},a=function(e,t,i){var n,a,o=e.cycle;for(n in o)a=o[n],e[n]="function"==typeof a?a.call(t[i],i):a[i%a.length];delete e.cycle},o=function(e,t,n){i.call(this,e,t,n),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=o.prototype.render},r=1e-10,s=i._internals,l=s.isSelector,c=s.isArray,d=o.prototype=i.to({},.1,{}),h=[];o.version="1.18.2",d.constructor=o,d.kill()._gc=!1,o.killTweensOf=o.killDelayedCallsTo=i.killTweensOf,o.getTweensOf=i.getTweensOf,o.lagSmoothing=i.lagSmoothing,o.ticker=i.ticker,o.render=i.render,d.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),i.prototype.invalidate.call(this)},d.updateTo=function(e,t){var n,a=this.ratio,o=this.vars.immediateRender||e.immediateRender;t&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(n in e)this.vars[n]=e[n];if(this._initted||o)if(t)this._initted=!1,o&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&i._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var r=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(r,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||o)for(var s,l=1/(1-a),c=this._firstPT;c;)s=c.s+c.c,c.c*=l,c.s=s-c.c,c=c._next;return this},d.render=function(e,t,i){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var n,a,o,l,c,d,h,u,p=this._dirty?this.totalDuration():this._totalDuration,m=this._time,f=this._totalTime,v=this._cycle,g=this._duration,w=this._rawPrevTime;
if(e>=p-1e-7?(this._totalTime=p,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=g,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(n=!0,a="onComplete",i=i||this._timeline.autoRemoveChildren),0===g&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(e=0),(0>w||0>=e&&e>=-1e-7||w===r&&"isPause"!==this.data)&&w!==e&&(i=!0,w>r&&(a="onReverseComplete")),this._rawPrevTime=u=!t||e||w===e?e:r)):1e-7>e?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==f||0===g&&w>0)&&(a="onReverseComplete",n=this._reversed),0>e&&(this._active=!1,0===g&&(this._initted||!this.vars.lazy||i)&&(w>=0&&(i=!0),this._rawPrevTime=u=!t||e||w===e?e:r)),this._initted||(i=!0)):(this._totalTime=this._time=e,0!==this._repeat&&(l=g+this._repeatDelay,this._cycle=this._totalTime/l>>0,0!==this._cycle&&this._cycle===this._totalTime/l&&this._cycle--,this._time=this._totalTime-this._cycle*l,this._yoyo&&0!==(1&this._cycle)&&(this._time=g-this._time),this._time>g?this._time=g:this._time<0&&(this._time=0)),this._easeType?(c=this._time/g,d=this._easeType,h=this._easePower,(1===d||3===d&&c>=.5)&&(c=1-c),3===d&&(c*=2),1===h?c*=c:2===h?c*=c*c:3===h?c*=c*c*c:4===h&&(c*=c*c*c*c),this.ratio=1===d?1-c:2===d?c:this._time/g<.5?c/2:1-c/2):this.ratio=this._ease.getRatio(this._time/g)),m===this._time&&!i&&v===this._cycle)return void(f!==this._totalTime&&this._onUpdate&&(t||this._callback("onUpdate")));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=m,this._totalTime=f,this._rawPrevTime=w,this._cycle=v,s.lazyTweens.push(this),void(this._lazy=[e,t]);this._time&&!n?this.ratio=this._ease.getRatio(this._time/g):n&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==m&&e>=0&&(this._active=!0),0===f&&(2===this._initted&&e>0&&this._init(),this._startAt&&(e>=0?this._startAt.render(e,t,i):a||(a="_dummyGS")),this.vars.onStart&&(0!==this._totalTime||0===g)&&(t||this._callback("onStart"))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(0>e&&this._startAt&&this._startTime&&this._startAt.render(e,t,i),t||(this._totalTime!==f||n)&&this._callback("onUpdate")),this._cycle!==v&&(t||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),a&&(!this._gc||i)&&(0>e&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(e,t,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[a]&&this._callback(a),0===g&&this._rawPrevTime===r&&u!==r&&(this._rawPrevTime=0))},o.to=function(e,t,i){return new o(e,t,i)},o.from=function(e,t,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new o(e,t,i)},o.fromTo=function(e,t,i,n){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,new o(e,t,n)},o.staggerTo=o.allTo=function(e,t,r,s,d,u,p){s=s||0;var m,f,v,g,w=0,_=[],y=function(){r.onComplete&&r.onComplete.apply(r.onCompleteScope||this,arguments),d.apply(p||r.callbackScope||this,u||h)},b=r.cycle,x=r.startAt&&r.startAt.cycle;for(c(e)||("string"==typeof e&&(e=i.selector(e)||e),l(e)&&(e=n(e))),e=e||[],0>s&&(e=n(e),e.reverse(),s*=-1),m=e.length-1,v=0;m>=v;v++){f={};for(g in r)f[g]=r[g];if(b&&a(f,e,v),x){x=f.startAt={};for(g in r.startAt)x[g]=r.startAt[g];a(f.startAt,e,v)}f.delay=w+(f.delay||0),v===m&&d&&(f.onComplete=y),_[v]=new o(e[v],t,f),w+=s}return _},o.staggerFrom=o.allFrom=function(e,t,i,n,a,r,s){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,o.staggerTo(e,t,i,n,a,r,s)},o.staggerFromTo=o.allFromTo=function(e,t,i,n,a,r,s,l){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,o.staggerTo(e,t,n,a,r,s,l)},o.delayedCall=function(e,t,i,n,a){return new o(t,0,{delay:e,onComplete:t,onCompleteParams:i,callbackScope:n,onReverseComplete:t,onReverseCompleteParams:i,immediateRender:!1,useFrames:a,overwrite:0})},o.set=function(e,t){return new o(e,0,t)},o.isTweening=function(e){return i.getTweensOf(e,!0).length>0};var u=function(e,t){for(var n=[],a=0,o=e._first;o;)o instanceof i?n[a++]=o:(t&&(n[a++]=o),n=n.concat(u(o,t)),a=n.length),o=o._next;return n},p=o.getAllTweens=function(t){return u(e._rootTimeline,t).concat(u(e._rootFramesTimeline,t))};o.killAll=function(e,i,n,a){null==i&&(i=!0),null==n&&(n=!0);var o,r,s,l=p(0!=a),c=l.length,d=i&&n&&a;for(s=0;c>s;s++)r=l[s],(d||r instanceof t||(o=r.target===r.vars.onComplete)&&n||i&&!o)&&(e?r.totalTime(r._reversed?0:r.totalDuration()):r._enabled(!1,!1))},o.killChildTweensOf=function(e,t){if(null!=e){var a,r,d,h,u,p=s.tweenLookup;if("string"==typeof e&&(e=i.selector(e)||e),l(e)&&(e=n(e)),c(e))for(h=e.length;--h>-1;)o.killChildTweensOf(e[h],t);else{a=[];for(d in p)for(r=p[d].target.parentNode;r;)r===e&&(a=a.concat(p[d].tweens)),r=r.parentNode;for(u=a.length,h=0;u>h;h++)t&&a[h].totalTime(a[h].totalDuration()),a[h]._enabled(!1,!1)}}};var m=function(e,i,n,a){i=i!==!1,n=n!==!1,a=a!==!1;for(var o,r,s=p(a),l=i&&n&&a,c=s.length;--c>-1;)r=s[c],(l||r instanceof t||(o=r.target===r.vars.onComplete)&&n||i&&!o)&&r.paused(e)};return o.pauseAll=function(e,t,i){m(!0,e,t,i)},o.resumeAll=function(e,t,i){m(!1,e,t,i)},o.globalTimeScale=function(t){var n=e._rootTimeline,a=i.ticker.time;return arguments.length?(t=t||r,n._startTime=a-(a-n._startTime)*n._timeScale/t,n=e._rootFramesTimeline,a=i.ticker.frame,n._startTime=a-(a-n._startTime)*n._timeScale/t,n._timeScale=e._rootTimeline._timeScale=t,t):n._timeScale},d.progress=function(e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},d.totalProgress=function(e){return arguments.length?this.totalTime(this.totalDuration()*e,!1):this._totalTime/this.totalDuration()},d.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!==(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},d.duration=function(t){return arguments.length?e.prototype.duration.call(this,t):this._duration},d.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},d.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},d.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},d.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},o},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,i){var n=function(e){t.call(this,e),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var i,n,a=this.vars;for(n in a)i=a[n],l(i)&&-1!==i.join("").indexOf("{self}")&&(a[n]=this._swapSelfInParams(i));l(a.tweens)&&this.add(a.tweens,0,a.align,a.stagger)},a=1e-10,o=i._internals,r=n._internals={},s=o.isSelector,l=o.isArray,c=o.lazyTweens,d=o.lazyRender,h=_gsScope._gsDefine.globals,u=function(e){var t,i={};for(t in e)i[t]=e[t];return i},p=function(e,t,i){var n,a,o=e.cycle;for(n in o)a=o[n],e[n]="function"==typeof a?a.call(t[i],i):a[i%a.length];delete e.cycle},m=r.pauseCallback=function(){},f=function(e){var t,i=[],n=e.length;for(t=0;t!==n;i.push(e[t++]));return i},v=n.prototype=new t;return n.version="1.18.2",v.constructor=n,v.kill()._gc=v._forcingPlayhead=v._hasPause=!1,v.to=function(e,t,n,a){var o=n.repeat&&h.TweenMax||i;return t?this.add(new o(e,t,n),a):this.set(e,n,a)},v.from=function(e,t,n,a){return this.add((n.repeat&&h.TweenMax||i).from(e,t,n),a)},v.fromTo=function(e,t,n,a,o){var r=a.repeat&&h.TweenMax||i;return t?this.add(r.fromTo(e,t,n,a),o):this.set(e,a,o)},v.staggerTo=function(e,t,a,o,r,l,c,d){var h,m,v=new n({onComplete:l,onCompleteParams:c,callbackScope:d,smoothChildTiming:this.smoothChildTiming}),g=a.cycle;for("string"==typeof e&&(e=i.selector(e)||e),e=e||[],s(e)&&(e=f(e)),o=o||0,0>o&&(e=f(e),e.reverse(),o*=-1),m=0;m<e.length;m++)h=u(a),h.startAt&&(h.startAt=u(h.startAt),h.startAt.cycle&&p(h.startAt,e,m)),g&&p(h,e,m),v.to(e[m],t,h,m*o);return this.add(v,r)},v.staggerFrom=function(e,t,i,n,a,o,r,s){return i.immediateRender=0!=i.immediateRender,i.runBackwards=!0,this.staggerTo(e,t,i,n,a,o,r,s)},v.staggerFromTo=function(e,t,i,n,a,o,r,s,l){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,this.staggerTo(e,t,n,a,o,r,s,l)},v.call=function(e,t,n,a){return this.add(i.delayedCall(0,e,t,n),a)},v.set=function(e,t,n){return n=this._parseTimeOrLabel(n,0,!0),null==t.immediateRender&&(t.immediateRender=n===this._time&&!this._paused),this.add(new i(e,0,t),n)},n.exportRoot=function(e,t){e=e||{},null==e.smoothChildTiming&&(e.smoothChildTiming=!0);var a,o,r=new n(e),s=r._timeline;for(null==t&&(t=!0),s._remove(r,!0),r._startTime=0,r._rawPrevTime=r._time=r._totalTime=s._time,a=s._first;a;)o=a._next,t&&a instanceof i&&a.target===a.vars.onComplete||r.add(a,a._startTime-a._delay),a=o;return s.add(r,0),r},v.add=function(a,o,r,s){var c,d,h,u,p,m;if("number"!=typeof o&&(o=this._parseTimeOrLabel(o,0,!0,a)),!(a instanceof e)){if(a instanceof Array||a&&a.push&&l(a)){for(r=r||"normal",s=s||0,c=o,d=a.length,h=0;d>h;h++)l(u=a[h])&&(u=new n({tweens:u})),this.add(u,c),"string"!=typeof u&&"function"!=typeof u&&("sequence"===r?c=u._startTime+u.totalDuration()/u._timeScale:"start"===r&&(u._startTime-=u.delay())),c+=s;return this._uncache(!0)}if("string"==typeof a)return this.addLabel(a,o);if("function"!=typeof a)throw"Cannot add "+a+" into the timeline; it is not a tween, timeline, function, or string.";a=i.delayedCall(0,a)}if(t.prototype.add.call(this,a,o),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(p=this,m=p.rawTime()>a._startTime;p._timeline;)m&&p._timeline.smoothChildTiming?p.totalTime(p._totalTime,!0):p._gc&&p._enabled(!0,!1),p=p._timeline;return this},v.remove=function(t){if(t instanceof e){this._remove(t,!1);var i=t._timeline=t.vars.useFrames?e._rootFramesTimeline:e._rootTimeline;return t._startTime=(t._paused?t._pauseTime:i._time)-(t._reversed?t.totalDuration()-t._totalTime:t._totalTime)/t._timeScale,this}if(t instanceof Array||t&&t.push&&l(t)){for(var n=t.length;--n>-1;)this.remove(t[n]);return this}return"string"==typeof t?this.removeLabel(t):this.kill(null,t)},v._remove=function(e,i){t.prototype._remove.call(this,e,i);var n=this._last;return n?this._time>n._startTime+n._totalDuration/n._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},v.append=function(e,t){return this.add(e,this._parseTimeOrLabel(null,t,!0,e))},v.insert=v.insertMultiple=function(e,t,i,n){return this.add(e,t||0,i,n)},v.appendMultiple=function(e,t,i,n){return this.add(e,this._parseTimeOrLabel(null,t,!0,e),i,n)},v.addLabel=function(e,t){return this._labels[e]=this._parseTimeOrLabel(t),this},v.addPause=function(e,t,n,a){var o=i.delayedCall(0,m,n,a||this);return o.vars.onComplete=o.vars.onReverseComplete=t,o.data="isPause",this._hasPause=!0,this.add(o,e)},v.removeLabel=function(e){return delete this._labels[e],this},v.getLabelTime=function(e){return null!=this._labels[e]?this._labels[e]:-1},v._parseTimeOrLabel=function(t,i,n,a){var o;if(a instanceof e&&a.timeline===this)this.remove(a);else if(a&&(a instanceof Array||a.push&&l(a)))for(o=a.length;--o>-1;)a[o]instanceof e&&a[o].timeline===this&&this.remove(a[o]);if("string"==typeof i)return this._parseTimeOrLabel(i,n&&"number"==typeof t&&null==this._labels[i]?t-this.duration():0,n);if(i=i||0,"string"!=typeof t||!isNaN(t)&&null==this._labels[t])null==t&&(t=this.duration());else{if(o=t.indexOf("="),-1===o)return null==this._labels[t]?n?this._labels[t]=this.duration()+i:i:this._labels[t]+i;i=parseInt(t.charAt(o-1)+"1",10)*Number(t.substr(o+1)),t=o>1?this._parseTimeOrLabel(t.substr(0,o-1),0,n):this.duration()}return Number(t)+i},v.seek=function(e,t){return this.totalTime("number"==typeof e?e:this._parseTimeOrLabel(e),t!==!1)},v.stop=function(){return this.paused(!0)},v.gotoAndPlay=function(e,t){return this.play(e,t)},v.gotoAndStop=function(e,t){return this.pause(e,t)},v.render=function(e,t,i){this._gc&&this._enabled(!0,!1);var n,o,r,s,l,h,u,p=this._dirty?this.totalDuration():this._totalDuration,m=this._time,f=this._startTime,v=this._timeScale,g=this._paused;if(e>=p-1e-7)this._totalTime=this._time=p,this._reversed||this._hasPausedChild()||(o=!0,s="onComplete",l=!!this._timeline.autoRemoveChildren,0===this._duration&&(0>=e&&e>=-1e-7||this._rawPrevTime<0||this._rawPrevTime===a)&&this._rawPrevTime!==e&&this._first&&(l=!0,this._rawPrevTime>a&&(s="onReverseComplete"))),this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a,e=p+1e-4;else if(1e-7>e)if(this._totalTime=this._time=0,(0!==m||0===this._duration&&this._rawPrevTime!==a&&(this._rawPrevTime>0||0>e&&this._rawPrevTime>=0))&&(s="onReverseComplete",o=this._reversed),0>e)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(l=o=!0,s="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(l=!0),this._rawPrevTime=e;else{if(this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a,0===e&&o)for(n=this._first;n&&0===n._startTime;)n._duration||(o=!1),n=n._next;e=0,this._initted||(l=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!t){if(e>=m)for(n=this._first;n&&n._startTime<=e&&!h;)n._duration||"isPause"!==n.data||n.ratio||0===n._startTime&&0===this._rawPrevTime||(h=n),n=n._next;else for(n=this._last;n&&n._startTime>=e&&!h;)n._duration||"isPause"===n.data&&n._rawPrevTime>0&&(h=n),n=n._prev;h&&(this._time=e=h._startTime,this._totalTime=e+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=e}if(this._time!==m&&this._first||i||l||h){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==m&&e>0&&(this._active=!0),0===m&&this.vars.onStart&&0!==this._time&&(t||this._callback("onStart")),u=this._time,u>=m)for(n=this._first;n&&(r=n._next,u===this._time&&(!this._paused||g));)(n._active||n._startTime<=u&&!n._paused&&!n._gc)&&(h===n&&this.pause(),n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(e-n._startTime)*n._timeScale,t,i):n.render((e-n._startTime)*n._timeScale,t,i)),n=r;else for(n=this._last;n&&(r=n._prev,u===this._time&&(!this._paused||g));){if(n._active||n._startTime<=m&&!n._paused&&!n._gc){if(h===n){for(h=n._prev;h&&h.endTime()>this._time;)h.render(h._reversed?h.totalDuration()-(e-h._startTime)*h._timeScale:(e-h._startTime)*h._timeScale,t,i),h=h._prev;h=null,this.pause()}n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(e-n._startTime)*n._timeScale,t,i):n.render((e-n._startTime)*n._timeScale,t,i)}n=r}this._onUpdate&&(t||(c.length&&d(),this._callback("onUpdate"))),s&&(this._gc||(f===this._startTime||v!==this._timeScale)&&(0===this._time||p>=this.totalDuration())&&(o&&(c.length&&d(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[s]&&this._callback(s)))}},v._hasPausedChild=function(){for(var e=this._first;e;){if(e._paused||e instanceof n&&e._hasPausedChild())return!0;e=e._next}return!1},v.getChildren=function(e,t,n,a){a=a||-9999999999;for(var o=[],r=this._first,s=0;r;)r._startTime<a||(r instanceof i?t!==!1&&(o[s++]=r):(n!==!1&&(o[s++]=r),e!==!1&&(o=o.concat(r.getChildren(!0,t,n)),s=o.length))),r=r._next;return o},v.getTweensOf=function(e,t){var n,a,o=this._gc,r=[],s=0;for(o&&this._enabled(!0,!0),n=i.getTweensOf(e),a=n.length;--a>-1;)(n[a].timeline===this||t&&this._contains(n[a]))&&(r[s++]=n[a]);return o&&this._enabled(!1,!0),r},v.recent=function(){return this._recent},v._contains=function(e){for(var t=e.timeline;t;){if(t===this)return!0;t=t.timeline}return!1},v.shiftChildren=function(e,t,i){i=i||0;for(var n,a=this._first,o=this._labels;a;)a._startTime>=i&&(a._startTime+=e),a=a._next;if(t)for(n in o)o[n]>=i&&(o[n]+=e);return this._uncache(!0)},v._kill=function(e,t){if(!e&&!t)return this._enabled(!1,!1);for(var i=t?this.getTweensOf(t):this.getChildren(!0,!0,!1),n=i.length,a=!1;--n>-1;)i[n]._kill(e,t)&&(a=!0);return a},v.clear=function(e){var t=this.getChildren(!1,!0,!0),i=t.length;for(this._time=this._totalTime=0;--i>-1;)t[i]._enabled(!1,!1);return e!==!1&&(this._labels={}),this._uncache(!0)},v.invalidate=function(){for(var t=this._first;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},v._enabled=function(e,i){if(e===this._gc)for(var n=this._first;n;)n._enabled(e,!0),n=n._next;return t.prototype._enabled.call(this,e,i)},v.totalTime=function(){this._forcingPlayhead=!0;var t=e.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,t},v.duration=function(e){return arguments.length?(0!==this.duration()&&0!==e&&this.timeScale(this._duration/e),this):(this._dirty&&this.totalDuration(),this._duration)},v.totalDuration=function(e){if(!arguments.length){if(this._dirty){for(var t,i,n=0,a=this._last,o=999999999999;a;)t=a._prev,a._dirty&&a.totalDuration(),a._startTime>o&&this._sortChildren&&!a._paused?this.add(a,a._startTime-a._delay):o=a._startTime,a._startTime<0&&!a._paused&&(n-=a._startTime,this._timeline.smoothChildTiming&&(this._startTime+=a._startTime/this._timeScale),this.shiftChildren(-a._startTime,!1,-9999999999),o=0),i=a._startTime+a._totalDuration/a._timeScale,i>n&&(n=i),a=t;this._duration=this._totalDuration=n,this._dirty=!1}return this._totalDuration}return e&&this.totalDuration()?this.timeScale(this._totalDuration/e):this},v.paused=function(t){if(!t)for(var i=this._first,n=this._time;i;)i._startTime===n&&"isPause"===i.data&&(i._rawPrevTime=0),i=i._next;return e.prototype.paused.apply(this,arguments)},v.usesFrames=function(){for(var t=this._timeline;t._timeline;)t=t._timeline;return t===e._rootFramesTimeline},v.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},n},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(e,t,i){var n=function(t){e.call(this,t),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},a=1e-10,o=t._internals,r=o.lazyTweens,s=o.lazyRender,l=new i(null,null,1,0),c=n.prototype=new e;return c.constructor=n,c.kill()._gc=!1,n.version="1.18.2",c.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),e.prototype.invalidate.call(this)},c.addCallback=function(e,i,n,a){return this.add(t.delayedCall(0,e,n,a),i)},c.removeCallback=function(e,t){if(e)if(null==t)this._kill(null,e);else for(var i=this.getTweensOf(e,!1),n=i.length,a=this._parseTimeOrLabel(t);--n>-1;)i[n]._startTime===a&&i[n]._enabled(!1,!1);return this},c.removePause=function(t){return this.removeCallback(e._internals.pauseCallback,t)},c.tweenTo=function(e,i){i=i||{};var n,a,o,r={ease:l,useFrames:this.usesFrames(),immediateRender:!1};for(a in i)r[a]=i[a];return r.time=this._parseTimeOrLabel(e),n=Math.abs(Number(r.time)-this._time)/this._timeScale||.001,o=new t(this,n,r),r.onStart=function(){o.target.paused(!0),o.vars.time!==o.target.time()&&n===o.duration()&&o.duration(Math.abs(o.vars.time-o.target.time())/o.target._timeScale),i.onStart&&o._callback("onStart")},o},c.tweenFromTo=function(e,t,i){i=i||{},e=this._parseTimeOrLabel(e),i.startAt={onComplete:this.seek,onCompleteParams:[e],callbackScope:this},i.immediateRender=i.immediateRender!==!1;var n=this.tweenTo(t,i);return n.duration(Math.abs(n.vars.time-e)/this._timeScale||.001)},c.render=function(e,t,i){this._gc&&this._enabled(!0,!1);var n,o,l,c,d,h,u,p,m=this._dirty?this.totalDuration():this._totalDuration,f=this._duration,v=this._time,g=this._totalTime,w=this._startTime,_=this._timeScale,y=this._rawPrevTime,b=this._paused,x=this._cycle;if(e>=m-1e-7)this._locked||(this._totalTime=m,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(o=!0,c="onComplete",d=!!this._timeline.autoRemoveChildren,0===this._duration&&(0>=e&&e>=-1e-7||0>y||y===a)&&y!==e&&this._first&&(d=!0,y>a&&(c="onReverseComplete"))),this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a,this._yoyo&&0!==(1&this._cycle)?this._time=e=0:(this._time=f,e=f+1e-4);else if(1e-7>e)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==v||0===f&&y!==a&&(y>0||0>e&&y>=0)&&!this._locked)&&(c="onReverseComplete",o=this._reversed),0>e)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(d=o=!0,c="onReverseComplete"):y>=0&&this._first&&(d=!0),this._rawPrevTime=e;else{if(this._rawPrevTime=f||!t||e||this._rawPrevTime===e?e:a,0===e&&o)for(n=this._first;n&&0===n._startTime;)n._duration||(o=!1),n=n._next;e=0,this._initted||(d=!0)}else if(0===f&&0>y&&(d=!0),this._time=this._rawPrevTime=e,this._locked||(this._totalTime=e,0!==this._repeat&&(h=f+this._repeatDelay,this._cycle=this._totalTime/h>>0,0!==this._cycle&&this._cycle===this._totalTime/h&&this._cycle--,this._time=this._totalTime-this._cycle*h,this._yoyo&&0!==(1&this._cycle)&&(this._time=f-this._time),this._time>f?(this._time=f,e=f+1e-4):this._time<0?this._time=e=0:e=this._time)),this._hasPause&&!this._forcingPlayhead&&!t){if(e=this._time,e>=v)for(n=this._first;n&&n._startTime<=e&&!u;)n._duration||"isPause"!==n.data||n.ratio||0===n._startTime&&0===this._rawPrevTime||(u=n),n=n._next;else for(n=this._last;n&&n._startTime>=e&&!u;)n._duration||"isPause"===n.data&&n._rawPrevTime>0&&(u=n),n=n._prev;u&&(this._time=e=u._startTime,this._totalTime=e+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==x&&!this._locked){var S=this._yoyo&&0!==(1&x),T=S===(this._yoyo&&0!==(1&this._cycle)),C=this._totalTime,k=this._cycle,P=this._rawPrevTime,E=this._time;if(this._totalTime=x*f,this._cycle<x?S=!S:this._totalTime+=f,this._time=v,this._rawPrevTime=0===f?y-1e-4:y,this._cycle=x,this._locked=!0,v=S?0:f,this.render(v,t,0===f),t||this._gc||this.vars.onRepeat&&this._callback("onRepeat"),v!==this._time)return;if(T&&(v=S?f+1e-4:-1e-4,this.render(v,!0,!1)),this._locked=!1,this._paused&&!b)return;this._time=E,this._totalTime=C,this._cycle=k,this._rawPrevTime=P}if(!(this._time!==v&&this._first||i||d||u))return void(g!==this._totalTime&&this._onUpdate&&(t||this._callback("onUpdate")));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==g&&e>0&&(this._active=!0),0===g&&this.vars.onStart&&0!==this._totalTime&&(t||this._callback("onStart")),p=this._time,p>=v)for(n=this._first;n&&(l=n._next,p===this._time&&(!this._paused||b));)(n._active||n._startTime<=this._time&&!n._paused&&!n._gc)&&(u===n&&this.pause(),n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(e-n._startTime)*n._timeScale,t,i):n.render((e-n._startTime)*n._timeScale,t,i)),n=l;else for(n=this._last;n&&(l=n._prev,p===this._time&&(!this._paused||b));){if(n._active||n._startTime<=v&&!n._paused&&!n._gc){if(u===n){for(u=n._prev;u&&u.endTime()>this._time;)u.render(u._reversed?u.totalDuration()-(e-u._startTime)*u._timeScale:(e-u._startTime)*u._timeScale,t,i),u=u._prev;u=null,this.pause()}n._reversed?n.render((n._dirty?n.totalDuration():n._totalDuration)-(e-n._startTime)*n._timeScale,t,i):n.render((e-n._startTime)*n._timeScale,t,i)}n=l}this._onUpdate&&(t||(r.length&&s(),this._callback("onUpdate"))),c&&(this._locked||this._gc||(w===this._startTime||_!==this._timeScale)&&(0===this._time||m>=this.totalDuration())&&(o&&(r.length&&s(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[c]&&this._callback(c)))},c.getActive=function(e,t,i){null==e&&(e=!0),null==t&&(t=!0),null==i&&(i=!1);var n,a,o=[],r=this.getChildren(e,t,i),s=0,l=r.length;for(n=0;l>n;n++)a=r[n],a.isActive()&&(o[s++]=a);return o},c.getLabelAfter=function(e){e||0!==e&&(e=this._time);var t,i=this.getLabelsArray(),n=i.length;for(t=0;n>t;t++)if(i[t].time>e)return i[t].name;return null},c.getLabelBefore=function(e){null==e&&(e=this._time);for(var t=this.getLabelsArray(),i=t.length;--i>-1;)if(t[i].time<e)return t[i].name;return null},c.getLabelsArray=function(){var e,t=[],i=0;for(e in this._labels)t[i++]={time:this._labels[e],name:e};return t.sort(function(e,t){return e.time-t.time}),t},c.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),t):this._time/this.duration()},c.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this._totalTime/this.totalDuration()},c.totalDuration=function(t){return arguments.length?-1!==this._repeat&&t?this.timeScale(this.totalDuration()/t):this:(this._dirty&&(e.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},c.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!==(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},c.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},c.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},c.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},c.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.getLabelBefore(this._time+1e-8)},n},!0),function(){var e=180/Math.PI,t=[],i=[],n=[],a={},o=_gsScope._gsDefine.globals,r=function(e,t,i,n){this.a=e,this.b=t,this.c=i,this.d=n,this.da=n-e,this.ca=i-e,this.ba=t-e},s=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",l=function(e,t,i,n){var a={a:e},o={},r={},s={c:n},l=(e+t)/2,c=(t+i)/2,d=(i+n)/2,h=(l+c)/2,u=(c+d)/2,p=(u-h)/8;return a.b=l+(e-l)/4,o.b=h+p,a.c=o.a=(a.b+o.b)/2,o.c=r.a=(h+u)/2,r.b=u-p,s.b=d+(n-d)/4,r.c=s.a=(r.b+s.b)/2,[a,o,r,s]},c=function(e,a,o,r,s){var c,d,h,u,p,m,f,v,g,w,_,y,b,x=e.length-1,S=0,T=e[0].a;for(c=0;x>c;c++)p=e[S],d=p.a,h=p.d,u=e[S+1].d,s?(_=t[c],y=i[c],b=(y+_)*a*.25/(r?.5:n[c]||.5),m=h-(h-d)*(r?.5*a:0!==_?b/_:0),f=h+(u-h)*(r?.5*a:0!==y?b/y:0),v=h-(m+((f-m)*(3*_/(_+y)+.5)/4||0))):(m=h-(h-d)*a*.5,f=h+(u-h)*a*.5,v=h-(m+f)/2),m+=v,f+=v,p.c=g=m,p.b=0!==c?T:T=p.a+.6*(p.c-p.a),p.da=h-d,p.ca=g-d,p.ba=T-d,o?(w=l(d,T,g,h),e.splice(S,1,w[0],w[1],w[2],w[3]),S+=4):S++,T=f;p=e[S],p.b=T,p.c=T+.4*(p.d-T),p.da=p.d-p.a,p.ca=p.c-p.a,p.ba=T-p.a,o&&(w=l(p.a,T,p.c,p.d),e.splice(S,1,w[0],w[1],w[2],w[3]))},d=function(e,n,a,o){var s,l,c,d,h,u,p=[];if(o)for(e=[o].concat(e),l=e.length;--l>-1;)"string"==typeof(u=e[l][n])&&"="===u.charAt(1)&&(e[l][n]=o[n]+Number(u.charAt(0)+u.substr(2)));if(s=e.length-2,0>s)return p[0]=new r(e[0][n],0,0,e[-1>s?0:1][n]),p;for(l=0;s>l;l++)c=e[l][n],d=e[l+1][n],p[l]=new r(c,0,0,d),a&&(h=e[l+2][n],t[l]=(t[l]||0)+(d-c)*(d-c),i[l]=(i[l]||0)+(h-d)*(h-d));return p[l]=new r(e[l][n],0,0,e[l+1][n]),p},h=function(e,o,r,l,h,u){var p,m,f,v,g,w,_,y,b={},x=[],S=u||e[0];h="string"==typeof h?","+h+",":s,null==o&&(o=1);for(m in e[0])x.push(m);if(e.length>1){for(y=e[e.length-1],_=!0,p=x.length;--p>-1;)if(m=x[p],Math.abs(S[m]-y[m])>.05){_=!1;break}_&&(e=e.concat(),u&&e.unshift(u),e.push(e[1]),u=e[e.length-3])}for(t.length=i.length=n.length=0,p=x.length;--p>-1;)m=x[p],a[m]=-1!==h.indexOf(","+m+","),b[m]=d(e,m,a[m],u);for(p=t.length;--p>-1;)t[p]=Math.sqrt(t[p]),i[p]=Math.sqrt(i[p]);if(!l){for(p=x.length;--p>-1;)if(a[m])for(f=b[x[p]],w=f.length-1,v=0;w>v;v++)g=f[v+1].da/i[v]+f[v].da/t[v],n[v]=(n[v]||0)+g*g;for(p=n.length;--p>-1;)n[p]=Math.sqrt(n[p])}for(p=x.length,v=r?4:1;--p>-1;)m=x[p],f=b[m],c(f,o,r,l,a[m]),_&&(f.splice(0,v),f.splice(f.length-v,v));return b},u=function(e,t,i){t=t||"soft";var n,a,o,s,l,c,d,h,u,p,m,f={},v="cubic"===t?3:2,g="soft"===t,w=[];if(g&&i&&(e=[i].concat(e)),null==e||e.length<v+1)throw"invalid Bezier data";for(u in e[0])w.push(u);for(c=w.length;--c>-1;){for(u=w[c],f[u]=l=[],p=0,h=e.length,d=0;h>d;d++)n=null==i?e[d][u]:"string"==typeof(m=e[d][u])&&"="===m.charAt(1)?i[u]+Number(m.charAt(0)+m.substr(2)):Number(m),g&&d>1&&h-1>d&&(l[p++]=(n+l[p-2])/2),l[p++]=n;for(h=p-v+1,p=0,d=0;h>d;d+=v)n=l[d],a=l[d+1],o=l[d+2],s=2===v?0:l[d+3],l[p++]=m=3===v?new r(n,a,o,s):new r(n,(2*a+n)/3,(2*a+o)/3,o);l.length=p}return f},p=function(e,t,i){for(var n,a,o,r,s,l,c,d,h,u,p,m=1/i,f=e.length;--f>-1;)for(u=e[f],o=u.a,r=u.d-o,s=u.c-o,l=u.b-o,n=a=0,d=1;i>=d;d++)c=m*d,h=1-c,n=a-(a=(c*c*r+3*h*(c*s+h*l))*c),p=f*i+d-1,t[p]=(t[p]||0)+n*n},m=function(e,t){t=t>>0||6;var i,n,a,o,r=[],s=[],l=0,c=0,d=t-1,h=[],u=[];for(i in e)p(e[i],r,t);for(a=r.length,n=0;a>n;n++)l+=Math.sqrt(r[n]),o=n%t,u[o]=l,o===d&&(c+=l,o=n/t>>0,h[o]=u,s[o]=c,l=0,u=[]);return{length:c,lengths:s,segments:h}},f=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.4",API:2,global:!0,init:function(e,t,i){this._target=e,t instanceof Array&&(t={values:t}),this._func={},this._round={},this._props=[],this._timeRes=null==t.timeResolution?6:parseInt(t.timeResolution,10);var n,a,o,r,s,l=t.values||[],c={},d=l[0],p=t.autoRotate||i.vars.orientToBezier;this._autoRotate=p?p instanceof Array?p:[["x","y","rotation",p===!0?0:Number(p)||0]]:null;for(n in d)this._props.push(n);for(o=this._props.length;--o>-1;)n=this._props[o],this._overwriteProps.push(n),a=this._func[n]="function"==typeof e[n],c[n]=a?e[n.indexOf("set")||"function"!=typeof e["get"+n.substr(3)]?n:"get"+n.substr(3)]():parseFloat(e[n]),s||c[n]!==l[0][n]&&(s=c);if(this._beziers="cubic"!==t.type&&"quadratic"!==t.type&&"soft"!==t.type?h(l,isNaN(t.curviness)?1:t.curviness,!1,"thruBasic"===t.type,t.correlate,s):u(l,t.type,c),this._segCount=this._beziers[n].length,this._timeRes){var f=m(this._beziers,this._timeRes);this._length=f.length,this._lengths=f.lengths,this._segments=f.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(p=this._autoRotate)for(this._initialRotations=[],p[0]instanceof Array||(this._autoRotate=p=[p]),o=p.length;--o>-1;){for(r=0;3>r;r++)n=p[o][r],this._func[n]="function"==typeof e[n]?e[n.indexOf("set")||"function"!=typeof e["get"+n.substr(3)]?n:"get"+n.substr(3)]:!1;n=p[o][2],this._initialRotations[o]=this._func[n]?this._func[n].call(this._target):this._target[n]}return this._startRatio=i.vars.runBackwards?1:0,!0},set:function(t){var i,n,a,o,r,s,l,c,d,h,u=this._segCount,p=this._func,m=this._target,f=t!==this._startRatio;if(this._timeRes){if(d=this._lengths,h=this._curSeg,t*=this._length,a=this._li,t>this._l2&&u-1>a){for(c=u-1;c>a&&(this._l2=d[++a])<=t;);this._l1=d[a-1],this._li=a,this._curSeg=h=this._segments[a],this._s2=h[this._s1=this._si=0]}else if(t<this._l1&&a>0){for(;a>0&&(this._l1=d[--a])>=t;);0===a&&t<this._l1?this._l1=0:a++,this._l2=d[a],this._li=a,this._curSeg=h=this._segments[a],this._s1=h[(this._si=h.length-1)-1]||0,this._s2=h[this._si]}if(i=a,t-=this._l1,a=this._si,t>this._s2&&a<h.length-1){for(c=h.length-1;c>a&&(this._s2=h[++a])<=t;);this._s1=h[a-1],this._si=a}else if(t<this._s1&&a>0){for(;a>0&&(this._s1=h[--a])>=t;);0===a&&t<this._s1?this._s1=0:a++,this._s2=h[a],this._si=a}s=(a+(t-this._s1)/(this._s2-this._s1))*this._prec
}else i=0>t?0:t>=1?u-1:u*t>>0,s=(t-i*(1/u))*u;for(n=1-s,a=this._props.length;--a>-1;)o=this._props[a],r=this._beziers[o][i],l=(s*s*r.da+3*n*(s*r.ca+n*r.ba))*s+r.a,this._round[o]&&(l=Math.round(l)),p[o]?m[o](l):m[o]=l;if(this._autoRotate){var v,g,w,_,y,b,x,S=this._autoRotate;for(a=S.length;--a>-1;)o=S[a][2],b=S[a][3]||0,x=S[a][4]===!0?1:e,r=this._beziers[S[a][0]],v=this._beziers[S[a][1]],r&&v&&(r=r[i],v=v[i],g=r.a+(r.b-r.a)*s,_=r.b+(r.c-r.b)*s,g+=(_-g)*s,_+=(r.c+(r.d-r.c)*s-_)*s,w=v.a+(v.b-v.a)*s,y=v.b+(v.c-v.b)*s,w+=(y-w)*s,y+=(v.c+(v.d-v.c)*s-y)*s,l=f?Math.atan2(y-w,_-g)*x+b:this._initialRotations[a],p[o]?m[o](l):m[o]=l)}}}),v=f.prototype;f.bezierThrough=h,f.cubicToQuadratic=l,f._autoCSS=!0,f.quadraticToCubic=function(e,t,i){return new r(e,(2*t+e)/3,(2*t+i)/3,i)},f._cssRegister=function(){var e=o.CSSPlugin;if(e){var t=e._internals,i=t._parseToProxy,n=t._setPluginRatio,a=t.CSSPropTween;t._registerComplexSpecialProp("bezier",{parser:function(e,t,o,r,s,l){t instanceof Array&&(t={values:t}),l=new f;var c,d,h,u=t.values,p=u.length-1,m=[],v={};if(0>p)return s;for(c=0;p>=c;c++)h=i(e,u[c],r,s,l,p!==c),m[c]=h.end;for(d in t)v[d]=t[d];return v.values=m,s=new a(e,"bezier",0,0,h.pt,2),s.data=h,s.plugin=l,s.setRatio=n,0===v.autoRotate&&(v.autoRotate=!0),!v.autoRotate||v.autoRotate instanceof Array||(c=v.autoRotate===!0?0:Number(v.autoRotate),v.autoRotate=null!=h.end.left?[["left","top","rotation",c,!1]]:null!=h.end.x?[["x","y","rotation",c,!1]]:!1),v.autoRotate&&(r._transform||r._enableTransforms(!1),h.autoRotate=r._target._gsTransform),l._onInitTween(h.proxy,v,r._tween),s}})}},v._roundProps=function(e,t){for(var i=this._overwriteProps,n=i.length;--n>-1;)(e[i[n]]||e.bezier||e.bezierThrough)&&(this._round[i[n]]=t)},v._kill=function(e){var t,i,n=this._props;for(t in this._beziers)if(t in e)for(delete this._beziers[t],delete this._func[t],i=n.length;--i>-1;)n[i]===t&&n.splice(i,1);return this._super._kill.call(this,e)}}(),_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(e,t){var i,n,a,o,r=function(){e.call(this,"css"),this._overwriteProps.length=0,this.setRatio=r.prototype.setRatio},s=_gsScope._gsDefine.globals,l={},c=r.prototype=new e("css");c.constructor=r,r.version="1.18.2",r.API=2,r.defaultTransformPerspective=0,r.defaultSkewType="compensated",r.defaultSmoothOrigin=!0,c="px",r.suffixMap={top:c,right:c,bottom:c,left:c,width:c,height:c,fontSize:c,padding:c,margin:c,perspective:c,lineHeight:""};var d,h,u,p,m,f,v=/(?:\d|\-\d|\.\d|\-\.\d)+/g,g=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,w=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,_=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,y=/(?:\d|\-|\+|=|#|\.)*/g,b=/opacity *= *([^)]*)/i,x=/opacity:([^;]*)/i,S=/alpha\(opacity *=.+?\)/i,T=/^(rgb|hsl)/,C=/([A-Z])/g,k=/-([a-z])/gi,P=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,E=function(e,t){return t.toUpperCase()},D=/(?:Left|Right|Width)/i,A=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,$=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,I=/,(?=[^\)]*(?:\(|$))/gi,O=Math.PI/180,N=180/Math.PI,R={},M=document,j=function(e){return M.createElementNS?M.createElementNS("http://www.w3.org/1999/xhtml",e):M.createElement(e)},L=j("div"),F=j("img"),z=r._internals={_specialProps:l},W=navigator.userAgent,B=function(){var e=W.indexOf("Android"),t=j("a");return u=-1!==W.indexOf("Safari")&&-1===W.indexOf("Chrome")&&(-1===e||Number(W.substr(e+8,1))>3),m=u&&Number(W.substr(W.indexOf("Version/")+8,1))<6,p=-1!==W.indexOf("Firefox"),(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(W)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(W))&&(f=parseFloat(RegExp.$1)),t?(t.style.cssText="top:1px;opacity:.55;",/^0.55/.test(t.style.opacity)):!1}(),H=function(e){return b.test("string"==typeof e?e:(e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100:1},U=function(e){window.console&&console.log(e)},V="",Y="",X=function(e,t){t=t||L;var i,n,a=t.style;if(void 0!==a[e])return e;for(e=e.charAt(0).toUpperCase()+e.substr(1),i=["O","Moz","ms","Ms","Webkit"],n=5;--n>-1&&void 0===a[i[n]+e];);return n>=0?(Y=3===n?"ms":i[n],V="-"+Y.toLowerCase()+"-",Y+e):null},q=M.defaultView?M.defaultView.getComputedStyle:function(){},J=r.getStyle=function(e,t,i,n,a){var o;return B||"opacity"!==t?(!n&&e.style[t]?o=e.style[t]:(i=i||q(e))?o=i[t]||i.getPropertyValue(t)||i.getPropertyValue(t.replace(C,"-$1").toLowerCase()):e.currentStyle&&(o=e.currentStyle[t]),null==a||o&&"none"!==o&&"auto"!==o&&"auto auto"!==o?o:a):H(e)},G=z.convertToPixels=function(e,i,n,a,o){if("px"===a||!a)return n;if("auto"===a||!n)return 0;var s,l,c,d=D.test(i),h=e,u=L.style,p=0>n;if(p&&(n=-n),"%"===a&&-1!==i.indexOf("border"))s=n/100*(d?e.clientWidth:e.clientHeight);else{if(u.cssText="border:0 solid red;position:"+J(e,"position")+";line-height:0;","%"!==a&&h.appendChild&&"v"!==a.charAt(0)&&"rem"!==a)u[d?"borderLeftWidth":"borderTopWidth"]=n+a;else{if(h=e.parentNode||M.body,l=h._gsCache,c=t.ticker.frame,l&&d&&l.time===c)return l.width*n/100;u[d?"width":"height"]=n+a}h.appendChild(L),s=parseFloat(L[d?"offsetWidth":"offsetHeight"]),h.removeChild(L),d&&"%"===a&&r.cacheWidths!==!1&&(l=h._gsCache=h._gsCache||{},l.time=c,l.width=s/n*100),0!==s||o||(s=G(e,i,n,a,!0))}return p?-s:s},K=z.calculateOffset=function(e,t,i){if("absolute"!==J(e,"position",i))return 0;var n="left"===t?"Left":"Top",a=J(e,"margin"+n,i);return e["offset"+n]-(G(e,t,parseFloat(a),a.replace(y,""))||0)},Q=function(e,t){var i,n,a,o={};if(t=t||q(e,null))if(i=t.length)for(;--i>-1;)a=t[i],(-1===a.indexOf("-transform")||Ct===a)&&(o[a.replace(k,E)]=t.getPropertyValue(a));else for(i in t)(-1===i.indexOf("Transform")||Tt===i)&&(o[i]=t[i]);else if(t=e.currentStyle||e.style)for(i in t)"string"==typeof i&&void 0===o[i]&&(o[i.replace(k,E)]=t[i]);return B||(o.opacity=H(e)),n=jt(e,t,!1),o.rotation=n.rotation,o.skewX=n.skewX,o.scaleX=n.scaleX,o.scaleY=n.scaleY,o.x=n.x,o.y=n.y,Pt&&(o.z=n.z,o.rotationX=n.rotationX,o.rotationY=n.rotationY,o.scaleZ=n.scaleZ),o.filters&&delete o.filters,o},Z=function(e,t,i,n,a){var o,r,s,l={},c=e.style;for(r in i)"cssText"!==r&&"length"!==r&&isNaN(r)&&(t[r]!==(o=i[r])||a&&a[r])&&-1===r.indexOf("Origin")&&("number"==typeof o||"string"==typeof o)&&(l[r]="auto"!==o||"left"!==r&&"top"!==r?""!==o&&"auto"!==o&&"none"!==o||"string"!=typeof t[r]||""===t[r].replace(_,"")?o:0:K(e,r),void 0!==c[r]&&(s=new mt(c,r,c[r],s)));if(n)for(r in n)"className"!==r&&(l[r]=n[r]);return{difs:l,firstMPT:s}},et={width:["Left","Right"],height:["Top","Bottom"]},tt=["marginLeft","marginRight","marginTop","marginBottom"],it=function(e,t,i){var n=parseFloat("width"===t?e.offsetWidth:e.offsetHeight),a=et[t],o=a.length;for(i=i||q(e,null);--o>-1;)n-=parseFloat(J(e,"padding"+a[o],i,!0))||0,n-=parseFloat(J(e,"border"+a[o]+"Width",i,!0))||0;return n},nt=function(e,t){if("contain"===e||"auto"===e||"auto auto"===e)return e+" ";(null==e||""===e)&&(e="0 0");var i=e.split(" "),n=-1!==e.indexOf("left")?"0%":-1!==e.indexOf("right")?"100%":i[0],a=-1!==e.indexOf("top")?"0%":-1!==e.indexOf("bottom")?"100%":i[1];return null==a?a="center"===n?"50%":"0":"center"===a&&(a="50%"),("center"===n||isNaN(parseFloat(n))&&-1===(n+"").indexOf("="))&&(n="50%"),e=n+" "+a+(i.length>2?" "+i[2]:""),t&&(t.oxp=-1!==n.indexOf("%"),t.oyp=-1!==a.indexOf("%"),t.oxr="="===n.charAt(1),t.oyr="="===a.charAt(1),t.ox=parseFloat(n.replace(_,"")),t.oy=parseFloat(a.replace(_,"")),t.v=e),t||e},at=function(e,t){return"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(t)},ot=function(e,t){return null==e?t:"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2))+t:parseFloat(e)},rt=function(e,t,i,n){var a,o,r,s,l,c=1e-6;return null==e?s=t:"number"==typeof e?s=e:(a=360,o=e.split("_"),l="="===e.charAt(1),r=(l?parseInt(e.charAt(0)+"1",10)*parseFloat(o[0].substr(2)):parseFloat(o[0]))*(-1===e.indexOf("rad")?1:N)-(l?0:t),o.length&&(n&&(n[i]=t+r),-1!==e.indexOf("short")&&(r%=a,r!==r%(a/2)&&(r=0>r?r+a:r-a)),-1!==e.indexOf("_cw")&&0>r?r=(r+9999999999*a)%a-(r/a|0)*a:-1!==e.indexOf("ccw")&&r>0&&(r=(r-9999999999*a)%a-(r/a|0)*a)),s=t+r),c>s&&s>-c&&(s=0),s},st={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},lt=function(e,t,i){return e=0>e?e+1:e>1?e-1:e,255*(1>6*e?t+(i-t)*e*6:.5>e?i:2>3*e?t+(i-t)*(2/3-e)*6:t)+.5|0},ct=r.parseColor=function(e,t){var i,n,a,o,r,s,l,c,d,h,u;if(e)if("number"==typeof e)i=[e>>16,e>>8&255,255&e];else{if(","===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),st[e])i=st[e];else if("#"===e.charAt(0))4===e.length&&(n=e.charAt(1),a=e.charAt(2),o=e.charAt(3),e="#"+n+n+a+a+o+o),e=parseInt(e.substr(1),16),i=[e>>16,e>>8&255,255&e];else if("hsl"===e.substr(0,3))if(i=u=e.match(v),t){if(-1!==e.indexOf("="))return e.match(g)}else r=Number(i[0])%360/360,s=Number(i[1])/100,l=Number(i[2])/100,a=.5>=l?l*(s+1):l+s-l*s,n=2*l-a,i.length>3&&(i[3]=Number(e[3])),i[0]=lt(r+1/3,n,a),i[1]=lt(r,n,a),i[2]=lt(r-1/3,n,a);else i=e.match(v)||st.transparent;i[0]=Number(i[0]),i[1]=Number(i[1]),i[2]=Number(i[2]),i.length>3&&(i[3]=Number(i[3]))}else i=st.black;return t&&!u&&(n=i[0]/255,a=i[1]/255,o=i[2]/255,c=Math.max(n,a,o),d=Math.min(n,a,o),l=(c+d)/2,c===d?r=s=0:(h=c-d,s=l>.5?h/(2-c-d):h/(c+d),r=c===n?(a-o)/h+(o>a?6:0):c===a?(o-n)/h+2:(n-a)/h+4,r*=60),i[0]=r+.5|0,i[1]=100*s+.5|0,i[2]=100*l+.5|0),i},dt=function(e,t){var i,n,a,o=e.match(ht)||[],r=0,s=o.length?"":e;for(i=0;i<o.length;i++)n=o[i],a=e.substr(r,e.indexOf(n,r)-r),r+=a.length+n.length,n=ct(n,t),3===n.length&&n.push(1),s+=a+(t?"hsla("+n[0]+","+n[1]+"%,"+n[2]+"%,"+n[3]:"rgba("+n.join(","))+")";return s},ht="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(c in st)ht+="|"+c+"\\b";ht=new RegExp(ht+")","gi"),r.colorStringFilter=function(e){var t,i=e[0]+e[1];ht.lastIndex=0,ht.test(i)&&(t=-1!==i.indexOf("hsl(")||-1!==i.indexOf("hsla("),e[0]=dt(e[0],t),e[1]=dt(e[1],t))},t.defaultStringFilter||(t.defaultStringFilter=r.colorStringFilter);var ut=function(e,t,i,n){if(null==e)return function(e){return e};var a,o=t?(e.match(ht)||[""])[0]:"",r=e.split(o).join("").match(w)||[],s=e.substr(0,e.indexOf(r[0])),l=")"===e.charAt(e.length-1)?")":"",c=-1!==e.indexOf(" ")?" ":",",d=r.length,h=d>0?r[0].replace(v,""):"";return d?a=t?function(e){var t,u,p,m;if("number"==typeof e)e+=h;else if(n&&I.test(e)){for(m=e.replace(I,"|").split("|"),p=0;p<m.length;p++)m[p]=a(m[p]);return m.join(",")}if(t=(e.match(ht)||[o])[0],u=e.split(t).join("").match(w)||[],p=u.length,d>p--)for(;++p<d;)u[p]=i?u[(p-1)/2|0]:r[p];return s+u.join(c)+c+t+l+(-1!==e.indexOf("inset")?" inset":"")}:function(e){var t,o,u;if("number"==typeof e)e+=h;else if(n&&I.test(e)){for(o=e.replace(I,"|").split("|"),u=0;u<o.length;u++)o[u]=a(o[u]);return o.join(",")}if(t=e.match(w)||[],u=t.length,d>u--)for(;++u<d;)t[u]=i?t[(u-1)/2|0]:r[u];return s+t.join(c)+l}:function(e){return e}},pt=function(e){return e=e.split(","),function(t,i,n,a,o,r,s){var l,c=(i+"").split(" ");for(s={},l=0;4>l;l++)s[e[l]]=c[l]=c[l]||c[(l-1)/2>>0];return a.parse(t,s,o,r)}},mt=(z._setPluginRatio=function(e){this.plugin.setRatio(e);for(var t,i,n,a,o,r=this.data,s=r.proxy,l=r.firstMPT,c=1e-6;l;)t=s[l.v],l.r?t=Math.round(t):c>t&&t>-c&&(t=0),l.t[l.p]=t,l=l._next;if(r.autoRotate&&(r.autoRotate.rotation=s.rotation),1===e||0===e)for(l=r.firstMPT,o=1===e?"e":"b";l;){if(i=l.t,i.type){if(1===i.type){for(a=i.xs0+i.s+i.xs1,n=1;n<i.l;n++)a+=i["xn"+n]+i["xs"+(n+1)];i[o]=a}}else i[o]=i.s+i.xs0;l=l._next}},function(e,t,i,n,a){this.t=e,this.p=t,this.v=i,this.r=a,n&&(n._prev=this,this._next=n)}),ft=(z._parseToProxy=function(e,t,i,n,a,o){var r,s,l,c,d,h=n,u={},p={},m=i._transform,f=R;for(i._transform=null,R=t,n=d=i.parse(e,t,n,a),R=f,o&&(i._transform=m,h&&(h._prev=null,h._prev&&(h._prev._next=null)));n&&n!==h;){if(n.type<=1&&(s=n.p,p[s]=n.s+n.c,u[s]=n.s,o||(c=new mt(n,"s",s,c,n.r),n.c=0),1===n.type))for(r=n.l;--r>0;)l="xn"+r,s=n.p+"_"+l,p[s]=n.data[l],u[s]=n[l],o||(c=new mt(n,l,s,c,n.rxp[l]));n=n._next}return{proxy:u,end:p,firstMPT:c,pt:d}},z.CSSPropTween=function(e,t,n,a,r,s,l,c,d,h,u){this.t=e,this.p=t,this.s=n,this.c=a,this.n=l||t,e instanceof ft||o.push(this.n),this.r=c,this.type=s||0,d&&(this.pr=d,i=!0),this.b=void 0===h?n:h,this.e=void 0===u?n+a:u,r&&(this._next=r,r._prev=this)}),vt=function(e,t,i,n,a,o){var r=new ft(e,t,i,n-i,a,-1,o);return r.b=i,r.e=r.xs0=n,r},gt=r.parseComplex=function(e,t,i,n,a,o,r,s,l,c){i=i||o||"",r=new ft(e,t,0,0,r,c?2:1,null,!1,s,i,n),n+="";var h,u,p,m,f,w,_,y,b,x,S,T,C,k=i.split(", ").join(",").split(" "),P=n.split(", ").join(",").split(" "),E=k.length,D=d!==!1;for((-1!==n.indexOf(",")||-1!==i.indexOf(","))&&(k=k.join(" ").replace(I,", ").split(" "),P=P.join(" ").replace(I,", ").split(" "),E=k.length),E!==P.length&&(k=(o||"").split(" "),E=k.length),r.plugin=l,r.setRatio=c,ht.lastIndex=0,h=0;E>h;h++)if(m=k[h],f=P[h],y=parseFloat(m),y||0===y)r.appendXtra("",y,at(f,y),f.replace(g,""),D&&-1!==f.indexOf("px"),!0);else if(a&&ht.test(m))T=","===f.charAt(f.length-1)?"),":")",C=-1!==f.indexOf("hsl")&&B,m=ct(m,C),f=ct(f,C),b=m.length+f.length>6,b&&!B&&0===f[3]?(r["xs"+r.l]+=r.l?" transparent":"transparent",r.e=r.e.split(P[h]).join("transparent")):(B||(b=!1),C?r.appendXtra(b?"hsla(":"hsl(",m[0],at(f[0],m[0]),",",!1,!0).appendXtra("",m[1],at(f[1],m[1]),"%,",!1).appendXtra("",m[2],at(f[2],m[2]),b?"%,":"%"+T,!1):r.appendXtra(b?"rgba(":"rgb(",m[0],f[0]-m[0],",",!0,!0).appendXtra("",m[1],f[1]-m[1],",",!0).appendXtra("",m[2],f[2]-m[2],b?",":T,!0),b&&(m=m.length<4?1:m[3],r.appendXtra("",m,(f.length<4?1:f[3])-m,T,!1))),ht.lastIndex=0;else if(w=m.match(v)){if(_=f.match(g),!_||_.length!==w.length)return r;for(p=0,u=0;u<w.length;u++)S=w[u],x=m.indexOf(S,p),r.appendXtra(m.substr(p,x-p),Number(S),at(_[u],S),"",D&&"px"===m.substr(x+S.length,2),0===u),p=x+S.length;r["xs"+r.l]+=m.substr(p)}else r["xs"+r.l]+=r.l?" "+f:f;if(-1!==n.indexOf("=")&&r.data){for(T=r.xs0+r.data.s,h=1;h<r.l;h++)T+=r["xs"+h]+r.data["xn"+h];r.e=T+r["xs"+h]}return r.l||(r.type=-1,r.xs0=r.e),r.xfirst||r},wt=9;for(c=ft.prototype,c.l=c.pr=0;--wt>0;)c["xn"+wt]=0,c["xs"+wt]="";c.xs0="",c._next=c._prev=c.xfirst=c.data=c.plugin=c.setRatio=c.rxp=null,c.appendXtra=function(e,t,i,n,a,o){var r=this,s=r.l;return r["xs"+s]+=o&&s?" "+e:e||"",i||0===s||r.plugin?(r.l++,r.type=r.setRatio?2:1,r["xs"+r.l]=n||"",s>0?(r.data["xn"+s]=t+i,r.rxp["xn"+s]=a,r["xn"+s]=t,r.plugin||(r.xfirst=new ft(r,"xn"+s,t,i,r.xfirst||r,0,r.n,a,r.pr),r.xfirst.xs0=0),r):(r.data={s:t+i},r.rxp={},r.s=t,r.c=i,r.r=a,r)):(r["xs"+s]+=t+(n||""),r)};var _t=function(e,t){t=t||{},this.p=t.prefix?X(e)||e:e,l[e]=l[this.p]=this,this.format=t.formatter||ut(t.defaultValue,t.color,t.collapsible,t.multi),t.parser&&(this.parse=t.parser),this.clrs=t.color,this.multi=t.multi,this.keyword=t.keyword,this.dflt=t.defaultValue,this.pr=t.priority||0},yt=z._registerComplexSpecialProp=function(e,t,i){"object"!=typeof t&&(t={parser:i});var n,a,o=e.split(","),r=t.defaultValue;for(i=i||[r],n=0;n<o.length;n++)t.prefix=0===n&&t.prefix,t.defaultValue=i[n]||r,a=new _t(o[n],t)},bt=function(e){if(!l[e]){var t=e.charAt(0).toUpperCase()+e.substr(1)+"Plugin";yt(e,{parser:function(e,i,n,a,o,r,c){var d=s.com.greensock.plugins[t];return d?(d._cssRegister(),l[n].parse(e,i,n,a,o,r,c)):(U("Error: "+t+" js file not loaded."),o)}})}};c=_t.prototype,c.parseComplex=function(e,t,i,n,a,o){var r,s,l,c,d,h,u=this.keyword;if(this.multi&&(I.test(i)||I.test(t)?(s=t.replace(I,"|").split("|"),l=i.replace(I,"|").split("|")):u&&(s=[t],l=[i])),l){for(c=l.length>s.length?l.length:s.length,r=0;c>r;r++)t=s[r]=s[r]||this.dflt,i=l[r]=l[r]||this.dflt,u&&(d=t.indexOf(u),h=i.indexOf(u),d!==h&&(-1===h?s[r]=s[r].split(u).join(""):-1===d&&(s[r]+=" "+u)));t=s.join(", "),i=l.join(", ")}return gt(e,this.p,t,i,this.clrs,this.dflt,n,this.pr,a,o)},c.parse=function(e,t,i,n,o,r){return this.parseComplex(e.style,this.format(J(e,this.p,a,!1,this.dflt)),this.format(t),o,r)},r.registerSpecialProp=function(e,t,i){yt(e,{parser:function(e,n,a,o,r,s){var l=new ft(e,a,0,0,r,2,a,!1,i);return l.plugin=s,l.setRatio=t(e,n,o._tween,a),l},priority:i})},r.useSVGTransformAttr=u||p;var xt,St="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),Tt=X("transform"),Ct=V+"transform",kt=X("transformOrigin"),Pt=null!==X("perspective"),Et=z.Transform=function(){this.perspective=parseFloat(r.defaultTransformPerspective)||0,this.force3D=r.defaultForce3D!==!1&&Pt?r.defaultForce3D||"auto":!1},Dt=window.SVGElement,At=function(e,t,i){var n,a=M.createElementNS("http://www.w3.org/2000/svg",e),o=/([a-z])([A-Z])/g;for(n in i)a.setAttributeNS(null,n.replace(o,"$1-$2").toLowerCase(),i[n]);return t.appendChild(a),a},$t=M.documentElement,It=function(){var e,t,i,n=f||/Android/i.test(W)&&!window.chrome;return M.createElementNS&&!n&&(e=At("svg",$t),t=At("rect",e,{width:100,height:50,x:100}),i=t.getBoundingClientRect().width,t.style[kt]="50% 50%",t.style[Tt]="scaleX(0.5)",n=i===t.getBoundingClientRect().width&&!(p&&Pt),$t.removeChild(e)),n}(),Ot=function(e,t,i,n,a){var o,s,l,c,d,h,u,p,m,f,v,g,w,_,y=e._gsTransform,b=Mt(e,!0);y&&(w=y.xOrigin,_=y.yOrigin),(!n||(o=n.split(" ")).length<2)&&(u=e.getBBox(),t=nt(t).split(" "),o=[(-1!==t[0].indexOf("%")?parseFloat(t[0])/100*u.width:parseFloat(t[0]))+u.x,(-1!==t[1].indexOf("%")?parseFloat(t[1])/100*u.height:parseFloat(t[1]))+u.y]),i.xOrigin=c=parseFloat(o[0]),i.yOrigin=d=parseFloat(o[1]),n&&b!==Rt&&(h=b[0],u=b[1],p=b[2],m=b[3],f=b[4],v=b[5],g=h*m-u*p,s=c*(m/g)+d*(-p/g)+(p*v-m*f)/g,l=c*(-u/g)+d*(h/g)-(h*v-u*f)/g,c=i.xOrigin=o[0]=s,d=i.yOrigin=o[1]=l),y&&(a||a!==!1&&r.defaultSmoothOrigin!==!1?(s=c-w,l=d-_,y.xOffset+=s*b[0]+l*b[2]-s,y.yOffset+=s*b[1]+l*b[3]-l):y.xOffset=y.yOffset=0),e.setAttribute("data-svg-origin",o.join(" "))},Nt=function(e){return!!(Dt&&"function"==typeof e.getBBox&&e.getCTM&&(!e.parentNode||e.parentNode.getBBox&&e.parentNode.getCTM))},Rt=[1,0,0,1,0,0],Mt=function(e,t){var i,n,a,o,r,s=e._gsTransform||new Et,l=1e5;if(Tt?n=J(e,Ct,null,!0):e.currentStyle&&(n=e.currentStyle.filter.match(A),n=n&&4===n.length?[n[0].substr(4),Number(n[2].substr(4)),Number(n[1].substr(4)),n[3].substr(4),s.x||0,s.y||0].join(","):""),i=!n||"none"===n||"matrix(1, 0, 0, 1, 0, 0)"===n,(s.svg||e.getBBox&&Nt(e))&&(i&&-1!==(e.style[Tt]+"").indexOf("matrix")&&(n=e.style[Tt],i=0),a=e.getAttribute("transform"),i&&a&&(-1!==a.indexOf("matrix")?(n=a,i=0):-1!==a.indexOf("translate")&&(n="matrix(1,0,0,1,"+a.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",")+")",i=0))),i)return Rt;for(a=(n||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],wt=a.length;--wt>-1;)o=Number(a[wt]),a[wt]=(r=o-(o|=0))?(r*l+(0>r?-.5:.5)|0)/l+o:o;return t&&a.length>6?[a[0],a[1],a[4],a[5],a[12],a[13]]:a},jt=z.getTransform=function(e,i,n,o){if(e._gsTransform&&n&&!o)return e._gsTransform;var s,l,c,d,h,u,p=n?e._gsTransform||new Et:new Et,m=p.scaleX<0,f=2e-5,v=1e5,g=Pt?parseFloat(J(e,kt,i,!1,"0 0 0").split(" ")[2])||p.zOrigin||0:0,w=parseFloat(r.defaultTransformPerspective)||0;if(p.svg=!(!e.getBBox||!Nt(e)),p.svg&&(Ot(e,J(e,kt,a,!1,"50% 50%")+"",p,e.getAttribute("data-svg-origin")),xt=r.useSVGTransformAttr||It),s=Mt(e),s!==Rt){if(16===s.length){var _,y,b,x,S,T=s[0],C=s[1],k=s[2],P=s[3],E=s[4],D=s[5],A=s[6],$=s[7],I=s[8],O=s[9],R=s[10],M=s[12],j=s[13],L=s[14],F=s[11],z=Math.atan2(A,R);p.zOrigin&&(L=-p.zOrigin,M=I*L-s[12],j=O*L-s[13],L=R*L+p.zOrigin-s[14]),p.rotationX=z*N,z&&(x=Math.cos(-z),S=Math.sin(-z),_=E*x+I*S,y=D*x+O*S,b=A*x+R*S,I=E*-S+I*x,O=D*-S+O*x,R=A*-S+R*x,F=$*-S+F*x,E=_,D=y,A=b),z=Math.atan2(-k,R),p.rotationY=z*N,z&&(x=Math.cos(-z),S=Math.sin(-z),_=T*x-I*S,y=C*x-O*S,b=k*x-R*S,O=C*S+O*x,R=k*S+R*x,F=P*S+F*x,T=_,C=y,k=b),z=Math.atan2(C,T),p.rotation=z*N,z&&(x=Math.cos(-z),S=Math.sin(-z),T=T*x+E*S,y=C*x+D*S,D=C*-S+D*x,A=k*-S+A*x,C=y),p.rotationX&&Math.abs(p.rotationX)+Math.abs(p.rotation)>359.9&&(p.rotationX=p.rotation=0,p.rotationY=180-p.rotationY),p.scaleX=(Math.sqrt(T*T+C*C)*v+.5|0)/v,p.scaleY=(Math.sqrt(D*D+O*O)*v+.5|0)/v,p.scaleZ=(Math.sqrt(A*A+R*R)*v+.5|0)/v,p.skewX=0,p.perspective=F?1/(0>F?-F:F):0,p.x=M,p.y=j,p.z=L,p.svg&&(p.x-=p.xOrigin-(p.xOrigin*T-p.yOrigin*E),p.y-=p.yOrigin-(p.yOrigin*C-p.xOrigin*D))}else if(!(Pt&&!o&&s.length&&p.x===s[4]&&p.y===s[5]&&(p.rotationX||p.rotationY)||void 0!==p.x&&"none"===J(e,"display",i))){var W=s.length>=6,B=W?s[0]:1,H=s[1]||0,U=s[2]||0,V=W?s[3]:1;p.x=s[4]||0,p.y=s[5]||0,c=Math.sqrt(B*B+H*H),d=Math.sqrt(V*V+U*U),h=B||H?Math.atan2(H,B)*N:p.rotation||0,u=U||V?Math.atan2(U,V)*N+h:p.skewX||0,Math.abs(u)>90&&Math.abs(u)<270&&(m?(c*=-1,u+=0>=h?180:-180,h+=0>=h?180:-180):(d*=-1,u+=0>=u?180:-180)),p.scaleX=c,p.scaleY=d,p.rotation=h,p.skewX=u,Pt&&(p.rotationX=p.rotationY=p.z=0,p.perspective=w,p.scaleZ=1),p.svg&&(p.x-=p.xOrigin-(p.xOrigin*B+p.yOrigin*U),p.y-=p.yOrigin-(p.xOrigin*H+p.yOrigin*V))}p.zOrigin=g;for(l in p)p[l]<f&&p[l]>-f&&(p[l]=0)}return n&&(e._gsTransform=p,p.svg&&(xt&&e.style[Tt]?t.delayedCall(.001,function(){Wt(e.style,Tt)}):!xt&&e.getAttribute("transform")&&t.delayedCall(.001,function(){e.removeAttribute("transform")}))),p},Lt=function(e){var t,i,n=this.data,a=-n.rotation*O,o=a+n.skewX*O,r=1e5,s=(Math.cos(a)*n.scaleX*r|0)/r,l=(Math.sin(a)*n.scaleX*r|0)/r,c=(Math.sin(o)*-n.scaleY*r|0)/r,d=(Math.cos(o)*n.scaleY*r|0)/r,h=this.t.style,u=this.t.currentStyle;if(u){i=l,l=-c,c=-i,t=u.filter,h.filter="";var p,m,v=this.t.offsetWidth,g=this.t.offsetHeight,w="absolute"!==u.position,_="progid:DXImageTransform.Microsoft.Matrix(M11="+s+", M12="+l+", M21="+c+", M22="+d,x=n.x+v*n.xPercent/100,S=n.y+g*n.yPercent/100;if(null!=n.ox&&(p=(n.oxp?v*n.ox*.01:n.ox)-v/2,m=(n.oyp?g*n.oy*.01:n.oy)-g/2,x+=p-(p*s+m*l),S+=m-(p*c+m*d)),w?(p=v/2,m=g/2,_+=", Dx="+(p-(p*s+m*l)+x)+", Dy="+(m-(p*c+m*d)+S)+")"):_+=", sizingMethod='auto expand')",h.filter=-1!==t.indexOf("DXImageTransform.Microsoft.Matrix(")?t.replace($,_):_+" "+t,(0===e||1===e)&&1===s&&0===l&&0===c&&1===d&&(w&&-1===_.indexOf("Dx=0, Dy=0")||b.test(t)&&100!==parseFloat(RegExp.$1)||-1===t.indexOf("gradient("&&t.indexOf("Alpha"))&&h.removeAttribute("filter")),!w){var T,C,k,P=8>f?1:-1;for(p=n.ieOffsetX||0,m=n.ieOffsetY||0,n.ieOffsetX=Math.round((v-((0>s?-s:s)*v+(0>l?-l:l)*g))/2+x),n.ieOffsetY=Math.round((g-((0>d?-d:d)*g+(0>c?-c:c)*v))/2+S),wt=0;4>wt;wt++)C=tt[wt],T=u[C],i=-1!==T.indexOf("px")?parseFloat(T):G(this.t,C,parseFloat(T),T.replace(y,""))||0,k=i!==n[C]?2>wt?-n.ieOffsetX:-n.ieOffsetY:2>wt?p-n.ieOffsetX:m-n.ieOffsetY,h[C]=(n[C]=Math.round(i-k*(0===wt||2===wt?1:P)))+"px"}}},Ft=z.set3DTransformRatio=z.setTransformRatio=function(e){var t,i,n,a,o,r,s,l,c,d,h,u,m,f,v,g,w,_,y,b,x,S,T,C=this.data,k=this.t.style,P=C.rotation,E=C.rotationX,D=C.rotationY,A=C.scaleX,$=C.scaleY,I=C.scaleZ,N=C.x,R=C.y,M=C.z,j=C.svg,L=C.perspective,F=C.force3D;if(!(((1!==e&&0!==e||"auto"!==F||this.tween._totalTime!==this.tween._totalDuration&&this.tween._totalTime)&&F||M||L||D||E||1!==I)&&(!xt||!j)&&Pt))return void(P||C.skewX||j?(P*=O,S=C.skewX*O,T=1e5,t=Math.cos(P)*A,a=Math.sin(P)*A,i=Math.sin(P-S)*-$,o=Math.cos(P-S)*$,S&&"simple"===C.skewType&&(w=Math.tan(S),w=Math.sqrt(1+w*w),i*=w,o*=w,C.skewY&&(t*=w,a*=w)),j&&(N+=C.xOrigin-(C.xOrigin*t+C.yOrigin*i)+C.xOffset,R+=C.yOrigin-(C.xOrigin*a+C.yOrigin*o)+C.yOffset,xt&&(C.xPercent||C.yPercent)&&(f=this.t.getBBox(),N+=.01*C.xPercent*f.width,R+=.01*C.yPercent*f.height),f=1e-6,f>N&&N>-f&&(N=0),f>R&&R>-f&&(R=0)),y=(t*T|0)/T+","+(a*T|0)/T+","+(i*T|0)/T+","+(o*T|0)/T+","+N+","+R+")",j&&xt?this.t.setAttribute("transform","matrix("+y):k[Tt]=(C.xPercent||C.yPercent?"translate("+C.xPercent+"%,"+C.yPercent+"%) matrix(":"matrix(")+y):k[Tt]=(C.xPercent||C.yPercent?"translate("+C.xPercent+"%,"+C.yPercent+"%) matrix(":"matrix(")+A+",0,0,"+$+","+N+","+R+")");if(p&&(f=1e-4,f>A&&A>-f&&(A=I=2e-5),f>$&&$>-f&&($=I=2e-5),!L||C.z||C.rotationX||C.rotationY||(L=0)),P||C.skewX)P*=O,v=t=Math.cos(P),g=a=Math.sin(P),C.skewX&&(P-=C.skewX*O,v=Math.cos(P),g=Math.sin(P),"simple"===C.skewType&&(w=Math.tan(C.skewX*O),w=Math.sqrt(1+w*w),v*=w,g*=w,C.skewY&&(t*=w,a*=w))),i=-g,o=v;else{if(!(D||E||1!==I||L||j))return void(k[Tt]=(C.xPercent||C.yPercent?"translate("+C.xPercent+"%,"+C.yPercent+"%) translate3d(":"translate3d(")+N+"px,"+R+"px,"+M+"px)"+(1!==A||1!==$?" scale("+A+","+$+")":""));t=o=1,i=a=0}c=1,n=r=s=l=d=h=0,u=L?-1/L:0,m=C.zOrigin,f=1e-6,b=",",x="0",P=D*O,P&&(v=Math.cos(P),g=Math.sin(P),s=-g,d=u*-g,n=t*g,r=a*g,c=v,u*=v,t*=v,a*=v),P=E*O,P&&(v=Math.cos(P),g=Math.sin(P),w=i*v+n*g,_=o*v+r*g,l=c*g,h=u*g,n=i*-g+n*v,r=o*-g+r*v,c*=v,u*=v,i=w,o=_),1!==I&&(n*=I,r*=I,c*=I,u*=I),1!==$&&(i*=$,o*=$,l*=$,h*=$),1!==A&&(t*=A,a*=A,s*=A,d*=A),(m||j)&&(m&&(N+=n*-m,R+=r*-m,M+=c*-m+m),j&&(N+=C.xOrigin-(C.xOrigin*t+C.yOrigin*i)+C.xOffset,R+=C.yOrigin-(C.xOrigin*a+C.yOrigin*o)+C.yOffset),f>N&&N>-f&&(N=x),f>R&&R>-f&&(R=x),f>M&&M>-f&&(M=0)),y=C.xPercent||C.yPercent?"translate("+C.xPercent+"%,"+C.yPercent+"%) matrix3d(":"matrix3d(",y+=(f>t&&t>-f?x:t)+b+(f>a&&a>-f?x:a)+b+(f>s&&s>-f?x:s),y+=b+(f>d&&d>-f?x:d)+b+(f>i&&i>-f?x:i)+b+(f>o&&o>-f?x:o),E||D||1!==I?(y+=b+(f>l&&l>-f?x:l)+b+(f>h&&h>-f?x:h)+b+(f>n&&n>-f?x:n),y+=b+(f>r&&r>-f?x:r)+b+(f>c&&c>-f?x:c)+b+(f>u&&u>-f?x:u)+b):y+=",0,0,0,0,1,0,",y+=N+b+R+b+M+b+(L?1+-M/L:1)+")",k[Tt]=y};c=Et.prototype,c.x=c.y=c.z=c.skewX=c.skewY=c.rotation=c.rotationX=c.rotationY=c.zOrigin=c.xPercent=c.yPercent=c.xOffset=c.yOffset=0,c.scaleX=c.scaleY=c.scaleZ=1,yt("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(e,t,i,n,o,s,l){if(n._lastParsedTransform===l)return o;n._lastParsedTransform=l;var c,d,h,u,p,m,f,v,g,w,_=e._gsTransform,y=e.style,b=1e-6,x=St.length,S=l,T={},C="transformOrigin";if(l.display?(u=J(e,"display"),y.display="block",c=jt(e,a,!0,l.parseTransform),y.display=u):c=jt(e,a,!0,l.parseTransform),n._transform=c,"string"==typeof S.transform&&Tt)u=L.style,u[Tt]=S.transform,u.display="block",u.position="absolute",M.body.appendChild(L),d=jt(L,null,!1),M.body.removeChild(L),d.perspective||(d.perspective=c.perspective),null!=S.xPercent&&(d.xPercent=ot(S.xPercent,c.xPercent)),null!=S.yPercent&&(d.yPercent=ot(S.yPercent,c.yPercent));else if("object"==typeof S){if(d={scaleX:ot(null!=S.scaleX?S.scaleX:S.scale,c.scaleX),scaleY:ot(null!=S.scaleY?S.scaleY:S.scale,c.scaleY),scaleZ:ot(S.scaleZ,c.scaleZ),x:ot(S.x,c.x),y:ot(S.y,c.y),z:ot(S.z,c.z),xPercent:ot(S.xPercent,c.xPercent),yPercent:ot(S.yPercent,c.yPercent),perspective:ot(S.transformPerspective,c.perspective)},v=S.directionalRotation,null!=v)if("object"==typeof v)for(u in v)S[u]=v[u];else S.rotation=v;"string"==typeof S.x&&-1!==S.x.indexOf("%")&&(d.x=0,d.xPercent=ot(S.x,c.xPercent)),"string"==typeof S.y&&-1!==S.y.indexOf("%")&&(d.y=0,d.yPercent=ot(S.y,c.yPercent)),d.rotation=rt("rotation"in S?S.rotation:"shortRotation"in S?S.shortRotation+"_short":"rotationZ"in S?S.rotationZ:c.rotation,c.rotation,"rotation",T),Pt&&(d.rotationX=rt("rotationX"in S?S.rotationX:"shortRotationX"in S?S.shortRotationX+"_short":c.rotationX||0,c.rotationX,"rotationX",T),d.rotationY=rt("rotationY"in S?S.rotationY:"shortRotationY"in S?S.shortRotationY+"_short":c.rotationY||0,c.rotationY,"rotationY",T)),d.skewX=null==S.skewX?c.skewX:rt(S.skewX,c.skewX),d.skewY=null==S.skewY?c.skewY:rt(S.skewY,c.skewY),(h=d.skewY-c.skewY)&&(d.skewX+=h,d.rotation+=h)}for(Pt&&null!=S.force3D&&(c.force3D=S.force3D,f=!0),c.skewType=S.skewType||c.skewType||r.defaultSkewType,m=c.force3D||c.z||c.rotationX||c.rotationY||d.z||d.rotationX||d.rotationY||d.perspective,m||null==S.scale||(d.scaleZ=1);--x>-1;)i=St[x],p=d[i]-c[i],(p>b||-b>p||null!=S[i]||null!=R[i])&&(f=!0,o=new ft(c,i,c[i],p,o),i in T&&(o.e=T[i]),o.xs0=0,o.plugin=s,n._overwriteProps.push(o.n));return p=S.transformOrigin,c.svg&&(p||S.svgOrigin)&&(g=c.xOffset,w=c.yOffset,Ot(e,nt(p),d,S.svgOrigin,S.smoothOrigin),o=vt(c,"xOrigin",(_?c:d).xOrigin,d.xOrigin,o,C),o=vt(c,"yOrigin",(_?c:d).yOrigin,d.yOrigin,o,C),(g!==c.xOffset||w!==c.yOffset)&&(o=vt(c,"xOffset",_?g:c.xOffset,c.xOffset,o,C),o=vt(c,"yOffset",_?w:c.yOffset,c.yOffset,o,C)),p=xt?null:"0px 0px"),(p||Pt&&m&&c.zOrigin)&&(Tt?(f=!0,i=kt,p=(p||J(e,i,a,!1,"50% 50%"))+"",o=new ft(y,i,0,0,o,-1,C),o.b=y[i],o.plugin=s,Pt?(u=c.zOrigin,p=p.split(" "),c.zOrigin=(p.length>2&&(0===u||"0px"!==p[2])?parseFloat(p[2]):u)||0,o.xs0=o.e=p[0]+" "+(p[1]||"50%")+" 0px",o=new ft(c,"zOrigin",0,0,o,-1,o.n),o.b=u,o.xs0=o.e=c.zOrigin):o.xs0=o.e=p):nt(p+"",c)),f&&(n._transformType=c.svg&&xt||!m&&3!==this._transformType?2:3),o},prefix:!0}),yt("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),yt("borderRadius",{defaultValue:"0px",parser:function(e,t,i,o,r){t=this.format(t);var s,l,c,d,h,u,p,m,f,v,g,w,_,y,b,x,S=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],T=e.style;for(f=parseFloat(e.offsetWidth),v=parseFloat(e.offsetHeight),s=t.split(" "),l=0;l<S.length;l++)this.p.indexOf("border")&&(S[l]=X(S[l])),h=d=J(e,S[l],a,!1,"0px"),-1!==h.indexOf(" ")&&(d=h.split(" "),h=d[0],d=d[1]),u=c=s[l],p=parseFloat(h),w=h.substr((p+"").length),_="="===u.charAt(1),_?(m=parseInt(u.charAt(0)+"1",10),u=u.substr(2),m*=parseFloat(u),g=u.substr((m+"").length-(0>m?1:0))||""):(m=parseFloat(u),g=u.substr((m+"").length)),""===g&&(g=n[i]||w),g!==w&&(y=G(e,"borderLeft",p,w),b=G(e,"borderTop",p,w),"%"===g?(h=y/f*100+"%",d=b/v*100+"%"):"em"===g?(x=G(e,"borderLeft",1,"em"),h=y/x+"em",d=b/x+"em"):(h=y+"px",d=b+"px"),_&&(u=parseFloat(h)+m+g,c=parseFloat(d)+m+g)),r=gt(T,S[l],h+" "+d,u+" "+c,!1,"0px",r);return r},prefix:!0,formatter:ut("0px 0px 0px 0px",!1,!0)}),yt("backgroundPosition",{defaultValue:"0 0",parser:function(e,t,i,n,o,r){var s,l,c,d,h,u,p="background-position",m=a||q(e,null),v=this.format((m?f?m.getPropertyValue(p+"-x")+" "+m.getPropertyValue(p+"-y"):m.getPropertyValue(p):e.currentStyle.backgroundPositionX+" "+e.currentStyle.backgroundPositionY)||"0 0"),g=this.format(t);if(-1!==v.indexOf("%")!=(-1!==g.indexOf("%"))&&(u=J(e,"backgroundImage").replace(P,""),u&&"none"!==u)){for(s=v.split(" "),l=g.split(" "),F.setAttribute("src",u),c=2;--c>-1;)v=s[c],d=-1!==v.indexOf("%"),d!==(-1!==l[c].indexOf("%"))&&(h=0===c?e.offsetWidth-F.width:e.offsetHeight-F.height,s[c]=d?parseFloat(v)/100*h+"px":parseFloat(v)/h*100+"%");v=s.join(" ")}return this.parseComplex(e.style,v,g,o,r)},formatter:nt}),yt("backgroundSize",{defaultValue:"0 0",formatter:nt}),yt("perspective",{defaultValue:"0px",prefix:!0}),yt("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),yt("transformStyle",{prefix:!0}),yt("backfaceVisibility",{prefix:!0}),yt("userSelect",{prefix:!0}),yt("margin",{parser:pt("marginTop,marginRight,marginBottom,marginLeft")}),yt("padding",{parser:pt("paddingTop,paddingRight,paddingBottom,paddingLeft")}),yt("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(e,t,i,n,o,r){var s,l,c;return 9>f?(l=e.currentStyle,c=8>f?" ":",",s="rect("+l.clipTop+c+l.clipRight+c+l.clipBottom+c+l.clipLeft+")",t=this.format(t).split(",").join(c)):(s=this.format(J(e,this.p,a,!1,this.dflt)),t=this.format(t)),this.parseComplex(e.style,s,t,o,r)}}),yt("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),yt("autoRound,strictUnits",{parser:function(e,t,i,n,a){return a}}),yt("border",{defaultValue:"0px solid #000",parser:function(e,t,i,n,o,r){return this.parseComplex(e.style,this.format(J(e,"borderTopWidth",a,!1,"0px")+" "+J(e,"borderTopStyle",a,!1,"solid")+" "+J(e,"borderTopColor",a,!1,"#000")),this.format(t),o,r)},color:!0,formatter:function(e){var t=e.split(" ");return t[0]+" "+(t[1]||"solid")+" "+(e.match(ht)||["#000"])[0]}}),yt("borderWidth",{parser:pt("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),yt("float,cssFloat,styleFloat",{parser:function(e,t,i,n,a){var o=e.style,r="cssFloat"in o?"cssFloat":"styleFloat";return new ft(o,r,0,0,a,-1,i,!1,0,o[r],t)
}});var zt=function(e){var t,i=this.t,n=i.filter||J(this.data,"filter")||"",a=this.s+this.c*e|0;100===a&&(-1===n.indexOf("atrix(")&&-1===n.indexOf("radient(")&&-1===n.indexOf("oader(")?(i.removeAttribute("filter"),t=!J(this.data,"filter")):(i.filter=n.replace(S,""),t=!0)),t||(this.xn1&&(i.filter=n=n||"alpha(opacity="+a+")"),-1===n.indexOf("pacity")?0===a&&this.xn1||(i.filter=n+" alpha(opacity="+a+")"):i.filter=n.replace(b,"opacity="+a))};yt("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(e,t,i,n,o,r){var s=parseFloat(J(e,"opacity",a,!1,"1")),l=e.style,c="autoAlpha"===i;return"string"==typeof t&&"="===t.charAt(1)&&(t=("-"===t.charAt(0)?-1:1)*parseFloat(t.substr(2))+s),c&&1===s&&"hidden"===J(e,"visibility",a)&&0!==t&&(s=0),B?o=new ft(l,"opacity",s,t-s,o):(o=new ft(l,"opacity",100*s,100*(t-s),o),o.xn1=c?1:0,l.zoom=1,o.type=2,o.b="alpha(opacity="+o.s+")",o.e="alpha(opacity="+(o.s+o.c)+")",o.data=e,o.plugin=r,o.setRatio=zt),c&&(o=new ft(l,"visibility",0,0,o,-1,null,!1,0,0!==s?"inherit":"hidden",0===t?"hidden":"inherit"),o.xs0="inherit",n._overwriteProps.push(o.n),n._overwriteProps.push(i)),o}});var Wt=function(e,t){t&&(e.removeProperty?(("ms"===t.substr(0,2)||"webkit"===t.substr(0,6))&&(t="-"+t),e.removeProperty(t.replace(C,"-$1").toLowerCase())):e.removeAttribute(t))},Bt=function(e){if(this.t._gsClassPT=this,1===e||0===e){this.t.setAttribute("class",0===e?this.b:this.e);for(var t=this.data,i=this.t.style;t;)t.v?i[t.p]=t.v:Wt(i,t.p),t=t._next;1===e&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};yt("className",{parser:function(e,t,n,o,r,s,l){var c,d,h,u,p,m=e.getAttribute("class")||"",f=e.style.cssText;if(r=o._classNamePT=new ft(e,n,0,0,r,2),r.setRatio=Bt,r.pr=-11,i=!0,r.b=m,d=Q(e,a),h=e._gsClassPT){for(u={},p=h.data;p;)u[p.p]=1,p=p._next;h.setRatio(1)}return e._gsClassPT=r,r.e="="!==t.charAt(1)?t:m.replace(new RegExp("\\s*\\b"+t.substr(2)+"\\b"),"")+("+"===t.charAt(0)?" "+t.substr(2):""),e.setAttribute("class",r.e),c=Z(e,d,Q(e),l,u),e.setAttribute("class",m),r.data=c.firstMPT,e.style.cssText=f,r=r.xfirst=o.parse(e,c.difs,r,s)}});var Ht=function(e){if((1===e||0===e)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var t,i,n,a,o,r=this.t.style,s=l.transform.parse;if("all"===this.e)r.cssText="",a=!0;else for(t=this.e.split(" ").join("").split(","),n=t.length;--n>-1;)i=t[n],l[i]&&(l[i].parse===s?a=!0:i="transformOrigin"===i?kt:l[i].p),Wt(r,i);a&&(Wt(r,Tt),o=this.t._gsTransform,o&&(o.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(yt("clearProps",{parser:function(e,t,n,a,o){return o=new ft(e,n,0,0,o,2),o.setRatio=Ht,o.e=t,o.pr=-10,o.data=a._tween,i=!0,o}}),c="bezier,throwProps,physicsProps,physics2D".split(","),wt=c.length;wt--;)bt(c[wt]);c=r.prototype,c._firstPT=c._lastParsedTransform=c._transform=null,c._onInitTween=function(e,t,s){if(!e.nodeType)return!1;this._target=e,this._tween=s,this._vars=t,d=t.autoRound,i=!1,n=t.suffixMap||r.suffixMap,a=q(e,""),o=this._overwriteProps;var c,p,f,v,g,w,_,y,b,S=e.style;if(h&&""===S.zIndex&&(c=J(e,"zIndex",a),("auto"===c||""===c)&&this._addLazySet(S,"zIndex",0)),"string"==typeof t&&(v=S.cssText,c=Q(e,a),S.cssText=v+";"+t,c=Z(e,c,Q(e)).difs,!B&&x.test(t)&&(c.opacity=parseFloat(RegExp.$1)),t=c,S.cssText=v),this._firstPT=p=t.className?l.className.parse(e,t.className,"className",this,null,null,t):this.parse(e,t,null),this._transformType){for(b=3===this._transformType,Tt?u&&(h=!0,""===S.zIndex&&(_=J(e,"zIndex",a),("auto"===_||""===_)&&this._addLazySet(S,"zIndex",0)),m&&this._addLazySet(S,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(b?"visible":"hidden"))):S.zoom=1,f=p;f&&f._next;)f=f._next;y=new ft(e,"transform",0,0,null,2),this._linkCSSP(y,null,f),y.setRatio=Tt?Ft:Lt,y.data=this._transform||jt(e,a,!0),y.tween=s,y.pr=-1,o.pop()}if(i){for(;p;){for(w=p._next,f=v;f&&f.pr>p.pr;)f=f._next;(p._prev=f?f._prev:g)?p._prev._next=p:v=p,(p._next=f)?f._prev=p:g=p,p=w}this._firstPT=v}return!0},c.parse=function(e,t,i,o){var r,s,c,h,u,p,m,f,v,g,w=e.style;for(r in t)p=t[r],s=l[r],s?i=s.parse(e,p,r,this,i,o,t):(u=J(e,r,a)+"",v="string"==typeof p,"color"===r||"fill"===r||"stroke"===r||-1!==r.indexOf("Color")||v&&T.test(p)?(v||(p=ct(p),p=(p.length>3?"rgba(":"rgb(")+p.join(",")+")"),i=gt(w,r,u,p,!0,"transparent",i,0,o)):!v||-1===p.indexOf(" ")&&-1===p.indexOf(",")?(c=parseFloat(u),m=c||0===c?u.substr((c+"").length):"",(""===u||"auto"===u)&&("width"===r||"height"===r?(c=it(e,r,a),m="px"):"left"===r||"top"===r?(c=K(e,r,a),m="px"):(c="opacity"!==r?0:1,m="")),g=v&&"="===p.charAt(1),g?(h=parseInt(p.charAt(0)+"1",10),p=p.substr(2),h*=parseFloat(p),f=p.replace(y,"")):(h=parseFloat(p),f=v?p.replace(y,""):""),""===f&&(f=r in n?n[r]:m),p=h||0===h?(g?h+c:h)+f:t[r],m!==f&&""!==f&&(h||0===h)&&c&&(c=G(e,r,c,m),"%"===f?(c/=G(e,r,100,"%")/100,t.strictUnits!==!0&&(u=c+"%")):"em"===f||"rem"===f||"vw"===f||"vh"===f?c/=G(e,r,1,f):"px"!==f&&(h=G(e,r,h,f),f="px"),g&&(h||0===h)&&(p=h+c+f)),g&&(h+=c),!c&&0!==c||!h&&0!==h?void 0!==w[r]&&(p||p+""!="NaN"&&null!=p)?(i=new ft(w,r,h||c||0,0,i,-1,r,!1,0,u,p),i.xs0="none"!==p||"display"!==r&&-1===r.indexOf("Style")?p:u):U("invalid "+r+" tween value: "+t[r]):(i=new ft(w,r,c,h-c,i,0,r,d!==!1&&("px"===f||"zIndex"===r),0,u,p),i.xs0=f)):i=gt(w,r,u,p,!0,null,i,0,o)),o&&i&&!i.plugin&&(i.plugin=o);return i},c.setRatio=function(e){var t,i,n,a=this._firstPT,o=1e-6;if(1!==e||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(e||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;a;){if(t=a.c*e+a.s,a.r?t=Math.round(t):o>t&&t>-o&&(t=0),a.type)if(1===a.type)if(n=a.l,2===n)a.t[a.p]=a.xs0+t+a.xs1+a.xn1+a.xs2;else if(3===n)a.t[a.p]=a.xs0+t+a.xs1+a.xn1+a.xs2+a.xn2+a.xs3;else if(4===n)a.t[a.p]=a.xs0+t+a.xs1+a.xn1+a.xs2+a.xn2+a.xs3+a.xn3+a.xs4;else if(5===n)a.t[a.p]=a.xs0+t+a.xs1+a.xn1+a.xs2+a.xn2+a.xs3+a.xn3+a.xs4+a.xn4+a.xs5;else{for(i=a.xs0+t+a.xs1,n=1;n<a.l;n++)i+=a["xn"+n]+a["xs"+(n+1)];a.t[a.p]=i}else-1===a.type?a.t[a.p]=a.xs0:a.setRatio&&a.setRatio(e);else a.t[a.p]=t+a.xs0;a=a._next}else for(;a;)2!==a.type?a.t[a.p]=a.b:a.setRatio(e),a=a._next;else for(;a;){if(2!==a.type)if(a.r&&-1!==a.type)if(t=Math.round(a.s+a.c),a.type){if(1===a.type){for(n=a.l,i=a.xs0+t+a.xs1,n=1;n<a.l;n++)i+=a["xn"+n]+a["xs"+(n+1)];a.t[a.p]=i}}else a.t[a.p]=t+a.xs0;else a.t[a.p]=a.e;else a.setRatio(e);a=a._next}},c._enableTransforms=function(e){this._transform=this._transform||jt(this._target,a,!0),this._transformType=this._transform.svg&&xt||!e&&3!==this._transformType?2:3};var Ut=function(){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};c._addLazySet=function(e,t,i){var n=this._firstPT=new ft(e,t,0,0,this._firstPT,2);n.e=i,n.setRatio=Ut,n.data=this},c._linkCSSP=function(e,t,i,n){return e&&(t&&(t._prev=e),e._next&&(e._next._prev=e._prev),e._prev?e._prev._next=e._next:this._firstPT===e&&(this._firstPT=e._next,n=!0),i?i._next=e:n||null!==this._firstPT||(this._firstPT=e),e._next=t,e._prev=i),e},c._kill=function(t){var i,n,a,o=t;if(t.autoAlpha||t.alpha){o={};for(n in t)o[n]=t[n];o.opacity=1,o.autoAlpha&&(o.visibility=1)}return t.className&&(i=this._classNamePT)&&(a=i.xfirst,a&&a._prev?this._linkCSSP(a._prev,i._next,a._prev._prev):a===this._firstPT&&(this._firstPT=i._next),i._next&&this._linkCSSP(i._next,i._next._next,a._prev),this._classNamePT=null),e.prototype._kill.call(this,o)};var Vt=function(e,t,i){var n,a,o,r;if(e.slice)for(a=e.length;--a>-1;)Vt(e[a],t,i);else for(n=e.childNodes,a=n.length;--a>-1;)o=n[a],r=o.type,o.style&&(t.push(Q(o)),i&&i.push(o)),1!==r&&9!==r&&11!==r||!o.childNodes.length||Vt(o,t,i)};return r.cascadeTo=function(e,i,n){var a,o,r,s,l=t.to(e,i,n),c=[l],d=[],h=[],u=[],p=t._internals.reservedProps;for(e=l._targets||l.target,Vt(e,d,u),l.render(i,!0,!0),Vt(e,h),l.render(0,!0,!0),l._enabled(!0),a=u.length;--a>-1;)if(o=Z(u[a],d[a],h[a]),o.firstMPT){o=o.difs;for(r in n)p[r]&&(o[r]=n[r]);s={};for(r in o)s[r]=d[a][r];c.push(t.fromTo(u[a],i,s,o))}return c},e.activate([r]),r},!0),function(){var e=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.5",priority:-1,API:2,init:function(e,t,i){return this._tween=i,!0}}),t=function(e){for(;e;)e.f||e.blob||(e.r=1),e=e._next},i=e.prototype;i._onInitAllProps=function(){for(var e,i,n,a=this._tween,o=a.vars.roundProps.join?a.vars.roundProps:a.vars.roundProps.split(","),r=o.length,s={},l=a._propLookup.roundProps;--r>-1;)s[o[r]]=1;for(r=o.length;--r>-1;)for(e=o[r],i=a._firstPT;i;)n=i._next,i.pg?i.t._roundProps(s,!0):i.n===e&&(2===i.f&&i.t?t(i.t._firstPT):(this._add(i.t,e,i.s,i.c),n&&(n._prev=i._prev),i._prev?i._prev._next=n:a._firstPT===i&&(a._firstPT=n),i._next=i._prev=null,a._propLookup[e]=l)),i=n;return!1},i._add=function(e,t,i,n){this._addTween(e,t,i,i+n,t,!0),this._overwriteProps.push(t)}}(),function(){_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.5.0",init:function(e,t){var i;if("function"!=typeof e.setAttribute)return!1;for(i in t)this._addTween(e,"setAttribute",e.getAttribute(i)+"",t[i]+"",i,!1,i),this._overwriteProps.push(i);return!0}})}(),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.2.1",API:2,init:function(e,t){"object"!=typeof t&&(t={rotation:t}),this.finals={};var i,n,a,o,r,s,l=t.useRadians===!0?2*Math.PI:360,c=1e-6;for(i in t)"useRadians"!==i&&(s=(t[i]+"").split("_"),n=s[0],a=parseFloat("function"!=typeof e[i]?e[i]:e[i.indexOf("set")||"function"!=typeof e["get"+i.substr(3)]?i:"get"+i.substr(3)]()),o=this.finals[i]="string"==typeof n&&"="===n.charAt(1)?a+parseInt(n.charAt(0)+"1",10)*Number(n.substr(2)):Number(n)||0,r=o-a,s.length&&(n=s.join("_"),-1!==n.indexOf("short")&&(r%=l,r!==r%(l/2)&&(r=0>r?r+l:r-l)),-1!==n.indexOf("_cw")&&0>r?r=(r+9999999999*l)%l-(r/l|0)*l:-1!==n.indexOf("ccw")&&r>0&&(r=(r-9999999999*l)%l-(r/l|0)*l)),(r>c||-c>r)&&(this._addTween(e,i,a,a+r,i),this._overwriteProps.push(i)));return!0},set:function(e){var t;if(1!==e)this._super.setRatio.call(this,e);else for(t=this._firstPT;t;)t.f?t.t[t.p](this.finals[t.p]):t.t[t.p]=this.finals[t.p],t=t._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(e){var t,i,n,a=_gsScope.GreenSockGlobals||_gsScope,o=a.com.greensock,r=2*Math.PI,s=Math.PI/2,l=o._class,c=function(t,i){var n=l("easing."+t,function(){},!0),a=n.prototype=new e;return a.constructor=n,a.getRatio=i,n},d=e.register||function(){},h=function(e,t,i,n){var a=l("easing."+e,{easeOut:new t,easeIn:new i,easeInOut:new n},!0);return d(a,e),a},u=function(e,t,i){this.t=e,this.v=t,i&&(this.next=i,i.prev=this,this.c=i.v-t,this.gap=i.t-e)},p=function(t,i){var n=l("easing."+t,function(e){this._p1=e||0===e?e:1.70158,this._p2=1.525*this._p1},!0),a=n.prototype=new e;return a.constructor=n,a.getRatio=i,a.config=function(e){return new n(e)},n},m=h("Back",p("BackOut",function(e){return(e-=1)*e*((this._p1+1)*e+this._p1)+1}),p("BackIn",function(e){return e*e*((this._p1+1)*e-this._p1)}),p("BackInOut",function(e){return(e*=2)<1?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)})),f=l("easing.SlowMo",function(e,t,i){t=t||0===t?t:.7,null==e?e=.7:e>1&&(e=1),this._p=1!==e?t:0,this._p1=(1-e)/2,this._p2=e,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),v=f.prototype=new e;return v.constructor=f,v.getRatio=function(e){var t=e+(.5-e)*this._p;return e<this._p1?this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t:e>this._p3?this._calcEnd?1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e:this._calcEnd?1:t},f.ease=new f(.7,.7),v.config=f.config=function(e,t,i){return new f(e,t,i)},t=l("easing.SteppedEase",function(e){e=e||1,this._p1=1/e,this._p2=e+1},!0),v=t.prototype=new e,v.constructor=t,v.getRatio=function(e){return 0>e?e=0:e>=1&&(e=.999999999),(this._p2*e>>0)*this._p1},v.config=t.config=function(e){return new t(e)},i=l("easing.RoughEase",function(t){t=t||{};for(var i,n,a,o,r,s,l=t.taper||"none",c=[],d=0,h=0|(t.points||20),p=h,m=t.randomize!==!1,f=t.clamp===!0,v=t.template instanceof e?t.template:null,g="number"==typeof t.strength?.4*t.strength:.4;--p>-1;)i=m?Math.random():1/h*p,n=v?v.getRatio(i):i,"none"===l?a=g:"out"===l?(o=1-i,a=o*o*g):"in"===l?a=i*i*g:.5>i?(o=2*i,a=o*o*.5*g):(o=2*(1-i),a=o*o*.5*g),m?n+=Math.random()*a-.5*a:p%2?n+=.5*a:n-=.5*a,f&&(n>1?n=1:0>n&&(n=0)),c[d++]={x:i,y:n};for(c.sort(function(e,t){return e.x-t.x}),s=new u(1,1,null),p=h;--p>-1;)r=c[p],s=new u(r.x,r.y,s);this._prev=new u(0,0,0!==s.t?s:s.next)},!0),v=i.prototype=new e,v.constructor=i,v.getRatio=function(e){var t=this._prev;if(e>t.t){for(;t.next&&e>=t.t;)t=t.next;t=t.prev}else for(;t.prev&&e<=t.t;)t=t.prev;return this._prev=t,t.v+(e-t.t)/t.gap*t.c},v.config=function(e){return new i(e)},i.ease=new i,h("Bounce",c("BounceOut",function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}),c("BounceIn",function(e){return(e=1-e)<1/2.75?1-7.5625*e*e:2/2.75>e?1-(7.5625*(e-=1.5/2.75)*e+.75):2.5/2.75>e?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}),c("BounceInOut",function(e){var t=.5>e;return e=t?1-2*e:2*e-1,e=1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5})),h("Circ",c("CircOut",function(e){return Math.sqrt(1-(e-=1)*e)}),c("CircIn",function(e){return-(Math.sqrt(1-e*e)-1)}),c("CircInOut",function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)})),n=function(t,i,n){var a=l("easing."+t,function(e,t){this._p1=e>=1?e:1,this._p2=(t||n)/(1>e?e:1),this._p3=this._p2/r*(Math.asin(1/this._p1)||0),this._p2=r/this._p2},!0),o=a.prototype=new e;return o.constructor=a,o.getRatio=i,o.config=function(e,t){return new a(e,t)},a},h("Elastic",n("ElasticOut",function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*this._p2)+1},.3),n("ElasticIn",function(e){return-(this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2))},.3),n("ElasticInOut",function(e){return(e*=2)<1?-.5*this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2):this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*this._p2)*.5+1},.45)),h("Expo",c("ExpoOut",function(e){return 1-Math.pow(2,-10*e)}),c("ExpoIn",function(e){return Math.pow(2,10*(e-1))-.001}),c("ExpoInOut",function(e){return(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))})),h("Sine",c("SineOut",function(e){return Math.sin(e*s)}),c("SineIn",function(e){return-Math.cos(e*s)+1}),c("SineInOut",function(e){return-.5*(Math.cos(Math.PI*e)-1)})),l("easing.EaseLookup",{find:function(t){return e.map[t]}},!0),d(a.SlowMo,"SlowMo","ease,"),d(i,"RoughEase","ease,"),d(t,"SteppedEase","ease,"),m},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(e,t){var i=e.GreenSockGlobals=e.GreenSockGlobals||e;if(!i.TweenLite){var n,a,o,r,s,l=function(e){var t,n=e.split("."),a=i;for(t=0;t<n.length;t++)a[n[t]]=a=a[n[t]]||{};return a},c=l("com.greensock"),d=1e-10,h=function(e){var t,i=[],n=e.length;for(t=0;t!==n;i.push(e[t++]));return i},u=function(){},p=function(){var e=Object.prototype.toString,t=e.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&e.call(i)===t)}}(),m={},f=function(n,a,o,r){this.sc=m[n]?m[n].sc:[],m[n]=this,this.gsClass=null,this.func=o;var s=[];this.check=function(c){for(var d,h,u,p,v,g=a.length,w=g;--g>-1;)(d=m[a[g]]||new f(a[g],[])).gsClass?(s[g]=d.gsClass,w--):c&&d.sc.push(this);if(0===w&&o)for(h=("com.greensock."+n).split("."),u=h.pop(),p=l(h.join("."))[u]=this.gsClass=o.apply(o,s),r&&(i[u]=p,v="undefined"!=typeof module&&module.exports,!v&&"function"==typeof define&&define.amd?define((e.GreenSockAMDPath?e.GreenSockAMDPath+"/":"")+n.split(".").pop(),[],function(){return p}):n===t&&v&&(module.exports=p)),g=0;g<this.sc.length;g++)this.sc[g].check()},this.check(!0)},v=e._gsDefine=function(e,t,i,n){return new f(e,t,i,n)},g=c._class=function(e,t,i){return t=t||function(){},v(e,[],function(){return t},i),t};v.globals=i;var w=[0,0,1,1],_=[],y=g("easing.Ease",function(e,t,i,n){this._func=e,this._type=i||0,this._power=n||0,this._params=t?w.concat(t):w},!0),b=y.map={},x=y.register=function(e,t,i,n){for(var a,o,r,s,l=t.split(","),d=l.length,h=(i||"easeIn,easeOut,easeInOut").split(",");--d>-1;)for(o=l[d],a=n?g("easing."+o,null,!0):c.easing[o]||{},r=h.length;--r>-1;)s=h[r],b[o+"."+s]=b[s+o]=a[s]=e.getRatio?e:e[s]||new e};for(o=y.prototype,o._calcEnd=!1,o.getRatio=function(e){if(this._func)return this._params[0]=e,this._func.apply(null,this._params);var t=this._type,i=this._power,n=1===t?1-e:2===t?e:.5>e?2*e:2*(1-e);return 1===i?n*=n:2===i?n*=n*n:3===i?n*=n*n*n:4===i&&(n*=n*n*n*n),1===t?1-n:2===t?n:.5>e?n/2:1-n/2},n=["Linear","Quad","Cubic","Quart","Quint,Strong"],a=n.length;--a>-1;)o=n[a]+",Power"+a,x(new y(null,null,1,a),o,"easeOut",!0),x(new y(null,null,2,a),o,"easeIn"+(0===a?",easeNone":"")),x(new y(null,null,3,a),o,"easeInOut");b.linear=c.easing.Linear.easeIn,b.swing=c.easing.Quad.easeInOut;var S=g("events.EventDispatcher",function(e){this._listeners={},this._eventTarget=e||this});o=S.prototype,o.addEventListener=function(e,t,i,n,a){a=a||0;var o,l,c=this._listeners[e],d=0;for(null==c&&(this._listeners[e]=c=[]),l=c.length;--l>-1;)o=c[l],o.c===t&&o.s===i?c.splice(l,1):0===d&&o.pr<a&&(d=l+1);c.splice(d,0,{c:t,s:i,up:n,pr:a}),this!==r||s||r.wake()},o.removeEventListener=function(e,t){var i,n=this._listeners[e];if(n)for(i=n.length;--i>-1;)if(n[i].c===t)return void n.splice(i,1)},o.dispatchEvent=function(e){var t,i,n,a=this._listeners[e];if(a)for(t=a.length,i=this._eventTarget;--t>-1;)n=a[t],n&&(n.up?n.c.call(n.s||i,{type:e,target:i}):n.c.call(n.s||i))};var T=e.requestAnimationFrame,C=e.cancelAnimationFrame,k=Date.now||function(){return(new Date).getTime()},P=k();for(n=["ms","moz","webkit","o"],a=n.length;--a>-1&&!T;)T=e[n[a]+"RequestAnimationFrame"],C=e[n[a]+"CancelAnimationFrame"]||e[n[a]+"CancelRequestAnimationFrame"];g("Ticker",function(e,t){var i,n,a,o,l,c=this,h=k(),p=t!==!1&&T?"auto":!1,m=500,f=33,v="tick",g=function(e){var t,r,s=k()-P;s>m&&(h+=s-f),P+=s,c.time=(P-h)/1e3,t=c.time-l,(!i||t>0||e===!0)&&(c.frame++,l+=t+(t>=o?.004:o-t),r=!0),e!==!0&&(a=n(g)),r&&c.dispatchEvent(v)};S.call(c),c.time=c.frame=0,c.tick=function(){g(!0)},c.lagSmoothing=function(e,t){m=e||1/d,f=Math.min(t,m,0)},c.sleep=function(){null!=a&&(p&&C?C(a):clearTimeout(a),n=u,a=null,c===r&&(s=!1))},c.wake=function(e){null!==a?c.sleep():e?h+=-P+(P=k()):c.frame>10&&(P=k()-m+5),n=0===i?u:p&&T?T:function(e){return setTimeout(e,1e3*(l-c.time)+1|0)},c===r&&(s=!0),g(2)},c.fps=function(e){return arguments.length?(i=e,o=1/(i||60),l=this.time+o,void c.wake()):i},c.useRAF=function(e){return arguments.length?(c.sleep(),p=e,void c.fps(i)):p},c.fps(e),setTimeout(function(){"auto"===p&&c.frame<5&&"hidden"!==document.visibilityState&&c.useRAF(!1)},1500)}),o=c.Ticker.prototype=new c.events.EventDispatcher,o.constructor=c.Ticker;var E=g("core.Animation",function(e,t){if(this.vars=t=t||{},this._duration=this._totalDuration=e||0,this._delay=Number(t.delay)||0,this._timeScale=1,this._active=t.immediateRender===!0,this.data=t.data,this._reversed=t.reversed===!0,X){s||r.wake();var i=this.vars.useFrames?Y:X;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});r=E.ticker=new c.Ticker,o=E.prototype,o._dirty=o._gc=o._initted=o._paused=!1,o._totalTime=o._time=0,o._rawPrevTime=-1,o._next=o._last=o._onUpdate=o._timeline=o.timeline=null,o._paused=!1;var D=function(){s&&k()-P>2e3&&r.wake(),setTimeout(D,2e3)};D(),o.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},o.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},o.resume=function(e,t){return null!=e&&this.seek(e,t),this.paused(!1)},o.seek=function(e,t){return this.totalTime(Number(e),t!==!1)},o.restart=function(e,t){return this.reversed(!1).paused(!1).totalTime(e?-this._delay:0,t!==!1,!0)},o.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},o.render=function(){},o.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},o.isActive=function(){var e,t=this._timeline,i=this._startTime;return!t||!this._gc&&!this._paused&&t.isActive()&&(e=t.rawTime())>=i&&e<i+this.totalDuration()/this._timeScale},o._enabled=function(e,t){return s||r.wake(),this._gc=!e,this._active=this.isActive(),t!==!0&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},o._kill=function(){return this._enabled(!1,!1)},o.kill=function(e,t){return this._kill(e,t),this},o._uncache=function(e){for(var t=e?this:this.timeline;t;)t._dirty=!0,t=t.timeline;return this},o._swapSelfInParams=function(e){for(var t=e.length,i=e.concat();--t>-1;)"{self}"===e[t]&&(i[t]=this);return i},o._callback=function(e){var t=this.vars;t[e].apply(t[e+"Scope"]||t.callbackScope||this,t[e+"Params"]||_)},o.eventCallback=function(e,t,i,n){if("on"===(e||"").substr(0,2)){var a=this.vars;if(1===arguments.length)return a[e];null==t?delete a[e]:(a[e]=t,a[e+"Params"]=p(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,a[e+"Scope"]=n),"onUpdate"===e&&(this._onUpdate=t)}return this},o.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},o.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==e&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},o.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},o.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(e>this._duration?this._duration:e,t)):this._time},o.totalTime=function(e,t,i){if(s||r.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>e&&!i&&(e+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var n=this._totalDuration,a=this._timeline;if(e>n&&!i&&(e=n),this._startTime=(this._paused?this._pauseTime:a._time)-(this._reversed?n-e:e)/this._timeScale,a._dirty||this._uncache(!1),a._timeline)for(;a._timeline;)a._timeline._time!==(a._startTime+a._totalTime)/a._timeScale&&a.totalTime(a._totalTime,!0),a=a._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==e||0===this._duration)&&(N.length&&J(),this.render(e,t,!1),N.length&&J())}return this},o.progress=o.totalProgress=function(e,t){var i=this.duration();return arguments.length?this.totalTime(i*e,t):i?this._time/i:this.ratio},o.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},o.endTime=function(e){return this._startTime+(0!=e?this.totalDuration():this.duration())/this._timeScale},o.timeScale=function(e){if(!arguments.length)return this._timeScale;if(e=e||d,this._timeline&&this._timeline.smoothChildTiming){var t=this._pauseTime,i=t||0===t?t:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/e}return this._timeScale=e,this._uncache(!1)},o.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},o.paused=function(e){if(!arguments.length)return this._paused;var t,i,n=this._timeline;return e!=this._paused&&n&&(s||e||r.wake(),t=n.rawTime(),i=t-this._pauseTime,!e&&n.smoothChildTiming&&(this._startTime+=i,this._uncache(!1)),this._pauseTime=e?t:null,this._paused=e,this._active=this.isActive(),!e&&0!==i&&this._initted&&this.duration()&&(t=n.smoothChildTiming?this._totalTime:(t-this._startTime)/this._timeScale,this.render(t,t===this._totalTime,!0))),this._gc&&!e&&this._enabled(!0,!1),this};var A=g("core.SimpleTimeline",function(e){E.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0});o=A.prototype=new E,o.constructor=A,o.kill()._gc=!1,o._first=o._last=o._recent=null,o._sortChildren=!1,o.add=o.insert=function(e,t){var i,n;if(e._startTime=Number(t||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),i=this._last,this._sortChildren)for(n=e._startTime;i&&i._startTime>n;)i=i._prev;return i?(e._next=i._next,i._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=i,this._recent=e,this._timeline&&this._uncache(!0),this},o._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),e._next=e._prev=e.timeline=null,e===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},o.render=function(e,t,i){var n,a=this._first;for(this._totalTime=this._time=this._rawPrevTime=e;a;)n=a._next,(a._active||e>=a._startTime&&!a._paused)&&(a._reversed?a.render((a._dirty?a.totalDuration():a._totalDuration)-(e-a._startTime)*a._timeScale,t,i):a.render((e-a._startTime)*a._timeScale,t,i)),a=n},o.rawTime=function(){return s||r.wake(),this._totalTime};var $=g("TweenLite",function(t,i,n){if(E.call(this,i,n),this.render=$.prototype.render,null==t)throw"Cannot tween a null target.";this.target=t="string"!=typeof t?t:$.selector(t)||t;var a,o,r,s=t.jquery||t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType),l=this.vars.overwrite;if(this._overwrite=l=null==l?V[$.defaultOverwrite]:"number"==typeof l?l>>0:V[l],(s||t instanceof Array||t.push&&p(t))&&"number"!=typeof t[0])for(this._targets=r=h(t),this._propLookup=[],this._siblings=[],a=0;a<r.length;a++)o=r[a],o?"string"!=typeof o?o.length&&o!==e&&o[0]&&(o[0]===e||o[0].nodeType&&o[0].style&&!o.nodeType)?(r.splice(a--,1),this._targets=r=r.concat(h(o))):(this._siblings[a]=G(o,this,!1),1===l&&this._siblings[a].length>1&&Q(o,this,null,1,this._siblings[a])):(o=r[a--]=$.selector(o),"string"==typeof o&&r.splice(a+1,1)):r.splice(a--,1);else this._propLookup={},this._siblings=G(t,this,!1),1===l&&this._siblings.length>1&&Q(t,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-d,this.render(-this._delay))},!0),I=function(t){return t&&t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType)},O=function(e,t){var i,n={};for(i in e)U[i]||i in t&&"transform"!==i&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!W[i]||W[i]&&W[i]._autoCSS)||(n[i]=e[i],delete e[i]);e.css=n};o=$.prototype=new E,o.constructor=$,o.kill()._gc=!1,o.ratio=0,o._firstPT=o._targets=o._overwrittenProps=o._startAt=null,o._notifyPluginsOfEnabled=o._lazy=!1,$.version="1.18.2",$.defaultEase=o._ease=new y(null,null,1,1),$.defaultOverwrite="auto",$.ticker=r,$.autoSleep=120,$.lagSmoothing=function(e,t){r.lagSmoothing(e,t)},$.selector=e.$||e.jQuery||function(t){var i=e.$||e.jQuery;return i?($.selector=i,i(t)):"undefined"==typeof document?t:document.querySelectorAll?document.querySelectorAll(t):document.getElementById("#"===t.charAt(0)?t.substr(1):t)};var N=[],R={},M=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,j=function(e){for(var t,i=this._firstPT,n=1e-6;i;)t=i.blob?e?this.join(""):this.start:i.c*e+i.s,i.r?t=Math.round(t):n>t&&t>-n&&(t=0),i.f?i.fp?i.t[i.p](i.fp,t):i.t[i.p](t):i.t[i.p]=t,i=i._next},L=function(e,t,i,n){var a,o,r,s,l,c,d,h=[e,t],u=0,p="",m=0;for(h.start=e,i&&(i(h),e=h[0],t=h[1]),h.length=0,a=e.match(M)||[],o=t.match(M)||[],n&&(n._next=null,n.blob=1,h._firstPT=n),l=o.length,s=0;l>s;s++)d=o[s],c=t.substr(u,t.indexOf(d,u)-u),p+=c||!s?c:",",u+=c.length,m?m=(m+1)%5:"rgba("===c.substr(-5)&&(m=1),d===a[s]||a.length<=s?p+=d:(p&&(h.push(p),p=""),r=parseFloat(a[s]),h.push(r),h._firstPT={_next:h._firstPT,t:h,p:h.length-1,s:r,c:("="===d.charAt(1)?parseInt(d.charAt(0)+"1",10)*parseFloat(d.substr(2)):parseFloat(d)-r)||0,f:0,r:m&&4>m}),u+=d.length;return p+=t.substr(u),p&&h.push(p),h.setRatio=j,h},F=function(e,t,i,n,a,o,r,s){var l,c,d="get"===i?e[t]:i,h=typeof e[t],u="string"==typeof n&&"="===n.charAt(1),p={t:e,p:t,s:d,f:"function"===h,pg:0,n:a||t,r:o,pr:0,c:u?parseInt(n.charAt(0)+"1",10)*parseFloat(n.substr(2)):parseFloat(n)-d||0};return"number"!==h&&("function"===h&&"get"===i&&(c=t.indexOf("set")||"function"!=typeof e["get"+t.substr(3)]?t:"get"+t.substr(3),p.s=d=r?e[c](r):e[c]()),"string"==typeof d&&(r||isNaN(d))?(p.fp=r,l=L(d,n,s||$.defaultStringFilter,p),p={t:l,p:"setRatio",s:0,c:1,f:2,pg:0,n:a||t,pr:0}):u||(p.s=parseFloat(d),p.c=parseFloat(n)-p.s||0)),p.c?((p._next=this._firstPT)&&(p._next._prev=p),this._firstPT=p,p):void 0},z=$._internals={isArray:p,isSelector:I,lazyTweens:N,blobDif:L},W=$._plugins={},B=z.tweenLookup={},H=0,U=z.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1},V={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},Y=E._rootFramesTimeline=new A,X=E._rootTimeline=new A,q=30,J=z.lazyRender=function(){var e,t=N.length;for(R={};--t>-1;)e=N[t],e&&e._lazy!==!1&&(e.render(e._lazy[0],e._lazy[1],!0),e._lazy=!1);N.length=0};X._startTime=r.time,Y._startTime=r.frame,X._active=Y._active=!0,setTimeout(J,1),E._updateRoot=$.render=function(){var e,t,i;if(N.length&&J(),X.render((r.time-X._startTime)*X._timeScale,!1,!1),Y.render((r.frame-Y._startTime)*Y._timeScale,!1,!1),N.length&&J(),r.frame>=q){q=r.frame+(parseInt($.autoSleep,10)||120);for(i in B){for(t=B[i].tweens,e=t.length;--e>-1;)t[e]._gc&&t.splice(e,1);0===t.length&&delete B[i]}if(i=X._first,(!i||i._paused)&&$.autoSleep&&!Y._first&&1===r._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||r.sleep()}}},r.addEventListener("tick",E._updateRoot);var G=function(e,t,i){var n,a,o=e._gsTweenID;if(B[o||(e._gsTweenID=o="t"+H++)]||(B[o]={target:e,tweens:[]}),t&&(n=B[o].tweens,n[a=n.length]=t,i))for(;--a>-1;)n[a]===t&&n.splice(a,1);return B[o].tweens},K=function(e,t,i,n){var a,o,r=e.vars.onOverwrite;return r&&(a=r(e,t,i,n)),r=$.onOverwrite,r&&(o=r(e,t,i,n)),a!==!1&&o!==!1},Q=function(e,t,i,n,a){var o,r,s,l;if(1===n||n>=4){for(l=a.length,o=0;l>o;o++)if((s=a[o])!==t)s._gc||s._kill(null,e,t)&&(r=!0);else if(5===n)break;return r}var c,h=t._startTime+d,u=[],p=0,m=0===t._duration;for(o=a.length;--o>-1;)(s=a[o])===t||s._gc||s._paused||(s._timeline!==t._timeline?(c=c||Z(t,0,m),0===Z(s,c,m)&&(u[p++]=s)):s._startTime<=h&&s._startTime+s.totalDuration()/s._timeScale>h&&((m||!s._initted)&&h-s._startTime<=2e-10||(u[p++]=s)));for(o=p;--o>-1;)if(s=u[o],2===n&&s._kill(i,e,t)&&(r=!0),2!==n||!s._firstPT&&s._initted){if(2!==n&&!K(s,t))continue;s._enabled(!1,!1)&&(r=!0)}return r},Z=function(e,t,i){for(var n=e._timeline,a=n._timeScale,o=e._startTime;n._timeline;){if(o+=n._startTime,a*=n._timeScale,n._paused)return-100;n=n._timeline}return o/=a,o>t?o-t:i&&o===t||!e._initted&&2*d>o-t?d:(o+=e.totalDuration()/e._timeScale/a)>t+d?0:o-t-d};o._init=function(){var e,t,i,n,a,o=this.vars,r=this._overwrittenProps,s=this._duration,l=!!o.immediateRender,c=o.ease;if(o.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),a={};for(n in o.startAt)a[n]=o.startAt[n];if(a.overwrite=!1,a.immediateRender=!0,a.lazy=l&&o.lazy!==!1,a.startAt=a.delay=null,this._startAt=$.to(this.target,0,a),l)if(this._time>0)this._startAt=null;
else if(0!==s)return}else if(o.runBackwards&&0!==s)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(l=!1),i={};for(n in o)U[n]&&"autoCSS"!==n||(i[n]=o[n]);if(i.overwrite=0,i.data="isFromStart",i.lazy=l&&o.lazy!==!1,i.immediateRender=l,this._startAt=$.to(this.target,0,i),l){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=c=c?c instanceof y?c:"function"==typeof c?new y(c,o.easeParams):b[c]||$.defaultEase:$.defaultEase,o.easeParams instanceof Array&&c.config&&(this._ease=c.config.apply(c,o.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(e=this._targets.length;--e>-1;)this._initProps(this._targets[e],this._propLookup[e]={},this._siblings[e],r?r[e]:null)&&(t=!0);else t=this._initProps(this.target,this._propLookup,this._siblings,r);if(t&&$._onPluginEvent("_onInitAllProps",this),r&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),o.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=o.onUpdate,this._initted=!0},o._initProps=function(t,i,n,a){var o,r,s,l,c,d;if(null==t)return!1;R[t._gsTweenID]&&J(),this.vars.css||t.style&&t!==e&&t.nodeType&&W.css&&this.vars.autoCSS!==!1&&O(this.vars,t);for(o in this.vars)if(d=this.vars[o],U[o])d&&(d instanceof Array||d.push&&p(d))&&-1!==d.join("").indexOf("{self}")&&(this.vars[o]=d=this._swapSelfInParams(d,this));else if(W[o]&&(l=new W[o])._onInitTween(t,this.vars[o],this)){for(this._firstPT=c={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:1,n:o,pg:1,pr:l._priority},r=l._overwriteProps.length;--r>-1;)i[l._overwriteProps[r]]=this._firstPT;(l._priority||l._onInitAllProps)&&(s=!0),(l._onDisable||l._onEnable)&&(this._notifyPluginsOfEnabled=!0),c._next&&(c._next._prev=c)}else i[o]=F.call(this,t,o,"get",d,o,0,null,this.vars.stringFilter);return a&&this._kill(a,t)?this._initProps(t,i,n,a):this._overwrite>1&&this._firstPT&&n.length>1&&Q(t,this,i,this._overwrite,n)?(this._kill(i,t),this._initProps(t,i,n,a)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(R[t._gsTweenID]=!0),s)},o.render=function(e,t,i){var n,a,o,r,s=this._time,l=this._duration,c=this._rawPrevTime;if(e>=l-1e-7)this._totalTime=this._time=l,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(n=!0,a="onComplete",i=i||this._timeline.autoRemoveChildren),0===l&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(e=0),(0>c||0>=e&&e>=-1e-7||c===d&&"isPause"!==this.data)&&c!==e&&(i=!0,c>d&&(a="onReverseComplete")),this._rawPrevTime=r=!t||e||c===e?e:d);else if(1e-7>e)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==s||0===l&&c>0)&&(a="onReverseComplete",n=this._reversed),0>e&&(this._active=!1,0===l&&(this._initted||!this.vars.lazy||i)&&(c>=0&&(c!==d||"isPause"!==this.data)&&(i=!0),this._rawPrevTime=r=!t||e||c===e?e:d)),this._initted||(i=!0);else if(this._totalTime=this._time=e,this._easeType){var h=e/l,u=this._easeType,p=this._easePower;(1===u||3===u&&h>=.5)&&(h=1-h),3===u&&(h*=2),1===p?h*=h:2===p?h*=h*h:3===p?h*=h*h*h:4===p&&(h*=h*h*h*h),this.ratio=1===u?1-h:2===u?h:.5>e/l?h/2:1-h/2}else this.ratio=this._ease.getRatio(e/l);if(this._time!==s||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=s,this._rawPrevTime=c,N.push(this),void(this._lazy=[e,t]);this._time&&!n?this.ratio=this._ease.getRatio(this._time/l):n&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==s&&e>=0&&(this._active=!0),0===s&&(this._startAt&&(e>=0?this._startAt.render(e,t,i):a||(a="_dummyGS")),this.vars.onStart&&(0!==this._time||0===l)&&(t||this._callback("onStart"))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(0>e&&this._startAt&&e!==-1e-4&&this._startAt.render(e,t,i),t||(this._time!==s||n)&&this._callback("onUpdate")),a&&(!this._gc||i)&&(0>e&&this._startAt&&!this._onUpdate&&e!==-1e-4&&this._startAt.render(e,t,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[a]&&this._callback(a),0===l&&this._rawPrevTime===d&&r!==d&&(this._rawPrevTime=0))}},o._kill=function(e,t,i){if("all"===e&&(e=null),null==e&&(null==t||t===this.target))return this._lazy=!1,this._enabled(!1,!1);t="string"!=typeof t?t||this._targets||this.target:$.selector(t)||t;var n,a,o,r,s,l,c,d,h,u=i&&this._time&&i._startTime===this._startTime&&this._timeline===i._timeline;if((p(t)||I(t))&&"number"!=typeof t[0])for(n=t.length;--n>-1;)this._kill(e,t[n],i)&&(l=!0);else{if(this._targets){for(n=this._targets.length;--n>-1;)if(t===this._targets[n]){s=this._propLookup[n]||{},this._overwrittenProps=this._overwrittenProps||[],a=this._overwrittenProps[n]=e?this._overwrittenProps[n]||{}:"all";break}}else{if(t!==this.target)return!1;s=this._propLookup,a=this._overwrittenProps=e?this._overwrittenProps||{}:"all"}if(s){if(c=e||s,d=e!==a&&"all"!==a&&e!==s&&("object"!=typeof e||!e._tempKill),i&&($.onOverwrite||this.vars.onOverwrite)){for(o in c)s[o]&&(h||(h=[]),h.push(o));if((h||!e)&&!K(this,i,t,h))return!1}for(o in c)(r=s[o])&&(u&&(r.f?r.t[r.p](r.s):r.t[r.p]=r.s,l=!0),r.pg&&r.t._kill(c)&&(l=!0),r.pg&&0!==r.t._overwriteProps.length||(r._prev?r._prev._next=r._next:r===this._firstPT&&(this._firstPT=r._next),r._next&&(r._next._prev=r._prev),r._next=r._prev=null),delete s[o]),d&&(a[o]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return l},o.invalidate=function(){return this._notifyPluginsOfEnabled&&$._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],E.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-d,this.render(-this._delay)),this},o._enabled=function(e,t){if(s||r.wake(),e&&this._gc){var i,n=this._targets;if(n)for(i=n.length;--i>-1;)this._siblings[i]=G(n[i],this,!0);else this._siblings=G(this.target,this,!0)}return E.prototype._enabled.call(this,e,t),this._notifyPluginsOfEnabled&&this._firstPT?$._onPluginEvent(e?"_onEnable":"_onDisable",this):!1},$.to=function(e,t,i){return new $(e,t,i)},$.from=function(e,t,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new $(e,t,i)},$.fromTo=function(e,t,i,n){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,new $(e,t,n)},$.delayedCall=function(e,t,i,n,a){return new $(t,0,{delay:e,onComplete:t,onCompleteParams:i,callbackScope:n,onReverseComplete:t,onReverseCompleteParams:i,immediateRender:!1,lazy:!1,useFrames:a,overwrite:0})},$.set=function(e,t){return new $(e,0,t)},$.getTweensOf=function(e,t){if(null==e)return[];e="string"!=typeof e?e:$.selector(e)||e;var i,n,a,o;if((p(e)||I(e))&&"number"!=typeof e[0]){for(i=e.length,n=[];--i>-1;)n=n.concat($.getTweensOf(e[i],t));for(i=n.length;--i>-1;)for(o=n[i],a=i;--a>-1;)o===n[a]&&n.splice(i,1)}else for(n=G(e).concat(),i=n.length;--i>-1;)(n[i]._gc||t&&!n[i].isActive())&&n.splice(i,1);return n},$.killTweensOf=$.killDelayedCallsTo=function(e,t,i){"object"==typeof t&&(i=t,t=!1);for(var n=$.getTweensOf(e,t),a=n.length;--a>-1;)n[a]._kill(i,e)};var et=g("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=et.prototype},!0);if(o=et.prototype,et.version="1.18.0",et.API=2,o._firstPT=null,o._addTween=F,o.setRatio=j,o._kill=function(e){var t,i=this._overwriteProps,n=this._firstPT;if(null!=e[this._propName])this._overwriteProps=[];else for(t=i.length;--t>-1;)null!=e[i[t]]&&i.splice(t,1);for(;n;)null!=e[n.n]&&(n._next&&(n._next._prev=n._prev),n._prev?(n._prev._next=n._next,n._prev=null):this._firstPT===n&&(this._firstPT=n._next)),n=n._next;return!1},o._roundProps=function(e,t){for(var i=this._firstPT;i;)(e[this._propName]||null!=i.n&&e[i.n.split(this._propName+"_").join("")])&&(i.r=t),i=i._next},$._onPluginEvent=function(e,t){var i,n,a,o,r,s=t._firstPT;if("_onInitAllProps"===e){for(;s;){for(r=s._next,n=a;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:o)?s._prev._next=s:a=s,(s._next=n)?n._prev=s:o=s,s=r}s=t._firstPT=a}for(;s;)s.pg&&"function"==typeof s.t[e]&&s.t[e]()&&(i=!0),s=s._next;return i},et.activate=function(e){for(var t=e.length;--t>-1;)e[t].API===et.API&&(W[(new e[t])._propName]=e[t]);return!0},v.plugin=function(e){if(!(e&&e.propName&&e.init&&e.API))throw"illegal plugin definition.";var t,i=e.propName,n=e.priority||0,a=e.overwriteProps,o={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},r=g("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){et.call(this,i,n),this._overwriteProps=a||[]},e.global===!0),s=r.prototype=new et(i);s.constructor=r,r.API=e.API;for(t in o)"function"==typeof e[t]&&(s[o[t]]=e[t]);return r.version=e.version,et.activate([r]),r},n=e._gsQueue){for(a=0;a<n.length;a++)n[a]();for(o in m)m[o].func||e.console.log("GSAP encountered missing dependency: com.greensock."+o)}s=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax"),define("greensock/TweenMax",function(){}),function(){window.ScrollPage={bindScrollPage:function(e){function t(e){s=0,Reveal.wheelLock=!0,Reveal.originh=Reveal.indexh,Reveal.originv=Reveal.indexv,Reveal.indexv-=e,Reveal.transition.autostart(Reveal.options.transition,"y",e)}var i=interaction_view.ipagelist.getPage(e),n=interaction_view.doc.get("height"),a=i.get("height"),o=$("section#"+e).children(),r=i.get("is_scrollPage")&&a>n;if(r?this.disable():this.enable(),!o.data("is_scrollPage")){if(r){o.data("is_scrollPage",!0),o.children().css({height:a,"-webkit-transform":"translate3d(0,0,0)"});var s=0,l=50;i.iview.scrollview=new _g.scrollview({containment:o,contentel:o.children(),mask_width:o.width(),mask_height:n,content_width:o.children().width(),content_height:a,content_x:0,content_y:0,scrollY:!0,bounce:!1,onScrollStart:function(){var e=i.iview.scrollview._getCurrentPosition().y;(e>=0||n-a>=e)&&(s=e>=0?1:-1),$(window.event.target).parents(".iLayerRef").size()&&i.iview.scrollview.iScroll.disable()},onScrolling:function(e){if(s)if(s>0&&e.deltaY>l){if(Reveal.getUp())return t(1),!1}else if(0>s&&-e.deltaY>a-n+l&&Reveal.getDown())return t(-1),!1},onScrollend:function(){s=0}}),o.css({"-webkit-transform":"translate3d(0,0,0)",overflow:"visible"})}return r}},enable:function(){$(".reveal").removeClass("disableMouseWheelY").removeClass("disableDragY").addClass("enableMouseWheelY").addClass("enableDragY")},disable:function(){$(".reveal").removeClass("enableMouseWheelY").removeClass("enableDragY").addClass("disableMouseWheelY").addClass("disableDragY")}}}(window),define("_e/scrollpage",function(){}),!function(e){var t=function(t,i){this.$element=e(t),this.options=i,this.init()};t.prototype={init:function(){_.bindAll(this)},_animate_loading:function(){return this.loading.is(":visible")?(e("div",this.loading).css("top",-40*this.loadingFrame+"px"),void(this.loadingFrame=(this.loadingFrame+1)%12)):void clearInterval(this.loadingTimer)},load:function(t){this.$element.children("#jswait-loading").remove(),this.$element.children("#jswait-overlay").remove(),this.loadingTimer=this.loadingFrame=1,this.options=t,this.$element.append(this.loading=e('<div id="jswait-loading"><div></div></div>'),this.overlay=e('<div id="jswait-overlay" class="mask hide"></div>')),this.options.modal&&this.overlay.removeClass("hide"),this.options.simple?(this.loading.css({background:"#000000","line-height":40,"text-align":"center"}),this.loading.html('<img src="/staticfs/thirdparty/jswait/jswait.gif">'),this.loading.show()):(clearInterval(this.loadingTimer),this.loading.show(),this.loadingTimer=setInterval(this._animate_loading,66)),this.waited=!0},close:function(){this.waited&&(this.loading.remove(),this.overlay.remove(),this.$element.children("#jswait-loading").remove(),this.$element.children("#jswait-overlay").remove(),this.loadingFrame=1,clearInterval(this.loadingTimer),this.waited=!1)}},e.fn.jswait=function(i){return this.each(function(){var n=e(this),a=n.data("jswait"),o=e.extend({},e.fn.jswait.defaults,"object"==typeof i&&i),r="string"==typeof i?i:null;a||n.data("jswait",a=new t(this,o)),r?a[r]():a.load(o)})},e.fn.jswait.defaults={modal:!1},e.fn.jswait.Constructor=t}(window.jQuery),define("jswait",["jquery"],function(){});var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){function e(e,t,i,n){return i=parseFloat(i)-parseFloat(e),n=parseFloat(n)-parseFloat(t),Math.sqrt(i*i+n*n)}function t(e){return"string"!=typeof e&&e.nodeType||(e=_gsScope.TweenLite.selector(e),e.length&&(e=e[0])),e}function i(e,t,i){var n,a,o=e.indexOf(" ");return-1===o?(n=void 0!==i?i+"":e,a=e):(n=e.substr(0,o),a=e.substr(o+1)),n=-1!==n.indexOf("%")?parseFloat(n)/100*t:parseFloat(n),a=-1!==a.indexOf("%")?parseFloat(a)/100*t:parseFloat(a),n>a?[a,n]:[n,a]}function n(i){if(!i)return 0;i=t(i);var n,a,o,r,s,l,c,d,h=i.tagName.toLowerCase();if("path"===h)n=i.getTotalLength()||0;else if("rect"===h)a=i.getBBox(),n=2*(a.width+a.height);else if("circle"===h)n=2*Math.PI*parseFloat(i.getAttribute("r"));else if("line"===h)n=e(i.getAttribute("x1"),i.getAttribute("y1"),i.getAttribute("x2"),i.getAttribute("y2"));else if("polyline"===h||"polygon"===h)for(o=i.getAttribute("points").split(" "),n=0,s=o[0].split(","),"polygon"===h&&(o.push(o[0]),-1===o[0].indexOf(",")&&o.push(o[1])),l=1;l<o.length;l++)r=o[l].split(","),1===r.length&&(r[1]=o[l++]),2===r.length&&(n+=e(s[0],s[1],r[0],r[1])||0,s=r);else"ellipse"===h&&(c=parseFloat(i.getAttribute("rx")),d=parseFloat(i.getAttribute("ry")),n=Math.PI*(3*(c+d)-Math.sqrt((3*c+d)*(c+3*d))));return n||0}function a(e,i){if(!e)return[0,0];e=t(e),i=i||n(e)+1;var a=r(e),o=a.strokeDasharray||"",s=parseFloat(a.strokeDashoffset);return o=-1===o.indexOf(" ")?i:parseFloat(o.split(" ")[0])||1e-5,o>i&&(o=i),[Math.max(0,-s),o-s]}var o,r=document.defaultView?document.defaultView.getComputedStyle:function(){};o=_gsScope._gsDefine.plugin({propName:"drawSVG",API:2,version:"0.0.4",global:!0,overwriteProps:["drawSVG"],init:function(e,t){if(!e.getBBox)return!1;var o,r,s,l=n(e)+1;return this._style=e.style,t===!0||"true"===t?t="0 100%":t?-1===(t+"").indexOf(" ")&&(t="0 "+t):t="0 0",o=a(e,l),r=i(t,l,o[0]),this._length=l+10,0===o[0]&&0===r[0]?(s=Math.max(1e-5,r[1]-l),this._dash=l+s,this._offset=l-o[1]+s,this._addTween(this,"_offset",this._offset,l-r[1]+s,"drawSVG")):(this._dash=o[1]-o[0]||1e-6,this._offset=-o[0],this._addTween(this,"_dash",this._dash,r[1]-r[0]||1e-5,"drawSVG"),this._addTween(this,"_offset",this._offset,-r[0],"drawSVG")),!0},set:function(e){this._firstPT&&(this._super.setRatio.call(this,e),this._style.strokeDashoffset=this._offset,this._style.strokeDasharray=this._dash+" "+this._length)}}),o.getLength=n,o.getPosition=a}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),define("greensock/plugins/DrawSVGPlugin",function(){});var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){var e=Math.PI/180,t=180/Math.PI,i=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,n=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,a=/[achlmqstvz]/gi,o=_gsScope.TweenLite,r=function(e){window.console&&console.log(e)},s=function(t,i){var n,a,o,r,s,l,c=Math.ceil(Math.abs(i)/90),d=0,h=[];for(t*=e,i*=e,n=i/c,a=4/3*Math.sin(n/2)/(1+Math.cos(n/2)),l=0;c>l;l++)o=t+l*n,r=Math.cos(o),s=Math.sin(o),h[d++]=r-a*s,h[d++]=s+a*r,o+=n,r=Math.cos(o),s=Math.sin(o),h[d++]=r+a*s,h[d++]=s-a*r,h[d++]=r,h[d++]=s;return h},l=function(i,n,a,o,r,l,c,d,h){if(i!==d||n!==h){a=Math.abs(a),o=Math.abs(o);var u=r%360*e,p=Math.cos(u),m=Math.sin(u),f=(i-d)/2,v=(n-h)/2,g=p*f+m*v,w=-m*f+p*v,_=a*a,y=o*o,b=g*g,x=w*w,S=b/_+x/y;S>1&&(a=Math.sqrt(S)*a,o=Math.sqrt(S)*o,_=a*a,y=o*o);var T=l===c?-1:1,C=(_*y-_*x-y*b)/(_*x+y*b);0>C&&(C=0);var k=T*Math.sqrt(C),P=k*(a*w/o),E=k*-(o*g/a),D=(i+d)/2,A=(n+h)/2,$=D+(p*P-m*E),I=A+(m*P+p*E),O=(g-P)/a,N=(w-E)/o,R=(-g-P)/a,M=(-w-E)/o,j=Math.sqrt(O*O+N*N),L=O;T=0>N?-1:1;var F=T*Math.acos(L/j)*t;j=Math.sqrt((O*O+N*N)*(R*R+M*M)),L=O*R+N*M,T=0>O*M-N*R?-1:1;var z=T*Math.acos(L/j)*t;!c&&z>0?z-=360:c&&0>z&&(z+=360),z%=360,F%=360;var W,B,H,U=s(F,z),V=p*a,Y=m*a,X=m*-o,q=p*o,J=U.length-2;for(W=0;J>W;W+=2)B=U[W],H=U[W+1],U[W]=B*V+H*X+$,U[W+1]=B*Y+H*q+I;return U[U.length-2]=d,U[U.length-1]=h,U}},c=function(e){var t,n,a,o,s,c,d,h,u,p,m,f,v,g=(e+"").match(i)||[],w=[],_=0,y=0,b=g.length,x=2,S=0;if(!e||!isNaN(g[0])||isNaN(g[1]))return r("ERROR: malformed path data: "+e),w;for(t=0;b>t;t++)if(v=s,isNaN(g[t])?(s=g[t].toUpperCase(),c=s!==g[t]):t--,a=+g[t+1],o=+g[t+2],c&&(a+=_,o+=y),0===t&&(h=a,u=o),"M"===s)d&&d.length<8&&(w.length-=1,x=0),_=h=a,y=u=o,d=[a,o],S+=x,x=2,w.push(d),t+=2,s="L";else if("C"===s)d||(d=[0,0]),d[x++]=a,d[x++]=o,c||(_=y=0),d[x++]=_+1*g[t+3],d[x++]=y+1*g[t+4],d[x++]=_+=1*g[t+5],d[x++]=y+=1*g[t+6],t+=6;else if("S"===s)"C"===v||"S"===v?(p=_-d[x-4],m=y-d[x-3],d[x++]=_+p,d[x++]=y+m):(d[x++]=_,d[x++]=y),d[x++]=a,d[x++]=o,c||(_=y=0),d[x++]=_+=1*g[t+3],d[x++]=y+=1*g[t+4],t+=4;else if("Q"===s)p=a-_,m=o-y,d[x++]=_+2*p/3,d[x++]=y+2*m/3,c||(_=y=0),_+=1*g[t+3],y+=1*g[t+4],p=a-_,m=o-y,d[x++]=_+2*p/3,d[x++]=y+2*m/3,d[x++]=_,d[x++]=y,t+=4;else if("T"===s)p=_-d[x-4],m=y-d[x-3],d[x++]=_+p,d[x++]=y+m,p=_+1.5*p-a,m=y+1.5*m-o,d[x++]=a+2*p/3,d[x++]=o+2*m/3,d[x++]=_=a,d[x++]=y=o,t+=2;else if("H"===s)o=y,d[x++]=_+(a-_)/3,d[x++]=y+(o-y)/3,d[x++]=_+2*(a-_)/3,d[x++]=y+2*(o-y)/3,d[x++]=_=a,d[x++]=o,t+=1;else if("V"===s)o=a,a=_,c&&(o+=y-_),d[x++]=a,d[x++]=y+(o-y)/3,d[x++]=a,d[x++]=y+2*(o-y)/3,d[x++]=a,d[x++]=y=o,t+=1;else if("L"===s||"Z"===s)"Z"===s&&(a=h,o=u,d.closed=!0),("L"===s||Math.abs(_-a)>.5||Math.abs(y-o)>.5)&&(d[x++]=_+(a-_)/3,d[x++]=y+(o-y)/3,d[x++]=_+2*(a-_)/3,d[x++]=y+2*(o-y)/3,d[x++]=a,d[x++]=o,"L"===s&&(t+=2)),_=a,y=o;else if("A"===s){for(f=l(_,y,1*g[t+1],1*g[t+2],1*g[t+3],1*g[t+4],1*g[t+5],(c?_:0)+1*g[t+6],(c?y:0)+1*g[t+7]),n=0;n<f.length;n++)d[x++]=f[n];_=d[x-2],y=d[x-1],t+=7}else r("Error: malformed path data: "+e);return w.totalPoints=S+x,w},d=function(e,t){var i,n,a,o,r,s,l,c,d,h,u,p,m,f,v=0,g=.999999,w=e.length,_=t/((w-2)/6);for(m=2;w>m;m+=6)for(v+=_;v>g;)i=e[m-2],n=e[m-1],a=e[m],o=e[m+1],r=e[m+2],s=e[m+3],l=e[m+4],c=e[m+5],f=1/(Math.floor(v)+1),d=i+(a-i)*f,u=a+(r-a)*f,d+=(u-d)*f,u+=(r+(l-r)*f-u)*f,h=n+(o-n)*f,p=o+(s-o)*f,h+=(p-h)*f,p+=(s+(c-s)*f-p)*f,e.splice(m,4,i+(a-i)*f,n+(o-n)*f,d,h,d+(u-d)*f,h+(p-h)*f,u,p,r+(l-r)*f,s+(c-s)*f),m+=6,w+=6,v--;return e},h=function(e){var t,i,n,a,o="",r=e.length,s=100;for(i=0;r>i;i++){for(a=e[i],o+="M"+a[0]+","+a[1]+" C",t=a.length,n=2;t>n;n++)o+=(a[n++]*s|0)/s+","+(a[n++]*s|0)/s+" "+(a[n++]*s|0)/s+","+(a[n++]*s|0)/s+" "+(a[n++]*s|0)/s+","+(a[n]*s|0)/s+" ";a.closed&&(o+="z")}return o},u=function(e){for(var t=[],i=e.length-1,n=0;--i>-1;)t[n++]=e[i],t[n++]=e[i+1],i--;for(i=0;n>i;i++)e[i]=t[i];e.reversed=e.reversed?!1:!0},p=function(e){var t,i=e.length,n=0,a=0;for(t=0;i>t;t++)n+=e[t++],a+=e[t];return[n/(i/2),a/(i/2)]},m=function(e){var t,i,n,a=e.length,o=e[0],r=o,s=e[1],l=s;for(n=6;a>n;n+=6)t=e[n],i=e[n+1],t>o?o=t:r>t&&(r=t),i>s?s=i:l>i&&(l=i);return e.centerX=(o+r)/2,e.centerY=(s+l)/2,e.size=(o-r)*(s-l)},f=function(e){for(var t,i,n,a,o,r=e.length,s=e[0][0],l=s,c=e[0][1],d=c;--r>-1;)for(o=e[r],t=o.length,a=6;t>a;a+=6)i=o[a],n=o[a+1],i>s?s=i:l>i&&(l=i),n>c?c=n:d>n&&(d=n);return e.centerX=(s+l)/2,e.centerY=(c+d)/2,e.size=(s-l)*(c-d)},v=function(e,t){return t.length-e.length},g=function(e,t){var i=e.size||m(e),n=t.size||m(t);return Math.abs(n-i)<(i+n)/20?t.centerX-e.centerX||t.centerY-e.centerY:n-i},w=function(e,t){var i,n,a=e.slice(0),o=e.length,r=o-2;for(t=0|t,i=0;o>i;i++)n=(i+t)%r,e[i++]=a[n],e[i]=a[n+1]},_=function(e,t,i,n,a){var o,r,s,l,c=e.length,d=0,h=c-2;for(i*=6,r=0;c>r;r+=6)o=(r+i)%h,l=e[o]-(t[r]-n),s=e[o+1]-(t[r+1]-a),d+=Math.sqrt(s*s+l*l);return d},y=function(e,t,i){var n,a,o,r=e.length,s=p(e),l=p(t),c=l[0]-s[0],d=l[1]-s[1],h=_(e,t,0,c,d),m=0;for(o=6;r>o;o+=6)a=_(e,t,o/6,c,d),h>a&&(h=a,m=o);if(i)for(n=e.slice(0),u(n),o=6;r>o;o+=6)a=_(n,t,o/6,c,d),h>a&&(h=a,m=-o);return m/6},b=function(e,t,i){for(var n,a,o,r,s,l,c=e.length,d=99999999999,h=0,u=0;--c>-1;)for(n=e[c],l=n.length,s=0;l>s;s+=6)a=n[s]-t,o=n[s+1]-i,r=Math.sqrt(a*a+o*o),d>r&&(d=r,h=n[s],u=n[s+1]);return[h,u]},x=function(e,t,i,n,a,o){var r,s,l,c,d,h=t.length,u=0,p=Math.min(e.size||m(e),t[i].size||m(t[i]))*n,f=999999999999,v=e.centerX+a,g=e.centerY+o;for(s=i;h>s&&(r=t[s].size||m(t[s]),!(p>r));s++)l=t[s].centerX-v,c=t[s].centerY-g,d=Math.sqrt(l*l+c*c),f>d&&(u=s,f=d);return d=t[u],t.splice(u,1),d},S=function(e,t,i,n){var a,o,s,l,c,h,p,_=t.length-e.length,S=_>0?t:e,T=_>0?e:t,C=0,k="complexity"===n?v:g,P="position"===n?0:"number"==typeof n?n:.8,E=T.length,D="object"==typeof i&&i.push?i.slice(0):[i],A="reverse"===D[0]||D[0]<0,$="log"===i;if(T[0]){if(S.length>1&&(e.sort(k),t.sort(k),h=S.size||f(S),h=T.size||f(T),h=S.centerX-T.centerX,p=S.centerY-T.centerY,k===g))for(E=0;E<T.length;E++)S.splice(E,0,x(T[E],S,E,P,h,p));if(_)for(0>_&&(_=-_),S[0].length>T[0].length&&d(T[0],(S[0].length-T[0].length)/6|0),E=T.length;_>C;)l=S[E].size||m(S[E]),s=b(T,S[E].centerX,S[E].centerY),l=s[0],c=s[1],T[E++]=[l,c,l,c,l,c,l,c],T.totalPoints+=8,C++;for(E=0;E<e.length;E++)a=t[E],o=e[E],_=a.length-o.length,0>_?d(a,-_/6|0):_>0&&d(o,_/6|0),A&&!o.reversed&&u(o),i=D[E]||0===D[E]?D[E]:"auto",i&&(o.closed||Math.abs(o[0]-o[o.length-2])<.5&&Math.abs(o[1]-o[o.length-1])<.5?"auto"===i||"log"===i?(D[E]=i=y(o,a,0===E),0>i&&(A=!0,u(o),i=-i),w(o,6*i)):"reverse"!==i&&(E&&0>i&&u(o),w(o,6*(0>i?-i:i))):!A&&("auto"===i&&Math.abs(a[0]-o[0])+Math.abs(a[1]-o[1])+Math.abs(a[a.length-2]-o[o.length-2])+Math.abs(a[a.length-1]-o[o.length-1])>Math.abs(a[0]-o[o.length-2])+Math.abs(a[1]-o[o.length-1])+Math.abs(a[a.length-2]-o[0])+Math.abs(a[a.length-1]-o[1])||i%2)?(u(o),D[E]=-1,A=!0):"auto"===i?D[E]=0:"reverse"===i&&(D[E]=-1),o.closed!==a.closed&&(o.closed=a.closed=!1));return $&&r("shapeIndex:["+D.join(",")+"]"),D}},T=function(e,t,i,n){var a=c(e[0]),o=c(e[1]);S(a,o,t||0===t?t:"auto",i)&&(e[0]=h(a),e[1]=h(o),("log"===n||n===!0)&&r('precompile:["'+e[0]+'","'+e[1]+'"]'))},C=function(e,t,i){return t||i||e||0===e?function(n){T(n,e,t,i)}:T},k=function(e,t){if(!t)return e;var i,a,o,r=e.match(n)||[],s=r.length,l="";for("reverse"===t?(a=s-1,i=-2):(a=(2*(parseInt(t,10)||0)+1+100*s)%s,i=2),o=0;s>o;o+=2)l+=r[a-1]+","+r[a]+" ",a=(a+i)%s;return l},P=function(e,t){var i,n,a,o,r,s,l,c=0,d=parseFloat(e[0]),h=parseFloat(e[1]),u=d+","+h+" ",p=.999999;for(a=e.length,i=.5*t/(.5*a-1),n=0;a-2>n;n+=2){if(c+=i,s=parseFloat(e[n+2]),l=parseFloat(e[n+3]),c>p)for(r=1/(Math.floor(c)+1),o=1;c>p;)u+=(d+(s-d)*r*o).toFixed(2)+","+(h+(l-h)*r*o).toFixed(2)+" ",c--,o++;u+=s+","+l+" ",d=s,h=l}return u},E=function(e){var t=e[0].match(n)||[],i=e[1].match(n)||[],a=i.length-t.length;a>0?e[0]=P(t,a):e[1]=P(i,-a)},D=function(e){return isNaN(e)?E:function(t){E(t),t[1]=k(t[1],parseInt(e,10))}},A=function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg","path"),n=Array.prototype.slice.call(e.attributes),a=n.length;for(t=","+t+",";--a>-1;)-1===t.indexOf(","+n[a].nodeName+",")&&i.setAttributeNS(null,n[a].nodeName,n[a].nodeValue);return i},$=function(e,t){var i,a,o,r,s,l,c,d,h,u,p,m,f,v,g,w,_,y,b,x,S,T=e.tagName.toLowerCase(),C=.552284749831;return"path"!==T&&e.getBBox?(l=A(e,"x,y,width,height,cx,cy,rx,ry,r,x1,x2,y1,y2,points"),"rect"===T?(r=+e.getAttribute("rx")||0,s=+e.getAttribute("ry")||0,a=+e.getAttribute("x")||0,o=+e.getAttribute("y")||0,u=(+e.getAttribute("width")||0)-2*r,p=(+e.getAttribute("height")||0)-2*s,r||s?(m=a+r*(1-C),f=a+r,v=f+u,g=v+r*C,w=v+r,_=o+s*(1-C),y=o+s,b=y+p,x=b+s*C,S=b+s,i="M"+w+","+y+" V"+b+" C"+[w,x,g,S,v,S,v-(v-f)/3,S,f+(v-f)/3,S,f,S,m,S,a,x,a,b,a,b-(b-y)/3,a,y+(b-y)/3,a,y,a,_,m,o,f,o,f+(v-f)/3,o,v-(v-f)/3,o,v,o,g,o,w,_,w,y].join(",")+"z"):i="M"+(a+u)+","+o+" v"+p+" h"+-u+" v"+-p+" h"+u+"z"):"circle"===T||"ellipse"===T?("circle"===T?(r=s=+e.getAttribute("r")||0,d=r*C):(r=+e.getAttribute("rx")||0,s=+e.getAttribute("ry")||0,d=s*C),a=+e.getAttribute("cx")||0,o=+e.getAttribute("cy")||0,c=r*C,i="M"+(a+r)+","+o+" C"+[a+r,o+d,a+c,o+s,a,o+s,a-c,o+s,a-r,o+d,a-r,o,a-r,o-d,a-c,o-s,a,o-s,a+c,o-s,a+r,o-d,a+r,o].join(",")+"z"):"line"===T?i="M"+e.getAttribute("x1")+","+e.getAttribute("y1")+" L"+e.getAttribute("x2")+","+e.getAttribute("y2"):("polyline"===T||"polygon"===T)&&(h=(e.getAttribute("points")+"").match(n)||[],a=h.shift(),o=h.shift(),i="M"+a+","+o+" L"+h.join(","),"polygon"===T&&(i+=","+a+","+o+"z")),l.setAttribute("d",i),t&&e.parentNode&&(e.parentNode.insertBefore(l,e),e.parentNode.removeChild(e)),l):e},I=function(e,t,i){var a,s,l="string"==typeof e;return(!l||(e.match(n)||[]).length<3)&&(a=l?o.selector(e):[e],a&&a[0]?(a=a[0],s=a.nodeName.toUpperCase(),t&&"PATH"!==s&&(a=$(a,!1),s="PATH"),e=a.getAttribute("PATH"===s?"d":"points")||"",a===i&&(e=a.getAttributeNS(null,"data-original")||e)):(r("WARNING: invalid morph to: "+e),e=!1)),e},O="Use MorphSVGPlugin.convertToPath(elementOrSelectorText) to convert to a path before morphing.",N=_gsScope._gsDefine.plugin({propName:"morphSVG",API:2,global:!0,version:"0.8.1",init:function(e,t){var i,n,o,s,l;return"function"!=typeof e.setAttribute?!1:(i=e.nodeName.toUpperCase(),l="POLYLINE"===i||"POLYGON"===i,"PATH"===i||l?(n="PATH"===i?"d":"points",("string"==typeof t||t.getBBox||t[0])&&(t={shape:t}),s=I(t.shape||t.d||t.points||"","d"===n,e),l&&a.test(s)?(r("WARNING: a <"+i+"> cannot accept path data. "+O),!1):(s&&(this._target=e,e.getAttributeNS(null,"data-original")||e.setAttributeNS(null,"data-original",e.getAttribute(n)),o=this._addTween(e,"setAttribute",e.getAttribute(n)+"",s+"","morphSVG",!1,n,"object"==typeof t.precompile?function(e){e[0]=t.precompile[0],e[1]=t.precompile[1]}:"d"===n?C(t.shapeIndex,t.map||N.defaultMap,t.precompile):D(t.shapeIndex)),o&&(this._overwriteProps.push("morphSVG"),o.end=s,o.endProp=n)),!0)):(r("WARNING: cannot morph a <"+i+"> SVG element. "+O),!1))},set:function(e){var t;if(this._super.setRatio.call(this,e),1===e)for(t=this._firstPT;t;)t.end&&this._target.setAttribute(t.endProp,t.end),t=t._next}});N.pathFilter=T,N.pointsFilter=E,N.subdivideRawBezier=d,N.defaultMap="size",N.pathDataToRawBezier=function(e){return c(I(e,!0))},N.equalizeSegmentQuantity=S,N.convertToPath=function(e,t){"string"==typeof e&&(e=o.selector(e));for(var i=e&&0!==e.length?e.length&&e[0]&&e[0].nodeType?Array.prototype.slice.call(e,0):[e]:[],n=i.length;--n>-1;)i[n]=$(i[n],t!==!1);return i},N.pathDataToBezier=function(e,t){var i,n,a,r,s,l,d,h,u=c(I(e,!0))[0]||[],p=0;if(t=t||{},h=t.align||t.relative,r=t.matrix||[1,0,0,1,0,0],s=t.offsetX||0,l=t.offsetY||0,"relative"===h||h===!0?(s-=u[0]*r[0]+u[1]*r[2],l-=u[0]*r[1]+u[1]*r[3],p="+="):(s+=r[4],l+=r[5],h&&(h="string"==typeof h?o.selector(h):[h],h&&h[0]&&(d=h[0].getBBox()||{x:0,y:0},s-=d.x,l-=d.y))),i=[],a=u.length,r)for(n=0;a>n;n+=2)i.push({x:p+(u[n]*r[0]+u[n+1]*r[2]+s),y:p+(u[n]*r[1]+u[n+1]*r[3]+l)});else for(n=0;a>n;n+=2)i.push({x:p+(u[n]+s),y:p+(u[n+1]+l)});return i}}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),define("greensock/plugins/MorphSVGPlugin",function(){});var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){var e=function(t){var i=t.nodeType,n="";if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=e(t)}else if(3===i||4===i)return t.nodeValue;return n},t=_gsScope._gsDefine.plugin({propName:"text",API:2,version:"0.5.1",init:function(t,i,n){var a,o;if(!("innerHTML"in t))return!1;if(this._target=t,"object"!=typeof i&&(i={value:i}),void 0===i.value)return this._text=this._original=[""],!0;if(this._delimiter=i.delimiter||"",this._original=e(t).replace(/\s+/g," ").split(this._delimiter),this._delimiter)this._text=i.value.replace(/\s+/g," ").split(this._delimiter);else{var r=i.value.replace(/\s+/g," ");this._text=[];for(var s=0;r.length;){var l=r.indexOf("<div>"),c=r.indexOf("</div>");if(-1!=l||-1!=c){if(-1==l&&(l=99999),-1==c&&(c=99999),c>l)var d=!0;else var d=!1;if(d){var h=r.slice(s,l);if(h)for(var u=h.split(""),p=0;p<u.length;p++)this._text.push(u[p]);this._text.push("<div>"),r=r.slice(l+5)}else{var h=r.slice(s,c);if(h)for(var u=h.split(""),p=0;p<u.length;p++)this._text.push(u[p]);this._text.push("</div>"),r=r.slice(c+6)}}else{if(r)for(var u=r.split(""),p=0;p<u.length;p++)this._text.push(u[p]);r=""}}}for(this._runBackwards=n.vars.runBackwards===!0,this._runBackwards&&(a=this._original,this._original=this._text,this._text=a),"string"==typeof i.newClass&&(this._newClass=i.newClass,this._hasClass=!0),"string"==typeof i.oldClass&&(this._oldClass=i.oldClass,this._hasClass=!0),a=this._original.length-this._text.length,o=0>a?this._original:this._text,this._fillChar=i.fillChar||(i.padSpace?"&nbsp;":""),0>a&&(a=-a);--a>-1;)o.push(this._fillChar);return!0},set:function(e){e>1?e=1:0>e&&(e=0),this._runBackwards&&(e=1-e);var t,i,n,a=this._text.length,o=e*a+.5|0;this._hasClass?(t=this._newClass&&0!==o,i=this._oldClass&&o!==a,n=(t?"<span class='"+this._newClass+"'>":"")+this._text.slice(0,o).join(this._delimiter)+(t?"</span>":"")+(i?"<span class='"+this._oldClass+"'>":"")+this._delimiter+this._original.slice(o).join(this._delimiter)+(i?"</span>":"")):n=this._text.slice(0,o).join(this._delimiter)+this._delimiter+this._original.slice(o).join(this._delimiter),this._target.innerHTML="&nbsp;"===this._fillChar&&-1!==n.indexOf("  ")?n.split("  ").join("&nbsp;&nbsp;"):n}}),i=t.prototype;i._newClass=i._oldClass=i._delimiter=""}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),define("greensock/plugins/TextPlugin",function(){}),function(e,t,i){function n(e,i){this.wrapper="string"==typeof e?t.querySelector(e):e,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var n in i)this.options[n]=i[n];this.translateZ=this.options.HWCompositing&&s.hasPerspective?" translateZ(0)":"",this.options.useTransition=s.hasTransition&&this.options.useTransition,this.options.useTransform=s.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?s.ease[this.options.bounceEasing]||s.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function a(e,i,n){var a=t.createElement("div"),o=t.createElement("div");
return n===!0&&(a.style.cssText="position:absolute;z-index:9999",o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),o.className="iScrollIndicator","h"==e?(n===!0&&(a.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",o.style.height="100%"),a.className="iScrollHorizontalScrollbar"):(n===!0&&(a.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",o.style.width="100%"),a.className="iScrollVerticalScrollbar"),a.style.cssText+=";overflow:hidden",i||(a.style.pointerEvents="none"),a.appendChild(o),a}function o(i,n){this.wrapper="string"==typeof n.el?t.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=i,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var a in n)this.options[a]=n[a];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(s.addEvent(this.indicator,"touchstart",this),s.addEvent(e,"touchend",this)),this.options.disablePointer||(s.addEvent(this.indicator,"MSPointerDown",this),s.addEvent(e,"MSPointerUp",this)),this.options.disableMouse||(s.addEvent(this.indicator,"mousedown",this),s.addEvent(e,"mouseup",this))),this.options.fade&&(this.wrapperStyle[s.style.transform]=this.scroller.translateZ,this.wrapperStyle[s.style.transitionDuration]=s.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},s=function(){function n(e){return r===!1?!1:""===r?e:r+e.charAt(0).toUpperCase()+e.substr(1)}var a={},o=t.createElement("div").style,r=function(){for(var e,t=["t","webkitT","MozT","msT","OT"],i=0,n=t.length;n>i;i++)if(e=t[i]+"ransform",e in o)return t[i].substr(0,t[i].length-1);return!1}();a.getTime=Date.now||function(){return(new Date).getTime()},a.extend=function(e,t){for(var i in t)e[i]=t[i]},a.addEvent=function(e,t,i,n){e.addEventListener?e.addEventListener(t,i,!!n):e.attachEvent(t,i)},a.removeEvent=function(e,t,i,n){e.removeEventListener?e.removeEventListener(t,i,!!n):e.detachEvent(t,i)},a.momentum=function(e,t,n,a,o,r){var s,l,c=e-t,d=i.abs(c)/n;return r=void 0===r?6e-4:r,s=e+d*d/(2*r)*(0>c?-1:1),l=d/r,a>s?(s=o?a-o/2.5*(d/8):a,c=i.abs(s-e),l=c/d):s>0&&(s=o?o/2.5*(d/8):0,c=i.abs(e)+s,l=c/d),{destination:i.round(s),duration:l}};var s=n("transform");return a.extend(a,{hasTransform:s!==!1,hasPerspective:n("perspective")in o,hasTouch:"ontouchstart"in e,hasPointer:navigator.msPointerEnabled,hasTransition:n("transition")in o}),a.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion),a.extend(a.style={},{transform:s,transitionTimingFunction:n("transitionTimingFunction"),transitionDuration:n("transitionDuration"),transitionDelay:n("transitionDelay"),transformOrigin:n("transformOrigin")}),a.hasClass=function(e,t){var i=new RegExp("(^|\\s)"+t+"(\\s|$)");return i.test(e.className)},a.addClass=function(e,t){if(!a.hasClass(e,t)){var i=e.className.split(" ");i.push(t),e.className=i.join(" ")}},a.removeClass=function(e,t){if(a.hasClass(e,t)){var i=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(i," ")}},a.offset=function(e){for(var t=-e.offsetLeft,i=-e.offsetTop;e=e.offsetParent;)t-=e.offsetLeft,i-=e.offsetTop;return{left:t,top:i}},a.preventDefaultException=function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1},a.extend(a.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),a.extend(a.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return i.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e-=1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}},elastic:{style:"",fn:function(e){var t=.22,n=.4;return 0===e?0:1==e?1:n*i.pow(2,-10*e)*i.sin(2*(e-t/4)*i.PI/t)+1}}}),a.tap=function(e,i){var n=t.createEvent("Event");n.initEvent(i,!0,!0),n.pageX=e.pageX,n.pageY=e.pageY,e.target.dispatchEvent(n)},a.click=function(e){var i,n=e.target;/(SELECT|INPUT|TEXTAREA)/i.test(n.tagName)||(i=t.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,e.view,1,n.screenX,n.screenY,n.clientX,n.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),i._constructed=!0,n.dispatchEvent(i))},a}();n.prototype={version:"5.1.1",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){e.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(e){if(!(1!=s.eventType[e.type]&&0!==e.button||!this.enabled||this.initiated&&s.eventType[e.type]!==this.initiated)){!this.options.preventDefault||s.isBadAndroid||s.preventDefaultException(e.target,this.options.preventDefaultException)||e.preventDefault();var t,n=e.touches?e.touches[0]:e;this.initiated=s.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=s.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,t=this.getComputedPosition(),this._translate(i.round(t.x),i.round(t.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=n.pageX,this.pointY=n.pageY,this._execEvent("beforeScrollStart")}},_move:function(e){if(this.enabled&&s.eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault();var t,n,a,o,r=e.touches?e.touches[0]:e,l=r.pageX-this.pointX,c=r.pageY-this.pointY,d=s.getTime();if(this.pointX=r.pageX,this.pointY=r.pageY,this.distX+=l,this.distY+=c,a=i.abs(this.distX),o=i.abs(this.distY),!(d-this.endTime>300&&10>a&&10>o)){if(this.directionLocked||this.options.freeScroll||(this.directionLocked=a>o+this.options.directionLockThreshold?"h":o>=a+this.options.directionLockThreshold?"v":"n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)e.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);c=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)e.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);l=0}l=this.hasHorizontalScroll?l:0,c=this.hasVerticalScroll?c:0,(this.options.scrollX&&l||this.options.scrollY&&c)&&e.stopPropagation(),t=this.x+l,n=this.y+c,(t>0||t<this.maxScrollX)&&(t=this.options.bounce?this.x+l/3:t>0?0:this.maxScrollX),(n>0||n<this.maxScrollY)&&(n=this.options.bounce?this.y+c/3:n>0?0:this.maxScrollY),this.directionX=l>0?-1:0>l?1:0,this.directionY=c>0?-1:0>c?1:0,this.moved||this._execEvent("scrollStart"),this.enabled&&(this.moved=!0,this._translate(t,n),d-this.startTime>300&&(this.startTime=d,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll"))}}},_end:function(e){if(this.enabled&&s.eventType[e.type]===this.initiated){this.options.preventDefault&&!s.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();var t,n,a=(e.changedTouches?e.changedTouches[0]:e,s.getTime()-this.startTime),o=i.round(this.x),r=i.round(this.y),l=i.abs(o-this.startX),c=i.abs(r-this.startY),d=0,h="";if(this.isInTransition=0,this.initiated=0,this.endTime=s.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(o,r),!this.moved)return this.options.tap&&s.tap(e,this.options.tap),this.options.click&&s.click(e),void this._execEvent("scrollCancel");if(this._events.flick&&200>a&&100>l&&100>c)return void this._execEvent("flick");if(this.options.momentum&&300>a&&(t=this.hasHorizontalScroll?s.momentum(this.x,this.startX,a,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0},n=this.hasVerticalScroll?s.momentum(this.y,this.startY,a,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:r,duration:0},o=t.destination,r=n.destination,d=i.max(t.duration,n.duration),this.isInTransition=1),this.options.snap){var u=this._nearestSnap(o,r);this.currentPage=u,d=this.options.snapSpeed||i.max(i.max(i.min(i.abs(o-u.x),1e3),i.min(i.abs(r-u.y),1e3)),300),o=u.x,r=u.y,this.directionX=0,this.directionY=0,h=this.options.bounceEasing}return o!=this.x||r!=this.y?((o>0||o<this.maxScrollX||r>0||r<this.maxScrollY)&&(h=s.ease.quadratic),void this.scrollTo(o,r,d,h)):void this._execEvent("scrollEnd")}}},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(e){var t=this.x,i=this.y;return e=e||0,!this.hasHorizontalScroll||this.x>0?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),t==this.x&&i==this.y?!1:(this.scrollTo(t,i,e,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.options.scrollerHeight||this.wrapper.offsetHeight;this.wrapperWidth=this.options.wrapperWidth||this.wrapper.clientWidth,this.wrapperHeight=this.options.wrapperHeight||this.wrapper.clientHeight,this.scrollerWidth=this.options.scrollerWidth||this.scroller.offsetWidth,this.scrollerHeight=this.options.scrollerHeight||this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=s.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},off:function(e,t){if(this._events[e]){var i=this._events[e].indexOf(t);i>-1&&this._events[e].splice(i,1)}},_execEvent:function(e){if(this._events[e]){var t=0,i=this._events[e].length;if(i)for(;i>t;t++)this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,i,n){e=this.x+e,t=this.y+t,i=i||0,this.scrollTo(e,t,i,n)},scrollTo:function(e,t,i,n){n=n||s.ease.circular,this.isInTransition=this.options.useTransition&&i>0,!i||this.options.useTransition&&n.style?(this._transitionTimingFunction(n.style),this._transitionTime(i),this._translate(e,t)):this._animate(e,t,i,n.fn)},scrollToElement:function(e,t,n,a,o){if(e=e.nodeType?e:this.scroller.querySelector(e)){var r=s.offset(e);r.left-=this.wrapperOffset.left,r.top-=this.wrapperOffset.top,n===!0&&(n=i.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)),a===!0&&(a=i.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)),r.left-=n||0,r.top-=a||0,r.left=r.left>0?0:r.left<this.maxScrollX?this.maxScrollX:r.left,r.top=r.top>0?0:r.top<this.maxScrollY?this.maxScrollY:r.top,t=void 0===t||null===t||"auto"===t?i.max(i.abs(this.x-r.left),i.abs(this.y-r.top)):t,this.scrollTo(r.left,r.top,t,o)}},_transitionTime:function(e){if(e=e||0,this.scrollerStyle[s.style.transitionDuration]=e+"ms",!e&&s.isBadAndroid&&(this.scrollerStyle[s.style.transitionDuration]="0.001s"),this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTime(e)},_transitionTimingFunction:function(e){if(this.scrollerStyle[s.style.transitionTimingFunction]=e,this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTimingFunction(e)},_translate:function(e,t){if(this.options.useTransform?this.scrollerStyle[s.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ:(e=i.round(e),t=i.round(t),this.scrollerStyle.left=e+"px",this.scrollerStyle.top=t+"px"),this.x=e,this.y=t,this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].updatePosition()},_initEvents:function(t){var i=t?s.removeEvent:s.addEvent,n=this.options.bindToWrapper?this.wrapper:e;i(e,"orientationchange",this),i(e,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(n,"mousemove",this),i(n,"mousecancel",this),i(n,"mouseup",this)),s.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,"MSPointerDown",this),i(n,"MSPointerMove",this),i(n,"MSPointerCancel",this),i(n,"MSPointerUp",this)),s.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(n,"touchmove",this),i(n,"touchcancel",this),i(n,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t,i,n=e.getComputedStyle(this.scroller,null);return this.options.useTransform?(n=n[s.style.transform].split(")")[0].split(", "),t=+(n[12]||n[4]),i=+(n[13]||n[5])):(t=+n.left.replace(/[^-\d.]/g,""),i=+n.top.replace(/[^-\d.]/g,"")),{x:t,y:i}},_initIndicators:function(){function e(e){for(var t=s.indicators.length;t--;)e.call(s.indicators[t])}var t,i=this.options.interactiveScrollbars,n="string"!=typeof this.options.scrollbars,r=[],s=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(t={el:a("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(t.el),r.push(t)),this.options.scrollX&&(t={el:a("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(t.el),r.push(t))),this.options.indicators&&(r=r.concat(this.options.indicators));for(var l=r.length;l--;)this.indicators.push(new o(this,r[l]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){e(function(){this.fade()})}),this.on("scrollCancel",function(){e(function(){this.fade()})}),this.on("scrollStart",function(){e(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){e(function(){this.fade(1,!0)})})),this.on("refresh",function(){e(function(){this.refresh()})}),this.on("destroy",function(){e(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){s.addEvent(this.wrapper,"wheel",this),s.addEvent(this.wrapper,"mousewheel",this),s.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){s.removeEvent(this.wrapper,"wheel",this),s.removeEvent(this.wrapper,"mousewheel",this),s.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(this.enabled){var t,n,a,o,r=this;if("deltaX"in e?(t=-e.deltaX,n=-e.deltaY):"wheelDeltaX"in e?(t=e.wheelDeltaX/120*this.options.mouseWheelSpeed,n=e.wheelDeltaY/120*this.options.mouseWheelSpeed):t=n="wheelDelta"in e?e.wheelDelta/120*this.options.mouseWheelSpeed:"detail"in e?-e.detail/3*this.options.mouseWheelSpeed:void 0,(!t||this.options.scrollX||this.wheelTimeout)&&(!n||this.options.scrollY||this.wheelTimeout)&&(e.preventDefault(),e.stopPropagation(),void 0===this.wheelTimeout&&r._execEvent("scrollStart"),this.enabled&&(clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){r._execEvent("scrollEnd"),r.wheelTimeout=void 0},400),void 0!=t||void 0!=n))){if(t*=this.options.invertWheelDirection,n*=this.options.invertWheelDirection,this.hasVerticalScroll||(n=0),this.hasHorizontalScroll||(t=0),this.options.snap)return a=this.currentPage.pageX,o=this.currentPage.pageY,t>0?a--:0>t&&a++,n>0?o--:0>n&&o++,void this.goToPage(a,o);a=this.x+i.round(this.hasHorizontalScroll?t:0),o=this.y+i.round(this.hasVerticalScroll?n:0),a>0?a=0:a<this.maxScrollX&&(a=this.maxScrollX),o>0?o=0:o<this.maxScrollY&&(o=this.maxScrollY),this.scrollTo(a,o,0),this.options.probeType>1&&this._execEvent("scroll")}}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var e,t,n,a,o,r,s=0,l=0,c=0,d=this.options.snapStepX||this.wrapperWidth,h=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(n=i.round(d/2),a=i.round(h/2);c>-this.scrollerWidth;){for(this.pages[s]=[],e=0,o=0;o>-this.scrollerHeight;)this.pages[s][e]={x:i.max(c,this.maxScrollX),y:i.max(o,this.maxScrollY),width:d,height:h,cx:c-n,cy:o-a},o-=h,e++;c-=d,s++}else for(r=this.options.snap,e=r.length,t=-1;e>s;s++)(0===s||r[s].offsetLeft<=r[s-1].offsetLeft)&&(l=0,t++),this.pages[l]||(this.pages[l]=[]),c=i.max(-r[s].offsetLeft,this.maxScrollX),o=i.max(-r[s].offsetTop,this.maxScrollY),n=c-i.round(r[s].offsetWidth/2),a=o-i.round(r[s].offsetHeight/2),this.pages[l][t]={x:c,y:o,width:r[s].offsetWidth,height:r[s].offsetHeight,cx:n,cy:a},c>this.maxScrollX&&l++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var e=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.x-this.startX),1e3),i.min(i.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(e,t){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var n=0,a=this.pages.length,o=0;if(i.abs(e-this.absStartX)<this.snapThresholdX&&i.abs(t-this.absStartY)<this.snapThresholdY)return this.currentPage;for(e>0?e=0:e<this.maxScrollX&&(e=this.maxScrollX),t>0?t=0:t<this.maxScrollY&&(t=this.maxScrollY);a>n;n++)if(e>=this.pages[n][0].cx){e=this.pages[n][0].x;break}for(a=this.pages[n].length;a>o;o++)if(t>=this.pages[0][o].cy){t=this.pages[0][o].y;break}return n==this.currentPage.pageX&&(n+=this.directionX,0>n?n=0:n>=this.pages.length&&(n=this.pages.length-1),e=this.pages[n][0].x),o==this.currentPage.pageY&&(o+=this.directionY,0>o?o=0:o>=this.pages[0].length&&(o=this.pages[0].length-1),t=this.pages[0][o].y),{x:e,y:t,pageX:n,pageY:o}},goToPage:function(e,t,n,a){a=a||this.options.bounceEasing,e>=this.pages.length?e=this.pages.length-1:0>e&&(e=0),t>=this.pages[e].length?t=this.pages[e].length-1:0>t&&(t=0);var o=this.pages[e][t].x,r=this.pages[e][t].y;n=void 0===n?this.options.snapSpeed||i.max(i.max(i.min(i.abs(o-this.x),1e3),i.min(i.abs(r-this.y),1e3)),300):n,this.currentPage={x:o,y:r,pageX:e,pageY:t},this.scrollTo(o,r,n,a)},next:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,n++),this.goToPage(i,n,e,t)},prev:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;i--,0>i&&this.hasVerticalScroll&&(i=0,n--),this.goToPage(i,n,e,t)},_initKeys:function(){var t,i={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(t in this.options.keyBindings)"string"==typeof this.options.keyBindings[t]&&(this.options.keyBindings[t]=this.options.keyBindings[t].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(t in i)this.options.keyBindings[t]=this.options.keyBindings[t]||i[t];s.addEvent(e,"keydown",this),this.on("destroy",function(){s.removeEvent(e,"keydown",this)})},_key:function(e){if(this.enabled){var t,n=this.options.snap,a=n?this.currentPage.pageX:this.x,o=n?this.currentPage.pageY:this.y,r=s.getTime(),l=this.keyTime||0,c=.25;switch(this.options.useTransition&&this.isInTransition&&(t=this.getComputedPosition(),this._translate(i.round(t.x),i.round(t.y)),this.isInTransition=!1),this.keyAcceleration=200>r-l?i.min(this.keyAcceleration+c,50):0,e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?a+=n?1:this.wrapperWidth:o+=n?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?a-=n?1:this.wrapperWidth:o-=n?1:this.wrapperHeight;break;case this.options.keyBindings.end:a=n?this.pages.length-1:this.maxScrollX,o=n?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:a=0,o=0;break;case this.options.keyBindings.left:a+=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:o+=n?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:a-=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:o-=n?1:5+this.keyAcceleration>>0;break;default:return}if(n)return void this.goToPage(a,o);a>0?(a=0,this.keyAcceleration=0):a<this.maxScrollX&&(a=this.maxScrollX,this.keyAcceleration=0),o>0?(o=0,this.keyAcceleration=0):o<this.maxScrollY&&(o=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(a,o,0),this.keyTime=r}},_animate:function(e,t,i,n){function a(){var u,p,m,f=s.getTime();return f>=h?(o.isAnimating=!1,o._translate(e,t),void(o.resetPosition(o.options.bounceTime)||o._execEvent("scrollEnd"))):(f=(f-d)/i,m=n(f),u=(e-l)*m+l,p=(t-c)*m+c,o._translate(u,p),o.isAnimating&&r(a),void(3==o.options.probeType&&o._execEvent("scroll")))}var o=this,l=this.x,c=this.y,d=s.getTime(),h=d+i;this.isAnimating=!0,a()},handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":e._constructed||s.preventDefaultException(e.target,this.options.preventDefaultException)||(e.preventDefault(),e.stopPropagation())}}},o.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(s.removeEvent(this.indicator,"touchstart",this),s.removeEvent(this.indicator,"MSPointerDown",this),s.removeEvent(this.indicator,"mousedown",this),s.removeEvent(e,"touchmove",this),s.removeEvent(e,"MSPointerMove",this),s.removeEvent(e,"mousemove",this),s.removeEvent(e,"touchend",this),s.removeEvent(e,"MSPointerUp",this),s.removeEvent(e,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(t){var i=t.touches?t.touches[0]:t;t.preventDefault(),t.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=s.getTime(),this.options.disableTouch||s.addEvent(e,"touchmove",this),this.options.disablePointer||s.addEvent(e,"MSPointerMove",this),this.options.disableMouse||s.addEvent(e,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(e){var t,i,n,a,o=e.touches?e.touches[0]:e,r=s.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.enabled&&(this.moved=!0,t=o.pageX-this.lastPointX,this.lastPointX=o.pageX,i=o.pageY-this.lastPointY,this.lastPointY=o.pageY,n=this.x+t,a=this.y+i,this._pos(n,a),1==this.scroller.options.probeType&&r-this.startTime>300?(this.startTime=r,this.scroller._execEvent("scroll")):this.scroller.options.probeType>1&&this.scroller._execEvent("scroll"),e.preventDefault(),e.stopPropagation())},_end:function(t){if(this.initiated){if(this.initiated=!1,t.preventDefault(),t.stopPropagation(),s.removeEvent(e,"touchmove",this),s.removeEvent(e,"MSPointerMove",this),s.removeEvent(e,"mousemove",this),this.scroller.options.snap){var n=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),a=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.scroller.x-n.x),1e3),i.min(i.abs(this.scroller.y-n.y),1e3)),300);(this.scroller.x!=n.x||this.scroller.y!=n.y)&&(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=n,this.scroller.scrollTo(n.x,n.y,a,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(e){e=e||0,this.indicatorStyle[s.style.transitionDuration]=e+"ms",!e&&s.isBadAndroid&&(this.indicatorStyle[s.style.transitionDuration]="0.001s")},transitionTimingFunction:function(e){this.indicatorStyle[s.style.transitionTimingFunction]=e},refresh:function(){this.transitionTime(),this.indicatorStyle.display=this.options.listenX&&!this.options.listenY?this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.scroller.hasVerticalScroll?"block":"none":this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(s.addClass(this.wrapper,"iScrollBothScrollbars"),s.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(s.removeClass(this.wrapper,"iScrollBothScrollbars"),s.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.options.wrapperWidth||this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=i.max(i.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.options.wrapperHeight||this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=i.max(i.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var e=this.options.listenX&&i.round(this.sizeRatioX*this.scroller.x)||0,t=this.options.listenY&&i.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(e<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=i.max(this.indicatorWidth+e,8),this.indicatorStyle.width=this.width+"px"),e=this.minBoundaryX):e>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=i.max(this.indicatorWidth-(e-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",e=this.maxPosX+this.indicatorWidth-this.width):e=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),t<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=i.max(this.indicatorHeight+3*t,8),this.indicatorStyle.height=this.height+"px"),t=this.minBoundaryY):t>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=i.max(this.indicatorHeight-3*(t-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",t=this.maxPosY+this.indicatorHeight-this.height):t=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=e,this.y=t,this.scroller.options.useTransform?this.indicatorStyle[s.style.transform]="translate("+e+"px,"+t+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=e+"px",this.indicatorStyle.top=t+"px")},_pos:function(e,t){0>e?e=0:e>this.maxPosX&&(e=this.maxPosX),0>t?t=0:t>this.maxPosY&&(t=this.maxPosY),e=this.options.listenX?i.round(e/this.sizeRatioX):this.scroller.x,t=this.options.listenY?i.round(t/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(e,t)},fade:function(e,t){if(!t||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=e?250:500,n=e?0:300;e=e?"1":"0",this.wrapperStyle[s.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(e){this.wrapperStyle.opacity=e,this.visible=+e}.bind(this,e),n)}}},n.utils=s,"undefined"!=typeof module&&module.exports?module.exports=n:e.IScroll=n}(window,document,Math),define("iScroll",function(){}),function(){var e=function(e){this.init(e)};e.prototype={init:function(e){var t={containment:".mask",contentel:".layer-content",mask_width:200,mask_height:100,content_width:1024,content_height:768,content_x:0,content_y:0,throw_enabled:!0,scrollX:!0,scrollY:!0,onScrollStart:null,onScrolling:null,onScrollEnd:null,HWCompositing:!1};return this.options=e?$.extend(!0,{},t,e):t,_.bindAll(this),this._initVaribles(),this._initScrollItems(),this.iScroll},_initVaribles:function(){this.dragged=!1,this.dragstart=!1,this.dragging=!1,this.sliding=!1},_initScrollItems:function(){var e=this;this.containment=this.mask=$(this.options.containment),this.content=$(this.options.contentel),this.containment.css({width:this.options.mask_width,height:this.options.mask_height,overflow:"hidden"}),this.content.css({width:this.options.content_width,height:this.options.content_height}),this.iScroll=new IScroll(this.containment[0],{mouseWheel:!0,probeType:3,click:!0,scrollX:this.options.scrollX,scrollY:this.options.scrollY,wrapperWidth:this.options.mask_width,wrapperHeight:this.options.mask_height,scrollerWidth:this.options.content_width,scrollerHeight:this.options.content_height,HWCompositing:!1}),this.iScroll.scrollTo(this.options.content_x,this.options.content_y),this.iScroll.on("scrollStart",function(){e.options.onScrollStart&&e.options.onScrollStart()}),this.iScroll.on("scroll",function(){var t=!1;console.log(this.y),e.dragstart&&(t=!0),e.options.onScrolling&&e.options.onScrolling({deltaX:this.x,deltaY:this.y,controller:t})}),this.iScroll.on("scrollEnd",function(){e.options.onScrollend&&e.options.onScrollend&&e.options.onScrollend({deltaX:this.x,deltaY:this.y})})},_checkX:function(e){return e-this.options.mask_width<-this.options.content_width&&(e=this.options.mask_width-this.options.content_width),e>0&&(e=0),e
},_checkY:function(e){return e-this.options.mask_height<-this.options.content_height&&(e=this.options.mask_height-this.options.content_height),e>0&&(e=0),e},_getCurrentPosition:function(){var e={x:0,y:0};return e.x=this.iScroll.x,e.y=this.iScroll.y,e}},"undefined"==typeof require?(window._g||(window._g={}),window._g.scrollview=e):define("_g/scrollview",["_g/base","jquery.hammer","underscore","jquery.transit","iScroll"],function(){return window._g.scrollview=e,window._g.scrollview})}(window),function(){var e=function(e){this.init(e)};e.prototype={percent:0,init:function(e){var t={containment:".g-slider",handle:".g-slider-handle",range:".g-slider-range"};return this.options=e?$.extend(!0,{},t,e):t,_.bindAll(this),this.handle=$(this.options.containment).find(this.options.handle).first(),this.range=$(this.options.containment).find(this.options.range).first(),this._bindControl(),this},_bindControl:function(){var e=this;this.handle.hammer().on("dragstart",function(){e.dragstart=!0,e.startleft=parseInt(e.handle.css("left"),10)}),this.handle.hammer().on("drag",function(t){return console.log("dragleft"),e.dragstart=!0,e._doDragingEvent(t),t.gesture.preventDefault(),!1}),this.handle.hammer().on("dragend",function(t){return e.dragstart?(e.dragstart=!1,e._doDragEndEvent(t),t.gesture.preventDefault(),!1):void 0})},_doDragingEvent:function(e){console.log(e);var t=this.startleft,i=this.handle.parent().width(),n=$.zoom||1;t+=e.gesture.deltaX/n,0>t&&(t=0),t>i&&(t=i),this.percent=100*_g.number.decimal(t/i,2),this.handle.css("left",this.percent+"%"),this.range.css("width",this.percent+"%")},_doDragEndEvent:function(){this.options.onChange&&this.options.onChange(this.percent)},change:function(e){this.dragstart||(this.handle.css("left",e+"%"),this.range.css("width",e+"%"))}},"undefined"==typeof require?(window._g||(window._g={}),window._g.slider=e):define("_g/slider",["_g/base","_g/event","jquery.hammer"],function(){return window._g.slider=e,window._g.slider})}(window),function(){var e=["Image","ImageBlock","CycleImage","Slide","Gallery"],t={init:function(){interaction_view.preloadpageactions=new interaction_view.collection.Action},renderActions:function(e,t){for(var i=0;i<e.length;i++){var n=$.extend(!0,{},e[i]),a=new interaction_view.model.Action(n);a.iview.render(),function(e){var i={preload_hash:t,func:function(){e.iview.executeAction(e.iview)}};interaction_view.events.preloadPageEvents.push(i)}(a)}},preload:function(i,n){for(var a=[],o=function(){if(!a.length){var e=_.filter(interaction_view.events.preloadPageEvents,function(e){return e.preload_hash==n});e.length>0&&_.each(e,function(e){e.func()})}},r=0;r<i.length;r++){var s=i[r],l=interaction_view.ipagelist.getPage(s)||interaction_view.imasterlist.get(s)||interaction_view.ibackgroundlist.get(s);if(l){for(var c=l.get("overlays"),d=[],h=0;h<c.length;h++){var u=c[h];if(_.include(["LayerRef","LayerSlide"],u.iType)){var p=u.iDetail.layer_ids||[];d=_.union(d,p)}else if(_.include(e,u.iType)){var m=t.getPreloadImgs(u);a=_.union(a,m)}}if(d.length)for(var f=0;f<d.length;f++){var v=d[f],g=interaction_view.ilayerlist.get(v);if(g)for(var c=g.get("overlays"),h=0;h<c.length;h++){var u=c[h],m=t.getPreloadImgs(u);a=_.union(a,m)}}}}if(a.length)for(var r=0;r<a.length;r++)_e.preloadpage.loadImg(a[r],function(e,t,i){i&&(interaction_view.iImgs[e]=t),a=_.reject(a,function(t){return t==e}),o()});else o()},getPreloadImgs:function(t){var i=[];if(_.include(e,t.iType)){var n=t.iDetail.iImg;if(n&&n.length)for(var a=0;a<n.length;a++)interaction_view.iImgs[n[a].picture]||i.push(n[a].picture)}return i},loadImg:function(e,t){var i=new Image;i.onload=function(){t(e,i,!0)},i.onerror=function(){t(e,i,!1)},i.src=e}};"undefined"==typeof require?(window._e||(window._e={}),window._e.preloadpage=t):define("_e/preloadpage",[],function(){return window._e||(window._e={}),window._e.preloadpage=t,window._e.preloadpage})}(window),function(){window.e_api=function(){var e={custom:{}};return e}(),function(api){api._initialize=function(apis){for(var i=0;i<apis.length;i++){var apidata=apis[i];if(apidata&&apidata.name&&apidata.data){var data=unescape(apidata.data);if(data){data="function(){"+data+"}";try{api.custom[apidata.name]=eval("("+data+")")}catch(e){console.log(e)}}}}},api.doc={goToPage:function(e,t){presentation.gotopagebyargs(e,t)}}}(e_api),"undefined"!=typeof Epub&&Epub||(window.Epub={Player:{},PlayerSDK:{},MessageEvents:[]},window.addEventListener("message",function(e){console.log(e);var t=e.data;if(-1!=t.indexOf("_epub360_2016_player_oauth_"))try{var i=JSON.parse(t),n=i.event;if(Epub.MessageEvents.length)for(var a=0;a<Epub.MessageEvents.length;a++){var o=Epub.MessageEvents[a];o.event==n&&o.func(i.data)}}catch(e){console.log(e)}}),Epub.PlayerSDK.sendMessage=function(e,t){for(var i={oauth:"_epub360_2016_player_oauth_",data:t,event:e||"message"},n=document.getElementsByTagName("IFRAME"),a=JSON.stringify(i),o=0;o<n.length;o++)n[o].contentWindow.postMessage(a,"*")},Epub.PlayerSDK.onMessage=function(e,t){e||(e="message"),Epub.MessageEvents.push({event:e,func:t})},Epub.PlayerSDK.offMessage=function(e,t){if(e){for(var i=[],n=0;n<Epub.MessageEvents.length;n++){var a=Epub.MessageEvents[n];t?a.event==e&&t==a.func||i.push(a):a.event==e||i.push(a)}Epub.MessageEvents=i}})}(window),define("_e/api",function(){}),function(){function e(e,t){this.queue=e,this._callbacks=[],t&&(t.done=this.done,this.func=t)}function t(t){function i(e){return function(){o+=1,a[e]=Array.prototype.slice.call(arguments),o===r&&n.done(a)}}var n=new e,a=[];if(!t||!t.length)return n.done(a),n;for(var o=0,r=t.length,s=0;r>s;s++)t[s].then(i(s));return n}function i(t,n){var a=new e;return 0===t.length?a.done.apply(a,n):t[0].apply(null,n).then(function(){t.splice(0,1),i(t,arguments).then(function(){a.done.apply(a,arguments)})}),a}function n(e){if(this.options={},"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.init()}e.prototype.then=function(t,i){var n;return this._isdone?n=t.apply(i,this.result):(n=new e,this._callbacks.push(function(){var e=t.apply(i,arguments);e&&"function"==typeof e.then&&e.then(n.done,n)})),n},e.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var e=0;e<this._callbacks.length;e++)this._callbacks[e].apply(null,arguments);this._callbacks=[],this.queue&&this.queue.next.apply(this.queue,arguments)},n.prototype.init=function(){this.queues=[],this.pointer=null},n.prototype.add=function(t){var i=new e(this,t);return this.queues.push({func:i,type:1}),this._exec(),i},n.prototype.immediate=function(e){this.queues.push({type:0,func:e}),this._exec()},n.prototype.length=function(){return this.queues.length},n.prototype.next=function(e){e?this.error(e):(this.pointer=null,this._exec())},n.prototype._exec=function(){!this.pointer&&this.queues.length&&(this.queues.length&&(this.pointer=this.queues.shift()),0===this.pointer.type?(this.pointer.func(),this.pointer=null,this._exec()):this.pointer.func.func())},n.prototype.error=function(e){console.log(e),this.queues=[],this.pointer=null},window.Queue=n,window.promise={Promise:e,join:t,chain:i,ENOXHR:1,ETIMEOUT:2}}(window),define("_e/queue",function(){}),function(){window.dboperate=function(e){this.defaults={db_id:"",query:[],fields:[]},this.option=e,this.options=$.extend(!0,{},this.defaults,"object"==typeof e&&e)},window.dboperate.prototype={init:function(){var e=this.options.operation,t=interaction_view.dblist.get(this.options.datalistid.split(".")[0].split("$d_")[1]).attributes.sheet_id;this.listid=t,this.db=new DB.DBObject(this.listid),_.bindAll(this),"add"==e?this.addValue():"del"==e?this.deleteValue():"upd"==e&&this.setValue()},query:function(){if(!epub360.dbs){var e=Backbone.Model.extend({defaults:{query:{},fields:[]}}),t=Backbone.Collection.extend({model:e});epub360.dbs=new t}_.each(interaction_view.dblist.models,function(e){{var t,i=e.attributes.querys,n=e.attributes.sheet_id;e.attributes.db_id}_.each(i,function(e){var i=e.id,a=new DB.DBQuery,o=new DB.DBFilter({key:e.filter[0].key,value:e.filter[0].value}),r=new DB.DBFilter({key:e.filter[1].key,value:e.filter[1].value});e.fetch_fields&&a.addFields(e.fetch_fields),e.sort&&a.addSort(e.sort.field,1==e.sort.order?"ASC":"DESC"),e.scope&&a.addScope(e.scope),e.op&&(t="0"==e.op?o.and(r):o.or(r)),a.addFilter(t),a.Query(n,function(e){var e=e.data.results,t={};DB.Utils.setOpt(t,i,e),epub360.dbs.add({query:t})},function(e){console.log(e)})})})},setFields:function(){_.each(interaction_view.dblist.models,function(e){var t=e.attributes.db_id,i=e.attributes.fields;epub360.dbs[t].fields=i})},getDb:function(){},getValue:function(){},save:function(){},setValue:function(){this.db.updateRecord()},addValue:function(){this.db.flushRecord(!0,this.listid,this.options.fields,function(){},function(){})},deleteValue:function(){this.db.deleteRecord()},getrule:function(){}}}(window),define("_e/dboperate",function(){}),function(e){e.connector={dragcontroller:function(e,t,i,n){if(e.data("dragArgs"))var a=e.data("dragArgs");else{var a=new connector.controller({dom:e,funcs:i});e.data("dragArgs",a)}a.handle(t,n)},getDragArgs:function(e){for(var t={0:{funcs:[],start:0,end:0,range:0,_current:0,_delta:0},1:{funcs:[],start:0,end:0,range:0,_current:0,_delta:0}},i=0;i<e.length;i++){var n=(1==e[i].axis||3==e[i].axis)&&1||0;t[n].funcs.push(e[i])}return t},clearDragController:function(e){var t=e.data("dragArgs");t&&t.clear()},removeDragController:function(e){e.removeClass("is_exceededY").removeClass("is_exceededX"),e.data("dragArgs",null),e.data("dragfuncs",null)}},connector.controller=function(e){if(this.options={dom:null,funcs:null},"object"==typeof e)for(var t in e)e.hasOwnProperty(t)&&(this.options[t]=e[t]);this.init()},connector.controller.prototype.init=function(){this.args=connector.getDragArgs(this.options.funcs),this.dom=this.options.dom},connector.controller.prototype.handle=function(t,i){var n=this.args,a={0:0,1:0};if("dragend"!=t.type){this.inertiaTimer&&e.clearInterval(this.inertiaTimer);var o=1===i?"Y":"X";a[i]=t.gesture["delta"+o];for(var r={0:{max:0,min:0},1:{max:0,min:0}},s=0;s<n[i].funcs.length;s++){var l=n[i].funcs[s].func(t,a[i]);l&&0>l&&r[i].min>l&&(r[i].min=l),l&&l>0&&r[i].max<l&&(r[i].max=l)}i&&r[i].min<-30&&this.dom.attr("data-up")?this.dom.addClass("is_exceededY"):i&&r[i].max>30&&this.dom.attr("data-down")?this.dom.addClass("is_exceededY"):!i&&r[i].min<-30&&this.dom.attr("data-left")?this.dom.addClass("is_exceededX"):!i&&r[i].max>30&&this.dom.attr("data-right")&&this.dom.addClass("is_exceededX")}else{for(j=0;2>j;j++)for(var s=0;s<n[j].funcs.length;s++)n[j].funcs[s].func(t);this.inertia(t)}},connector.controller.prototype.clear=function(){this.inertiaTimer&&e.clearInterval(this.inertiaTimer),this.dom.removeClass("is_exceededY").removeClass("is_exceededX")},connector.controller.prototype.inertia=function(t){var i=3*t.gesture.velocityX,n=3*t.gesture.velocityY,a=this,o=this.args,r=0;this.inertiaTimer&&e.clearInterval(this.inertiaTimer),this.inertiaTimer=e.setInterval(function(){var s={0:0,1:0};if(n>0&&(s[1]=t.gesture.deltaY/Math.abs(t.gesture.deltaY)*n),i>0&&(s[0]=t.gesture.deltaX/Math.abs(t.gesture.deltaX)*i),i>0)for(var l=0,c=0;c<o[l].funcs.length;c++)o[l].funcs[c].func(t,s[0],!0);if(n>0)for(var l=1,c=0;c<o[l].funcs.length;c++)o[l].funcs[c].func(t,s[1],!0);n-=1e-5*r*r,i-=1e-5*r*r,0>=i&&0>=n&&e.clearInterval(a.inertiaTimer),r+=1},1)},connector.controller.prototype.excceeded=function(){},connector.controller.prototype.end=function(){}}(window),define("_e/connector",function(){}),function(e){var t=window.DB={};t.OptionBase={},t.Sync={},t.DBObject={},t.Utils={},t.DB=t,t.instants={};var i=t.DBObject=function(e){var i=this;return e?(i.className=e,i.baseUrl="http://data.21epub.com",void(t.instants[e]=i)):(console.log("å¯¹ä¸èµ·,åæ°classNameä¸è½ä¸ºç©º!"),!1)};i.prototype={extend:function(e){return d.extend(this,e,!0)},saveTable:function(e,t,i){var n=this;void 0==e&&(e=!0),n.post(n.baseUrl+"/tables/",e?JSON.stringify(n):n,t,i)},getTableObject:function(e){var t=this,n=new i(e);return t.options(t.baseUrl+"/tables/"+e+"/",{},function(e){"200"==e.code&&d.extend(n,e.data.results,!1)},function(){n=null},!1),n},convert2Table:function(e){var i=new t.DBObject(e.className);return d.extend(i,e,!1),i},getTableFields:function(e,t,i){var n=this;n.options(n.baseUrl+"/tables/"+e+"/",{},t,i)},updateTable:function(e,t,i,n,a){var o=this;void 0==e&&(e=!0),o.put(o.baseUrl+"/tables/"+t+"/",e?JSON.stringify(i):i,n,a)},deleteTable:function(e,t,i){var n=this;n.delete(n.baseUrl+"/tables/"+e+"/",{},t,i)},getTableRules:function(e){var t=this,i={};return t.get(t.baseUrl+"/tables/"+e+"/info/",{},function(e){if(e){var t=e.data.results[0].user_info,n=e.data.results[0].table_rule;d.extend(i,t,!1),d.extend(i,n,!1)}},function(){i={}},!1),i},flushRecord:function(e,t,i,n,a){var o=this;o.post(o.baseUrl+"/tables/"+t+"/objects/",e?JSON.stringify(i):i,n,a)},updateRecord:function(e,t,i,n,a,o){var r=this;r.put(r.baseUrl+"/tables/"+tableId+"/objects/"+i+"/",e?JSON.stringify(n):n,a,o)},deleteRecord:function(e,t,i,n){var a=this;a.delete(a.baseUrl+"/tables/"+e+"/objects/"+t+"/",{},i,n)},deleteRecords:function(e,t,i,n){var a=this;a.delete(a.baseUrl+"/tables/"+e+"/objects/",{ids:t},i,n)}};var n=t.DBConfig=function(e){this.hit=e||0,this.start=0};n.prototype={setPage:function(e){var t=this;return t.start=t.hit*e,t},getPage:function(){return this.start/this.hit},nextPage:function(){var e=this;return e.start+=e.hit,e},prevPage:function(){var e=this;return e.start-=e.hit,e.start<0&&(e.start=0),e},setCount:function(e){var t=this;return t.hit=e,this},getCount:function(){return this.hit}};var a=t.DBAggregate=function(e){d.setOpt(this,"group_key",e)};a.prototype={sum:function(e){var t=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==t?"sum("+e+")":t+"#sum("+e+")"),this},max:function(e){var t=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==t?"max("+e+")":t+"#max("+e+")"),this},min:function(e){var t=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==t?"min("+e+")":t+"#min("+e+")"),this},count:function(){var e=d.getOpt(this,"agg_fun")||"";return d.setOpt(this,"agg_fun",""==e?"count()":e+"#count()"),this},setRange:function(e,t){return d.setOpt(this,"range",e+"~"+t),this},setFilter:function(e){return d.setOpt(this,"agg_filter",e),this},setSamplerThreshold:function(e,t){return d.setOpt(this,"agg_sampler_threshold",e),d.setOpt(this,"agg_sampler_step",t),this},setMaxGroup:function(e){return d.setOpt(this,"max_group",e),this}};var o=t.DBLimit=function(){};o.prototype={equalTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),this},and:function(e){var t={opt:"AND",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new o;return i.statement=t,i},or:function(e){var t={opt:"OR",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new o;return i.statement=t,i},and_not:function(e){var t={opt:"ANDNOT",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new o;return i.statement=t,i},rank:function(e){var t={opt:"RANK",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new o;return i.statement=t,i}};var r=t.DBFilter=function(e){if(e&&e.key&&e.value){var t=this.analysz(e.value);this.key=e.key,d.extend(this,t,!1)}};r.prototype={analysz:function(e){var t={option:"=",value:""},i=d.trim(e,"g"),n=["<","<=",">",">=","=","!="],a=0;return i&&(d.each(n,function(e){0==i.indexOf(e)&&(a=1,t.option=e,t.value=i.substr(e.length))}),0==a&&(t.option="=",t.value=e)),t},and:function(e){var t={opt:"AND",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new r;return i.statement=t,i},or:function(e){var t={opt:"OR",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new r;return i.statement=t,i},and_not:function(e){var t={opt:"ANDNOT",values:[]};t.values.push(this),d.isArray(e)?d.each(e,function(e){t.values.push(e)}):t.values.push(e);var i=new r;return i.statement=t,i},equalTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option","="),this},notEqualTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option","!="),this},lessThan:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option","<"),this},lessThanOrEqualTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option","<="),this},greaterThan:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option",">"),this},greaterThanOrEqualTo:function(e,t){return d.setOpt(this,"key",e),d.setOpt(this,"value",t),d.setOpt(this,"option",">="),this}};var s=t.DBQuery=function(){var e=this;e.aggregate=[],e.baseUrl="http://data.21epub.com"};s.prototype={addAggregate:function(e){var t=this;return e&&t.aggregate.push(e),this},addLimit:function(e){var t=this;return e&&(t.query=e),this},addFilter:function(e){var t=this;return e&&(t.filter=e),this},addSort:function(e,t){if(!e||!t)return this;this.sort||(this.sort=[]);var i="ASC"==t.toUpperCase()?"+":"-";return this.sort.push(i+e),this},addConfig:function(e){var t=this;return e&&(t.config=e),this},addSQL:function(e){var t=this;return t.execSQL=e,t},addFields:function(e){var t=this;return t.fetch_fields||(t.fetch_fields=[]),d.isArray(e)&&d.each(e,function(e){t.fetch_fields.push(e)}),t},addScope:function(e){var t=this;return t.scope=e,t},Query:function(e,t,i){var n=this;n.send("get",n.baseUrl+"/tables/"+e+"/objects/",{data:JSON.stringify(n)},t,i)}};var l=t.Sync=function(){};l.prototype={send:function(t,i,n,a,o,r){return null!=t&&(t=t.toUpperCase()),i?(void 0==r&&(r=!0),"POST"!=t&&"PUT"!=t&&"GET"!=t&&"DELETE"!=t&&"OPTIONS"!=t?void console.log("å¯¹ä¸èµ·,è¯·æ±çæ¹æ³ä¸æ­£ç¡®!"):void e.ajax({type:t,url:i,data:n,async:r,contentType:"application/json",xhrFields:{withCredentials:!0},dataType:"json",crossDomain:!0,success:function(e,t,i){200==e.code?a&&a(e,i):o&&o(e,i)},error:function(e,t,i){o&&o(e,i)}})):void 0},post:function(e,t,i,n){this.send("POST",e,t,i,n)},get:function(e,t,i,n,a){this.send("GET",e,t,i,n,a)},put:function(e,t,i,n){this.send("PUT",e,t,i,n)},"delete":function(e,t,i,n){this.send("delete",e,t,i,n)},options:function(e,t,i,n){this.send("options",e,t,i,n)}};var c=t.OptionBase=function(){};c.prototype={addField:function(e){var t=this;return t.fields||(t.fields=[]),null!=e&&(d.isObject(e)&&t.fields.push(e),d.isArray(e)&&d.each(e,function(e){t.fields.push(e)})),this},addTitle:function(e){return d.setOpt(this,"title",e),this},addStartDate:function(e){return d.setOpt(this,"start",e),this},addEndDate:function(e){return d.setOpt(this,"end",e),this},addRule:function(e){return d.setOpt(this,"rule",e),this},addOpt:function(e,t){return d.setOpt(this,e,t),this},updateField:function(e,t,i){var n=this,a=n.fields;return d.each(a,function(n){n.cid==e&&(n[t]=i)}),this},getField:function(e,t){var i;return d.each(this.fields,function(n){return n[e]==t?(i=n,!1):void 0}),i},getFields:function(){return this.fields},removeField:function(e,t){var i=this,n=i.fields;return d.each(n,function(i,a){return i[e]==t?(n.splice(a,1),!1):void 0}),i},removeAll:function(){this.fields=[]}};var d=t.Utils={trim:function(e,t){var i;return i=e.replace(/(^\s+)|(\s+$)/g,""),"g"==t.toLowerCase()&&(i=i.replace(/\s/g,"")),i},each:function(e,t,i){if(null!=e)if(e.length===+e.length){for(var n=0,a=e.length;a>n;n++)if(t.call(i,e[n],n,e)===!1)return!1}else for(var o in e)if(e.hasOwnProperty(o)&&t.call(i,e[o],o,e)===!1)return!1},setOpt:function(e,t,i){var n={};d.isString(t)?n[t]=i:n=t,d.extend(e,n,!1)},getOpt:function(e,t){return e[t]},contains:function(e,t){for(var i=e.length;i--;)if(e[i]===t)return!0;return!1},clone:function(e,t){var i;t=t||{};for(var n in e)e.hasOwnProperty(n)&&(i=e[n],"object"==typeof i?(t[n]=d.isArray(i)?[]:{},d.clone(e[n],t[n])):t[n]=i);return t},inherits:function(e,t){var i=e.prototype,n=d.makeInstance(t.prototype);return d.extend(n,i,!0),e.prototype=n,n.constructor=e},extend:function(e,t,i){if(t)for(var n in t)i&&e.hasOwnProperty(n)||(e[n]=t[n]);return e},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},delArray:function(e,t){return 0>t?this:e.slice(0,t).concat(e.slice(t+1,e.length))}};d.each(["String","Function","Array","Number","RegExp","Object","Date"],function(e){t.Utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}}),d.inherits(i,c),d.inherits(i,l),d.inherits(i,s),d.inherits(s,l)}(window.jQuery),define("thirdparty/dataEngine/dataEngine",["jquery"],function(){}),define("interaction_view/touchmain",["interaction_view/model/main","interaction_view/ui/main","interaction_view/ui/presentation","interaction_view/ui/control","interaction_view/ui/event","interaction_view/ui/environment","interaction_view/ui/media","interaction_view/ui/adapt","interaction_view/ui/analytics","interaction_view/ui/application","interaction_view/ui/weixin","_g/touchslide2","_g/device","_g/mousewheel","share/main","jquery.actual","interaction_view/ui/screenset","interaction_view/ui/touchinit","interaction_view/ui/timeline","interaction_view/ui/expression","interaction_view/ui/pluginmanage","coverFlow","_e/eraser","_e/cssanimate","_e/animate","screenfull","greensock/TweenMax","_e/scrollpage","jswait","greensock/plugins/DrawSVGPlugin","greensock/plugins/MorphSVGPlugin","greensock/plugins/TextPlugin","_g/scrollview","_g/slider","screenfull","_e/preloadpage","_e/api","_e/queue","_e/dboperate","_e/connector","thirdparty/dataEngine/dataEngine"],function(){var e=require("interaction_view/ui/main");interaction_view.force3D=!1,interaction_view=$.extend({},interaction_view,e),interaction_view.weixin=require("interaction_view/ui/weixin"),interaction_view.control=require("interaction_view/ui/control"),interaction_view.events=require("interaction_view/ui/event"),interaction_view.environment=require("interaction_view/ui/environment"),interaction_view.media=require("interaction_view/ui/media"),interaction_view.screenset=require("interaction_view/ui/screenset"),window._e||(window._e={}),interaction_view.adapt=require("interaction_view/ui/adapt"),interaction_view.analytics=require("interaction_view/ui/analytics"),interaction_view.application=require("interaction_view/ui/application"),(_g.device.mobile()||_g.device.tablet())&&(interaction_view.ismobile=!0),interaction_view.touchview=!0,interaction_view.isAndroid=interaction_view.android=_g.device.android(),interaction_view.isWeixin=_g.device.isWeixin(),interaction_view.isIos=_g.device.ios(),interaction_view.isWin=_g.device.windows(),interaction_view.isMac=_g.device.mac(),interaction_view.touchinit=require("interaction_view/ui/touchinit"),interaction_view.touchinit.init()}),$.presentate=function(){return this.render(),this},$.presentate.prototype={render:function(){interaction_view.screenset.controlbarel&&(this.share_overlay=interaction_view.screenset.controlbarel.find(".action-share"),this.control=interaction_view.screenset.controlbarel,this.actualsize=this.control.find(".actualsize"),this.adaptive=this.control.find(".adaptive"),this.fullscreen=this.control.find(".fullscreen"),this.over=this.control.find(".overview")),"player"==_g.getUrlParameterByName("mode")&&(this.fullscreen.hide(),parent.postMessage&&parent.postMessage("epub360fullscreen","*"),console.log("not allowed screenfull")),this.click_event_name="click",interaction_view.screenset.controlbarel&&this.delegate_event()},size_share_overlay:function(){var e=this.share_overlay.children();$("html").width()>=600&&$("html").height()>=460?(e.width(560),e.height(220),e.find("#small_share").hide(),e.find("#normal_share").show()):(e.width($("html").width()/2),e.height($("html").height()/2),e.find("#small_share").show(),e.find("#normal_share").hide()),e.css("margin-top",-e.height()/2),e.css("margin-left",-e.width()/2)},delegate_event:function(){var e=this;this.share_overlay&&(this.share_overlay.on(e.click_event_name,function(t){t.target==$(this)[0]&&e.share_overlay.hide()}),this.share_overlay.find(".btn-close").on(e.click_event_name,function(){e.share_overlay.hide()}),this.share_overlay.find("input").mouseenter(function(){$(this).select()})),this.fullscreen.on(e.click_event_name,function(){return screenfull.enabled?void(screenfull.enabled&&!isFullscreen?screenfull.request(document.documentElement):screenfull.exit()):void window.open(window.location.href.replace("autoplay=false",""))}),_g.device.msie()?(window._IE_resize=function(){$(".reveal").css({margin:"0px",top:($("body").height()-$(".reveal").height()*$(".reveal")[0].style.zoom)/2,left:($("body").width()-$(".reveal").width()*$(".reveal")[0].style.zoom)/2})},_IE_resize(),$(window).resize(_IE_resize)):window._IE_resize=function(){},this.actualsize&&this.actualsize.on(e.click_event_name,function(){$(this).hasClass("active")||(e.over.hasClass("active")&&Reveal.toggleOverview(!1),e.state="actualsize",$(this).siblings().removeClass("active"),$(this).addClass("active"),screenSizeLock(),interaction_view.touchview||($(window).unbind("resize",_IE_resize),$(".reveal").css({top:0,left:0})),_IE_resize())}),this.adaptive&&this.adaptive.on(e.click_event_name,function(){$(this).hasClass("active")||(e.over.hasClass("active")&&Reveal.toggleOverview(!1),e.state="adaptive",$(this).siblings().removeClass("active"),$(this).addClass("active"),screenSizeRelease(),interaction_view.touchview||(_IE_resize(),$(window).resize(_IE_resize)),_IE_resize())}),this.share_overlay&&this.share_overlay.on(e.click_event_name,function(){share(interaction_view.doc.toJSON().title,context_url+"player")}),this.over&&this.over.on(e.click_event_name,function(){interaction_view.touchview?Reveal.toggleOverview(!0):$(this).hasClass("active")?e.control.find("."+e.state).trigger(e.click_event_name):(e.adaptive.parent().children().removeClass("active"),Reveal.toggleOverview(!0))})}},define("interaction_play/presentate",["bootstrap"],function(){}),require(["interaction_view/touchmain","bootstrap","_g/base","interaction_play/presentate"],function(){window.start_player=function(){_g.browserSupport({msie:8,chrome:1,safari:1,mozilla:1})?(interaction_view.init(),$(".return a").live("click",function(){var e=location.search,t={};if(-1!=e.indexOf("?")){var i=e.substr(1);strs=i.split("&");for(var n=0;n<strs.length;n++)t[strs[n].split("=")[0]]=unescape(strs[n].split("=")[1])}return"page"==t.from&&$(window.parent.document.getElementById("PreviewWindow")).remove(),!1})):_g.ajax.get({url:"index.json",callback:function(e){if(console.log(e),200==e.code&&e.data){var t=String(e.data.slave_url);window.location.href=t&&t.length?t:"/staticfs/admin-epub360/browser-old.html"}else window.location.href="/staticfs/admin-epub360/browser-old.html"}})}}),define("common/js/interaction_view/desktop.js",function(){});